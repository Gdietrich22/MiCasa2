[
    {
        "id": "50119c6e.6ff584",
        "type": "tab",
        "label": "Temperaturas",
        "disabled": false,
        "info": ""
    },
    {
        "id": "3ce5b54a.127d6a",
        "type": "tab",
        "label": "Baterias/Alarma",
        "disabled": false,
        "info": ""
    },
    {
        "id": "73083520.75304c",
        "type": "tab",
        "label": "Lavadero",
        "disabled": false,
        "info": ""
    },
    {
        "id": "1b403a13.0ec8c6",
        "type": "tab",
        "label": "Termo Solar",
        "disabled": false,
        "info": ""
    },
    {
        "id": "950c1426.ff4008",
        "type": "tab",
        "label": "Baño",
        "disabled": false,
        "info": ""
    },
    {
        "id": "9c63fd61.9908c",
        "type": "tab",
        "label": "Config Genericas",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a89e305a.c50bb",
        "type": "tab",
        "label": "Iluminacion Living",
        "disabled": false,
        "info": ""
    },
    {
        "id": "e364a467.07a6a8",
        "type": "tab",
        "label": "Dolar",
        "disabled": false,
        "info": ""
    },
    {
        "id": "f682d492.22a758",
        "type": "tab",
        "label": "BackUp",
        "disabled": false,
        "info": ""
    },
    {
        "id": "7ac92c99.66ea94",
        "type": "tab",
        "label": "Google Now",
        "disabled": false,
        "info": ""
    },
    {
        "id": "65561250.4225fc",
        "type": "tab",
        "label": "Salamandra",
        "disabled": false,
        "info": ""
    },
    {
        "id": "deff4396.4722a",
        "type": "tab",
        "label": "Cortinas",
        "disabled": false,
        "info": ""
    },
    {
        "id": "230e7f04.aca52",
        "type": "tab",
        "label": "Pruebas",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a27bf9ec.e6e2f8",
        "type": "tab",
        "label": "Escaleras/Pergola",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a43ba0fe.679e4",
        "type": "tab",
        "label": "Caldera",
        "disabled": false,
        "info": ""
    },
    {
        "id": "5c310d6f.5422c4",
        "type": "tab",
        "label": "prueba",
        "disabled": false,
        "info": ""
    },
    {
        "id": "71fbfc8a.29b834",
        "type": "tab",
        "label": "Flow 1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "f932890b.a73458",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "b86d561e.834378",
        "type": "serial-port",
        "serialport": "/dev/ttyUSB0",
        "serialbaud": "9600",
        "databits": "8",
        "parity": "none",
        "stopbits": "1",
        "newline": "\\n",
        "bin": "false",
        "out": "char",
        "addchar": false
    },
    {
        "id": "e779f8d6.7bc2c8",
        "type": "mqtt-broker",
        "name": "",
        "broker": "127.0.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "c339edbf.39572",
        "type": "mqtt-broker",
        "name": "",
        "broker": "127.0.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "637ff0bd.3c84b",
        "type": "mqtt-broker",
        "name": "",
        "broker": "127.0.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "43555c62.30ed34",
        "type": "mqtt-broker",
        "name": "",
        "broker": "127.0.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "900627dc.76e6a8",
        "type": "mqtt-broker",
        "name": "",
        "broker": "127.0.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "6b36e4a.1d30b1c",
        "type": "mqtt-broker",
        "name": "",
        "broker": "127.0.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "3fe9d635.ec409a",
        "type": "mqtt-broker",
        "name": "",
        "broker": "127.0.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "af08803a.808f4",
        "type": "mqtt-broker",
        "name": "",
        "broker": "127.0.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "d1041da5.a5788",
        "type": "ui_tab",
        "name": "Home",
        "icon": "dashboard",
        "order": 2
    },
    {
        "id": "e73b3a0d.765918",
        "type": "ui_tab",
        "name": "Principal",
        "icon": "dashboard",
        "order": 1
    },
    {
        "id": "265ca5a8.8a0dca",
        "type": "ui_tab",
        "name": "Pruebas",
        "icon": "dashboard"
    },
    {
        "id": "ff2252ef.d12aa",
        "type": "ui_group",
        "name": "Pruebas",
        "tab": "265ca5a8.8a0dca",
        "order": 3,
        "disp": true,
        "width": "8",
        "collapse": false
    },
    {
        "id": "177e0064.22348",
        "type": "ui_group",
        "name": "Salamandra",
        "tab": "d1041da5.a5788",
        "order": 1,
        "disp": false,
        "width": "16",
        "collapse": false
    },
    {
        "id": "6a6e2505.7b8a5c",
        "type": "ui_group",
        "name": "Living",
        "tab": "e73b3a0d.765918",
        "order": 1,
        "disp": true,
        "width": "5",
        "collapse": false
    },
    {
        "id": "1c362bad.cfd2e4",
        "type": "ui_group",
        "name": "Lavadero",
        "tab": "e73b3a0d.765918",
        "order": 3,
        "disp": true,
        "width": "5",
        "collapse": false
    },
    {
        "id": "1134b585.4c9e0a",
        "type": "ui_group",
        "name": "Datos Baterias",
        "tab": "e73b3a0d.765918",
        "order": 4,
        "disp": true,
        "width": "8",
        "collapse": false
    },
    {
        "id": "1a0f799.46f9186",
        "type": "ui_group",
        "name": "Baño",
        "tab": "e73b3a0d.765918",
        "order": 2,
        "disp": true,
        "width": "5",
        "collapse": false
    },
    {
        "id": "ff8a613f.fd5b7",
        "type": "ui_group",
        "name": "Cortinas",
        "tab": "265ca5a8.8a0dca",
        "order": 2,
        "disp": true,
        "width": "8",
        "collapse": false
    },
    {
        "id": "2c18e412.5f5cbc",
        "type": "blynk-ws-client",
        "name": "wss://127.0.0.1:9443/websockets",
        "path": "wss://127.0.0.1:9443/websockets",
        "key": "MJt3Wz2UszrRxCmfySOnfivyD5vF-d9C",
        "dbg_all": true,
        "dbg_read": false,
        "dbg_write": false,
        "dbg_notify": false,
        "dbg_mail": false,
        "dbg_prop": false,
        "dbg_sync": false,
        "dbg_bridge": false,
        "dbg_low": false,
        "dbg_pins": "",
        "multi_cmd": false,
        "proxy_type": "no",
        "proxy_url": ""
    },
    {
        "id": "32cfc6d9.2fc4aa",
        "type": "ui_tab",
        "name": "Salamandra",
        "icon": "dashboard"
    },
    {
        "id": "bb26301d.077de",
        "type": "ui_group",
        "name": "Principal",
        "tab": "32cfc6d9.2fc4aa",
        "order": 2,
        "disp": false,
        "width": "14",
        "collapse": false
    },
    {
        "id": "ce850dc4.5180c",
        "type": "ui_group",
        "name": "Default",
        "tab": "32cfc6d9.2fc4aa",
        "order": 1,
        "disp": false,
        "width": "6",
        "collapse": false
    },
    {
        "id": "8cf8292c.1cbf98",
        "type": "ui_group",
        "name": "Cocina",
        "tab": "e73b3a0d.765918",
        "disp": true,
        "width": "5",
        "collapse": false
    },
    {
        "id": "411b27cf.122ad8",
        "type": "function",
        "z": "230e7f04.aca52",
        "name": "",
        "func": "msg = {topic: \"ESP/Bano/Recibo\", payload: \"D\" + parseInt(msg.topic) + msg.payload};\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "x": 410,
        "y": 220,
        "wires": [
            [
                "20706a8e.08ded6"
            ]
        ]
    },
    {
        "id": "20706a8e.08ded6",
        "type": "mqtt out",
        "z": "230e7f04.aca52",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 570,
        "y": 220,
        "wires": []
    },
    {
        "id": "737f249a.6f982c",
        "type": "mqtt in",
        "z": "230e7f04.aca52",
        "name": "",
        "topic": "ESP/Bano/Debug",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 410,
        "y": 300,
        "wires": [
            [
                "f1992d54.9e6b6"
            ]
        ]
    },
    {
        "id": "e9e852e6.2ee3f",
        "type": "mqtt in",
        "z": "230e7f04.aca52",
        "name": "",
        "topic": "ESP/Bano/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 430,
        "y": 380,
        "wires": [
            [
                "f1992d54.9e6b6"
            ]
        ]
    },
    {
        "id": "d45c90b5.820a2",
        "type": "debug",
        "z": "230e7f04.aca52",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 670,
        "y": 30,
        "wires": []
    },
    {
        "id": "718a8d11.6f6294",
        "type": "mqtt in",
        "z": "230e7f04.aca52",
        "name": "",
        "topic": "ESP/Bano/Recibo",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 480,
        "y": 40,
        "wires": [
            [
                "d45c90b5.820a2"
            ]
        ]
    },
    {
        "id": "c4d6adc9.7d5d7",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "",
        "func": "msg.payload = msg.payload.replace(\",\", \".\");\nglobal.set(\"MaximoVender\", parseFloat(msg.payload).toFixed(2));\nnode.status({text: \"MaximoVender:\" + global.get(\"MaximoVender\")});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 460,
        "y": 160,
        "wires": [
            [
                "33996b47.4d3bc4"
            ]
        ]
    },
    {
        "id": "b9c8c2ba.5fe5c",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "",
        "func": "msg.payload = msg.payload.replace(\",\", \".\");\nglobal.set(\"MinimoVender\", parseFloat(msg.payload).toFixed(2));\nnode.status({text: \"MinimoVender:\" + global.get(\"MinimoVender\")});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 459.9999694824219,
        "y": 110.00000095367432,
        "wires": [
            [
                "33996b47.4d3bc4"
            ]
        ]
    },
    {
        "id": "57eb3056.92d7d",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "Patagonia",
        "func": "var dolarCompra;\nvar dolarVenta;\nvar payload = msg.payload;\nvar compra;\nvar venta;\n\npayload = payload.substring(payload.indexOf(\"nbsp\")+5); compra = payload.substring(0, payload.indexOf(\"</td>\"));\npayload = payload.substring(payload.indexOf(\"nbsp\")+5); venta = payload.substring(0, payload.indexOf(\"</td>\"));\n\ncompra = compra.replace(\",\", \".\");\nventa = venta.replace(\",\", \".\");\n\ncompra = parseFloat(compra).toFixed(2);\nventa = parseFloat(venta).toFixed(2);\n\nmsg = {pin:65, payload: \"$ \"+compra + \"  --  \" + \"$ \" + venta};\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 374.1666717529297,
        "y": 466.1111316680908,
        "wires": [
            [
                "21fc9b0b.e0f5b4",
                "9f8c863a.5e4538"
            ]
        ]
    },
    {
        "id": "5d42fd8.e980404",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "Dolar",
        "func": "var dolarCompra;\nvar dolarVenta;\nvar payload = msg.payload;\nvar compra;\nvar venta;\ncontext.minimo = context.minimo || 0;\ncontext.maximo = context.maximo || 0;\ncontext.minimoVender = context.minimoVender || 0;\ncontext.maximoVender = context.maximoVender || 0;\ncontext.comprarDolares = context.comprarDolares || 0;\ncontext.comprarDolaresCaro = context.comprarDolaresCaro || 0;\nvar datos;\nvar date = new Date();\nvar frecuencia = 15;\nvar dia = date.getDay();\nvar hh = date.getHours();\nvar mm = date.getMinutes();\nvar ss = date.getSeconds();\nif (hh===0 && mm===0 && ss===0){\n    context.minimo = 100;\n    context.maximo = 0;\n    context.inicio = 0;\n}\n\npayload = payload.substring(payload.indexOf(\"$\")+2); compra = payload.substring(0, payload.indexOf(\"</t\"));\npayload = payload.substring(payload.indexOf(\"<td>$\")+5); venta = payload.substring(0, payload.indexOf(\"</t\"));\n\nif (parseFloat(compra) === 0 || compra === undefined) return;\nif (parseFloat(venta) === 0 || venta === undefined) return;\n\ncompra = compra.replace(\",\", \".\");\nventa = venta.replace(\",\", \".\");\n\ncompra = parseFloat(compra).toFixed(2);\nventa = parseFloat(venta).toFixed(2);\n\nglobal.set(\"DolarOff\", compra);\n\nmsg = {pin: 55, payload: \"$ \"+compra + \"  --  \" + \"$ \" + venta}; node.send([null, null, null, msg]);\n// msg = {pin: 53, payload: compra}; node.send([null, null, null, msg]);\n// msg = {pin: 54, payload: venta}; node.send([null, null, null, msg]);\n\n\nmsg = {topic: \"DolarVenta\", payload: venta}; node.send([msg, null, null, null]);\nmsg = {topic: \"DolarCompra\", payload: compra}; node.send([msg, null, null, null]);\n\nif (parseFloat(global.get(\"MinimoVender\")) > parseFloat(compra) && parseFloat(context.minimoVender) != parseFloat(compra)){\n\tcontext.minimoVender = compra;\n    datos = \"Dolar muy bajo opcion a Vender, valor: \" + compra;//Dolar Bajo opcion a Comprar, valor: \n    msg = {payload: datos}; node.send([null, msg, null, null]);\n    msg = {topic: \"notifyBlynk\", payload: datos}; node.send([null, null, msg, null]);\t\n} \n\nif (parseFloat(global.get(\"MaximoVender\")) < parseFloat(compra) && parseFloat(context.maximoVender) != parseFloat(compra)){    //diferenciaCompraVenta\n    context.maximoVender = compra;\n    datos = \"Dolar Alto opcion a Vender, valor: \" + compra;//Dolar Bajo opcion a Comprar, valor: \n    msg = {payload: datos}; node.send([null, msg, null, null]);\n    msg = {topic: \"notifyBlynk\", payload: datos}; node.send([null, null, msg, null]);\n}\n// if (hh > 9 && hh < 17 && parseFloat(dato.libre) < parseFloat(context.maximo)){\n// if (parseFloat(global.get(\"compreA\")) + parseFloat(global.get(\"diferenciaCompraVenta\") < parseFloat(compra)){    // compre a 39.04\nif (parseFloat(global.get(\"MinimoComprar\")) > parseFloat(venta) && parseFloat(context.comprarDolares) != parseFloat(venta)){    // compre a 39.04    \n    context.comprarDolares = venta;\n    datos = \"Dolar Bajo opcion a Comprar, valor: \" + venta;\n    msg = {payload: datos}; node.send([null, msg, null, null]);\n    msg = {topic: \"notifyBlynk\", payload: datos}; node.send([null, null, msg, null]);\n}\n\nif (parseFloat(global.get(\"MaximoComprar\")) < parseFloat(venta) && parseFloat(context.comprarDolaresCaro) != parseFloat(venta)){    //diferenciaCompraVenta\n    context.comprarDolaresCaro = venta;\n    datos = \"Dolar Muy Alto tener en cuenta compra, valor: \" + venta;//Dolar Bajo opcion a Comprar, valor: \n    msg = {payload: datos}; node.send([null, msg, null, null]);\n    msg = {topic: \"notifyBlynk\", payload: datos}; node.send([null, null, msg, null]);\n}",
        "outputs": 4,
        "noerr": 0,
        "x": 566.8689880371094,
        "y": 302.8452727198601,
        "wires": [
            [
                "a1a99fe7.8ba95",
                "c73e087.839dbf8"
            ],
            [
                "a3758cc8.3858d",
                "5017e9e.15ea618"
            ],
            [
                "6dfbb0bb.311c",
                "a28eb446.155258"
            ],
            [
                "2d7d44ee.9b478c",
                "852f0223.43017"
            ]
        ]
    },
    {
        "id": "a1a99fe7.8ba95",
        "type": "debug",
        "z": "e364a467.07a6a8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 734.0117874145508,
        "y": 289.98811119794846,
        "wires": []
    },
    {
        "id": "21fc9b0b.e0f5b4",
        "type": "debug",
        "z": "e364a467.07a6a8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 522.2222442626953,
        "y": 481.3888568878174,
        "wires": []
    },
    {
        "id": "a28eb446.155258",
        "type": "debug",
        "z": "e364a467.07a6a8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 822.2500076293945,
        "y": 179.75,
        "wires": []
    },
    {
        "id": "52e152e0.741aac",
        "type": "http request",
        "z": "e364a467.07a6a8",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "url": "https://blockchain.info/es/ticker",
        "tls": "",
        "x": 449.9166450500488,
        "y": 406.17859333753586,
        "wires": [
            [
                "38255feb.59b5f"
            ]
        ]
    },
    {
        "id": "38255feb.59b5f",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "BTC",
        "func": "var dato = JSON.parse(msg.payload);\n// dato = JSON.parse(dato);\n\nmsg = dato.USD;\nvar datos = msg.buy;\nmsg = {topic: \"BitCoinUSD\", payload: parseFloat(datos)};\nnode.send(msg);\ndatos = datos * global.get(\"DolarOff\");\nmsg = {topic: \"BitCoinPesos\", payload: parseFloat(datos)};\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "x": 586.9166450500488,
        "y": 406.17859333753586,
        "wires": [
            [
                "c73e087.839dbf8"
            ]
        ]
    },
    {
        "id": "61476039.17e6e",
        "type": "delay",
        "z": "e364a467.07a6a8",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 300.9166450500488,
        "y": 403.17859333753586,
        "wires": [
            [
                "52e152e0.741aac"
            ]
        ]
    },
    {
        "id": "f018ada8.127b",
        "type": "debug",
        "z": "e364a467.07a6a8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 414.44443702697754,
        "y": 530.4166431427002,
        "wires": []
    },
    {
        "id": "6dfbb0bb.311c",
        "type": "mqtt out",
        "z": "e364a467.07a6a8",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "637ff0bd.3c84b",
        "x": 762.4166412353516,
        "y": 407.4285955429077,
        "wires": []
    },
    {
        "id": "f9da74a9.205d88",
        "type": "inject",
        "z": "e364a467.07a6a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 123.27382278442383,
        "y": 537.0833387374878,
        "wires": [
            [
                "d0d49344.b5b8e"
            ]
        ]
    },
    {
        "id": "d0d49344.b5b8e",
        "type": "http request",
        "z": "e364a467.07a6a8",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "url": "https://ebankpersonas.bancopatagonia.com.ar/eBanking/usuarios/cotizacionMonedaExtranjera.htm",
        "tls": "",
        "x": 201.6666717529297,
        "y": 475.83330059051514,
        "wires": [
            [
                "57eb3056.92d7d",
                "f018ada8.127b"
            ]
        ]
    },
    {
        "id": "ba05388f.9f1eb8",
        "type": "debug",
        "z": "e364a467.07a6a8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 633.8690414428711,
        "y": 200.4166914820671,
        "wires": []
    },
    {
        "id": "2db45f76.6b1ca",
        "type": "inject",
        "z": "e364a467.07a6a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "prueba",
        "payload": "",
        "payloadType": "date",
        "x": 215.66665267944336,
        "y": 334.1785936355591,
        "wires": [
            [
                "373edcf3.9708a4"
            ]
        ]
    },
    {
        "id": "ed2c54f5.4dc558",
        "type": "inject",
        "z": "e364a467.07a6a8",
        "name": "",
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 131.8451919555664,
        "y": 278.45241355895996,
        "wires": [
            [
                "a0fa2226.36519"
            ]
        ]
    },
    {
        "id": "a3758cc8.3858d",
        "type": "debug",
        "z": "e364a467.07a6a8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 774.9166450500488,
        "y": 364.17859333753586,
        "wires": []
    },
    {
        "id": "373edcf3.9708a4",
        "type": "http request",
        "z": "e364a467.07a6a8",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "url": "https://banco.santanderrio.com.ar/exec/cotizacion/index.jsp",
        "tls": "",
        "x": 424.0118713378906,
        "y": 281.4166962504387,
        "wires": [
            [
                "ba05388f.9f1eb8",
                "5d42fd8.e980404",
                "61476039.17e6e",
                "d0d49344.b5b8e"
            ]
        ]
    },
    {
        "id": "852f0223.43017",
        "type": "debug",
        "z": "e364a467.07a6a8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 764.7500076293945,
        "y": 464.75,
        "wires": []
    },
    {
        "id": "a0fa2226.36519",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "root",
        "func": "var date = new Date();\nvar frecuencia = 5;\nvar dia = date.getDay();\nvar hh = date.getHours();\nvar mm = date.getMinutes();\nvar ss = date.getSeconds();\nvar tiempo = mm % frecuencia;\nnode.status({text: hh + \":\" + mm + \":\" + ss + \" - \" + tiempo + \" - \" + dia});\nif (dia !== 0 && dia !== 6 && ss === 0 && tiempo === 0){\n\tif (hh > 9 && hh < 18) return msg;\n} \n// if (ss === 0 && tiempo === 0) return msg;\n//){//hh > 9 && hh < 17 && \n //   if (ss === 0 && tiempo === 0) return msg;\n    // if (ss === 0 && tiempo === 0) return msg;\n// }",
        "outputs": 1,
        "noerr": 0,
        "x": 270.4166374206543,
        "y": 278.9285936355591,
        "wires": [
            [
                "373edcf3.9708a4"
            ]
        ]
    },
    {
        "id": "23a53a0d.bc6c56",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "",
        "func": "msg.payload = msg.payload.replace(\",\", \".\");\nglobal.set(\"MinimoComprar\", parseFloat(msg.payload).toFixed(2));\nnode.status({text: \"MinimoComprar:\" + global.get(\"MinimoComprar\")});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 449.47220611572266,
        "y": 54.50000190734863,
        "wires": [
            [
                "33996b47.4d3bc4"
            ]
        ]
    },
    {
        "id": "ebfe9ed0.66ac1",
        "type": "inject",
        "z": "e364a467.07a6a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "prueba dolar",
        "payloadType": "str",
        "x": 578.2222442626953,
        "y": 365.75000190734863,
        "wires": [
            [
                "5017e9e.15ea618"
            ]
        ]
    },
    {
        "id": "5017e9e.15ea618",
        "type": "link out",
        "z": "e364a467.07a6a8",
        "name": "mailDolar",
        "links": [
            "294182fd.ac6bbe"
        ],
        "x": 733.2222442626953,
        "y": 325.75000190734863,
        "wires": []
    },
    {
        "id": "781635c9.10ab8c",
        "type": "mqtt out",
        "z": "50119c6e.6ff584",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 460,
        "y": 120,
        "wires": []
    },
    {
        "id": "3120e963.272b56",
        "type": "function",
        "z": "50119c6e.6ff584",
        "name": "tempPatioLuz",
        "func": "var temp = parseFloat(msg.payload);// + 0;\nif (isNaN(temp))temp = -1;\nif (parseFloat(msg.payload) !== 0){global.set(\"tempPatioLuz\", temp.toFixed(1));\n    msg= {topic: \"tempPatioLuz\", payload: global.get(\"tempPatioLuz\")}; node.send(msg);\n    node.status({text: \"temp: \" + global.get(\"tempPatioLuz\") + \" -- \" + global.get(\"hsCpu\")});\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 440,
        "y": 340,
        "wires": [
            [
                "1f5e6cad.b1cab3"
            ]
        ]
    },
    {
        "id": "7965054.c9eeefc",
        "type": "debug",
        "z": "50119c6e.6ff584",
        "name": "respuesta",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 673,
        "y": 131,
        "wires": []
    },
    {
        "id": "155cca1c.149836",
        "type": "mqtt in",
        "z": "50119c6e.6ff584",
        "name": "",
        "topic": "ESP/PatioLuz/Sens/Temp/Resp",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 190,
        "y": 340,
        "wires": [
            [
                "3120e963.272b56"
            ]
        ]
    },
    {
        "id": "29d8f876.fafdb8",
        "type": "inject",
        "z": "50119c6e.6ff584",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "tomarMedicion",
        "payload": "1",
        "payloadType": "str",
        "x": 154.28571891784668,
        "y": 86.19046211242676,
        "wires": [
            [
                "d1bdce06.cc5f9",
                "3cbba0f1.1702a"
            ]
        ]
    },
    {
        "id": "eb7a6bb0.1114a8",
        "type": "function",
        "z": "50119c6e.6ff584",
        "name": "tempLavadero",
        "func": "var temp = parseFloat(msg.payload);// + 1.6;\nif (parseFloat(msg.payload) !== 0){global.set(\"tempLavadero\", temp.toFixed(1));\nmsg= {topic: \"tempLavadero\", payload: global.get(\"tempLavadero\")}; node.send(msg);\nnode.status({text: \"temp: \" + global.get(\"tempLavadero\") + \" -- \" + global.get(\"hsCpu\")});\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 400,
        "y": 280,
        "wires": [
            [
                "1f5e6cad.b1cab3",
                "25e92b87.f7d434"
            ]
        ]
    },
    {
        "id": "4b87f8d.3061f08",
        "type": "inject",
        "z": "50119c6e.6ff584",
        "name": "",
        "repeat": "1",
        "crontab": "",
        "once": true,
        "onceDelay": "0.1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 164.2857265472412,
        "y": 122.85712432861322,
        "wires": [
            [
                "d1bdce06.cc5f9"
            ]
        ]
    },
    {
        "id": "d1bdce06.cc5f9",
        "type": "function",
        "z": "50119c6e.6ff584",
        "name": "",
        "func": "var date = new Date();\nvar mm = date.getMinutes();\nvar ss = date.getSeconds();\nvar tiempo = mm%5;\nnode.status({text: global.get(\"hsCpu\")});\nif (tiempo === 0 && ss === 1 || msg.topic == \"tomarMedicion\"){\n    // msg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"tempExt\\\",\\\"payload\\\":1}\"}; node.send(msg);\n    msg = {topic: \"ESP/Lavadero/Recibo\", payload: \"pedidoTemp\"}; node.send(msg);\n    msg = {topic: \"ESP/Pasillo/Sens/Temp/Pedido\", payload: 1}; node.send(msg);\n    msg = {topic: \"ESP/Living/Sens/Temp/Pedido\", payload: 1}; node.send(msg);\n    msg = {topic: \"ESP/TermoSolar/Recibo\", payload: 1}; node.send(msg);\n    msg = {topic: \"salamandra/Recibo\", payload: \"pedidoTemp\"}; node.send(msg);\n    msg = {topic: \"ESP/Pileta/Redonda/Recibo\", payload: \"pedidoTemp\"}; node.send(msg);\n\n    // if (parseInt(global.get(\"estadoCargador\")) === 0){\n        msg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"Baterias/Est/Pedido\\\",\\\"payload\\\":1}\"}; node.send(msg);\n    // }\n     if (parseInt(global.get(\"llenarTanque\")) === 0){msg = {topic: \"ESP/TanqueAgua/Recibo\", payload: 1}; node.send(msg);}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 312.142915725708,
        "y": 105.71426486968988,
        "wires": [
            [
                "781635c9.10ab8c",
                "2aca495.744cab6"
            ]
        ]
    },
    {
        "id": "bd212d32.d2ec8",
        "type": "function",
        "z": "50119c6e.6ff584",
        "name": "tempHabitacion",
        "func": "var dato = JSON.parse(msg.payload);\nvar temp = parseFloat(JSON.parse(dato.temp) + 3.0);// + 3.6;\nvar hum = parseFloat(JSON.parse(dato.hum)).toFixed(1);\n\nif (parseFloat(temp) !== 0){\n    global.set(\"tempHabitacion\", temp.toFixed(1));\n    global.set(\"humHabitacion\", hum);\n    // msg= {topic: \"tempLiving\", payload: global.get(\"tempLiving\")}; node.send(msg);\n    msg= {topic: \"tempHabitacion\", payload: global.get(\"tempHabitacion\")}; node.send(msg);\n    msg= {topic: \"tempHabitacion\", payload: global.get(\"tempHabitacion\")}; node.send(null, msg);\n    // msg= {topic: \"humHabitacion\", payload: hum}; node.send(msg);\n    msg = {payload: global.get(\"tempHabitacion\")}; node.send([null,msg]);\n    node.status({text: \"temp: \" + global.get(\"tempHabitacion\") + \" hum:\" + hum + \" -- \" + global.get(\"hsCpu\")});\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 450,
        "y": 390,
        "wires": [
            [
                "1f5e6cad.b1cab3",
                "4b971887.75de38"
            ],
            [
                "7aaed2d0.0da38c"
            ]
        ]
    },
    {
        "id": "2aca495.744cab6",
        "type": "debug",
        "z": "50119c6e.6ff584",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 460,
        "y": 80,
        "wires": []
    },
    {
        "id": "4de71176.ac571",
        "type": "comment",
        "z": "50119c6e.6ff584",
        "name": "Blynk privado (Prueba)",
        "info": "wss://192.168.6.40:9443/websockets\n5e076af9bf8d46abb21c1e29066899b7",
        "x": 700,
        "y": 80,
        "wires": []
    },
    {
        "id": "e84a1d80.15bd5",
        "type": "function",
        "z": "50119c6e.6ff584",
        "name": "tempExterior",
        "func": "if (global.get(\"tempMaxExtValor\") === undefined)global.set(\"tempMaxExtValor\", -255);\nif (global.get(\"tempMinExtValor\") === undefined)global.set(\"tempMinExtValor\", 255);\nif (global.get(\"tempMaxExtAnt\") === undefined)global.set(\"tempMaxExtAnt\", -255);\nif (global.get(\"tempMinExtAnt\") === undefined)global.set(\"tempMinExtAnt\", 255);\nvar temp;\nvar date = new Date();\nvar dia = date.getDate();\ncontext.temp = context.temp || 0;//hola\ncontext.diaAnt = context.diaAnt || dia - 1;\n\n\nif (context.diaAnt !== dia){\ncontext.diaAnt = dia;\n\tglobal.set(\"tempMaxExtAnt\", global.get(\"tempMaxExt\"));\n\tglobal.set(\"tempMinExtAnt\", global.get(\"tempMinExt\"));\n\tglobal.set(\"tempMinExtValor\", 255);\n\tglobal.set(\"tempMaxExtValor\", -255);\n}\n\n// msg.payload = global.get(\"tempExterior\"); node.send(msg);\n\nvar tempExterior = parseFloat(global.get(\"tempExterior\"));\nvar tempmax = parseFloat(global.get(\"tempMaxExtValor\"));\nvar tempmin = parseFloat(global.get(\"tempMinExtValor\"));\n\n\nif (parseFloat(tempExterior) > parseFloat(tempmax)){\n\tglobal.set(\"tempMaxExt\", parseFloat(tempExterior).toFixed(1) + \" (\" + global.get(\"hsCpu\") + \")\");\n\tglobal.set(\"tempMaxExtValor\", global.get(\"tempExterior\"));\n}\nif (parseFloat(tempExterior) < parseFloat(tempmin)){\n\tglobal.set(\"tempMinExt\", parseFloat(tempExterior).toFixed(1) + \" (\" + global.get(\"hsCpu\") + \")\");\n\tglobal.set(\"tempMinExtValor\", global.get(\"tempExterior\"));\n}\n\nnode.status({text: \"temp: \" + parseFloat(tempExterior).toFixed(1) + \" -- \" + global.get(\"hsCpu\")});\t\nmsg = {topic: \"tempExterior\", payload: parseFloat(tempExterior).toFixed(1)}; \t\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 430,
        "y": 220,
        "wires": [
            [
                "1f5e6cad.b1cab3",
                "7965054.c9eeefc"
            ]
        ]
    },
    {
        "id": "e0462fa7.e52fe",
        "type": "mqtt in",
        "z": "50119c6e.6ff584",
        "name": "tempExterior",
        "topic": "ESP/TermoSolar/Envio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 140,
        "y": 240,
        "wires": [
            [
                "8d5ce4ce.a2a8c8"
            ]
        ]
    },
    {
        "id": "1d3d722b.454c1e",
        "type": "function",
        "z": "50119c6e.6ff584",
        "name": "tempPasillo",
        "func": "var temp = parseFloat(msg.payload) + (-3);\nif (parseFloat(msg.payload) !== 0){global.set(\"tempPasillo\", temp.toFixed(1));\n    msg= {topic: \"tempPasillo\", payload: global.get(\"tempPasillo\")}; node.send(msg);\n    node.status({text: \"temp: \" + global.get(\"tempPasillo\") + \" -- \" + global.get(\"hsCpu\")});\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 440,
        "y": 440,
        "wires": [
            [
                "1f5e6cad.b1cab3"
            ]
        ]
    },
    {
        "id": "48c77f6c.2ff13",
        "type": "mqtt in",
        "z": "50119c6e.6ff584",
        "name": "",
        "topic": "ESP/Pasillo/Sens/Temp/Resp",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 200,
        "y": 440,
        "wires": [
            [
                "1d3d722b.454c1e"
            ]
        ]
    },
    {
        "id": "c9964422.ac71b8",
        "type": "mqtt in",
        "z": "50119c6e.6ff584",
        "name": "",
        "topic": "ESP/Living/Sens/Temp/Resp",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 200,
        "y": 390,
        "wires": [
            [
                "bd212d32.d2ec8",
                "4b971887.75de38"
            ]
        ]
    },
    {
        "id": "8d5ce4ce.a2a8c8",
        "type": "delay",
        "z": "50119c6e.6ff584",
        "name": "50",
        "pauseType": "delay",
        "timeout": "200",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 290,
        "y": 220,
        "wires": [
            [
                "e84a1d80.15bd5"
            ]
        ]
    },
    {
        "id": "79b1727b.7e302c",
        "type": "inject",
        "z": "50119c6e.6ff584",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 200,
        "wires": [
            [
                "8d5ce4ce.a2a8c8"
            ]
        ]
    },
    {
        "id": "6d18b788.0a1948",
        "type": "mqtt in",
        "z": "50119c6e.6ff584",
        "name": "",
        "topic": "ESP/Lavadero/Temperatura",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 150,
        "y": 290,
        "wires": [
            [
                "eb7a6bb0.1114a8"
            ]
        ]
    },
    {
        "id": "e1bb7fde.4d99f",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "Info",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "2",
        "topic": "",
        "payload": "{\"topic\":\"Baterias/Est/Pedido\",\"payload\":1}",
        "payloadType": "str",
        "x": 340,
        "y": 720,
        "wires": [
            [
                "35c86102.3c4c2e"
            ]
        ]
    },
    {
        "id": "3b47184b.08c028",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"tempBat1\", payload: global.get(\"tempBat1\")}; node.send(msg);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 2623.5951919555664,
        "y": 255.4523634229388,
        "wires": [
            [
                "f172b930.5a1238"
            ]
        ]
    },
    {
        "id": "3743b9dc.4822b6",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[]",
        "payloadType": "json",
        "x": 2621.491855621338,
        "y": 78.94444847106934,
        "wires": [
            [
                "c886ed5f.c4e19"
            ]
        ]
    },
    {
        "id": "c4484790.d577c8",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "resetAutos",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 1490,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "76adfb47.e0f244",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"Blynk/mostrar/infos\", payload: msg.payload};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1570,
        "y": 630,
        "wires": [
            [
                "445cd48b.3633cc",
                "ac76f2be.6c98a"
            ]
        ]
    },
    {
        "id": "d88558e1.84a5b8",
        "type": "delay",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1874.3800048828125,
        "y": 969.5000540869577,
        "wires": [
            [
                "74700a6b.b7b424"
            ]
        ]
    },
    {
        "id": "3e7ffb21.6f9f44",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "3",
        "payloadType": "str",
        "x": 1368.5717124938965,
        "y": 641.4286403656006,
        "wires": [
            [
                "76adfb47.e0f244"
            ]
        ]
    },
    {
        "id": "79f2193e.97a0f8",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "USBin/Baterias",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 309.8810577392578,
        "y": 283.8095147269113,
        "wires": [
            [
                "95935531.f40c18",
                "2903e624.47c22a"
            ]
        ]
    },
    {
        "id": "7c2d61c4.d857a",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "x": 1781.1667823791504,
        "y": 528.5238674027579,
        "wires": [
            [
                "5364362d.fcfe48"
            ]
        ]
    },
    {
        "id": "cf18dea9.b1f6d",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "salida2 lcd blynk",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1931.3927841186523,
        "y": 755.9643287658691,
        "wires": []
    },
    {
        "id": "8ab8978.3433d68",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 1350.5236053466797,
        "y": 417.14293003082275,
        "wires": [
            [
                "6528d108.e3a9c"
            ]
        ]
    },
    {
        "id": "8a88e4e8.06aa68",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "USBin",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 600,
        "y": 550,
        "wires": [
            [
                "2ada1853.b0f5c8",
                "d1b1c079.3077f",
                "5af90f29.39a76"
            ]
        ]
    },
    {
        "id": "9dc76856.62acb8",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "x": 1364.2859573364258,
        "y": 574.2858028411865,
        "wires": [
            [
                "76adfb47.e0f244"
            ]
        ]
    },
    {
        "id": "f07145ce.8d14a8",
        "type": "e-mail",
        "z": "3ce5b54a.127d6a",
        "server": "smtp.mail.yahoo.com",
        "port": "465",
        "secure": true,
        "name": "gdietrich22@yahoo.com.ar",
        "dname": "gd28722563",
        "x": 780,
        "y": 320,
        "wires": []
    },
    {
        "id": "5364362d.fcfe48",
        "type": "mqtt out",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "pedidoActualizacion",
        "qos": "",
        "retain": "",
        "broker": "c339edbf.39572",
        "x": 1937.1430206298828,
        "y": 580.0000352859497,
        "wires": []
    },
    {
        "id": "f20c8fe3.a0061",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"tempExterior\", payload: global.get(\"tempExterior\")}; node.send(msg);\nmsg = {topic: \"tempPatioLuz\", payload: global.get(\"tempPatioLuz\")}; node.send(msg);\nmsg = {topic: \"tempLiving\", payload: global.get(\"tempLiving\")}; node.send(msg);\nmsg = {topic: \"tempPasillo\", payload: global.get(\"tempPasillo\")}; node.send(msg);\nmsg = {topic: \"tempLavadero\", payload: global.get(\"tempLavadero\")}; node.send(msg);\nmsg = {topic: \"tempBat6\", payload: global.get(\"tempBat6\")}; node.send(msg);\nmsg = {topic: \"tempAmbiente\", payload: global.get(\"tempAmbienteBat\")}; node.send(msg);\nmsg = {topic: \"voltajeBaterias\", payload: global.get(\"voltajeBaterias\")}; node.send(msg);\nmsg = {topic: \"voltajeBaterias\", payload: global.get(\"voltajeBaterias\")}; node.send(msg);\nmsg = {topic: \"tempCPU\", payload: global.get(\"tempCPU\")}; node.send(msg);\nmsg = {topic: \"tempTermo\", payload: global.get(\"tempTermoFin\")}; node.send(msg);\n\nreturn;",
        "outputs": 1,
        "noerr": 0,
        "x": 2619.309543609619,
        "y": 215.45234816414973,
        "wires": [
            [
                "c886ed5f.c4e19",
                "b831424a.5150e"
            ]
        ]
    },
    {
        "id": "31ff5121.fd716e",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"topic\":\"most\",\"payload\":\"0\"}",
        "payloadType": "str",
        "x": 300,
        "y": 590,
        "wires": [
            [
                "d5de6169.53ddd"
            ]
        ]
    },
    {
        "id": "339629e1.979776",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1555.4205669826933,
        "y": 678.7540316051907,
        "wires": []
    },
    {
        "id": "f786c1b.12b354",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"Corriente Carga\", payload: global.get(\"corrienteCarga\")}; node.send(msg);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 2629.3095474243164,
        "y": 342.59523364475797,
        "wires": [
            [
                "a300fbef.9d5148"
            ]
        ]
    },
    {
        "id": "e2f3ed1d.878f1",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "toldo/abrir",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 1339.6188926696777,
        "y": 341.9762897491455,
        "wires": [
            [
                "6528d108.e3a9c"
            ]
        ]
    },
    {
        "id": "2c40d55b.eedb6a",
        "type": "mqtt out",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "c339edbf.39572",
        "x": 900,
        "y": 530,
        "wires": []
    },
    {
        "id": "5af90f29.39a76",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "filtro USB",
        "func": "if (msg.payload.substring(0, 18) == \"inicioNanoBaterias\"){\n    msg = {topic: \"Baterias/Inicio\", payload: 1};\n    return msg;\n}\n\nvar dato = JSON.parse(msg.payload);\n\nif (dato.topic === \"Alarma/Activacion\" || dato.topic === \"Alarma/Disparo\"){\n    msg = {topic: \"USBin/Alarma\", payload: msg.payload};\n\treturn msg;\n}\nif (dato.topic === \"Toldo\"){\n    msg = {topic: \"USBin/Toldo\", payload: msg.payload};\n\treturn msg;\n}\n\nif (dato.topic === \"Baterias/Est/Pedido/Resp\" || dato.topic === \"Cargador\"){\n    msg = {topic: \"USBin/Baterias\", payload: msg.payload};\n\treturn msg;\n}\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 774.5000228881836,
        "y": 447.0000104904175,
        "wires": [
            [
                "345da128.04a5ae",
                "2c40d55b.eedb6a"
            ]
        ]
    },
    {
        "id": "345da128.04a5ae",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 900,
        "y": 570,
        "wires": []
    },
    {
        "id": "b91e565b.c3c818",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"tempBat5\", payload: global.get(\"tempBat5\")}; node.send(msg);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 2632.166603088379,
        "y": 426.88093921116433,
        "wires": [
            []
        ]
    },
    {
        "id": "6b3150e6.3a576",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "toldo/cerrar",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 1331.9046592712402,
        "y": 247.97626876831055,
        "wires": [
            [
                "6528d108.e3a9c"
            ]
        ]
    },
    {
        "id": "c3665e22.cefcc",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "hs cel",
        "func": "msg.payload = global.get(\"fechaCompleta\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1567.6428565979004,
        "y": 592.6429491043091,
        "wires": [
            [
                "746f78d9.9ca9d8"
            ]
        ]
    },
    {
        "id": "4a5f13c4.c6331c",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 760,
        "y": 130,
        "wires": []
    },
    {
        "id": "57b149bd.b8d058",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "salida lcd blynk",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1941.3927841186523,
        "y": 715.9643287658691,
        "wires": []
    },
    {
        "id": "55f49290.df977c",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "crepMQTT",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 1492.3807945251465,
        "y": 152.14294338226318,
        "wires": [
            []
        ]
    },
    {
        "id": "cb99b704.0df768",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2405.547550201416,
        "y": 609.9761947904317,
        "wires": [
            [
                "6426f42f.2ca5bc"
            ]
        ]
    },
    {
        "id": "aad338fd.eb88b8",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "// var dato = JSON.parse(msg.payload);\nif (global.get(\"tiempoEspera\") === undefined)global.set(\"tiempoEspera\", 0);\nif (global.get(\"tiempoCargando\") === undefined)global.set(\"tiempoCargando\", 0);\n// context.cont = context.cont || 0;\n// context.voltaje = context.voltaje || 0;\n// context.nivTanque = context.nivTanque || 0;\n// context.tempAmb = context.tempAmb || 0;\n// context.tempCPU = context.tempCPU || 0;\n// context.PWMCooler = context.PWMCooler || 0;\n// context.Crep = context.Crep || 0;\n\n// context.cont++;\n// context.voltaje += parseFloat(global.get(\"voltajeBaterias\"));\n// context.nivTanque += parseFloat(global.get(\"nivTanque\"));\n// context.tempAmb += parseFloat(global.get(\"tempAmbienteBat\"));\n// context.tempCPU += parseFloat(global.get(\"tempCPU\"));\n// context.PWMCooler += parseFloat(global.get(\"PWM-Cooler\"));\n// context.Crep += parseFloat(global.get(\"LDR\"));\n\n// node.status({text: context.cont});\n// if (context.cont >= 10){\n// \tcontext.voltaje = context.voltaje / context.cont;\n// \tcontext.nivTanque = context.nivTanque / context.cont;\n// \tcontext.tempAmb = context.tempAmb / context.cont;\n// \tcontext.tempCPU = context.tempCPU / context.cont;\n// \tcontext.PWMCooler = context.PWMCooler / context.cont;\n// \tcontext.Crep = context.Crep / context.cont;\n// if (dato.topic == \"Baterias/Est/Pedido/Resp\"){\n\n// \tmsg= {topic: \"voltajeBat\", payload: global.get(\"voltajeBaterias\")}; node.send(msg);\n// \tmsg= {topic: \"corrienteCarga\", payload: global.get(\"corrienteCarga\")}; node.send(msg);\n// \tmsg= {topic: \"cargador\", payload: global.get(\"estadoCargador\")}; node.send(msg);\n// \tmsg= {topic: \"tiempoCargando\", payload: global.get(\"tiempoCargando\").toFixed(2)}; node.send(msg);\n// \tmsg= {topic: \"tiempoEspera\", payload: global.get(\"tiempoEspera\").toFixed(2)}; node.send(msg);\n\tif (parseInt(global.get(\"llenarTanque\")) === 0){\n    \tmsg= {topic: \"nivTanque\", payload: global.get(\"nivTanque\")}; node.send(msg);\n    \tmsg= {topic: \"tasaLlenado\", payload: parseFloat(global.get(\"tasaLlenadoTanque\")).toFixed(2)}; node.send(msg);\n    // \tmsg = {pin: 33, payload: global.get(\"nivTanque\")}; node.send([null, msg]);\n    \tmsg = {pin: 33, payload: global.get(\"nivTanque\")}; node.send([null, msg]);\n    // \tmsg = {pin: 33, payload: global.get(\"nivTanque\")}; node.send([null, msg]);\n\t}\n// \tmsg= {topic: \"tempAmb\", payload: global.get(\"tempAmbienteBat\")}; node.send(msg);\n// \tnode.status ({text: global.get(\"tempAmbienteBat\")});\n// \tmsg= {topic: \"tempBat1\", payload: global.get(\"tempBat1\")}; node.send(msg);\n// }\n// if (dato.topic === \"Cargador\"){\n// \tglobal.set(\"voltajeBaterias\", parseFloat(dato.volt).toFixed(2));\n// \tglobal.set(\"voltajeBat\", dato.voltajeBat);\n// \tglobal.set(\"cargador\", dato.payload);\n\t\n// \tmsg= {topic: \"voltajeBat\", payload: global.get(\"voltajeBaterias\")}; node.send(msg);\n// \tmsg= {topic: \"corrienteCarga\", payload: global.get(\"corrienteCarga\")}; node.send(msg);\n// \tmsg= {topic: \"cargador\", payload: global.get(\"estadoCargador\")}; node.send(msg);\n\n// \t// msg= {topic: \"cargador\", payload: dato.payload}; node.send(msg);\n// \t// global.set(\"voltajeBaterias\", dato.volt);\n// \t// msg= {topic: \"voltajeBat\", payload: global.get(\"voltajeBaterias\")}; node.send(msg);\n// }\n\n// \t// msg= {topic: \"voltajeBat\", payload: context.voltaje.toFixed(2)}; node.send(msg);\n// \t// msg= {topic: \"nivTanque\", payload: context.nivTanque.toFixed(2)}; node.send(msg);\n// \t// msg= {topic: \"tempAmb\", payload: context.tempAmb.toFixed(2)}; node.send(msg);\n// \t// msg= {topic: \"tempCPU\", payload: context.tempCPU.toFixed(2)}; node.send(msg);\n// \t// msg= {topic: \"PWM-Cooler\", payload: context.PWMCooler.toFixed(2)}; node.send(msg);\n// \t// msg= {topic: \"Crep\", payload: context.Crep.toFixed(2)}; node.send(msg);\n\n// // \tcontext.cont = 0;\n// // \tcontext.voltaje = 0;\n// // \tcontext.nivTanque = 0;\n// // \tcontext.tempAmb = 0;\n// // \tcontext.tempCPU = 0;\n// // \tcontext.PWMCooler = 0;\n// // \tcontext.Crep = 0;\n// // }",
        "outputs": 2,
        "noerr": 0,
        "x": 530,
        "y": 950,
        "wires": [
            [
                "490a73a0.04a99c",
                "e14463a7.a8348",
                "8b0611c9.25273"
            ],
            [
                "577fff27.098f7"
            ]
        ]
    },
    {
        "id": "d5de6169.53ddd",
        "type": "mqtt out",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "USBin",
        "qos": "",
        "retain": "",
        "broker": "c339edbf.39572",
        "x": 450,
        "y": 550,
        "wires": []
    },
    {
        "id": "8e54227e.9f431",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "toldo andando",
        "func": "\tvar topic = msg.topic;\n\tvar payload = parseInt(msg.payload);\n\tcontext.estadoToldo = context.estadoToldo || 0;  // estToldo:  0= parado, 1= abriendo, 2= abierto, 3= cerrando, 4= cerrado\n\tcontext.estAnt = context.estAnt || 0; // =0 parado, =1 abriendo, = 2 cerrando\n\tvar tiempoMover = 15;\n\tvar diffAmanecer = 1.5;\n\tvar date = new Date();\n\tvar hh = global.get(\"hh\");\n\tvar mm = global.get(\"mm\");\n\tvar ss = global.get(\"ss\");\n\tif (global.get(\"tiempoEsperaRociador\") === undefined)global.set(\"tiempoEsperaRociador\", 30);\n\tif (global.get(\"tiempoMojandoRociador\") === undefined)global.set(\"tiempoMojandoRociador\", 0.8);\n\n\t// context.tiempoToldo = context.tiempoToldo || date.getTime();\n\tcontext.datoAmanecer = context.datoAmanecer || date.getTime()+5000;\n\tcontext.CerrarToldoAuto = context.CerrarToldoAuto || 0; \n\tcontext.AbrirToldoAuto = context.AbrirToldoAuto || 0;\n\tcontext.hsAnterior =context.hsAnterior || hh-1;\n\tcontext.ssAnterior = context.ssAnterior || 0;\n\tcontext.inicio = context.inicio || 0;\n\tcontext.error = context.error || 0;\n\n\tcontext.avisoAuto = context.avisoAuto || 0;\n\tcontext.avisoRociador = context.avisoRociador || 0;\n\tcontext.condicionEstadoToldo = context.condicionEstadoToldo || 0;\n\tcontext.aperturaAmanecer = context.aperturaAmanecer || 0;\n\tcontext.cerradoManual = context.cerradoManual || 0;// =1 lo cerre manual se habilita pone a 0 cuando se cierra de forma automatica\n\tcontext.abiertoManual = context.abiertoManual || 0;// =1 lo habri manual se habilita pone a 0 cuando se habre de forma automatica\n\n\tif (global.get(\"tiempoMoviendo\") === undefined)global.set(\"tiempoMoviendo\", 0);\n\tif (global.get(\"enfriarToldo\") === undefined)global.set(\"enfriarToldo\", 0);\n\tif (global.get(\"mojandoToldo\") === undefined)global.set(\"mojandoToldo\", 0);\n\tif (global.get(\"estadoToldo\") === undefined)global.set(\"estadoToldo\", \"nulo\");\n\tif (global.get(\"Dia\") === undefined)global.set(\"Dia\", 0);\n\tif (global.get(\"datoAmanecer\") === undefined)global.set(\"datoAmanecer\", \"nulo\");\n\tif (global.get(\"tempPatioLuz\") === undefined)global.set(\"tempPatioLuz\", 0);\n\tif (global.get(\"hsAmanecer\") === undefined)global.set(\"hsAmanecer\", \"nulo\");\n\tif (global.get(\"hsAnochecer\") === undefined)global.set(\"hsAnochecer\", \"nulo\");\n\n\tvar dato = JSON.parse(msg.payload);\n\n\tvar tiempo = hh + \":\" + mm + \":\" + ss;\n\n\tif (dato.topic === \"Toldo\")comprobarToldo();\n\n\tif (msg.topic === \"USBin/Toldo\"){\n\t\tif (dato.topic === \"tiempoEsperaRociador\"){global.set(\"tiempoEsperaRociador\", parseFloat(dato.payload).toFixed(1)); return;}\n\t\tif (dato.topic === \"tiempoMojandoRociador\"){global.set(\"tiempoMojandoRociador\", parseFloat(dato.payload).toFixed(1)); return;}\n\t}\n\n\n\tif (global.get(\"estadoToldo\") !== \"Abriendo\" || global.get(\"estadoToldo\") !== \"Cerrando\")node.status({text: global.get(\"hsCpu\") + \"  \" + context.CerrarToldoAuto + \" -- \" + hh});\t\t\n\n\tif(context.inicio === 0){\n\t\tif (global.get(\"Dia\") === 1)context.aperturaAmanecer = 1;\n\n\tcontext.inicio = 1;\t\n\t}\n\n\tif (hh === 0 && mm === 0 && ss === 0){\n\t\tcontext.CerrarToldoAuto = 0;\n\t\tcontext.AbrirToldoAuto = 0;\t\n\t\tcontext.cerradoManual = 0;\n\t}\n\n\tif (topic === \"resetAutos\"){\n\t\tcontext.CerrarToldoAuto = 0;\n\t\tcontext.AbrirToldoAuto = 0;\t\n\t\tglobal.set(\"CerrarToldoAuto\", context.CerrarToldoAuto);\n\t\tglobal.set(\"AbrirToldoAuto\", context.AbrirToldoAuto);\n\t\treturn;}\n\n\tif (topic === \"toldoBlynk\"){\n\t\tglobal.set(\"estadoToldo\", \"Error Borrado\");\n\t\tglobal.set(\"toldoManual\", 1);\n\t\tif (payload === 1 && context.estAnt === 0){\n\t\t\t// context.abiertoManual = 0;\n\t\t\tcontext.abiertoManual = 1;\n\t\t\tcontext.condicionEstadoToldo = 0;\n\t\t\tcontext.CerrarToldoAuto = 0;\n\t\t\tglobal.set(\"estadoToldoLCD\", \"Abriendo toldo modo manual (Blynk)\");\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`) VALUES (now(),\\\"Abriendo Toldo Manual Blynk\\\")\"};\n\t\t\tnode.send([null, null, msg]);\t\t\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":2}\"};\n\t\t\tnode.send([msg, null, null]); \n\t\t\treturn;}\n\n\t\tif (payload === 1 && context.estAnt === 1){\n\t\t\tcontext.cerradoManual = 1;\n\t\t\t// context.cerradoManual = 0;\n\t\t\tcontext.condicionEstadoToldo = 0;\n\t\t\tcontext.AbrirToldoAuto = 0;\n\t\t\tglobal.set(\"estadoToldoLCD\", \"Cerrando toldo modo manual (Blynk)\");\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`) VALUES (now(),\\\"Cerrando Toldo Manual Blynk\\\")\"};\n\t\t\tnode.send([null, null, msg]);\t\t\t\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":4}\"};\n\t\t\tnode.send([msg, null, null]); \n\t\t\treturn;}\n\n\t\tif (payload === 0 && context.estadoToldo === 2){\n\t\t\tcontext.cerradoManual = 1;\n\t\t\t// context.cerradoManual = 0;\n\t\t\tcontext.condicionEstadoToldo = 0;\n\t\t\tglobal.set(\"estadoToldoLCD\", \"Cerrando toldo modo manual (Blynk)\");\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`) VALUES (now(),\\\"Cerrando Toldo Manual Blynk\\\")\"};\n\t\t\tnode.send([null, null, msg]);\t\t\t\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":4}\"};\n\t\t\tnode.send([msg, null, null]); \n\t\t\treturn;}\n\n\t\tif (payload === 0){\n\t\t\tcontext.abiertoManual = 0;\n\t\t\tcontext.cerradoManual = 0;\t\t\n\t\t\tglobal.set(\"estadoToldoLCD\", \"Toldo Parado\");\n\t\t\tcontext.cerradoManual = 0;\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":0}\"};\n\t\t\tnode.send([msg, null, null]); \n\t\t\tglobal.set(\"estadoToldoLCD\", \"Toldo parado de forma manual (Blynk)\");\n\t\t\treturn;}\n\t\t}\n\n\tif (global.get(\"Dia\") === 0){context.aperturaAmanecer = 0; context.datoAmanecer = date.getTime() + 1000;}\n\n\t// global.set(\"datoAmanecer\", context.datoAmanecer);\t\n\tif (global.get(\"tempPatioLuz\") > 19 && global.get(\"estadoToldo\") === \"Abierto\")context.CerrarToldoAuto = 0;\n\tif (topic === \"crepMQTT\" && payload === 0){context.CerrarToldoAuto = 0;}\n\n\tglobal.set(\"CerrarToldoAuto\", context.CerrarToldoAuto);\n\tglobal.set(\"AbrirToldoAuto\", context.AbrirToldoAuto);\n\tglobal.set(\"aperturaAmanecer\", context.aperturaAmanecer);\t\n\tglobal.set(\"diff\", date.getTime() - (context.datoAmanecer + (1000 * 2)));\n\n\tif (global.get(\"mes\") >= 3 && global.get(\"mes\") <= 8 && hh === 22 && mm < 5 && context.CerrarToldoAuto === 0 && global.get(\"estadoToldo\") !== \"Cerrado\"){\n\t\tcontext.abiertoManual = 0;\t\n\t\tcontext.AbrirToldoAuto = 0;\t\n\t\tcontext.condicionEstadoToldo = 1;\n\t\tvar datoMsg = \"Cerrando toldo por oscurcer en invierno\";\n\t\tglobal.set(\"estadoToldoLCD\", datoMsg);\n\n\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`, \\`tempPatioLuz\\`) VALUES (now(),\\\"\" + datoMsg + \"\\\", \" + global.get(\"tempPatioLuz\") + \")\"};\n\t\tnode.send([null, null, msg]);\t\t\n\n\t\tmsg = {topic: \"notifyBlynk\", payload: datoMsg}; node.send([msg, null, null]);\n\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":4}\"}; node.send([msg, null, null]);  \n\t\tglobal.set(\"CerrarToldoAuto\", context.CerrarToldoAuto);\n\t\tglobal.set(\"AbrirToldoAuto\", context.AbrirToldoAuto);\n\t\t// return;\t\n\t}\n\n\t//Cerrar\t\n\tif (global.get(\"tempPatioLuz\") > 24 && global.get(\"Dia\") === 1 || global.get(\"tempPatioLuz\") < 15 && global.get(\"Dia\") === 0  && context.abiertoManual === 0){\n\t\tif (context.CerrarToldoAuto === 0 && global.get(\"estadoToldo\") !== \"Cerrado\"){\n\t\t\tcontext.cerradoManual = 0;\n\t\t\tcontext.AbrirToldoAuto = 0;\t\t\n\t\t\tcontext.condicionEstadoToldo = 2;\n\t\t\t// global.set(\"estadoToldo\", \"Cerrando\");\n\t\t\tvar datoMsg = \"Cerrando toldo por temperatura (24<\" + global.get(\"tempPatioLuz\") + \"<15)\";\n\t\t\tglobal.set(\"estadoToldoLCD\", datoMsg);\n\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`, \\`tempPatioLuz\\`) VALUES (now(),\\\"\" + datoMsg + \"\\\", \" + global.get(\"tempPatioLuz\") + \")\"};\n\t\t\tnode.send([null, null, msg]);\t\t\n\n\t\t\tmsg = {topic: \"notifyBlynk\", payload: datoMsg}; node.send([msg, null, null]);\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":4}\"};\n\t\t\tnode.send([msg, null, null]);  \n\t\t\tglobal.set(\"CerrarToldoAuto\", context.CerrarToldoAuto);\n\t\t\tglobal.set(\"AbrirToldoAuto\", context.AbrirToldoAuto);\n\t\t\treturn;}\t\t\t\n\t\t}\t\n\n\t//Abrir anochecer\n\tif (topic === \"crepMQTT\" && payload === 0){\n\t\tcontext.aperturaAmanecer = 0;\n\t\tif(global.get(\"tempPatioLuz\") < 23 && global.get(\"tempPatioLuz\") >= 18 && global.get(\"estadoToldo\") !== \"Abierto\" && context.cerradoManual === 0){\n\t\t\tcontext.CerrarToldoAuto = 0;\n\t\t\tcontext.abiertoManual = 0\n\t\t\tcontext.condicionEstadoToldo = 2;\n\t\t\tvar datoMsg = \"Abriendo toldo por hacerse de noche\";\n\t\t\tglobal.set(\"estadoToldoLCD\", datoMsg);\n\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`, \\`tempPatioLuz\\`, \\`crepuscular\\`) VALUES (now(),\\\"Abriendo toldo por oscurecer\\\", \" + global.get(\"tempPatioLuz\") + \", \\\"\" + global.get(\"hsAnochecer\") + \"\\\")\"};\n\t\t\tnode.send([null, null, msg]);\n\n\t\t\tmsg = {topic: \"notifyBlynk\", payload: datoMsg}; node.send([msg, null, null]);\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":2}\"};\n\t\t\tnode.send([msg, null, null]);  \n\t\t\tglobal.set(\"CerrarToldoAuto\", context.CerrarToldoAuto);\n\t\t\tglobal.set(\"AbrirToldoAuto\", context.AbrirToldoAuto);\n\t\t}}\t\t\n\n\t//Abrir por temp\n\tif (global.get(\"tempPatioLuz\") < 17 && global.get(\"tempPatioLuz\") > 15 && global.get(\"Dia\") === 1 && context.AbrirToldoAuto === 0 && global.get(\"estadoToldo\") !== \"Abierto\" && context.cerradoManual === 0){\n\t\tcontext.condicionEstadoToldo = 1;\n\t\tcontext.abiertoManual = 0\n\t\tvar datoMsg = \"Abriendo toldo por temperatura (19<\" + global.get(\"tempPatioLuz\") + \">17)\";\n\t\tglobal.set(\"estadoToldoLCD\", datoMsg); \n\n\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`, \\`tempPatioLuz\\`, \\`crepuscular\\`) VALUES (now(),\\\"\" + datoMsg + \"\\\", \" + global.get(\"tempPatioLuz\") + \", \\\"\" + datoAmanecer + \"\\\")\"};\n\t\tnode.send([null, null, msg]);\t\n\n\t\tmsg = {topic: \"notifyBlynk\", payload: datoMsg}; node.send([msg, null, null]);\n\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":2}\"}; node.send([msg, null, null]); \n\t\tglobal.set(\"CerrarToldoAuto\", context.CerrarToldoAuto);\n\t\tglobal.set(\"AbrirToldoAuto\", context.AbrirToldoAuto);\n\t\treturn;}\n\n\t//Abrir amanecer     * 60 * diffAmanecer\n\tif (date.getTime() > (context.datoAmanecer + (1000 * 60 * 60 * diffAmanecer)) && global.get(\"tempPatioLuz\") < 23  && context.aperturaAmanecer === 0){   //Abrir Auto por Hora, hs= 23:15:25\n\t\tcontext.aperturaAmanecer = 1;\n\t\tif(context.AbrirToldoAuto === 0 && global.get(\"estadoToldo\") !== \"Abierto\"){\n\t\t\tcontext.condicionEstadoToldo = 3;\n\t\t\tcontext.aperturaAmanecer = 1;\n\t\t\tcontext.abiertoManual = 0;\t\t\n\t\t\tcontext.CerrarToldoAuto = 0;\n\t\t\tvar datoAmanecer = global.get(\"hsAmanecer\"); if (datoAmanecer === undefined)datoAmanecer = null;\n\t\t\tvar datoMsg = \"Abriendo toldo por Amanecer, hs amanecer: \" + global.get(\"hsCpu\");\n\t\t\tglobal.set(\"estadoToldoLCD\", datoMsg);\n\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`, \\`tempPatioLuz\\`, \\`crepuscular\\`) VALUES (now(),\\\"\" + datoMsg + \"\\\", \" + global.get(\"tempPatioLuz\") + \", \\\"\" + datoAmanecer + \"\\\")\"};\n\t\t\tnode.send([null, null, msg]);\n\n\t\t\tmsg = {topic: \"notifyBlynk\", payload: datoMsg}; node.send([msg, null, null]);\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":2}\"}; node.send([msg, null, null]); \n\t\t\tglobal.set(\"CerrarToldoAuto\", context.CerrarToldoAuto);\n\t\t\tglobal.set(\"AbrirToldoAuto\", context.AbrirToldoAuto);\n\t\t\treturn;}\t}\n\n\t//60 * 60 * 1.5\n\n\tif (msg.topic === \"enfriarToldoBlynk\"){global.set(\"enfriarToldo\", msg.apyload);}\n\n\tif (global.get(\"tempPatioLuz\") >= 25 && global.get(\"estadoToldo\") === \"Cerrado\"  && global.get(\"enfriarToldo\") === 0){\n\t\t\tcontext.esperaMojando = date.getTime() - 1000; global.set(\"mojandoToldo\",0);\n\t\t\tvar datoEnfriador = \"Enfriador habilitado (\" + global.get(\"hsCel\") + \" temp: \" + global.get(\"tempPatioLuz\") + \")\";\n\t\t\tmsg = {pin: 9, payload: 1}; node.send([null, msg, null]);\n\t\t\tglobal.set(\"enfriadorToldo\", datoEnfriador);\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`) VALUES (now(), \\\"\" + datoEnfriador + \"\\\")\"}; node.send([null, null, msg]);\t\n\t\t\t// msg = {topic: \"notifyBlynk\", payload: datoEnfriador}; node.send([msg, null, null]);\n\t\t\tglobal.set(\"enfriarToldo\", 1);\n\t\t\tcontext.avisoRociador = 0;}\n\n\tif (global.get(\"tempPatioLuz\") <= 18 && global.get(\"enfriarToldo\") === 1 || global.get(\"estadoToldo\") !== \"Cerrado\" && global.get(\"enfriarToldo\") === 1){\n\t\t\tvar datoEnfriador = \"Enfriador deshabilitado (\" + global.get(\"hsCel\") + \" temp: \" + global.get(\"tempPatioLuz\") + \")\";\n\t\t\tmsg = {topic: \"notifyBlynk\", payload: datoEnfriador}; node.send([msg, null, null]);\n\t\t\tglobal.set(\"enfriadorToldo\", datoEnfriador);\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`) VALUES (now(), \\\"\" + datoEnfriador + \"\\\")\"}; node.send([null, null, msg]);\t\n\t\t\tglobal.set(\"enfriarToldo\", 0);\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"rele1\\\",\\\"payload\\\": 0}\"};\t\n\t\t\tnode.send([msg, null, null]);\n\t\t\tmsg = {pin: 9, payload: 0}; node.send([null, msg, null]);\n\t\t}\n\n\tif (global.get(\"enfriarToldo\") === 1){\n\t\tif (global.get(\"mojandoToldo\") === 0 && date.getTime() > context.esperaMojando && global.get(\"tempPatioLuz\") >= 22){\n\t\t\tcontext.tiempoMojando = date.getTime() + (1000*60*global.get(\"tiempoMojandoRociador\"));//3'\n\t\t\tglobal.set(\"mojandoToldo\", 1);\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"rele1\\\",\\\"payload\\\": 1}\"};\t\n\t\t\tnode.send([msg, null, null])\n\t\t\tmsg = {pin: 9, payload: 1}; node.send([null, msg, null]);\n\n\t\t\tvar datoEnfriador = \"rociador mojando desde las \" + global.get(\"hsCel\") ;\n\t\t\tglobal.set(\"rociadorToldo\", datoEnfriador);\n\t\t\tmsg = {topic: \"notifyBlynk\", payload: \"Rociador mojando desde las \" + global.get(\"hsCel\") }; node.send([msg, null, null]);\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`) VALUES (now(), \\\"\" + msg.payload + \"\\\")\"}; \n\t\t\tnode.send([null, null, msg]);\n\t\t\tmsg = {topic: \"ESP/Lavadero/Presurizadora\", payload: 1}; node.send([msg, null, null])\t\t\t\t\t\n\t\t}\n\t\tif (global.get(\"mojandoToldo\") === 1 && date.getTime() > context.tiempoMojando){\n\t\t\tcontext.esperaMojando = date.getTime() + (1000*60*global.get(\"tiempoEsperaRociador\"));//30'\n\t\t\tglobal.set(\"mojandoToldo\", 0);\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"rele1\\\",\\\"payload\\\": 0}\"};\t\n\t\t\tnode.send([msg, null, null]);\n\t\t\tmsg = {pin: 9, payload: 0}; node.send([null, msg, null]);\n\t\t\tvar datoEnfriador = \"rociador en espera desde las \" + global.get(\"hsCel\") ;\n\t\t\tglobal.set(\"rociadorToldo\", datoEnfriador);\n\t\t\tmsg = {topic: \"notifyBlynk\", payload: \"Rociador en espera desde las \" + global.get(\"hsCel\")}; node.send([msg, null, null]);\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`) VALUES (now(), \\\"\" + msg.payload + \"\\\")\"}; \n\t\t\tnode.send([null, null, msg]);\t\t\n\t\t}\n\t}//Cerrando toldo por temperatura (24<\n\tif (global.get(\"enfriarToldo\") === 0 && context.avisoRociador === 0){\t\t\n\t\tvar datoEnfriador = \"Enfriador deshabilitado, \" + global.get(\"hsCel\") + \" temp: \" + global.get(\"tempPatioLuz\");\n\t\tmsg = {topic: \"notifyBlynk\", payload: datoEnfriador}; node.send([msg, null, null]);\n\t\tcontext.avisoRociador = 1;\t\t\n\t\tglobal.set(\"mojandoToldo\" , 0);\n\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"rele1\\\",\\\"payload\\\": 0}\"};\t\n\t\tnode.send([msg, null, null]);}\t\t\n\n\tfunction comprobarToldo(){\n\tswitch (dato.payload){\n\t\tcase 0:\n\t\t\tglobal.set(\"estadoToldo\", \"Parado\");\t\t\n\t\t\tcontext.estadoToldo = 0;\t\n\t\t\tif (context.error !== 0)global.set(\"estadoToldoLCD\", \"Toldo parado de forma manual (Blynk)\");\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`, \\`tiempoMov\\`) VALUES (now(),\\\"\" + global.get(\"estadoToldoLCD\") + \"\\\",\" + global.get(\"tiempoMoviendo\") + \")\"};\t\t\n\t\t\tmsg = {topic: \"Blynk/actualizar/estado\", payload: 1}; node.send([msg, null, null]);\n\t\t\tif (context.estAnt === 0){msg = {payload: 0, color: \"#ffbc26\", label: \"Toldo Parado\", offlabel: \"Abrir\", pin: 3}; node.send([null, msg, null]); return;}\n\t\t\tif (context.estAnt === 1){msg = {payload: 0, color: \"#ffbc26\", label: \"Toldo Parado\", offlabel: \"Cerrar\", pin: 3}; node.send([null, msg, null]); return;}\n\t\tbreak;\n\t\tcase 1:\t\n\t\t    // if (global.get(\"estadoToldo\") === \"Abierto\") return;\n\t\t\tcontext.AbrirToldoAuto = 1;\n\t\t\tcontext.error = 0;\n\t\t\tif (global.get(\"estadoToldo\") === \"Cerrado\" || global.get(\"estadoToldo\") === \"Error Toldo abriendo\" || global.get(\"estadoToldo\") === \"Error Toldo cerrando\")global.set(\"tiempoMoviendo\", 0);\n\t\t\tmsg = {payload: 1, color: \"#ffbc26\", label: \"Tol. Abriendo\", onlabel: \"Parar\", pin: 3}; node.send([null, msg, null]);\n\t\t\tcontext.estadoToldo = 1;\n\t\t\tcontext.estAnt = 1;\n\t\t\tglobal.set(\"estadoToldo\", \"Abriendo\");\n\t\t\tnode.status({text: global.get(\"estadoToldo\") + \" \" + context.tiempoToldo});//toldo abierto\n\t\tbreak;\n\t\tcase 2:\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"abiertoOK\\\",\\\"payload\\\":0}\"}; node.send([msg, null, null]);\n\t\t\tif (global.get(\"estadoToldo\") == \"Abierto\")return;\n\t\t\tglobal.set(\"estadoToldo\", \"Abierto\");\t\t\n\t\t\tglobal.set(\"toldoManual\", 0);\n\t\t\tif (context.condicionEstadoToldo === 0)global.set(\"estadoToldoLCD\", \"Toldo Abierto de forma manual (Blynk)\" + global.get(\"hsCpu\"));\n\t\t\tif (context.condicionEstadoToldo === 1)global.set(\"estadoToldoLCD\", \"Toldo Abierto por temp (\" + global.get(\"hsCpu\") + \", temp: \" + global.get(\"tempPatioLuz\") + \")\");\n\t\t\tif (context.condicionEstadoToldo === 2)global.set(\"estadoToldoLCD\", \"Toldo Abierto por Oscurecer(\"  + global.get(\"hsCpu\") + \")\");\n\t\t\tif (context.condicionEstadoToldo === 3)global.set(\"estadoToldoLCD\", \"Toldo Abierto por Amanecer(\"  + global.get(\"hsCpu\") + \")\");\n\t\t\tvar moviendo = Math.abs(tiempoMover - global.get(\"tiempoMoviendo\"));\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`, \\`tiempoMov\\`, \\`tempPatioLuz\\`) VALUES (now(),\\\"\" + global.get(\"estadoToldoLCD\") + \"\\\",\" + moviendo + \",\" + global.get(\"tempPatioLuz\") + \")\"};\n\t\t\tnode.send([null, null, msg]);\t\n\t\t\tmsg = {pin: 3, payload: 1, color: \"#23C48E\", label: \"Toldo Abierto\", onlabel: \"Cerrar\"}; node.send([null, msg, null]);\n\t\t\tmsg = {topic: \"notifyBlynk\", payload: \"Toldo Abierto\"}; node.send([msg, null, null]);\n\t\t\tcontext.estadoToldo = 2;\n\t\t\tcontext.estAnt = 1;\n\t\t\tmsg = {topic: \"Blynk/actualizar/estado\", payload: 1}; node.send([msg, null, null]);\n\t\t\treturn;\n\t\tcase 3:\n\t\t\t// if (global.get(\"estadoToldo\") === \"Cerrado\") return;\t\t\n\t\t\tcontext.CerrarToldoAuto = 1;\t\n\t\t\tcontext.error = 0;\n\t\t\tif (global.get(\"estadoToldo\") === \"Abierto\" || global.get(\"estadoToldo\") === \"Error Toldo abriendo\" || global.get(\"estadoToldo\") === \"Error Toldo cerrando\")global.set(\"tiempoMoviendo\", 0);\n\t\t\tmsg = {payload: 1, color: \"#ffbc26\", label: \"Tol. Cerrando\", onlabel: \"Parar\", pin: 3}; node.send([null, msg, null]);\n\t\t\tcontext.estadoToldo = 3;\n\t\t\tcontext.estAnt = 0;\n\t\t\tglobal.set(\"estadoToldo\", \"Cerrando\");\n\t\t\tnode.status({text: global.get(\"estadoToldo\") + \" \" + context.tiempoToldo});\n\t\tbreak;\n\t\tcase 4://Cerrando toldo por temperatura (24<\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"cerradoOK\\\",\\\"payload\\\":0}\"}; node.send([msg, null, null]);\n\t\t\tif (global.get(\"estadoToldo\") == \"Cerrado\")return;\n\t\t\tglobal.set(\"estadoToldo\", \"Cerrado\");\n\t\t\tglobal.set(\"toldoManual\", 0);\n\t\t\tif (context.condicionEstadoToldo === 0)global.set(\"estadoToldoLCD\", \"Toldo Cerrado de forma manual (Blynk \" + global.get(\"hsCpu\") + \")\");\n\t\t\tif (context.condicionEstadoToldo === 1)global.set(\"estadoToldoLCD\", \"Toldo Cerrado por oscurcer en invierno (\" + global.get(\"hsCpu\") + \", temp: \" + global.get(\"tempPatioLuz\") + \")\");\n\t\t\tif (context.condicionEstadoToldo === 2)global.set(\"estadoToldoLCD\", \"Toldo Cerrado por temp. (\" + global.get(\"hsCpu\") + \", temp: \" + global.get(\"tempPatioLuz\") + \")\");\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`, \\`tiempoMov\\`, \\`tempPatioLuz\\`) VALUES (now(),\\\"\" + global.get(\"estadoToldoLCD\") + \"\\\",\" + global.get(\"tiempoMoviendo\") + \",\" + global.get(\"tempPatioLuz\") + \")\"};\n\t\t\tnode.send([null, null, msg]);\n\t\t\tmsg = {pin: 3, payload: 0, color: \"#23C48E\", label: \"Toldo Cerrado\", offlabel: \"Abrir\"}; node.send([null, msg, null]);\n\t\t\tmsg = {topic: \"notifyBlynk\", payload: \"Toldo Cerrado\"}; node.send([msg, null, null]);\t\n\t\t\tcontext.estadoToldo = 4;\t\t\n\t\t\tcontext.estAnt = 0;\n\t\t\tmsg = {topic: \"Blynk/actualizar/estado\", payload: 1}; node.send([msg, null, null]);\n\t\t\treturn;}\n\tmsg = {topic: \"Blynk/actualizar/toldo\", payload: 1}; node.send([msg, null, null]);}\n\n\t//\"Toldo Cerrado (9:11:13)9:11:12)por temperatura (24<14.0<15)\"\n\n\tif (context.ssAnterior !== ss){\n\t\tcontext.ssAnterior = ss;\n\t\tif (global.get(\"estadoToldo\") === \"Cerrando\" || global.get(\"estadoToldo\") === \"Abriendo\"){\n\t\tvar porcentaje;\n\t\tif (global.get(\"estadoToldo\") === \"Abriendo\"){\n\t\t\tmsg = {pin: 4, payload: \" Abriendo Toldo \"};\n\t\t\ttiempoMoviendo = global.get(\"tiempoMoviendo\") - 1; \n\t\t\tglobal.set(\"tiempoMoviendo\", tiempoMoviendo);}\n\n\t\tif (global.get(\"estadoToldo\") === \"Cerrando\"){\n\t\t\tmsg = {pin: 4, payload: \" Cerrando Toldo \"};\n\t\t\ttiempoMoviendo = global.get(\"tiempoMoviendo\") + 1; \n\t\t\tglobal.set(\"tiempoMoviendo\", tiempoMoviendo);}\n\t\tnode.send([null, msg, null]);\n\n\t\tporcentaje = Math.abs(((parseFloat((tiempoMoviendo * 100)/tiempoMover))).toFixed(1));\n\t\tif (global.get(\"estadoToldo\") === \"Cerrando\")porcentaje = (Math.abs(100 - porcentaje)).toFixed(1);\n\t\tif (porcentaje < 10)porcentaje = \"  \" + porcentaje;\n\t\tif (porcentaje < 100 && porcentaje >= 10)porcentaje = \" \" + porcentaje;\t\n\n\t\tmsg = {pin: 5, payload: \" Avance= \" + porcentaje + \"% \"};// Avance= 100.1%\n\t\tnode.send([null, msg, null]); \n\t\tnode.status({text: tiempoMoviendo + \"  Avance: \" + porcentaje+ \"%\"});\n\t\t}}\n\n\tif (global.get(\"estadoToldo\") === \"Abriendo\" && global.get(\"toldoManual\") === 0){\n\t\tif(Math.abs(global.get(\"tiempoMoviendo\")) > tiempoMover * 1.2){\n\t\t\tcontext.estadoToldo = 0;\n\t\t\tcontext.error = 1;\n\t\t\tglobal.set(\"estadoToldo\", \"Error Toldo abriendo\");\n\t\t\tglobal.set(\"estadoToldoLCD\", \"Error al abrir toldo\");\n\t\t\tvar moviendo = Math.abs(tiempoMover - global.get(\"tiempoMoviendo\"))/2;\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`, \\`tiempoMov\\`, \\`tempPatioLuz\\`) VALUES (now(),\\\"\" + global.get(\"estadoToldoLCD\") + \"\\\",\" + moviendo + \",\" + global.get(\"tempPatioLuz\") + \")\"};\n\t\t\tnode.send([null, null, msg]);\t\t\n\t\t\tmsg = {topic: \"notifyBlynk\", payload: global.get(\"estadoToldoLCD\")}; node.send([msg, null, null]);\n\t\t\tmsg = {payload: 1, color: \"#D3435C\", onlabel: \"Error\", pin: 3}; node.send([null, msg, null]);\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":0}\"};node.send([msg, null, null]);\n\t\t\treturn;\t\n\t\t}//error al abrir//error al abrir\n\t}\n\tif (global.get(\"estadoToldo\") === \"Cerrando\" && global.get(\"toldoManual\") === 0){\n\t\tif(Math.abs(global.get(\"tiempoMoviendo\")) > tiempoMover * 1.2){\n\t\t\tcontext.estadoToldo = 0;\n\t\t\tcontext.error = 1;\n\t\t\tglobal.set(\"estadoToldo\", \"Error Toldo cerrando\");\n\t\t\tglobal.set(\"estadoToldoLCD\", \"Error al cerrar toldo\");\n\t\t\tvar moviendo = Math.abs(global.get(\"tiempoMoviendo\"));\n\t\t\tmsg = {topic: \"INSERT INTO \\`toldo\\`(\\`fecha\\`, \\`estado\\`, \\`tiempoMov\\`, \\`tempPatioLuz\\`) VALUES (now(),\\\"\" + global.get(\"estadoToldoLCD\") + \"\\\",\" + moviendo + \",\" + global.get(\"tempPatioLuz\") + \")\"};\n\t\t\tnode.send([null, null, msg]);\t\t\n\t\t\tmsg = {topic: \"notifyBlynk\", payload: global.get(\"estadoToldoLCD\")}; node.send([msg, null, null]);\n\t\t\tmsg = {payload: 1, color: \"#D3435C\", onlabel: \"Error\", pin: 3}; node.send([null, msg, null]);\n\t\t\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"toldo\\\",\\\"payload\\\":0}\"};node.send([msg, null, null]);\n\t\t\treturn;\t\n\t\t}//error al cerrar\n\t}\n\n\n",
        "outputs": 3,
        "noerr": 0,
        "x": 1700,
        "y": 230,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "555ebd7f.d71624",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "mandarMail",
        "payload": "1",
        "payloadType": "str",
        "x": 310,
        "y": 240,
        "wires": [
            [
                "95935531.f40c18"
            ]
        ]
    },
    {
        "id": "954f709c.f5b4a",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"tempAmbiente\", payload: global.get(\"tempAmbienteBat\")}; node.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 2635.023780822754,
        "y": 508.30952807835183,
        "wires": [
            [
                "8af0a3fa.e59e7"
            ]
        ]
    },
    {
        "id": "9940a873.9a33d8",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"topic\":\"Crep\",\"payload\":\"1\"}",
        "payloadType": "str",
        "x": 300,
        "y": 510,
        "wires": [
            [
                "d5de6169.53ddd"
            ]
        ]
    },
    {
        "id": "fc934b68.c77b08",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "Alarma",
        "func": "var dato = JSON.parse(msg.payload);\npayload = parseInt(dato.payload);\n\n\nif (msg.topic === \"google/Alarma\" || msg.topic === \"alarmaBlynk\"){\n  msg = {topic: \"USBout\", payload:\"{\\\"topic\\\":\\\"Alarma\\\",\\\"payload\\\":\" + msg.payload + \"}\"};\n  node.send([null, msg]);\n}\n\n// if (msg.topic === \"google/Alarma\" || msg.topic === \"alarmaBlynk\"){\n//  if (parseInt(msg.payload) === 1 && global.get(\"estadoAlarma\") === 0){msg = {topic: \"USBout\", payload:\"{\\\"topic\\\":\\\"Alarma\\\",\\\"payload\\\": 1}\"}; return([null, msg]);}\n//  if (parseInt(msg.payload) === 0 && global.get(\"estadoAlarma\") === 1){msg = {topic: \"USBout\", payload:\"{\\\"topic\\\":\\\"Alarma\\\",\\\"payload\\\": 0}\"}; return([null, msg]);}\n  \n// }\n\nif (dato.topic === \"Alarma/Activacion\"){\n  global.set(\"estadoAlarma\", payload); \n//   msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \", top: \" + dato.topic + \", payload:\" + msg.payload + \"\\n\"}; node.send([null, msg]);\n  msg = {topic: \"aviso/Alarma\", payload: 1}; node.send([null, msg]);\n  if (global.get(\"estadoAlarma\") === 1){\n      msg = {payload: 1, color: \"#f5d86b\", pin: 1}; node.send([msg, null]);     \n      // msg = {payload: 140, color: \"#f5d86b\", pin: 0}; node.send([null, null, msg, null, null, null]);\n    }\n    if (global.get(\"estadoAlarma\") === 0){\n      msg = {payload: 0, color: \"#23C48E\", pin: 1}; node.send([msg, null]);\n      msg = {topic: \"notifyBlynk\", payload: \"Se desactivo la alarma de casa\"}; node.send([null, msg]);\n      // msg = {payload: 128, color: \"#23C48E\", pin: 0}; node.send([null, null, msg,null, null, null]);\n      }\n}\n\nif (dato.topic === \"Alarma/Disparo\"){\n  if (payload === 1){\n    msg = {payload: 1, color: \"#cc0000\", pin: 1}; node.send([msg, null]);\n    global.set(\"disparoAlarma\", 1);\n    msg = {topic: \"notifyBlynk\", payload: \"Se disparo Alarma en casa\"};\n\n  }\n  if (payload === 0){\n    global.set(\"disparoAlarma\", 0);\n    msg = {payload: 0, color: \"#23C48E\", pin: 1}; node.send([msg, null]);   \n    // msg = {payload: 0, pin: 10}; node.send([null, null, msg, null, null, null]);\n    msg = {topic: \"notifyBlynk\", payload: \"Se normalizo Alarma en casa\"};\n  }\n  node.send([null, msg]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 1697.951156616211,
        "y": 987.7857501166208,
        "wires": [
            [
                "d88558e1.84a5b8",
                "5909a72.73bd158",
                "d047b6ad.fafdf8"
            ],
            [
                "d047b6ad.fafdf8",
                "f1758d1f.8c7e"
            ]
        ]
    },
    {
        "id": "497188c9.5cb958",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "google/Alarma",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 1520,
        "y": 920,
        "wires": [
            [
                "fc934b68.c77b08"
            ]
        ]
    },
    {
        "id": "da17eae0.10cf48",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "if (global.get(\"estadoAlarma\") === 1)msg = {topic: \"alarmaBlynk\", payload: 0};\nif (global.get(\"estadoAlarma\") === 0)msg = {topic: \"alarmaBlynk\", payload: 1};\n// msg = {topic: \"alarmaBlynk\", payload: msg.payload};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1540,
        "y": 960,
        "wires": [
            [
                "fc934b68.c77b08"
            ]
        ]
    },
    {
        "id": "d9a01495.b2dde8",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "2",
        "payloadType": "str",
        "x": 1365.7144241333008,
        "y": 608.5713939666748,
        "wires": [
            [
                "76adfb47.e0f244"
            ]
        ]
    },
    {
        "id": "2ada1853.b0f5c8",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 740,
        "y": 510,
        "wires": []
    },
    {
        "id": "ac76f2be.6c98a",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 1720.5358047485352,
        "y": 573.5715401513236,
        "wires": []
    },
    {
        "id": "e3c140b0.d9b27",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[]",
        "payloadType": "json",
        "x": 2621.1307983398438,
        "y": 35.58730697631836,
        "wires": [
            [
                "de866222.be3ce"
            ]
        ]
    },
    {
        "id": "19fdb46e.72052c",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"temp Termo\", payload: global.get(\"tempTermoFin\")}; node.send(msg);//global.set(\"tempTermoFin\"\n",
        "outputs": 1,
        "noerr": 0,
        "x": 2632.166603088379,
        "y": 384.02379199436746,
        "wires": [
            [
                "bee9f645.f336a8"
            ]
        ]
    },
    {
        "id": "a91436a6.a86a88",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2412.2141761779785,
        "y": 654.9761947904317,
        "wires": [
            [
                "184270ba.7ac29f"
            ]
        ]
    },
    {
        "id": "3605c70e.a23568",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "USBin/Baterias",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 150,
        "y": 990,
        "wires": [
            [
                "7187c2e5.d9c10c",
                "b50751d4.0745",
                "52dc0931.634188"
            ]
        ]
    },
    {
        "id": "5fb8af81.f26aa",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "Blynk/actualizar/estado",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 1304.0243225097656,
        "y": 496.452394757952,
        "wires": [
            [
                "445cd48b.3633cc",
                "ac76f2be.6c98a",
                "d325e047.69122"
            ]
        ]
    },
    {
        "id": "2cb776c5.fc9dca",
        "type": "delay",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1918.1667404174805,
        "y": 223.64285346439908,
        "wires": [
            [
                "1f81c83c.68a278"
            ]
        ]
    },
    {
        "id": "7819eea3.04131",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 760,
        "y": 290,
        "wires": []
    },
    {
        "id": "897385ea.6c2c38",
        "type": "mqtt out",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "c339edbf.39572",
        "x": 760,
        "y": 170,
        "wires": []
    },
    {
        "id": "687f4d32.c23e84",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "Actualizacion/Baterias",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 2403.594997406006,
        "y": 364.0238041196553,
        "wires": [
            [
                "f20c8fe3.a0061",
                "3b47184b.08c028",
                "f786c1b.12b354",
                "4c70efb7.cbb4",
                "19fdb46e.72052c",
                "b91e565b.c3c818",
                "d0611568.fb10a8",
                "954f709c.f5b4a",
                "5d6a27c3.aa6e28",
                "6426f42f.2ca5bc",
                "184270ba.7ac29f",
                "b7217fe3.78b27",
                "942c7922.626f58"
            ]
        ]
    },
    {
        "id": "6528d108.e3a9c",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "toldoBlynk",
        "func": "msg = {topic: \"toldoBlynk\", payload: parseInt(msg.payload)};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1506.428554534912,
        "y": 240.95246124267578,
        "wires": [
            []
        ]
    },
    {
        "id": "95935531.f40c18",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "Baterias y Crep",
        "func": "  context.pruebas = context.pruebas || 0;\n  var haciendoPruebas;\n var offsetCorriente =0;\n\n  var frecuenciaDatos = 5;\n  var vEmergMax = 17;\n  var vEmergMin = 9.6;\n  // {\"topic\":\"Baterias/Est/Pedido/Resp\",\"bat1\":-127.00,\"bat2\":-127.00,\"bat3\":-127.00,\"bat4\":-127.00,\"bat5\":38.50,\"ambBat\":38.92,\"nivTanque\":0,\"volt\":3.72}\n  //{\"topic\":\"Crep\",\"payload\":1}.\n  //{\"topic\":\"Alarma/Disparo\",\"payload\":0}\n  //{\"topic\":\"{\"topic\":\"Baterias/Est/Pedido/Resp\",\"bat1\":-127.00,\"bat2\":-127.00,\"bat3\":-127.00,\"bat4\":-127.00,\"bat5\":38.50,\"ambBat\":38.92,\"nivTanque\":0,\"volt\":3.72}\n  //{\"topic\":\"Crep\",\"payload\":1}.\n  //{\"topic\":\"Alarma/Disparo\",\"payload\":0}\n  //{\"topic\":\"Toldo\",\"payload\":0}\n  //{\"topic\":\"Alarma/Activacion\",\"payload\":1}\n  // salida 1 serial\n  // salida 2 blynk  pin = 0 notificaciones  --  pin 1= led alarma  --  pin2= boton alarma  --  pin3= linea 1 LCD -- pin4= linea 2 LCD\n  // salida 3 mysql\n  var dato = JSON.parse(msg.payload);\n  context.inicioCrep = context.inicioCrep || 0;\n  context.inicioCargador = context.inicioCargador || 0;\n\n  var difTempEmergencia = 25;\n  var avisoBat = [];\n  var date = new Date();\n  var hh = date.getHours(); \n  var mm = date.getMinutes(); \n  var ss = date.getSeconds(); \n  var dia = date.getDate(); \n  var mes = date.getMonth()+1; global.set(\"mes\", mes);\n  var ano = date.getFullYear();\n  global.set(\"fechaDia\", date.getDay());\n\n  if (hh < 10)(hh = \"0\" + hh); if (mm < 10)(mm = \"0\" + mm); if (ss < 10)(ss = \"0\" + ss);\n  global.set(\"hh\", hh); global.set(\"mm\", mm); global.set(\"ss\", ss);\n  \n  global.set(\"fechaQuinela\", dia + \"/\" + mes + \"/\" + ano);\n  if (parseInt(global.set(\"fechaMes\")) !== parseInt(mes)) global.set(\"fechaMes\",mes);\n  if (parseInt(global.set(\"fechaAno\")) !== parseInt(ano)) global.set(\"fechaAno\",ano);\n    \n  global.set(\"fechaCompleta\", hh + \":\" + mm + \":\" + ss + \" - \" + dia + \"/\" + mes + \"/\" + ano);\n  context.hsAnterior = context.hsAnterior || 0;\n  context.enviado = context.enviado || 0;\n\n  context.Voltaje = context.Voltaje || null;\n  context.Bat1 = context.Bat1 || null;\n  context.Bat2 = context.Bat2 || null;\n  context.Bat3 = context.Bat3 || null;\n  context.Bat4 = context.Bat4 || null;\n  context.Bat5 = context.Bat5 || null;\n  context.Bat6 = context.Bat6 || null;\n  context.tempAmbienteBat = context.tempAmbienteBat || null;\n  context.nivelTanque = context.nivelTanque || null;\n  context.contador = context.contador ||0;\n  context.avisoMail = context.avisoMail ||0;\n  context.avisoTanque = context.avisoTanque ||0;\n  context.minAnt = context.minAnt || 0;\n  context.mesAnt = context.mesAnt || mes - 1;\n  context.diaAnt = context.diaAnt || dia;\n  context.estadoCargador = context.estadoCargador || 0;\n  context.cargarToldo = context.cargarToldo || 0;\n  context.tiempoCarga = context.tiempoCarga || 0;\n\n  var dateCel = new Date(date.getTime() + 960000); \n  var hhCel = dateCel.getHours(); \n  var mmCel = dateCel.getMinutes();\n  var ssCel = dateCel.getSeconds();\n\n  global.set(\"hsCpu\", hh + \":\" + mm + \":\" + ss);\n  if (hhCel < 10)(hhCel = \"0\" + hhCel); if (mmCel < 10)(mmCel = \"0\" + mmCel); if (ssCel < 10)(ssCel = \"0\" + ssCel);\n  global.set(\"hsCel\", hhCel + \":\" + mmCel + \":\" + ssCel);\n\n  var tiempo = mm % frecuenciaDatos;\n  node.status({text: hh + \":\" + mm + \":\" + ss + \"   \"  + hhCel + \":\" + mmCel + \":\" + ss + \" || \" + context.mesAnt  + \" || \" + mes  + \" || \" +  context.avisoMail});\n\n  if (dato.topic === \"Alarma\"){\n    msg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"Alarma\\\",\\\"payload\\\":\" + dato.payload + \"\\\"}\"}; \n    node.send([msg, null, null, null])}\n\n  if (msg.topic === \"mandarMail\")mandarBackUpMail();\n\n  if (ss === 2){\n    if (context.mesAnt !== mes && hh === 0 && mm === 0  && context.avisoMail === 0){mandarBackUpMail(); context.mesAnt = mes;}\n  }else{context.avisoMail = 0;}\n\n\n  // if (parseInt(ss) === 0){\n  //  // msg = {pin: 6, payload: global.get(\"hsCel\")}; node.send(msg);\n  //  // global.set(\"hsGlobal\", hh + \":\" + mm);\n  //  // if (context.minAnt !== mm){\n  //  //  context.minAnt = mm;\n  //  //  msg = {topic: \"Blynk/actualizar/estado\", payload: 1}; \n  //  //  actualizarEstado();\n  //  // }  avio\n  //  if (parseInt(tiempo) === 0 && context.enviado === 0){\n  //    msg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"Baterias/Est/Pedido\\\",\\\"payload\\\":1}\"}; \n  //    node.send([msg, null, null, null]); \n  //    context.enviado = 1;}\n  //    // return;}\n  // }\n  // else{\n  //  context.enviado = 0;\n  // }\n\n  // if (msg.topic === \"consultaCrep\"){msg = {topic : \"SELECT * FROM crepuscular ORDER BY hora Asc\"}; return ([null, null, msg, null]);}\n  // if (msg.topic === \"borrarCrep\"){msg = {topic : \"DELETE FROM `crepuscular` WHERE 1\"}; return ([null, null, msg, null]);}\n\n  if (msg.topic === \"alarmaBlynk\"){\n    msg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"Alarma\\\",\\\"payload\\\":\" + msg.payload + \"}\"};\n    node.send([msg, null, null, null]);\n  }\n\n  if (dato.topic === \"Baterias/Est/Pedido/Resp\"){\n    context.contador++; \n    global.set(\"tempBat1\", dato.bat1.toFixed(1)); //context.Bat1 += dato.bat1; if (global.get(\"tempBat1\") > difTempEmergencia + dato.tempAmb){avisoBat[1] = 1; avisoBaterias(1);}\n    global.set(\"tempBat2\", dato.bat2.toFixed(1)*2); //context.Bat2 += dato.bat2; if (global.get(\"tempBat2\") > difTempEmergencia + dato.tempAmb){avisoBat[2] = 1; avisoBaterias(2);}\n    // global.set(\"tempBat3\", dato.bat3.toFixed(1)); context.Bat3 += dato.bat3; if (global.get(\"tempBat3\") > difTempEmergencia + dato.tempAmb){avisoBat[3] = 1; avisoBaterias(3);}\n    // global.set(\"tempBat4\", dato.bat4.toFixed(1)); context.Bat4 += dato.bat4; if (global.get(\"tempBat4\") > difTempEmergencia + dato.tempAmb){avisoBat[4] = 1; avisoBaterias(4);}\n    // global.set(\"tempBat5\", dato.bat5.toFixed(1)); context.Bat5 += dato.bat5; if (global.get(\"tempBat5\") > difTempEmergencia + dato.tempAmb){avisoBat[5] = 1; avisoBaterias(5);}\n    global.set(\"tempAmbienteBat\", dato.ambBat.toFixed(1)); //context.tempAmbienteBat += dato.ambBat; \n    node.status({text: global.get(\"tempAmbienteBat\")});\n    // global.set(\"voltajeBaterias\", dato.volt.toFixed(2)); context.Voltaje += dato.volt;// controlarVoltaje(global.get(\"voltajeBaterias\")); \n    // var corrienteCarga = parseFloat(dato.corriente) - offsetCorriente;\n    // global.set(\"corrienteCarga\", corrienteCarga.toFixed(2));\n\n    // if (global.get(\"voltajeBaterias\") > vEmergMax) {avisoBat[6] = 1; avisoBaterias(6);}  \n    // if (global.get(\"voltajeBaterias\") < vEmergMin) { avisoBat[6] = 1; avisoBaterias(6);}\n    actualizarEstado();\n    // mostrarLcd();\n\n    // if (context.contador === 6){\n    //   var mysql = \"INSERT INTO \\`Baterias\\`(\\`Fecha\\`, \\`Voltaje\\`, \\`tempBat1\\`, \\`tempBat2\\`, \\`tempBat3\\`, \\`tempBat4\\`, \\`tempBat5\\`, \\`tempBat6\\`, \\`tempAmbienteBaterias\\`)\"; \n    //   mysql += \"VALUES (now() ,\" + context.Voltaje / context.contador + \",\" + context.Bat1 / context.contador + \",\" + context.Bat2 / context.contador + \",\";\n    //   mysql += context.Bat3 / context.contador + \",\" + context.Bat4 / context.contador + \",\";\n    //   mysql += context.Bat5 / context.contador + \", \" + context.Bat6 / context.contador + \", \";\n    //   mysql += context.tempAmbienteBat / context.contador + \")\";\n    //   msg.topic = mysql;\n    //   node.send([ null, null, msg, null]);\n    //   context.Voltaje = 0; context.Bat1 = 0; context.Bat2 = 0; context.Bat3 = 0; context.Bat4 = 0; context.Bat5 = 0;\n    //   context.tempAmbienteBat = 0; context.nivTanque = 0; context.contador = 0;\n    // }\n    msg = {topic: \"Actualizacion/Baterias\", payload:\"\"}; node.send([msg, null, null, null]);\n  }\n\n  if (dato.topic === \"Cargador\"){\n    global.set(\"estadoCargador\", dato.payload);\n    global.set(\"voltajeBaterias\", parseFloat(dato.volt).toFixed(2));\n    var corrienteCarga = parseFloat(dato.corriente) - offsetCorriente;\n    global.set(\"corrienteCarga\", parseFloat(corrienteCarga).toFixed(2));\n\n    if (global.get(\"voltajeBaterias\") > vEmergMax) {avisoBat[6] = 1; avisoBaterias(6);} \n    if (global.get(\"voltajeBaterias\") < vEmergMin) { avisoBat[6] = 1; avisoBaterias(6);}  \n    \n    if (parseInt(dato.payload) === 1 && context.estadoCargador === 0) {\n      context.estadoCargador = 1;\n      var date1 = new Date(date.getTime() - context.tiempoCarga); \n      global.set(\"tiempoEspera\", (date.getTime() - context.tiempoCarga)/(60*1000));\n      msg = {topic: \"provisoriosMQTT\", payload: \"tiempo espera: \" + global.get(\"tiempoEspera\")}; node.send(msg);\n      // if (context.inicioCargador === 1)global.set(\"tiempoEspera\", (date.getTime() - context.tiempoCarga)/(60*1000));\n      // if (context.inicioCargador === 0)context.inicioCargador = 1;\n\n      var minCarg = date1.getMinutes(); var segCarg = date1.getSeconds();\n      if (minCarg < 10)(minCarg = \"0\" + minCarg); if (segCarg < 10)(segCarg = \"0\" + segCarg);\n      var mostrarTiempoCarga = minCarg + \":\" + segCarg; \n      context.tiempoCarga = date.getTime();\n\n      msg = {topic: \"estadoFallas\", payload: 1}; node.send(msg);\n      // msg = {topic: \"notifyBlynk\", payload: \"Iniciando carga baterias (tiempo espera= \" + mostrarTiempoCarga + \")\"}; node.send(msg); \n\n      global.set(\"estadocargadorTexto\", \"cargando desde \" + dia + \"/\" + (mes+1) + \"/\" + ano + \" \" + hh + \":\" + mm + \":\" + ss);}\n\n    if (parseInt(dato.payload) === 0 && context.estadoCargador === 1) {\n      context.estadoCargador = 0;\n      var date1 = new Date(date.getTime() - context.tiempoCarga); \n      global.set(\"tiempoCargando\", (date.getTime() - context.tiempoCarga)/(60*1000));\n      msg = {topic: \"provisoriosMQTT\", payload: \"tiempo cargand: \" + global.get(\"tiempoCargando\")}; node.send(msg);\n      \n      // if (context.inicioCargador === 1)global.set(\"tiempoCargando\", (date.getTime() - context.tiempoCarga)/(60*1000));\n      // if (context.inicioCargador === 0)context.inicioCargador = 1;\n\n      var minCarg = date1.getMinutes(); var segCarg = date1.getSeconds();\n      if (minCarg < 10)(minCarg = \"0\" + minCarg); if (segCarg < 10)(segCarg = \"0\" + segCarg);\n      var mostrarTiempoCarga = minCarg + \":\" + segCarg; \n      context.tiempoCarga = date.getTime();\n      msg = {topic: \"estadoFallas\", payload: 1}; node.send(msg);\n      // msg = {topic: \"notifyBlynk\", payload: \"Terminando carga baterias (tiempo cargando= \" + mostrarTiempoCarga + \")\"}; node.send(msg);\n\n      global.set(\"estadocargadorTexto\", \"OK desde \" + dia + \"/\" + (mes+1) + \"/\" + ano + \" \" + hh + \":\" + mm + \":\" + ss);\n    }\n    msg = {topic: \"Blynk/actualizar/estado\", payload: \"\"}; node.send([msg, null, null, null, null]);\n  }\n\n  function avisoBaterias(numBat){\n    if (numBat > 0 && numBat <= 5){\n      msg = {topic: \"notifyBlynk\", payload: \"Atencion baterias numero: \" + numBat + \" sobrecalentada\"};//, pin: 0};\n      node.send([msg, null, null, null]);\n    }\n    if (numBat === 6){\n      msg = {topic: \"notifyBlynk\", payload: \"Atencion voltaje de baterias fuera de rango, voltaje: \" + dato.volt + \"V\"};//, pin: 0};\n      node.send([msg, null, null, null]);\n    }\n  }\n\n  function mandarBackUpMail(){\n    var nombre = mes + \"_\" + ano;\n    var directorio = \"/home/gaston/BackUp-Node-Red/\";\n    msg = {topic : \"SELECT * FROM crepuscular ORDER BY hora Asc\"};\n    node.send([null, null, msg, null]);\n    msg = {topic : \"SELECT \\\"hora\\\", \\\"valor\\\" UNION  SELECT \\`hora\\`, \\`valor\\` INTO OUTFILE \\'\" + directorio + nombre + \".csv\\' FIELDS TERMINATED BY \\';\\' OPTIONALLY ENCLOSED BY '\\\"' LINES TERMINATED BY '\\r\\n' FROM \\`crepuscular\\`\"};\n    node.send([null, null, msg, null]);\n    msg = {topic : \"DELETE FROM \\`crepuscular\\` WHERE 1\"};\n    node.send([null, null, msg, null]);\n\n    msg.topic = \"BackUp crepuscular\";\n    msg.payload = \"BackUp crepuscular\";\n    msg.attachments = [{\n        filename: nombre + '.csv',\n        path: directorio + nombre + '.csv',\n        content: msg.payload\n    }];\n    node.send([null, null, null, msg]);\n    context.avisoMail = 1;\n  }\n\n  function actualizarEstado(){\n    if (global.get(\"estadoToldo\") !== \"Abriendo\" && global.get(\"estadoToldo\") !== \"Cerrando\"){\n      msg = {topic: \"Blynk/actualizar/estado\", payload: 1};\n      node.send([msg, null, null, null, null]);}  \n  }\n  //Serial.println(alturaTanque - valorAcumulado);\n  // alturaAgua = alturaAgua + (alturaTanque - valorAcumulado);//Serial.println(alturaTanque - valorAcumulado);",
        "outputs": 4,
        "noerr": 0,
        "x": 510,
        "y": 270,
        "wires": [
            [
                "897385ea.6c2c38",
                "4a5f13c4.c6331c"
            ],
            [],
            [],
            [
                "f07145ce.8d14a8",
                "7819eea3.04131"
            ]
        ]
    },
    {
        "id": "d325e047.69122",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "salida2 lcd blynk",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1611.809455871582,
        "y": 531.3929204940796,
        "wires": []
    },
    {
        "id": "b7217fe3.78b27",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"nivTanque\", payload: global.get(\"nivTanque\")}; node.send(msg);\nreturn;\n//tempTermoFin",
        "outputs": 1,
        "noerr": 0,
        "x": 2621.1310119628906,
        "y": 177.035699571882,
        "wires": [
            [
                "de866222.be3ce"
            ]
        ]
    },
    {
        "id": "d0611568.fb10a8",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"tempBat6\", payload: global.get(\"tempBat6\")}; node.send(msg);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 2632.166603088379,
        "y": 468.30952807835183,
        "wires": [
            []
        ]
    },
    {
        "id": "5d6a27c3.aa6e28",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"voltajeBaterias\", payload: global.get(\"voltajeBaterias\")}; node.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 2637.880958557129,
        "y": 549.7381147657125,
        "wires": [
            [
                "c50fec05.b4a01"
            ]
        ]
    },
    {
        "id": "2e048c0e.d58a74",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "USB/Alarma",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 1700,
        "y": 1020,
        "wires": []
    },
    {
        "id": "6426f42f.2ca5bc",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"nivTanque\", payload: global.get(\"nivTanque\")}; node.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 2636.4999389648438,
        "y": 602.119038990566,
        "wires": [
            [
                "649cd037.becf5"
            ]
        ]
    },
    {
        "id": "6547685f.652378",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "USBin/Toldo",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 1486.095043182373,
        "y": 200.42863273620605,
        "wires": [
            []
        ]
    },
    {
        "id": "445cd48b.3633cc",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "LCD Blynk",
        "func": "var velocidadTexto = 191;\nvar velocidadTexto1 = 140;\nvar payload = msg.payload;\nvar largo;\nvar estadoCarg;\nvar cont = -1;\nvar timer1;\nvar timer2;\nvar timer3;\nvar Baterias;\nvar Toldo;\nvar datosTemp;\nvar crepuscular;\nvar tempMaxMinAyer;\nvar tempMaxMinHoy;\n\nif (global.get (\"estadoCargador\") === 1) {estadoCarg = \"V Carg\";} else {estadoCarg = \"V OK\";}\n\nBaterias = global.get(\"estadocargadorTexto\") + \"   Volt=\" + global.get(\"voltajeBaterias\");// + estadoCarg + \" Tanque=\" + global.get(\"nivTanque\") + \"mm\" + \" Temp. Alt=\" + global.get(\"tempAmbienteBat\"); \n// Baterias += \" Bat1=\" + global.get(\"tempBat1\") + \" Bat2=\" + global.get(\"tempBat2\") + \" Bat3=\" + global.get(\"tempBat3\");\n// Baterias +=  \" Bat4=\" + global.get(\"tempBat4\") + \" Bat5=\" + global.get(\"tempBat5\");\n\n\nToldo = \"   \" + global.get(\"estadoToldoLCD\") + \", \" + global.get(\"enfriadorToldo\");// + global.get(\"enfriadorToldo\");\nif (global.get(\"enfriarToldo\") === 1){Toldo = Toldo + \", \" + global.get(\"rociadorToldo\");}\n\ndatosTemp = \"   Living=\" + parseFloat(global.get(\"tempLiving\")).toFixed(1) + \" Hum. Living=\" + parseFloat(global.get(\"humLiving\")).toFixed(1);\ndatosTemp += \"% Pasillo=\" + parseFloat(global.get(\"tempPasillo\")).toFixed(1) + \" PatioLuz=\" + parseFloat(global.get(\"tempPatioLuz\")).toFixed(1);\ndatosTemp += \" Exterior=\" + parseFloat(global.get(\"tempExterior\")).toFixed(1);\ndatosTemp +=\" Lavadero=\" + parseFloat(global.get(\"tempLavadero\")).toFixed(1) + \" Tanque=\" + global.get(\"nivTanque\") + \"mm\";\n\ntempMaxMinAyer = \"   Min ayer \" + global.get(\"tempMinExtAnt\") + \", Max ayer \" + global.get(\"tempMaxExtAnt\");\n \ntempMaxMinHoy =  \"   Min hoy \" + global.get(\"tempMinExt\") + \", Max hoy \" + global.get(\"tempMaxExt\") + \", actual \" + global.get(\"tempExterior\");\n\nif (global.get(\"Dia\") === 0){\n\tcrepuscular = \"   Oscurecio a las \" + global.get(\"hsAnochecer\") +  \", Amanecio a las \" + global.get(\"hsAmanecer\") + \", sensorCrep \" + global.get(\"sensorCrep\");}\n\telse{\n\tcrepuscular = \"   Amanecio a las \" + global.get(\"hsAmanecer\") + \", Oscurecio a las \" + global.get(\"hsAnochecer\") + \", sensorCrep \" + global.get(\"sensorCrep\");}\n\n\n\nmsg.payload = Baterias; node.send([null,msg]);\nmsg.payload = datosTemp; node.send([null,msg]);\nmsg.payload = Toldo; node.send([null,msg]);\nmsg.payload = crepuscular; node.send([null,msg]);\nmsg.payload = tempMaxMinAyer; node.send([null,msg]);\nmsg.payload = tempMaxMinHoy; node.send([null,msg]);\n\ncontext.mostrando = context.mostrando || 0;\ncontext.pedido = context.pedido || 0;\n\n\n// var largoTemperaturas = Temperaturas.length;\nvar largoBaterias = Baterias.length;\nvar largoToldo = Toldo.length;\nvar largoDatosTemp = datosTemp.length;\nvar largoCrepuscular = crepuscular.length;\nvar largotempMaxMinAyer = tempMaxMinAyer.length;\nvar largotempMaxMinHoy = tempMaxMinHoy.length;\n// node.status({text: context.mostrando});\nif (context.mostrando === 1)return;\n\n// if (msg.topic === \"pedidoActualizacion\")payload = context.pedido;\n\nif (msg.topic === \"Blynk/actualizar/estado\")actualizarEstado();\nif (global.get(\"estadoToldo\") !== \"Abriendo\" || global.get(\"estadoToldo\") !== \"Cerrando\"){\n\tif (payload === \"2\") velocidadTexto = velocidadTexto1;\n\tif (msg.topic === \"Blynk/actualizar/infos\"){\n\t\tpayload = context.pedido; \n\t\t// if (payload === \"1\") velocidadTexto = 190;\n\t\ttimer1 = setInterval(infoCompleta, velocidadTexto1);}\n\t\t\t\t\t//timer2 = setInterval(mostrarDatosTemp, velocidadTexto2);\n\tif (msg.topic === \"Blynk/mostrar/infos\")timer1 = setInterval(infoCompleta, velocidadTexto);\n\t// if (msg.topic === \"Blynk\")var timer1 = setInterval(datosTemp, velocidadTexto2);\n}\n\nreturn;\nfunction infoCompleta(){\n\tcontext.mostrando = 1;\n\tcont++;\n\tswitch (parseInt(payload)){\n\t\tcase 1:\n\t\t\tcontext.pedido = \"1\";\n\t\t\tlargo = largoDatosTemp;\n\t\t\tmsg = {pin: 4, payload: \" Temp Ambientes \"}; node.send(msg);\n\t\t\tif (cont < largoDatosTemp-15){msg = {pin: 5, payload: datosTemp.substring(cont)}; node.send(msg);}\n\t\tbreak;\n\n\t\tcase 2:\n\t\t\tcontext.pedido = \"2\";\n\t\t\tlargo = largoBaterias;\n\t\t\tmsg = {pin: 4, payload: \"Info de Baterias\"}; node.send(msg);\n\t\t\tif (cont < largoBaterias-15){msg = {pin: 5, payload: Baterias.substring(cont)}; node.send(msg);}\n\t\tbreak;\n\n\t\tcase 3:\n\t\t\tcontext.pedido = \"3\";\n\t\t\tlargo = largoToldo;\n\t\t\tmsg = {pin: 4, payload: \" Info del Toldo \"}; node.send(msg);\n\t\t\tif (cont < largoToldo-15){msg = {pin: 5, payload: Toldo.substring(cont)}; node.send(msg);}\n\t\tbreak;\n\t\tcase 4:\n\t\t\tcontext.pedido = \"4\";\n\t\t\tlargo = largoCrepuscular;\n\t\t\tmsg = {pin: 4, payload: \"Info crepuscular\"}; node.send(msg);\n\t\t\tif (cont < largoCrepuscular-15){msg = {pin: 5, payload: crepuscular.substring(cont)}; node.send(msg);}\n\t\tbreak;\t\n\t\tcase 5:\n\t\t\tcontext.pedido = \"5\";\n\t\t\tlargo = largotempMaxMinAyer;\n\t\t\tmsg = {pin: 4, payload: \"  Temp Max/Min  \"}; node.send(msg);\n\t\t\tif (cont < largotempMaxMinAyer-15){msg = {pin: 5, payload: tempMaxMinAyer.substring(cont)}; node.send(msg);}\n\t\tbreak;\n\t\tcase 6:\n\t\t\tcontext.pedido = \"6\";\n\t\t\tlargo = largotempMaxMinHoy;\n\t\t\tmsg = {pin: 4, payload: \"  Temp Max/Min  \"}; node.send(msg);\n\t\t\tif (cont < largotempMaxMinHoy-15){msg = {pin: 5, payload: tempMaxMinHoy.substring(cont)}; node.send(msg);}\n\t\tbreak;\t\t\n\t}\n\tif (cont > largo-16){clearInterval(timer1); timer3 = setInterval(pantallaPrincipal, 1000);}\n}\n\n// function mostrarDatosTemp(){\n// \tcontext.mostrando = 1;\n// \t// cont++;\n// \tlargo = largoDatosTemp;\n// \tmsg = {pin: 4, payload: \" Temp Ambientes \"}; node.send(msg);\n// \tif (cont < largoDatosTemp-15){msg = {pin: 5, payload: datosTemp.substring(cont)}; node.send(msg);}\n// \tif (cont > largo-16){clearInterval(timer2); timer3 = setInterval(pantallaPrincipal, 1000);}\n// }\n\nfunction pantallaPrincipal(){\n\tcontext.mostrando = 0;\n\tactualizarEstado();\n\tclearInterval(timer3);\t\t\n}\n\nfunction actualizarEstado(){\n\tnode.status({text: global.get(\"hsCel\")}); \n\t// msg = {pin: 6, payload: global.get(\"hsCel\")}; node.send(msg);\n\tif (global.get(\"estadoToldo\") !== \"Abriendo\" || global.get(\"estadoToldo\") !== \"Cerrando\"){\n\t\tif (global.get(\"estadoCargador\") == \"1\"){msg = {pin: 15, label: \"Estado Baterias: Cargando\", color: \"#fcaf17\", payload: parseFloat(global.get(\"voltajeBaterias\")).toFixed(2) + \"v  \" + global.get(\"corrienteCarga\") + \"A  \" + parseFloat((global.get(\"voltajeBaterias\") * global.get(\"corrienteCarga\"))/1000).toFixed(2) + \"Kw\"}; node.send(msg);}\n\t\tif (global.get(\"estadoCargador\") == \"0\"){msg = {pin: 15, label: \"Estado Baterias: Cargada\", color: \"#23C48E\", payload: parseFloat(global.get(\"voltajeBaterias\")).toFixed(2) + \"v    \" + global.get(\"corrienteCarga\") + \"A\"}; node.send(msg);}\t\t\n\t\tmsg = {pin: 4, payload: \"Temp= \" + global.get(\"tempExterior\")}; node.send(msg);\n\t\tmsg = {pin: 5, payload: \"Tq= \" + global.get(\"nivTanque\") + \"mm T=\" + global.get(\"tempPatioLuz\")}; node.send(msg);\n\t}\nreturn;}\n\n\n//temp= 21.5  ll55\n//Mi=10.5  Ma=21.5\n//Act=15.2 Tq=365mm",
        "outputs": 2,
        "noerr": 0,
        "x": 1755.5752067565918,
        "y": 676.3690500259399,
        "wires": [
            [
                "57b149bd.b8d058",
                "4b014358.da11bc",
                "1fa1bbd5.dc54e4"
            ],
            [
                "cf18dea9.b1f6d"
            ]
        ]
    },
    {
        "id": "91d5660a.0f6e38",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 1362.2261047363281,
        "y": 538.0596344811576,
        "wires": [
            [
                "c3665e22.cefcc"
            ]
        ]
    },
    {
        "id": "b0f045e1.47c488",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "USBout",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 420,
        "y": 640,
        "wires": [
            [
                "35c86102.3c4c2e"
            ]
        ]
    },
    {
        "id": "f47b95aa.c8d258",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "pulso",
        "repeat": "1",
        "crontab": "",
        "once": true,
        "onceDelay": "2",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1501.4284477233887,
        "y": 118.71432304382324,
        "wires": [
            []
        ]
    },
    {
        "id": "184270ba.7ac29f",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg.payload = global.get(\"estadocargadorTexto\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2639.8331909179688,
        "y": 653.7856649671285,
        "wires": [
            [
                "a0fdce3d.0029a"
            ]
        ]
    },
    {
        "id": "f1758d1f.8c7e",
        "type": "mqtt out",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "c339edbf.39572",
        "x": 1905.0942497253418,
        "y": 1026.3571545737132,
        "wires": []
    },
    {
        "id": "4c70efb7.cbb4",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"tempBat2\", payload: global.get(\"tempBat2\")}; node.send(msg);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 2629.3095474243164,
        "y": 298.3094975607736,
        "wires": [
            [
                "d4a94829.9d2278"
            ]
        ]
    },
    {
        "id": "be210406.8a4f68",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 1351.0951347351074,
        "y": 380.85718154907227,
        "wires": [
            [
                "6528d108.e3a9c"
            ]
        ]
    },
    {
        "id": "b5035f2.f7fe4a",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "USBin/Alarma",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 1520,
        "y": 1000,
        "wires": [
            [
                "fc934b68.c77b08",
                "2e048c0e.d58a74"
            ]
        ]
    },
    {
        "id": "35c86102.3c4c2e",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "Serial out",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 590,
        "y": 620,
        "wires": []
    },
    {
        "id": "36ea0611.adb13a",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "pulso",
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 322.6429634094238,
        "y": 330.2738253729684,
        "wires": [
            [
                "95935531.f40c18",
                "9fdf6dbc.c9208"
            ]
        ]
    },
    {
        "id": "7187c2e5.d9c10c",
        "type": "delay",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 360,
        "y": 950,
        "wires": [
            [
                "aad338fd.eb88b8",
                "bcf69a76.207f48"
            ]
        ]
    },
    {
        "id": "c45d2106.9d2f9",
        "type": "exec",
        "z": "3ce5b54a.127d6a",
        "command": "./temp.sh",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": true,
        "name": "tempCPU",
        "x": 350,
        "y": 1050,
        "wires": [
            [
                "ceaa70f7.12e92",
                "b5334e08.2a0aa"
            ],
            [],
            []
        ]
    },
    {
        "id": "ceaa70f7.12e92",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "var temp = msg.payload;\ncontext.temp = context.temp || 0;\ncontext.cont = context.cont || 0;\n\n// temp = temp.substring(temp.indexOf(\"temp\")+5);\n// temp = temp.substring(0, temp.indexOf(\"''\"));\n// temp = parseFloat(temp).toFixed(1);\n// temp = parseFloat(msg.payload / 1000).toFixed(1);\n// node.status({text: temp});\ncontext.cont++;\ncontext.temp = parseFloat(temp) + parseFloat(context.temp);\nvar dato = parseFloat(context.temp / context.cont).toFixed(1);\n// var dato = context.temp / context.cont;\nnode.status({text: \"cont: \" + context.cont + \"  temp: \"+ temp + \"  tempAc: \"+ context.temp});\n\nif (context.cont >= 10){\n    global.set(\"tempCPU\", parseFloat(context.temp / context.cont).toFixed(1));\n    node.status({text: \"cont: \" + context.cont + \"  temp: \" + global.get(\"tempCPU\")});    \n    node.status({text: \"Temp CPU: \" + global.get(\"tempCPU\")});\n    context.cont = 0;\n    context.temp = 0;\n    if (global.get(\"tempCPU\") > 80){\n        msg = {topic: \"notifyBlynk\", payload: \"Atencion, Servidor muy caliente\"};\n        node.send(msg);\n    }    \n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 591.111156463623,
        "y": 1070.0000162124634,
        "wires": [
            [
                "857b8d95.75481"
            ]
        ]
    },
    {
        "id": "81acbb17.363298",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "30",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "Baterias/Est/Pedido/Resp",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 1050,
        "wires": [
            [
                "c45d2106.9d2f9"
            ]
        ]
    },
    {
        "id": "857b8d95.75481",
        "type": "mqtt out",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 854.444450378418,
        "y": 1063.3333625793457,
        "wires": []
    },
    {
        "id": "942c7922.626f58",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg.payload = global.get(\"tempCPU\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2640,
        "y": 700,
        "wires": [
            [
                "2d31d0b7.e3314"
            ]
        ]
    },
    {
        "id": "fef811df.60e3b",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "5",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2430,
        "y": 700,
        "wires": [
            [
                "942c7922.626f58"
            ]
        ]
    },
    {
        "id": "c3639553.ac2e58",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "USBin/Baterias",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 520,
        "y": 460,
        "wires": [
            [
                "faf5118e.e222e"
            ]
        ]
    },
    {
        "id": "faf5118e.e222e",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "var dato = JSON.parse(msg.payload);\nif (dato.topic === \"Cargador\")return msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 670,
        "y": 460,
        "wires": [
            [
                "bef7330f.045f1"
            ]
        ]
    },
    {
        "id": "bef7330f.045f1",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 810,
        "y": 460,
        "wires": []
    },
    {
        "id": "9b78adbf.59e17",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "32",
        "payloadType": "num",
        "x": 360,
        "y": 130,
        "wires": [
            [
                "e85d0b9b.bcb288"
            ]
        ]
    },
    {
        "id": "e85d0b9b.bcb288",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "pwmPatioLuz",
        "func": "global.set(\"pwmPatioLuz\", msg.payload)\nnode.status({text: global.get(\"pwmPatioLuz\")})",
        "outputs": 1,
        "noerr": 0,
        "x": 540,
        "y": 130,
        "wires": [
            []
        ]
    },
    {
        "id": "d02f7746.45a218",
        "type": "mqtt out",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "c339edbf.39572",
        "x": 1884.166919708252,
        "y": 132.7857052939279,
        "wires": []
    },
    {
        "id": "b5b0d51b.cfbab8",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1360,
        "y": 920,
        "wires": [
            [
                "da17eae0.10cf48"
            ]
        ]
    },
    {
        "id": "d6e38d2.d5e297",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "inicio",
        "payloadType": "str",
        "x": 1710,
        "y": 880,
        "wires": [
            [
                "f8b20280.e0b44"
            ]
        ]
    },
    {
        "id": "f8b20280.e0b44",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "if (global.get(\"estadoAlarma\") === undefined)global.set(\"estadoAlarma\", 0);",
        "outputs": 1,
        "noerr": 0,
        "x": 1840,
        "y": 880,
        "wires": [
            []
        ]
    },
    {
        "id": "4b014358.da11bc",
        "type": "delay",
        "z": "3ce5b54a.127d6a",
        "name": "100mS",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1941.3927841186523,
        "y": 635.9643287658691,
        "wires": [
            [
                "e7f57541.097388"
            ]
        ]
    },
    {
        "id": "a0acd491.b98338",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "informarNivel",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 322.00000762939453,
        "y": 879.4167108535767,
        "wires": [
            [
                "99ff2535.0c1838"
            ]
        ]
    },
    {
        "id": "99ff2535.0c1838",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg= {topic: \"nivTanque\", payload: global.get(\"nivTanque\")}; node.send(msg);\nmsg= {topic: \"tasaLlenado\", payload: parseFloat(global.get(\"tasaLlenadoTanque\")).toFixed(2)};\nif (parseInt(global.get(\"llenarTanque\")) === 1){\n    node.send(msg);\n    msg = {pin: 33, payload: global.get(\"nivTanque\")}; node.send([null, msg]);\n    // msg = {pin: 22, payload: global.get(\"nivTanque\")}; node.send([null, msg]);\n    \n}\nif (parseInt(global.get(\"llenarTanque\")) === 0)global.set(\"tasaLlenadoTanque\", 0);\n\n\n\n",
        "outputs": 2,
        "noerr": 0,
        "x": 552.2222518920898,
        "y": 888.8888626098633,
        "wires": [
            [
                "490a73a0.04a99c",
                "c0d2001d.8e91b",
                "8b0611c9.25273"
            ],
            [
                "577fff27.098f7"
            ]
        ]
    },
    {
        "id": "6cc0d0ab.b9ba3",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "// var dato = JSON.parse(msg.payload);\n// if (dato.topic == \"Baterias/Est/Pedido/Resp\" || msg.topic == \"ESP/Pasillo/Sens/Temp/Pedido\"){\n    msg= {topic: \"tempAmbiente\", payload: global.get(\"tempAmbienteBat\")}; node.send(msg);\n    // node.status ({text: global.get(\"tempAmbienteBat\")});\n    msg= {topic: \"tempBat1\", payload: global.get(\"tempBat1\")}; node.send(msg);\n    msg= {topic: \"tempBat2\", payload: global.get(\"tempBat2\")}; node.send(msg);    \n    msg= {topic: \"tempCPU\", payload: global.get(\"tempCPU\")}; node.send(msg);\n    \n// }",
        "outputs": 1,
        "noerr": 0,
        "x": 530,
        "y": 990,
        "wires": [
            [
                "62525e7.2f30ca",
                "5afc7c60.d87c34"
            ]
        ]
    },
    {
        "id": "5afc7c60.d87c34",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 690,
        "y": 1040,
        "wires": []
    },
    {
        "id": "b50751d4.0745",
        "type": "delay",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 360,
        "y": 990,
        "wires": [
            [
                "6cc0d0ab.b9ba3"
            ]
        ]
    },
    {
        "id": "97f0b2f0.7fe07",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "if (msg.payload.includes(\"corrMin\"))global.set(\"corrMinimaBaterias\", parseFloat(msg.payload.substring(7)));\nif (msg.payload.includes(\"volMin\"))global.set(\"voltMinimoVaterias\", parseFloat(msg.payload.substring(6)));\nif (msg.payload.includes(\"offCorr\"))global.set(\"offSetCorriente\", parseFloat(msg.payload.substring(7)));\n\nnode.status({text: \"vMin: \" + global.get(\"voltMinimoVaterias\") + \"  corrMin: \" + global.get(\"corrMinimaBaterias\") + \"  offSetCorr: \" + global.get(\"offSetCorriente\") });\nmsg = {topic: \"Baterias/Inicio\", payload: global.get(\"corrMinimaBaterias\") + \"#\" + global.get(\"voltMinimoVaterias\") + \"#\" + global.get(\"offSetCorriente\")};\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 560,
        "y": 680,
        "wires": [
            [
                "861fc432.288a68",
                "f6dfc950.057bb8"
            ]
        ]
    },
    {
        "id": "d89575f4.ec7998",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 470,
        "y": 520,
        "wires": []
    },
    {
        "id": "ddddc125.92658",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"topic\":\"Alarma/Activacion\",\"payload\":1}",
        "payloadType": "str",
        "x": 250,
        "y": 430,
        "wires": [
            [
                "d5de6169.53ddd"
            ]
        ]
    },
    {
        "id": "737eb8ec.f89e98",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"topic\":\"Alarma/Activacion\",\"payload\":0}",
        "payloadType": "str",
        "x": 250,
        "y": 470,
        "wires": [
            [
                "d5de6169.53ddd"
            ]
        ]
    },
    {
        "id": "e38aae49.8ead8",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"topic\":\"Cargador\",\"payload\":1,\"volt\":13.33,\"corriente\":13.27}",
        "payloadType": "str",
        "x": 300,
        "y": 170,
        "wires": [
            [
                "95935531.f40c18"
            ]
        ]
    },
    {
        "id": "bf3b0610.5a8468",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"topic\":\"Cargador\",\"payload\":0,\"volt\":13.33,\"corriente\":13.27}",
        "payloadType": "str",
        "x": 300,
        "y": 200,
        "wires": [
            [
                "95935531.f40c18"
            ]
        ]
    },
    {
        "id": "11075f36.1f5d01",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1900,
        "y": 1110,
        "wires": [
            [
                "37029e26.0cf782"
            ]
        ]
    },
    {
        "id": "37029e26.0cf782",
        "type": "link out",
        "z": "3ce5b54a.127d6a",
        "name": "Alarma",
        "links": [
            "b1a0c92f.989598"
        ],
        "x": 2005,
        "y": 1110,
        "wires": []
    },
    {
        "id": "b1a0c92f.989598",
        "type": "link in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "links": [
            "37029e26.0cf782"
        ],
        "x": 1375,
        "y": 1000,
        "wires": [
            [
                "da17eae0.10cf48"
            ]
        ]
    },
    {
        "id": "d047b6ad.fafdf8",
        "type": "link out",
        "z": "3ce5b54a.127d6a",
        "name": "salidaAlarma",
        "links": [
            "fa1f9137.f79d5"
        ],
        "x": 2005,
        "y": 1010,
        "wires": []
    },
    {
        "id": "fa1f9137.f79d5",
        "type": "link in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "links": [
            "d047b6ad.fafdf8"
        ],
        "x": 1355,
        "y": 1110,
        "wires": [
            [
                "3dcd1e2f.ec8c22"
            ]
        ]
    },
    {
        "id": "3dcd1e2f.ec8c22",
        "type": "delay",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pauseType": "delay",
        "timeout": "020",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1460,
        "y": 1110,
        "wires": [
            [
                "eb30c259.d92c8"
            ]
        ]
    },
    {
        "id": "eb30c259.d92c8",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"\", payload: global.get(\"estadoAlarma\")}; \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1610,
        "y": 1110,
        "wires": [
            [
                "34a42ed0.f6adc2"
            ]
        ]
    },
    {
        "id": "3562e1c8.094afe",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1430,
        "y": 1160,
        "wires": [
            [
                "3dcd1e2f.ec8c22"
            ]
        ]
    },
    {
        "id": "a764f4e9.6c1028",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg.payload = global.get(\"fechaCompleta\") + \" - (\" + global.get(\"tempExterior\") + \")\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 700,
        "y": 360,
        "wires": [
            [
                "e68fc671.d485c8"
            ]
        ]
    },
    {
        "id": "9fdf6dbc.c9208",
        "type": "delay",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 550,
        "y": 360,
        "wires": [
            [
                "a764f4e9.6c1028"
            ]
        ]
    },
    {
        "id": "2903e624.47c22a",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 520,
        "y": 200,
        "wires": []
    },
    {
        "id": "b5334e08.2a0aa",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 510,
        "y": 1130,
        "wires": []
    },
    {
        "id": "ea97adc2.af88d",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2420,
        "y": 320,
        "wires": [
            [
                "19fdb46e.72052c",
                "b7217fe3.78b27",
                "f20c8fe3.a0061"
            ]
        ]
    },
    {
        "id": "14b0e482.88791b",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "provisoriosMQTT",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 450,
        "y": 80,
        "wires": [
            [
                "8a783ae9.33a138"
            ]
        ]
    },
    {
        "id": "8a783ae9.33a138",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "provisoriosMQTT",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 650,
        "y": 80,
        "wires": []
    },
    {
        "id": "861fc432.288a68",
        "type": "file",
        "z": "3ce5b54a.127d6a",
        "name": "back datos termo",
        "filename": "/home/pi/BackUp-Node-Red/Baterias.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 760,
        "y": 650,
        "wires": [
            []
        ]
    },
    {
        "id": "9606eb35.2c2108",
        "type": "file in",
        "z": "3ce5b54a.127d6a",
        "name": "recover datos termo",
        "filename": "/home/pi/BackUpNodeRed/Baterias.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 560,
        "y": 770,
        "wires": [
            [
                "924e9200.5d5d2"
            ]
        ]
    },
    {
        "id": "ca4777b4.f259b8",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "Baterias/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 320,
        "y": 800,
        "wires": [
            [
                "9606eb35.2c2108"
            ]
        ]
    },
    {
        "id": "9b66bb8e.b2ab78",
        "type": "mqtt out",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "c339edbf.39572",
        "x": 890,
        "y": 690,
        "wires": []
    },
    {
        "id": "f6dfc950.057bb8",
        "type": "delay",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 740,
        "y": 690,
        "wires": [
            [
                "9b66bb8e.b2ab78"
            ]
        ]
    },
    {
        "id": "924e9200.5d5d2",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "val. in. baterias",
        "func": "var dato = msg.payload.split(\"#\");\nglobal.set(\"corrMinimaBaterias\", dato[0]);\nglobal.set(\"voltMinimoVaterias\", dato[1]);\nglobal.set(\"offSetCorriente\", dato[2]);\n\nmsg = {topic: \"USBout\", payload: \"config\" + global.get(\"corrMinimaBaterias\") + \"#\" + global.get(\"voltMinimoVaterias\") + \"#\" + global.get(\"offSetCorriente\")};\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "x": 760,
        "y": 770,
        "wires": [
            [
                "9b66bb8e.b2ab78"
            ]
        ]
    },
    {
        "id": "52dc0931.634188",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 300,
        "y": 1120,
        "wires": []
    },
    {
        "id": "bcf69a76.207f48",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 510,
        "y": 850,
        "wires": []
    },
    {
        "id": "8e765cc1.2afb1",
        "type": "mqtt out",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 933,
        "y": 977,
        "wires": []
    },
    {
        "id": "e14463a7.a8348",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 695.5555572509766,
        "y": 965.5555620193481,
        "wires": []
    },
    {
        "id": "71ce9b48.3ad114",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "Pedido/Lavadero/Bombas",
        "qos": "",
        "retain": "",
        "broker": "c339edbf.39572",
        "x": 840,
        "y": 510,
        "wires": []
    },
    {
        "id": "e02bb3bc.f54b9",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/Inicio",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 324,
        "y": 509,
        "wires": [
            [
                "9f837dbe.a7563",
                "aeaa2ce9.06eb4"
            ]
        ]
    },
    {
        "id": "b7daae4c.c7c24",
        "type": "function",
        "z": "73083520.75304c",
        "name": "llenado de tanque (Andando)",
        "func": "var dato = JSON.parse(msg.payload);\nvar nivMaximo = 480;\ncontext.estadoAnterior = context.estadoAnterior || 0;\ncontext.avisoTanque = context.avisoTanque || 0;\nif (global.get(\"fallasLavadero\") === undefined)global.set(\"fallasLavadero\", 0);\n\nif (msg.topic == \"blynk/marchaBomba\"){\n\t// context.avisoTanque = 0;\n\tif (msg.payload === 1)global.set(\"bombaPozo\", 1);\n\tif (msg.payload === 0)global.set(\"bombaPozo\", 0);\n\tmsg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele1\", payload: global.get(\"bombaPozo\")}; node.send([msg, null]);\t\n}\n\nif (msg.topic == \"blynk/llenarTanque\"){\n\tcontext.avisoTanque = 0;\n    context.estadoAnterior = msg.payload;\n    global.set(\"llenarTanque\", msg.payload);\n    global.set(\"bombaPozo\",  msg.payload);\n    global.set(\"valvulaTanque\", msg.payload);\n    // if (global.get(\"nivTanque\") < nivMaximo - 10)global.set(\"valvulaTanque\", 1);\n    msg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"most\\\",\\\"payload\\\":\" + msg.payload + \"}\"}; node.send(msg);\n    enviarDatos();\n}\n\nif (dato.topic == \"bombaRF\"){\n\tif (global.get(\"bombaPozo\") === 0){global.set(\"bombaPozo\", 1);}else{global.set(\"bombaPozo\", 0);}\n\tmsg = {pin: 2, payload: global.get(\"bombaPozo\")}; node.send([null,msg]);\n\tmsg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele1\", payload: global.get(\"bombaPozo\")}; node.send([msg, null]);\t\t\n\treturn;\n}\n\nif (dato.topic === \"google/Tanque\") enviarDatos();\n\nif (dato.topic === \"Nivel\"){\n\tglobal.set(\"nivTanque\", parseInt(dato.payload));\n\tmsg = {topic: \"nivel\", payload: global.get(\"nivTanque\") + \"mm\"}; node.send([msg, null]);\n\tmsg = {topic: \"Actualizacion/Baterias\", payload:\"\"}; node.send([msg, null]);\n\tactualizarEstado();}\n\nif (dato.topic === \"Niveles\"){\n\tmsg = {topic: \"nivMinimo\", payload: dato.nivMinimo};\n\tnode.send([msg, null]);\n\tmsg = {topic: \"nivMaximo\", payload: dato.nivMaximo};\n\tnode.send([msg, null]);\n\tmsg = {topic: \"nivel\", payload: dato.nivel}; global.set(\"nivTanque\", parseInt(dato.nivel)); \n\tnode.send([msg, null]);\n\tmsg = {topic: \"altTanque\", payload: dato.altTanque};\n\tnode.send([msg, null]);\n\tmsg = {topic: \"crepuscular\", payload: dato.crepuscular};\n\tnode.send([msg, null]);\n\tactualizarEstado();\n}\t\n\nif (msg.topic === \"configNano\"){\n\tvar item = msg.payload.split(\" \");\n\tif (item[0] === \"altTanque\")msg.payload = \"{\\\"topic\\\":\\\"altTanque\\\",\\\"payload\\\":\" + item[1] + \"\\\"}\";\n\tif (item[0] === \"minTanque\")msg.payload = \"{\\\"topic\\\":\\\"minTanque\\\",\\\"payload\\\":\" + item[1] + \"\\\"}\";\t\n\tif (item[0] === \"maxTanque\")msg.payload = \"{\\\"topic\\\":\\\"maxTanque\\\",\\\"payload\\\":\" + item[1] + \"\\\"}\";\t\n\tmsg = {topic: \"USBout\", payload: msg.payload}; node.send(msg);}\n\n// if (global.get(\"llenarTanque\") === 1 && global.get(\"nivTanque\") >= nivMaximo)\t{\n// \tglobal.set(\"llenarTanque\", 0);\n// \tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"most\\\",\\\"payload\\\":0}\"}; node.send(msg);\n//     context.estadoAnterior = 0;\n//     global.set(\"bombaPozo\", 0);\n//     global.set(\"valvulaTanque\", 0);\n//     enviarDatos();\t\n// }\n\nif (global.get(\"nivTanque\") >= nivMaximo && context.avisoTanque === 0){\n\tglobal.set(\"bombaPozo\", 0);\n\tglobal.set(\"valvulaTanque\", 0);\n\tglobal.set(\"llenarTanque\", 0);\n    msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele1\", payload: global.get(\"bombaPozo\")}; node.send(msg);\n    msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele0\", payload: global.get(\"valvulaTanque\")}; node.send(msg);\n    msg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"most\\\",\\\"payload\\\":0}\"}; node.send(msg);\n\tmsg = {topic: \"notifyBlynk\", payload:\"tanque lleno\"}; node.send(msg);\n\tmsg = {pin: 34, payload: global.get(\"llenarTanque\")}; node.send([null,msg]);\n\tmsg = {pin: 2, payload: global.get(\"bombaPozo\")}; node.send([null,msg]);\n\tcontext.avisoTanque = 1;}\n\nif (dato.topic === \"LlenarTanque\"){global.set(\"llenarTanque\", parseInt(dato.payload));}\n\nif (global.get(\"llenarTanque\") === 1 && context.estadoAnterior === 0){\n\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"most\\\",\\\"payload\\\":1}\"}; node.send(msg);\n    context.estadoAnterior = 1;\n    global.set(\"bombaPozo\", 1);\n    if (global.get(\"nivTanque\") < nivMaximo - 10){\tcontext.avisoTanque = 0; global.set(\"valvulaTanque\", 1);}\n    enviarDatos();\n    }\nif (global.get(\"llenarTanque\") === 0 && context.estadoAnterior === 1){\n\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"most\\\",\\\"payload\\\":0}\"}; node.send(msg);\n    context.estadoAnterior = 0;\n    global.set(\"bombaPozo\", 0);\n    global.set(\"valvulaTanque\", 0);\n    context.avisoTanque = 0;\n    enviarDatos();\n    }    \nnode.status({text: \"Bomba: \" + global.get(\"bombaPozo\") + \"  Valvula: \" + global.get(\"valvulaTanque\") + \" - \" + global.get(\"nivTanque\") + \" - \" + global.get(\"llenarTanque\") + \" - \" + context.estadoAnterior});\nif (msg.topic == \"Pedido/Lavadero/Bombas\") {\n\tvar fallasLavadero = global.get(\"fallasLavadero\") + 1;\n\tglobal.set(\"fallasLavadero\", fallasLavadero);\n\tenviarDatos();\n}\n\nfunction enviarDatos(){\n\t// context.avisoTanque = 0;\n\tmsg = {pin: 2, payload: global.get(\"bombaPozo\")}; node.send([null,msg]);\n    msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele1\", payload: global.get(\"bombaPozo\")}; node.send(msg);\n    msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele0\", payload: global.get(\"valvulaTanque\")}; node.send(msg);    \n}\n\nfunction actualizarEstado(){\n\tif (global.get(\"estadoToldo\") !== \"Abriendo\" && global.get(\"estadoToldo\") !== \"Cerrando\"){\n\t\tmsg = {topic: \"Blynk/actualizar/estado\", payload: \"\"};\n\t\tnode.send(msg);}\t\n}\n",
        "outputs": 2,
        "noerr": 0,
        "x": 620,
        "y": 320,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "9f837dbe.a7563",
        "type": "function",
        "z": "73083520.75304c",
        "name": "llenado de tanque",
        "func": "context.nivelAnterior = context.nivelAnterior || 0;\ncontext.estadoAnterior = context.estadoAnterior || 0;\n\ncontext.nivelArranco = context.nivelArranco ||0;\ncontext.tiempoArrancoLLenado =context.tiempoArrancoLLenado ||0;\n// context.avisoTanque = context.avisoTanque || 0;\ncontext.llenadoAnulado = context.llenadoAnulado || 0;\ncontext.tiempoLlenado = context.tiempoLlenado || 0;\ncontext.tiempoRestante = context.tiempoRestante || 0; // 0 == por nivel\ncontext.nivelInicioLlenado = context.nivelInicioLlenado || 0;\ncontext.tiempoInicioLlenado = context.tiempoInicioLlenado || 0;\nif (global.get(\"llenarTanque\") === undefined)global.set(\"llenarTanque\", 0);\nif (global.get(\"bombaPozo\") === undefined || global.get(\"bombaPozo\") == isNaN)global.set(\"bombaPozo\", 0);\n\n    context.errorLlenadoAuto = context.errorLlenadoAuto || 0;\n  if (global.get(\"tiempoInicioLlenado\") === undefined)global.set(\"tiempoInicioLlenado\", 0);\n  // if (global.get(\"llenarTanque\") === undefined)global.set(\"llenarTanque\", 0);\n\n  var date = new Date();\n  // var dato = JSON.parse(msg.payload);\n  var topic = msg.topic;\n  var pin = parseInt(msg.pin);\n  var nivMaximo = 400;\n  var nivMinimo = 250;\n  var timerLuces = 12000;\n  var tasaLlenado = 0;\n\n  if (global.get(\"dateRiegoFrente\") === undefined)global.set(\"dateRiegoFrente\", 0);\n  if (global.get(\"dateRiegoPatio\") === undefined)global.set(\"dateRiegoPatio\", 0);\n  if (global.get(\"fallasLavadero\") === undefined)global.set(\"fallasLavadero\", 0);\n  if (global.get(\"luzLavadero\") === undefined)global.set(\"luzLavadero\", 0);\n  if (global.get(\"luzAlacenaLavadero\") === undefined)global.set(\"luzAlacenaLavadero\", 0);\n  if (global.get(\"bombaPozo\") === undefined)global.set(\"bombaPozo\", 0);\n  if (global.get(\"valvulaTanque\") === undefined)global.set(\"valvulaTanque\", 0);\n  if (global.get(\"riegoFrente\") === undefined)global.set(\"riegoFrente\", 0);\n  if (global.get(\"estadoEspTanque\") === undefined)global.set(\"estadoEspTanque\", 1);\n  if (global.get(\"tasaLlenadoTanque\") === undefined)global.set(\"tasaLlenadoTanque\", 0);\n\nglobal.set(\"minimoTanque\", 180);\nglobal.set(\"maximoTanque\", 370);\n  if (global.get(\"alturaTanque\") === undefined)global.set(\"alturaTanque\", 680);\n\n  // node.status({text: global.get(\"estadoAlarma\") + \" -- \"  + global.get(\"luzLavadero\")});\n\n  if (topic == \"blynk/marchaBomba\")pin = 2;\n  if (topic == \"blynk/llenarTanque\")pin = 34;\n\n  if (topic == \"aviso/Alarma\"){\n    if (global.get(\"estadoAlarma\") === 1)apagadoLuces();\n  }\n\n  // if (topic == \"google/Alarma\" || topic == \"aviso/Alarma\"){\n  //   if (global.get(\"luzAlacenaLavadero\") === 1 || global.get(\"luzLavadero\") === 1){\n  //     node.status({text: global.get(\"estadoAlarma\") + \" -ppp- \"  + global.get(\"luzLavadero\")});\n  //     if (global.get(\"estadoAlarma\") === 1 && global.get(\"Dia\") === 0){setTimeout(apagadoLuces, timerLuces);}\n  //     if (global.get(\"estadoAlarma\") === 1 && global.get(\"Dia\") === 1)apagadoLuces();\n  //   }\n  // } \n\n  if (topic == \"google/Lavadero\" || topic == \"crepMQTT\"){\n    enviarBlynk();\n    enviarDatos();\n  }   \n\n  if (parseInt(global.get(\"tipoRiego\")) === 1){\n    if (parseInt(global.get(\"modoRiegoFrente\")) === 1){\n        var valor = (parseInt(global.get(\"dateRiegoFrente\")) + parseInt(global.get(\"tiempoRiegoFrente\")) * 1000 * 60);\n        if (parseInt(date.getTime()) > parseInt(valor)){\n        if (parseInt(global.get(\"modoRiegoPatio\")) === 1){\n            global.set(\"tipoRiego\", 2);\n            valor  = parseInt(date.getTime());\n            global.set(\"dateRiegoPatio\", valor);   \n            dato = global.get(\"hsCpu\") + \" - riego Patio Auto SI\" + '\\n';\n            msg = {topic: \"terminalBlynk\", payload: dato}; node.send([msg, null, null]);          \n        }\n        if (parseInt(global.get(\"modoRiegoPatio\")) === 0)global.set(\"tipoRiego\", 0);\n    \tdato = global.get(\"hsCpu\") + \" - riego Frente Auto NO\" + '\\n';\n    \tmsg = {topic: \"terminalBlynk\", payload: dato}; node.send([msg, null, null]);        \n        valor = \"riego\" + global.get(\"tipoRiego\"); \n        msg = {topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([msg, null]);\n        }\n    }\n    }\n      if (parseInt(global.get(\"modoRiegoFrente\")) === 0 && parseInt(global.get(\"tipoRiego\")) === 1){\n        global.set(\"tipoRiego\", 2);\n        valor  = parseInt(date.getTime());\n        global.set(\"dateRiegoPatio\", valor);\n    }\n\n  if (parseInt(global.get(\"modoRiegoPatio\")) === 1){\n      if (parseInt(global.get(\"tipoRiego\")) === 2){\n        var valor = (parseInt(global.get(\"dateRiegoPatio\")) + parseInt(global.get(\"tiempoRiegoPatio\")) * 1000 * 60);\n        if (parseInt(date.getTime()) > parseInt(valor)){\n            global.set(\"tipoRiego\", 0);\n            valor = \"riego\" + global.get(\"tipoRiego\");     \n            msg = {topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([msg, null]);\n            dato = global.get(\"hsCpu\") + \" - riego Patio Auto NO\" + '\\n';\n            msg = {topic: \"terminalBlynk\", payload: dato}; node.send([msg, null, null]);              \n        }\n      }\n    }\n    if (parseInt(global.get(\"modoRiegoFrente\")) === 0 && parseInt(global.get(\"modoRiegoPatio\")) === 0 && parseInt(global.get(\"tipoRiego\")) !== 0){\n        global.set(\"tipoRiego\", 0); \n        dato = global.get(\"hsCpu\") + \" - riego frente Auto NO\" + '\\n';\n        msg = {topic: \"terminalBlynk\", payload: dato}; node.send([msg, null, null]);  \n        }        \n    if (parseInt(global.get(\"modoRiegoPatio\")) === 0 && parseInt(global.get(\"tipoRiego\")) === 2)global.set(\"tipoRiego\", 0);\n\n  if (topic == \"ESP/Lavadero/riego\"){\n        valor = \"riego\" + global.get(\"tipoRiego\");     \n        msg = {topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([msg, null]); \n        dato = global.get(\"hsCpu\") + \" - riego desde blynk: \" + global.get(\"tipoRiego\") + '\\n';\n        msg = {topic: \"terminalBlynk\", payload: dato}; node.send([msg, null, null]);         \n        return;\n  }\n\n  if (topic == \"ESP/Lavadero/Envio\"){\n    if (msg.payload === \"\")return;\n    if (msg.payload.substring(0, 13) == \"bloqueoTeclasSI\"){msg = {pin: 74, payload: 1}; node.send([null, msg]); return;}\n    if (msg.payload.substring(0, 13) == \"bloqueoTeclasNO\"){msg = {pin: 74, payload: 0}; node.send([null, msg]); return;}\n    // if (msg.substring(0, 6) == \"Buzzer\") msg = msg.substring(6);\n\n    if (msg.payload.substring(0, 6) == \"$riego\"){\n        var valor = msg.payload.substring(6);\n        if (parseInt(valor) === 0){\n            global.set(\"tipoRiego\", 0);\n            valor = \"riego\" + global.get(\"tipoRiego\");\n            msg = {delay: 300, topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([null, null, msg]);\n        }\n        if (parseInt(valor) === 1){\n            if (parseInt(global.get(\"modoRiegoFrente\")) === 1){\n                global.set(\"tipoRiego\", 1);\n                valor  = parseInt(date.getTime());\n                global.set(\"dateRiegoFrente\", valor);\n                valor = \"riego\" + global.get(\"tipoRiego\");\n                msg = {delay: 300, topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([null, null, msg]);\n                dato = global.get(\"hsCpu\") + \" - riego frente Man SI\" + '\\n';\n                msg = {topic: \"terminalBlynk\", payload: dato}; node.send([msg, null, null]);                \n            }\n            if (parseInt(global.get(\"modoRiegoFrente\")) === 0)global.set(\"tipoRiego\", 2);\n        }\n        if (parseInt(valor) === 2){\n            if (parseInt(global.get(\"modoRiegoPatio\")) === 1){\n                global.set(\"tipoRiego\", 2);\n                valor  = parseInt(date.getTime());\n                global.set(\"dateRiegoPatio\", valor);  \n                valor = \"riego\" + global.get(\"tipoRiego\");\n                msg = {delay: 300, topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([null, null, msg]);\n                dato = global.get(\"hsCpu\") + \" - riego patio Man SI\" + '\\n';\n                msg = {topic: \"terminalBlynk\", payload: dato}; node.send([msg, null, null]);                \n                }              \n            if (parseInt(global.get(\"modoRiegoPatio\")) === 0)global.set(\"tipoRiego\", 0); \n        }\n    }\n\n    var dato = msg.payload.substring(1);\n    // msg.payload = dato; return msg;\n    dato = msg.payload.split(\"#\");\n    global.set(\"bombaPozo\", parseInt(dato[0])); \n    global.set(\"riegoFrente\", parseInt(dato[1])); \n    global.set(\"luzLavadero\", parseInt(dato[2])); \n    global.set(\"luzAlacenaLavadero\", parseInt(dato[3])); \n\n    // node.status({text: global.get(\"riegoFrente\")});\n\n    // if (parseInt(global.get(\"riegoFrente\")) === 1){\n    //     global.set(\"bombaPozo\", 1);\n    //     global.set(\"riegoFrente\", 1);\n    //     enviarBlynk();\n    //     enviarDatos(); \n    // }\n    // if (parseInt(global.get(\"riegoFrente\")) === 0){\n    //     global.set(\"bombaPozo\", 0);\n    //     global.set(\"riegoFrente\", 0);\n    //     enviarBlynk();\n    //     enviarDatos(); \n    // }    \n  //   if (global.get(\"luzLavadero\") === 0)global.set(\"luzAlacenaLavadero\", 0); \n    enviarBlynk();\n    return;\n  }\n\n  if (topic == \"ESP/TanqueAgua/Desconectado\"){\n    var restante = parseInt(nivMaximo) - parseInt(global.get(\"nivTanque\"));\n    var tiempoRestante = (parseInt(restante) * 209) / 104;\n    context.tiempoRestante = parseInt(tiempoRestante * 1000);\n    global.set(\"estadoEspTanque\", 0);// 0 = Desconectado\n    return;\n  }  \n\n  if (topic == \"ESP/TanqueAgua/Inicio\"){\n    global.set(\"estadoEspTanque\", 1);\n    var datos = \"config\" + global.get(\"minimoTanque\") + \"#\" + global.get(\"maximoTanque\") + \"#\" + global.get(\"alturaTanque\");\n    msg = {topic: \"ESP/TanqueAgua/Recibo\", payload: datos}; node.send([msg, null]);\n    // enviarDatos();    \n    return;\n  }   \n\n  // if (global.get(\"estadoEspTanque\") === 0 && global.get(\"llenarTanque\") === 1 && date.getTime() > parseInt(context.tiempoRestante)){\n  //   global.set(\"llenarTanque\", 0); global.set(\"bombaPozo\", 0);  global.set(\"valvulaTanque\", 0); \n  //   msg = {topic: \"notifyBlynk\", payload:\"tanque lleno por tiempo\"}; node.send(msg);\n  //   enviarBlynk(); \n  //   enviarDatos();  \n  // }\n\n  // if (dato.topic == \"bombaRF\"){\n  //   if (global.get(\"bombaPozo\") === 0){global.set(\"bombaPozo\", 1);}else{global.set(\"bombaPozo\", 0);}\n  //   enviarBlynk(); \n  //   enviarDatos(); //return;\n  // }\n\n  if (parseInt(global.get(\"llenarTanque\")) === 1 && parseInt(date.getTime()) > parseInt(context.tiempoLlenado)){\n    context.tiempoLlenado = date.getTime() + 60000;\n    msg = {topic: \"ESP/TanqueAgua/Recibo\", payload: \" \"}; node.send([msg, null]); \n    return;\n  }\n\n  // sube el nivel a razon de 104mm cada 209\"     42mm en 91\"\nif (topic == \"ESP/TanqueAgua/Envio\"){\n    global.set(\"nivTanque\", parseInt(msg.payload));\n\n     if (parseInt(global.get(\"nivTanque\")) < 50){\n        // msg = {topic: \"notifyBlynk\", payload: global.get(\"fechaCompleta\") + \" Tanque con poca agua, nivel: \" + global.get(\"nivTanque\") + \"\\n\"}; node.send([msg, null]);\n     }\n\n    if (parseInt(global.get(\"llenarTanque\")) === 1){\n        var tiempoLlenando = parseInt(global.get(\"tiempoInicioLlenado\")) + 1200000;\n        if(parseInt(date.getTime()) > parseInt(tiempoLlenando)){\n            context.errorLlenadoAuto = 1;\n            global.set(\"llenarTanque\", 0);\n            global.set(\"bombaPozo\",  0);\n            global.set(\"valvulaTanque\", 0);        \n            msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" Error llenando tanque\\n\"}; node.send([msg, null]);        \n            msg = {topic: \"notifyBlynk\", payload: global.get(\"fechaCompleta\") + \" Error llenando tanque\\n\"}; node.send([msg, null]);\n            enviarBlynk(); \n            msg.topic = \"ESP/Lavadero/Inicio\";\n            enviarDatos(); \n        }\n    } \n\n    if (parseInt(global.get(\"nivTanque\")) < parseInt(global.get(\"minimoTanque\")) && global.get(\"llenarTanque\") === 0 && context.llenadoAnulado === 0 && context.errorLlenadoAuto === 0){\n        if(parseInt(global.get(\"nivTanque\")) === 0)return;\n        msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" Inicio llenando tanque\\n\"}; node.send([msg, null]);\n        global.set(\"tiempoInicioLlenado\", date.getTime());\n        context.nivelInicioLlenado = parseInt(global.get(\"nivTanque\"));\n        context.tiempoInicioLlenado = date.getTime();  \n        node.status({text: \"nivelInicio: \" + context.nivelInicioLlenado + \"  tiempoInicio: \" + context.tiempoInicioLlenado});\n        context.tiempoLlenado = date.getTime() + 60000;\n        context.estadoAnterior = 1;\n        global.set(\"llenarTanque\", 1);\n        // global.set(\"bombaPozo\",  1);\n        global.set(\"valvulaTanque\", 1);\n        //   msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" Inicio AUTO llenado tanque, \" + context.nivelInicioLlenado + \"mm\\n\"}; node.send([msg, null]);\n        msg = {topic: \"ESP/Lavadero/Recibo\", payload: \"llenando1\"}; node.send([msg, null]);\n        msg = {topic: \"informarNivel\", payload: 1}; node.send([msg, null]);\n        enviarBlynk(); \n        msg.topic = \"ESP/Lavadero/Inicio\";\n        enviarDatos();\n        return;    \n    }\n    \n    if (parseInt(global.get(\"nivTanque\")) >= parseInt(global.get(\"maximoTanque\")) && parseInt(global.get(\"llenarTanque\")) === 1){// && parseInt(global.get(\"estadoEspTanque\")) === 1){ //&& context.avisoTanque === 0 && global.get(\"estadoEspTanque\") === 1){\n        var var1 = global.get(\"nivTanque\");\n        tasaLlenado = (date.getTime() - parseInt(context.tiempoInicioLlenado)) / 60000;\n        tasaLlenado = parseFloat((var1 - context.nivelInicioLlenado) / tasaLlenado).toFixed(2);\n        global.set(\"tasaLlenadoTanque\", tasaLlenado);        \n        global.set(\"llenarTanque\", 0); global.set(\"bombaPozo\", 0);  global.set(\"valvulaTanque\", 0); \n        var ponele3 = parseInt(global.get(\"nivTanque\")) - context.nivelInicioLlenado;\n        node.status({text: \"FIN Auto nivelInicio: \" + ponele3 + \"  TiempoLlenado: \" + parseFloat(global.get(\"tasaLlenadoTanque\")).toFixed(2)});\n        // msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" Paro AUTO Llenado tanque, \" + var1 + \"mm\\n\"}; node.send([msg, null]);\n        // msg = {topic: \"notifyBlynk\", payload:\"tanque lleno por nivel\"}; node.send(msg);\n        var tasa = parseInt(date.getTime()) - parseInt(context.tiempoArrancoLLenado);\n        tasa = parseInt(tasa) / 60000;\n        var tasa2 = parseInt(global.get(\"nivTanque\")) - parseInt(context.nivelArranco);\n        tasa = parseFloat(tasa2) / tasa;\n        tasa = parseFloat(tasa).toFixed(1);\n\n        var diferencia = parseInt(global.get(\"nivTanque\")) - parseInt(context.nivelArranco);\n        var tiempoLL = parseInt(date.getTime()) - parseInt(context.tiempoArrancoLLenado);\n        mensaje = tiempoLL / 1000;\n        var minutosLL = parseInt(parseInt(mensaje)/60);\n        var segundosLL = parseInt(((parseInt(mensaje)/60) - minutosLL)*60);\n        if (parseInt(minutosLL) < 10) minutosLL = \"0\" + minutosLL;\n        if (parseInt(segundosLL) < 10) segundosLL = \"0\" + segundosLL;\n        minutosLL = minutosLL + \":\" + segundosLL;        \n\n        var mensaje = global.get(\"hsCpu\") + \" - Termino llenado tanque, tasa: \" + tasa + \"mm/min, diferencia nivel: \" + diferencia + \"mm, tiempo llenando: \" + minutosLL + \"\\n\"        \n\n        msg = {topic: \"notifyBlynk\", payload: mensaje}; node.send([msg, null]);\n        msg = {topic: \"terminalBlynk\", payload: mensaje}; node.send([msg, null]);\n        msg = {topic: \"informarNivel\", payload: 1}; node.send([msg, null]);\n        topicNuevo = \"ESP/Lavadero/Inicio\";\n        enviarBlynk(); \n        msg.topic = \"ESP/Lavadero/Inicio\";\n        enviarDatos();\n        return;\n    }  \n\n    if (global.get(\"nivTanque\") != context.nivelAnterior){\n      context.nivelAnterior = global.get(\"nivTanque\");\n        if (parseInt(global.get(\"llenarTanque\")) === 1){// parseInt(global.get(\"nivTanque\")) < parseInt(nivMaximo)){\n          var var1 = global.get(\"nivTanque\");\n          tasaLlenado = (date.getTime() - parseInt(context.tiempoInicioLlenado)) / 60000;\n          tasaLlenado = parseFloat((var1 - context.nivelInicioLlenado) / tasaLlenado).toFixed(2);\n          context.nivelInicioLlenado = parseInt(global.get(\"nivTanque\"));\n          context.tiempoInicioLlenado = date.getTime();\n          global.set(\"tasaLlenadoTanque\", tasaLlenado);      \n          msg = {topic: \"informarNivel\", payload: 1}; node.send([msg, null]);\n          msg = {topic: \"Blynk/actualizar/estado\", payload: 1}; node.send([msg, null]);\n      }\n    }  \n\n} \n\n  if (topic == \"ESP/Lavadero/Inicio\") {\n    enviarDatos(); \n\tvalor = \"riego\" + global.get(\"tipoRiego\");\n\tmsg = {delay: 2000, topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([null, null, msg]);    \n    return;\n  }\n\n  switch (pin){\n    case 2:\n    global.set(\"bombaPozo\", parseInt(msg.payload));\n      enviarDatos(); //return;\n      break;\n\n    case 200:\n        // global.set(\"bombaPozo\", parseInt(msg.payload));\n        // global.set(\"riegoFrente\", parseInt(msg.payload));\n        if (parseInt(msg.payload) === 1){\n            if (parseInt(global.get(\"modoRiegoFrente\")) === 1){\n                global.set(\"tipoRiego\", 1);\n                valor  = parseInt(date.getTime());\n                global.set(\"dateRiegoFrente\", valor);\n                valor = \"riego\" + global.get(\"tipoRiego\");\n                msg = {delay: 300, topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([null, null, msg]);\n                dato = global.get(\"hsCpu\") + \" - riego frente auto SI\" + '\\n';\n                msg = {topic: \"terminalBlynk\", payload: dato}; node.send([msg, null, null]);\n            }\n            if (parseInt(global.get(\"modoRiegoFrente\")) === 0){\n                if (parseInt(global.get(\"modoRiegoPatio\")) === 1){\n                    global.set(\"tipoRiego\", 2);\n                    valor  = parseInt(date.getTime());\n                    global.set(\"dateRiegoPatio\", valor);  \n                    valor = \"riego\" + global.get(\"tipoRiego\");\n                    msg = {delay: 300, topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([null, null, msg]);\n                    dato = global.get(\"hsCpu\") + \" - riego patio auto SI\" + '\\n';\n                    msg = {topic: \"terminalBlynk\", payload: dato}; node.send([msg, null, null]);\n                    }              \n                if (parseInt(global.get(\"modoRiegoPatio\")) === 0)global.set(\"tipoRiego\", 0); \n            }\n        }\n\n\n        // if (parseInt(msg.payload) === 1){\n        //     if (parseInt(global.get(\"modoRiegoFrente\")) === 1){\n        //         global.set(\"tipoRiego\", 1);\n        //         valor  = parseInt(date.getTime());\n        //         global.set(\"dateRiegoFrente\", valor);\n        //         valor = \"riego\" + global.get(\"tipoRiego\");\n        //         msg = {topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([null, null, msg]);\n        //     }\n        //     if (parseInt(global.get(\"modoRiegoFrente\")) === 0){\n        //         if (parseInt(global.set(\"modoRiegoPatio\")) === 1){\n        //             global.set(\"tipoRiego\", 2);\n        //             valor  = parseInt(date.getTime());\n        //             global.set(\"dateRiegoPatio\", valor);  \n        //             valor = \"riego\" + global.get(\"tipoRiego\");\n        //             msg = {topic: \"ESP/Lavadero/Recibo\", payload: valor}; node.send([null, null, msg]);\n        //             }\n        //             }              \n        //         if (parseInt(global.get(\"modoRiegoPatio\")) === 0)global.set(\"tipoRiego\", 0); \n        // }\n        // enviarBlynk();\n        // enviarDatos(); //return;      \n      break;      \n\n    case 34:\n      context.errorLlenadoAuto = 0;\n      context.estadoAnterior = msg.payload;\n      global.set(\"llenarTanque\", parseInt(msg.payload));\n      global.set(\"bombaPozo\",  parseInt(msg.payload));\n      global.set(\"valvulaTanque\",parseInt( msg.payload));\n      context.tiempoLlenado = date.getTime() + 60000;\n      if (parseInt(msg.payload) === 0) {\n        var var1 = global.get(\"nivTanque\");\n        tasaLlenado = (date.getTime() - context.tiempoInicioLlenado) / 60000;        \n        parseFloat((var1 - context.nivelInicioLlenado) / tasaLlenado).toFixed(2);\n        var ponele = var1 - context.nivelInicioLlenado;\n        global.set(\"tasaLlenadoTanque\", tasaLlenado);\n        // msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" Paro MANUAL Llenado tanque, \" + var1 + \"mm\\n\"}; node.send([msg, null]);\n        var tasa = parseInt(date.getTime()) - parseInt(context.tiempoArrancoLLenado);\n        tasa = parseInt(tasa) / 60000;\n        var tasa2 = parseInt(global.get(\"nivTanque\")) - parseInt(context.nivelArranco);\n        tasa = parseFloat(tasa2) / tasa;\n        tasa = parseFloat(tasa).toFixed(1);\n\n        var diferencia = parseInt(global.get(\"nivTanque\")) - parseInt(context.nivelArranco);\n        var tiempoLL = parseInt(date.getTime()) - parseInt(context.tiempoArrancoLLenado);\n\t\tmensaje = tiempoLL / 1000;\n\t\tvar minutosLL = parseInt(parseInt(mensaje)/60);\n\t\tvar segundosLL = parseInt(((parseInt(mensaje)/60) - minutosLL)*60);\n\t\tif (parseInt(minutosLL) < 10) minutosLL = \"0\" + minutosLL;\n\t\tif (parseInt(segundosLL) < 10) segundosLL = \"0\" + segundosLL;\n\t\tminutosLL = minutosLL + \":\" + segundosLL;       \n\n        var mensaje = global.get(\"hsCpu\") + \" - Termino llenado tanque, tasa: \" + tasa + \"mm/min, diferencia nivel: \" + diferencia + \"mm, tiempo llenando: \" + minutosLL + \"\\n\"\n        msg = {topic: \"notifyBlynk\", payload: mensaje}; node.send([msg, null]);\n        msg = {topic: \"terminalBlynk\", payload: mensaje}; node.send([msg, null]);      \n        msg = {topic: \"informarNivel\", payload: 1}; node.send([msg, null]);\n        node.status({text: \"FIN Man nivelInicio: \" + ponele + \"  TiempoLlenado: \" + parseFloat(global.get(\"tasaLlenadoTanque\")).toFixed(2)});\n        context.llenadoAnulado = 1;\n      }\n      if (parseInt(msg.payload) === 1) {\n        global.set(\"tiempoInicioLlenado\", date.getTime());\n        context.nivelInicioLlenado = parseInt(global.get(\"nivTanque\"));\n        context.tiempoInicioLlenado = date.getTime();\n        context.nivelArranco = global.get(\"nivTanque\");\n        context.tiempoArrancoLLenado = date.getTime();\n        // msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" Inicio MANUAL llenado tanque, \" + context.nivelInicioLlenado + \"mm\\n\"}; node.send([msg, null]);\n        msg = {topic: \"informarNivel\", payload: 1}; node.send([msg, null]);\n        msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" - Inicio llenado tanque\\n\"}; node.send([msg, null]);\n        node.status({text: \"nivelInicio: \" + context.nivelInicioLlenado + \"  tiempoInicio: \" + context.tiempoInicioLlenado});\n        context.llenadoAnulado = 0;\n        }\n      enviarBlynk();\n      enviarDatos(); //return;\n      break;  \n\n    case 35:\n      // if (parseInt(msg.payload) === 1) global.set(\"luzLavadero\", 0);\n      // if (parseInt(msg.payload) === 0) global.set(\"luzLavadero\", 1);\n      global.set(\"luzLavadero\", parseInt(msg.payload));\n      node.status({text: global.get(\"estadoAlarma\") + \" -fff- \"  + global.get(\"luzLavadero\")});\n      enviarDatos(); //return;\n      break;\n\n    case 36:\n      global.set(\"luzAlacenaLavadero\", parseInt(msg.payload));\n      node.status({text: global.get(\"estadoAlarma\") + \" -ggg- \"  + global.get(\"luzAlacenaLavadero\")});\n      enviarDatos(); //return;\n      break;\n\n    case 37:\n      global.set(\"PresurizadoraFria\", parseInt(msg.payload));\n      msg = {topic: \"ESP/Lavadero/Presurizadora\", payload: global.get(\"PresurizadoraFria\")}; node.send([msg, null]);\n      return;\n      break;   \n\n    case 38:\n      global.set(\"valvulaTanque\", parseInt(msg.payload));\n      enviarDatos(); //return;\n      break;                  \n  }\n\n  function enviarBlynk(){\n    msg = {pin: 2, payload: global.get(\"bombaPozo\")}; node.send([null, msg]);\n    msg = {pin: 34, payload: global.get(\"llenarTanque\")}; node.send([null, msg]);\n    msg = {pin: 35, payload: global.get(\"luzLavadero\")}; node.send([null, msg]);\n    msg = {pin: 36, payload: global.get(\"luzAlacenaLavadero\")}; node.send([null, msg]);\n    msg = {pin: 37, payload: global.get(\"riegoFrente\")}; node.send([null, msg]);\n    msg = {pin: 38, payload: global.get(\"valvulaTanque\")}; node.send([null, msg]);\n  }\n\n  function enviarDatos(){//return;\n    var topicNuevo = msg.topic;\n    msg = global.get(\"bombaPozo\") + \"#\";\n    msg += global.get(\"valvulaTanque\") + \"#\";\n    msg += global.get(\"riegoFrente\") + \"#\";\n    msg += global.get(\"luzLavadero\") + \"#\";\n    msg += global.get(\"luzAlacenaLavadero\") + \"#\";\n    msg += \"3#\";\n    // msg += global.get(\"1\") + \"1#\";\n    msg += global.get(\"pwmMinLed\") + \"#\";\n    msg += global.get(\"Dia\");\n    if (topicNuevo == \"crepMQTT\" || topicNuevo == \"ESP/Lavadero/Inicio\" || topicNuevo == \"aviso/Alarma\")msg += \"#\";\n    msg = {topic: \"ESP/Lavadero/Recibo\", payload: msg}; node.send([msg, null]);\n\n\n    // if (global.get(\"valvulaTanque\") === 1) {context.avisoTanque = 0;}\n    // msg = {pin: 2, payload: global.get(\"bombaPozo\")}; node.send([null,msg]);\n    // msg = {pin: 34, payload: global.get(\"llenarTanque\")}; node.send([null,msg]);\n    // msg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"most\\\",\\\"payload\\\":\" + msg.payload + \"}\"}; node.send(msg);\n    // msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele1\", payload: global.get(\"bombaPozo\")}; node.send(msg);\n    // msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele0\", payload: global.get(\"valvulaTanque\")}; node.send(msg);    \n    // node.status({text: \"Bomba: \" + global.get(\"bombaPozo\") + \"  Valvula: \" + global.get(\"valvulaTanque\") + \" - \" + global.get(\"nivTanque\") + \" - \" + global.get(\"llenarTanque\") + \" - \" + context.estadoAnterior});\n  }\n\n  function apagadoLuces(){\n      node.status({text: \"apagado auto\"});\n      global.set(\"luzLavadero\", 0);\n      global.set(\"luzAlacenaLavadero\", 0);\n      enviarBlynk();\n      enviarDatos();\n  }\n\n",
        "outputs": 3,
        "noerr": 0,
        "x": 606,
        "y": 420,
        "wires": [
            [
                "a8f7ee92.20b99",
                "b5883d54.09f77",
                "b42dab48.e96e78"
            ],
            [
                "f77a9f41.1fd82",
                "70fe7124.dd7c",
                "a8f7ee92.20b99"
            ],
            [
                "a783c06c.dd8ac"
            ]
        ]
    },
    {
        "id": "b76455bf.83a1d8",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "Pedido/Lavadero/Bombas",
        "payload": "1",
        "payloadType": "num",
        "x": 300,
        "y": 670,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "5919cee4.a4cba",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 620,
        "y": 510,
        "wires": [
            [
                "71ce9b48.3ad114"
            ]
        ]
    },
    {
        "id": "677f3912.9e2b88",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "pulso",
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 370,
        "y": 710,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "45c8def8.16a37",
        "type": "function",
        "z": "73083520.75304c",
        "name": "llenado de tanque",
        "func": "var dato = JSON.parse(msg.payload);\nif (global.get(\"bombaPozo\") === undefined)global.set(\"bombaPozo\", 0);\nif (global.get(\"valvulaTanque\") === undefined)global.set(\"valvulaTanque\", 0);\n\nvar nivMaximo = 420;\ncontext.estadoAnterior = context.estadoAnterior || 0;\ncontext.avisoTanque = context.avisoTanque || 0;\nif (global.get(\"fallasLavadero\") === undefined)global.set(\"fallasLavadero\", 0);\n\n\nif (msg.topic === \"google/Tanque\") enviarDatos();\n\nif (msg.topic == \"blynk/marchaBomba\"){\n\tif (msg.payload === 1)global.set(\"bombaPozo\", 1);\n\tif (msg.payload === 0)global.set(\"bombaPozo\", 0);\n\tenviarDatos(); //return;\n}\n\nif (msg.topic == \"blynk/llenarTanque\"){\n\tcontext.avisoTanque = 0;\n    context.estadoAnterior = msg.payload;\n    global.set(\"llenarTanque\", msg.payload);\n    global.set(\"bombaPozo\",  msg.payload);\n    global.set(\"valvulaTanque\", msg.payload);\n    enviarDatos(); //return;\n}\n\nif (dato.topic == \"bombaRF\"){\n\tif (global.get(\"bombaPozo\") === 0){global.set(\"bombaPozo\", 1);}else{global.set(\"bombaPozo\", 0);}\n\tenviarDatos(); //return;\n}\n\nif (dato.topic === \"Nivel\"){\n\tglobal.set(\"nivTanque\", parseFloat(dato.payload).toFixed(2));\n\tmsg = {topic: \"nivel\", payload: global.get(\"nivTanque\") + \"mm\"}; node.send([msg, null]);\n\tmsg = {topic: \"Actualizacion/Baterias\", payload:\"\"}; node.send([msg, null]);\n\tactualizarEstado();}\n\nif (dato.topic === \"Niveles\"){\n\tmsg = {topic: \"nivMinimo\", payload: dato.nivMinimo};\n\tnode.send([msg, null]);\n\tmsg = {topic: \"nivMaximo\", payload: dato.nivMaximo};\n\tnode.send([msg, null]);\n\tmsg = {topic: \"nivel\", payload: dato.nivel}; global.set(\"nivTanque\", parseInt(dato.nivel)); \n\tnode.send([msg, null]);\n\tmsg = {topic: \"altTanque\", payload: dato.altTanque};\n\tnode.send([msg, null]);\n\tmsg = {topic: \"crepuscular\", payload: dato.crepuscular};\n\tnode.send([msg, null]);\n\tactualizarEstado();\n}\t\n\nif (msg.topic === \"configNano\"){\n\tvar item = msg.payload.split(\" \");\n\tif (item[0] === \"altTanque\")msg.payload = \"{\\\"topic\\\":\\\"altTanque\\\",\\\"payload\\\":\" + item[1] + \"\\\"}\";\n\tif (item[0] === \"minTanque\")msg.payload = \"{\\\"topic\\\":\\\"minTanque\\\",\\\"payload\\\":\" + item[1] + \"\\\"}\";\t\n\tif (item[0] === \"maxTanque\")msg.payload = \"{\\\"topic\\\":\\\"maxTanque\\\",\\\"payload\\\":\" + item[1] + \"\\\"}\";\t\n\tmsg = {topic: \"USBout\", payload: msg.payload}; node.send(msg); return;}\n\nif (global.get(\"nivTanque\") >= nivMaximo && context.avisoTanque === 0){\n\tcontext.avisoTanque = 1;\n\tglobal.set(\"llenarTanque\", 0); global.set(\"bombaPozo\", 0);\tglobal.set(\"valvulaTanque\", 0);\t\n\tmsg = {topic: \"notifyBlynk\", payload:\"tanque lleno\"}; node.send(msg);\n\tenviarDatos();//return;\n} \n\nif (dato.topic === \"LlenarTanque\"){\n\tvar valor = parseInt(dato.payload);\n\tmsg = {topic: \"USBout\", payload: \"llenadoOK\"}; node.send([msg, null]);\n\tglobal.set(\"llenarTanque\", valor); global.set(\"bombaPozo\", valor);\tglobal.set(\"valvulaTanque\", valor);\n\tenviarDatos(); //return;\n}\n\nif (msg.topic === \"Pedido/Lavadero/Bombas\") {\n\tvar fallasLavadero = global.get(\"fallasLavadero\") + 1;\n\tglobal.set(\"fallasLavadero\", fallasLavadero); \n\tglobal.set(\"tipoFallaLav\", msg.payload); msg = {topic: \"fallas_MQTT\", payload: 1}; node.send([msg, null]);\n\tenviarDatos(); //return;\n}\n\nfunction enviarDatos(){\n\tif (global.get(\"valvulaTanque\") === 1) {context.avisoTanque = 0;}\n\tmsg = {pin: 2, payload: global.get(\"bombaPozo\")}; node.send([null,msg]);\n\tmsg = {pin: 34, payload: global.get(\"llenarTanque\")}; node.send([null,msg]);\n\tmsg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"most\\\",\\\"payload\\\":\" + msg.payload + \"}\"}; node.send(msg);\n    msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele1\", payload: global.get(\"bombaPozo\")}; node.send(msg);\n    msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele0\", payload: global.get(\"valvulaTanque\")}; node.send(msg);    \n    node.status({text: \"Bomba: \" + global.get(\"bombaPozo\") + \"  Valvula: \" + global.get(\"valvulaTanque\") + \" - \" + global.get(\"nivTanque\") + \" - \" + global.get(\"llenarTanque\") + \" - \" + context.estadoAnterior});\n}\n\nfunction actualizarEstado(){\n\tnode.status({text: \"Bomba: \" + global.get(\"bombaPozo\") + \"  Valvula: \" + global.get(\"valvulaTanque\") + \" - \" + global.get(\"nivTanque\") + \" - \" + global.get(\"llenarTanque\") + \" - \" + context.estadoAnterior});\n\tif (global.get(\"estadoToldo\") !== \"Abriendo\" && global.get(\"estadoToldo\") !== \"Cerrando\"){\n\t\tmsg = {topic: \"Blynk/actualizar/estado\", payload: \"\"};\n\t\tnode.send(msg);}\t\n}\n",
        "outputs": 2,
        "noerr": 0,
        "x": 630,
        "y": 280,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "7512e54b.bfa1fc",
        "type": "delay",
        "z": "73083520.75304c",
        "name": "",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 350,
        "y": 430,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "9774c645.8766a8",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "crepMQTT",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 170,
        "y": 430,
        "wires": [
            [
                "7512e54b.bfa1fc"
            ]
        ]
    },
    {
        "id": "75adfb30.21a464",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/Envio",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 330,
        "y": 590,
        "wires": [
            [
                "9f837dbe.a7563",
                "632a7529.a4550c",
                "c01e5ae4.cbad98"
            ]
        ]
    },
    {
        "id": "70fe7124.dd7c",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 950,
        "y": 420,
        "wires": []
    },
    {
        "id": "80e3f8f1.4dad58",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "google/Lavadero",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 340,
        "y": 550,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "ad875658.859188",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "if (msg.topic == \"Lavadero\")global.set(\"luzLavadero\", parseInt(msg.payload));\nif (msg.topic == \"alacenaLavadero\")global.set(\"luzAlacenaLavadero\", parseInt(msg.payload));\nif (msg.topic == \"llenarTanque\"){\n    global.set(\"llenarTanque\", parseInt(msg.payload));\n    global.set(\"bombaPozo\",  parseInt(msg.payload));\n    global.set(\"valvulaTanque\", parseInt(msg.payload));\n}\nif (msg.topic == \"bombaPozo\")global.set(\"bombaPozo\", parseInt(msg.payload));\nif (msg.topic == \"bombaPileta\")global.set(\"bombaPileta\", parseInt(msg.payload));\n\n\n    msg = {topic: \"google/Lavadero\", payload: 1}; node.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 1570,
        "y": 190,
        "wires": [
            [
                "8239a05e.054ae"
            ]
        ]
    },
    {
        "id": "8239a05e.054ae",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1720,
        "y": 170,
        "wires": []
    },
    {
        "id": "add12358.51f9b",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "aviso/Alarma",
        "qos": "2",
        "broker": "6b36e4a.1d30b1c",
        "x": 160,
        "y": 470,
        "wires": [
            [
                "21e34a48.0149b6"
            ]
        ]
    },
    {
        "id": "85d6e558.9b9838",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Envio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 580,
        "y": 570,
        "wires": [
            [
                "f6970a67.481d98",
                "9bd9b334.20d32"
            ]
        ]
    },
    {
        "id": "beab172d.9adee8",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 892.8571243286133,
        "y": 672.8571586608887,
        "wires": []
    },
    {
        "id": "77654698.b9eda8",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 642.8571243286133,
        "y": 632.8571586608887,
        "wires": [
            [
                "beab172d.9adee8"
            ]
        ]
    },
    {
        "id": "ccfae20a.9cb3a",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "recibo del tanque agua",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 1090,
        "y": 570,
        "wires": []
    },
    {
        "id": "4484dc6e.9206c4",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Debug",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 605.714277267456,
        "y": 778.5714244842529,
        "wires": [
            [
                "b6688191.06f9a",
                "2fad1afa.9276c6"
            ]
        ]
    },
    {
        "id": "b6688191.06f9a",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "debug Tanque agua",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 865.714277267456,
        "y": 798.5714244842529,
        "wires": []
    },
    {
        "id": "70129ec.d31966",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "var dato = \"niv: \" + global.get(\"nivTanque\") + \" - tasaLlen.: \" + global.get(\"tasaLlenadoTanque\") + \" - \" + global.get(\"hsCpu\");\nnode.status({text: dato});\n\nmsg = {topic: \"terminalBlynk\", payload: dato + \"\\n\"};\nnode.send(msg);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 920,
        "y": 570,
        "wires": [
            [
                "ccfae20a.9cb3a"
            ]
        ]
    },
    {
        "id": "ae251a3e.ebb0c8",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "debug1",
        "payloadType": "str",
        "x": 652.8571243286133,
        "y": 712.8571586608887,
        "wires": [
            [
                "beab172d.9adee8"
            ]
        ]
    },
    {
        "id": "fd6938a8.9d5648",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "debug0",
        "payloadType": "str",
        "x": 652.8571243286133,
        "y": 672.8571586608887,
        "wires": [
            [
                "beab172d.9adee8"
            ]
        ]
    },
    {
        "id": "2fad1afa.9276c6",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "// msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" -- \" + msg.payload + \"\\n\"};\n// if (msg.payload.includes(\"bomba\") )return msg;\nmsg = {payload: global.get(\"hsCpu\") + \" -- \" + msg.payload + \"\\n\"};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 815.714277267456,
        "y": 758.5714244842529,
        "wires": [
            [
                "eaa52870.d82168",
                "d44ec8ab.d055d8"
            ]
        ]
    },
    {
        "id": "eaa52870.d82168",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "debug Tanque agua",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 985.714277267456,
        "y": 758.5714244842529,
        "wires": []
    },
    {
        "id": "f6970a67.481d98",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 790,
        "y": 610,
        "wires": []
    },
    {
        "id": "4666f8b5.634208",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Envio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 271.1111297607422,
        "y": 633.3333511352539,
        "wires": [
            [
                "7dd27b8b.b63394",
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "560595ce.92794c",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Desconectado",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 290,
        "y": 350,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "b42dab48.e96e78",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 978,
        "y": 314,
        "wires": []
    },
    {
        "id": "b2c9e4a2.108c48",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 320,
        "y": 390,
        "wires": [
            [
                "9f837dbe.a7563",
                "86079719.eb54b8"
            ]
        ]
    },
    {
        "id": "6a7af8d9.d2edd8",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/Recibo",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 850,
        "y": 720,
        "wires": [
            [
                "8a69bea6.2b337"
            ]
        ]
    },
    {
        "id": "8a69bea6.2b337",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1040,
        "y": 720,
        "wires": []
    },
    {
        "id": "a8f7ee92.20b99",
        "type": "link out",
        "z": "73083520.75304c",
        "name": "MQTT_Lavadero",
        "links": [
            "dc99082e.eee2a8"
        ],
        "x": 1045,
        "y": 390,
        "wires": []
    },
    {
        "id": "630b3e83.c7f46",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "msg.payload = parseInt(global.get(\"luzLavadero\")); node.send([msg, null]);\nmsg.payload = parseInt(global.get(\"luzAlacenaLavadero\")); node.send([null, msg]);\nmsg.payload = parseInt(global.get(\"llenarTanque\")); node.send([null, null, msg]);\nmsg.payload = parseInt(global.get(\"bombaPozo\")); node.send([null, null, null, msg]);\nmsg.payload = parseInt(global.get(\"bombaPileta\")); node.send([null, null, null, null, msg]);\n",
        "outputs": 5,
        "noerr": 0,
        "x": 1200,
        "y": 210,
        "wires": [
            [
                "17d6214.c6c9bdf"
            ],
            [
                "84176557.cef1e8"
            ],
            [
                "1dc88260.6fd34e"
            ],
            [
                "d7c0da49.673d58"
            ],
            [
                "6f669d4b.6dda34"
            ]
        ]
    },
    {
        "id": "dc99082e.eee2a8",
        "type": "link in",
        "z": "73083520.75304c",
        "name": "",
        "links": [
            "a8f7ee92.20b99"
        ],
        "x": 965,
        "y": 210,
        "wires": [
            [
                "3b799030.6ff18"
            ]
        ]
    },
    {
        "id": "17ab055f.02911b",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "pedidoTemp",
        "payloadType": "str",
        "x": 570,
        "y": 240,
        "wires": [
            [
                "d575a75b.9a90a8"
            ]
        ]
    },
    {
        "id": "d575a75b.9a90a8",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 770,
        "y": 240,
        "wires": []
    },
    {
        "id": "6ecc3d58.b72fc4",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "debug1",
        "payloadType": "str",
        "x": 550,
        "y": 160,
        "wires": [
            [
                "d575a75b.9a90a8"
            ]
        ]
    },
    {
        "id": "99658c46.1f317",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "debug0",
        "payloadType": "str",
        "x": 550,
        "y": 200,
        "wires": [
            [
                "d575a75b.9a90a8"
            ]
        ]
    },
    {
        "id": "632a7529.a4550c",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 568,
        "y": 612,
        "wires": []
    },
    {
        "id": "aeaa2ce9.06eb4",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 715,
        "y": 386,
        "wires": []
    },
    {
        "id": "b5bc542b.d356e8",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/Envio",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 1280,
        "y": 430,
        "wires": [
            []
        ]
    },
    {
        "id": "cb96a5a1.360ad8",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" -- \" + msg.payload + \"\\n\"};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1490,
        "y": 430,
        "wires": [
            [
                "bf8dec2d.405cb"
            ]
        ]
    },
    {
        "id": "6264e839.39e838",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1670,
        "y": 430,
        "wires": []
    },
    {
        "id": "bf8dec2d.405cb",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1620,
        "y": 490,
        "wires": []
    },
    {
        "id": "7ebbf747.267f18",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1280,
        "y": 480,
        "wires": [
            [
                "cb96a5a1.360ad8"
            ]
        ]
    },
    {
        "id": "f5b01669.172ae8",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Envio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1280,
        "y": 380,
        "wires": [
            [
                "395f36a7.91527a"
            ]
        ]
    },
    {
        "id": "43cfb392.445e4c",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Debug",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1290,
        "y": 520,
        "wires": [
            [
                "cb96a5a1.360ad8"
            ]
        ]
    },
    {
        "id": "550047c7.aa71d8",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1177,
        "y": 935,
        "wires": []
    },
    {
        "id": "4aabd0b9.7db36",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "debug0",
        "payloadType": "str",
        "x": 927,
        "y": 895,
        "wires": [
            [
                "550047c7.aa71d8"
            ]
        ]
    },
    {
        "id": "24849a77.3980f6",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "debug1",
        "payloadType": "str",
        "x": 927,
        "y": 935,
        "wires": [
            [
                "550047c7.aa71d8"
            ]
        ]
    },
    {
        "id": "897b77cf.1e98b8",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "nivel",
        "payloadType": "str",
        "x": 927,
        "y": 975,
        "wires": [
            [
                "550047c7.aa71d8"
            ]
        ]
    },
    {
        "id": "3b799030.6ff18",
        "type": "delay",
        "z": "73083520.75304c",
        "name": "",
        "pauseType": "delay",
        "timeout": "20",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1070,
        "y": 210,
        "wires": [
            [
                "630b3e83.c7f46"
            ]
        ]
    },
    {
        "id": "9fc07a03.3e0248",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1260,
        "y": 710,
        "wires": [
            [
                "91aa366a.957238"
            ]
        ]
    },
    {
        "id": "91aa366a.957238",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "node.status({text: global.get(\"estadoEspTanque\")})",
        "outputs": 1,
        "noerr": 0,
        "x": 1430,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "55b57916.538338",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "msg.payload = \"bloqueoTeclas\" + msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 540,
        "y": 900,
        "wires": [
            [
                "9b9a8302.2cfbf"
            ]
        ]
    },
    {
        "id": "9b9a8302.2cfbf",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 740,
        "y": 910,
        "wires": []
    },
    {
        "id": "74f71376.3c258c",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 700,
        "y": 1010,
        "wires": []
    },
    {
        "id": "76f0f733.c330d8",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/Debug",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 440,
        "y": 1000,
        "wires": [
            [
                "74f71376.3c258c",
                "b91a37ca.9d35c8"
            ]
        ]
    },
    {
        "id": "9bd9b334.20d32",
        "type": "delay",
        "z": "73083520.75304c",
        "name": "",
        "pauseType": "delay",
        "timeout": "500",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 780,
        "y": 570,
        "wires": [
            [
                "70129ec.d31966"
            ]
        ]
    },
    {
        "id": "99ab6ee9.6b0d4",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/AguaCaliente",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 1650,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "21e34a48.0149b6",
        "type": "delay",
        "z": "73083520.75304c",
        "name": "",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 350,
        "y": 470,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "7dd27b8b.b63394",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 538.8888778686523,
        "y": 701.111120223999,
        "wires": []
    },
    {
        "id": "b91a37ca.9d35c8",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "// if (msg.payload.includes (\"pwmDucha\") || msg.payload.includes (\"LuzBano\")){\n    msg = {topic: \"terminalBlynk\", payload: msg.payload + \"\\n\"};\n    return msg;\n// }",
        "outputs": 1,
        "noerr": 0,
        "x": 640,
        "y": 1060,
        "wires": [
            []
        ]
    },
    {
        "id": "5ff9c137.03e4b",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 770,
        "y": 1060,
        "wires": []
    },
    {
        "id": "e7d25c02.7be0d",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 300,
        "y": 850,
        "wires": [
            [
                "a4147a38.db61c8"
            ]
        ]
    },
    {
        "id": "a4147a38.db61c8",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 580,
        "y": 850,
        "wires": []
    },
    {
        "id": "f6321491.61e598",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/TermoSolar/Debug",
        "qos": "2",
        "broker": "900627dc.76e6a8",
        "x": 1130,
        "y": 70,
        "wires": [
            [
                "b657b0f0.50ad6",
                "7e2f87a5.298818"
            ]
        ]
    },
    {
        "id": "b8d4156f.274c28",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "",
        "broker": "900627dc.76e6a8",
        "x": 1026,
        "y": 194,
        "wires": []
    },
    {
        "id": "e6471751.5c1cc8",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "val. in. termo",
        "func": "var dato = msg.payload.split(\"#\");\nglobal.set(\"autoBomba\", dato[0]);\nglobal.set(\"autoResistencia\", dato[1]);\nglobal.set(\"autoToldo\", dato[2]);\nglobal.set(\"pedBomba\", dato[3]);\nglobal.set(\"pedResistencia\", dato[4]);\nglobal.set(\"pedToldo\", dato[5]);\nglobal.set(\"tempMaximaTermo\", dato[6]);\nglobal.set(\"tempMaxResistencia\", dato[7]);\nglobal.set(\"tempMaxResistenciaManual\", dato[8]);\nglobal.set(\"tempMinimaResistencia\", dato[9]);\n// global.set(\"valorDia\", dato[10]);\n// global.set(\"valorNoche\", dato[11]);\n// global.set(\"segundosMarchaBomba\", dato[12]);\n// global.set(\"offsetDia\", dato[13]);\n// global.set(\"offsetNoche\", dato[14]);\n\nglobal.set(\"estBomba\", 0);\nglobal.set(\"estResistencia\", 0);\nglobal.set(\"estToldo\", 0);\nglobal.set(\"tempTermoFin\", 0);\nglobal.set(\"tempExteriorFin\", 0);\nglobal.set(\"sensorCrep\", 0);\nglobal.set(\"comienzoLlenado\", 0);\nglobal.set(\"tiempoLlenado\", 0);\nmsg = {topic: \"ESP/TermoSolar/pedido\", payload: 1}; node.send(msg);//ESP/TermoSolar/Recibo\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1750,
        "y": 600,
        "wires": [
            [
                "58ccdacc.e6a2d4"
            ]
        ]
    },
    {
        "id": "938efd9a.a812a",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/TermoSolar/Envio",
        "qos": "2",
        "broker": "900627dc.76e6a8",
        "x": 210,
        "y": 260,
        "wires": [
            [
                "e78455a.6986ca8",
                "e05432b5.73a34",
                "8d279b21.01ad38"
            ]
        ]
    },
    {
        "id": "54bd2c43.953b64",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/TermoSolar/Inicio",
        "qos": "2",
        "broker": "900627dc.76e6a8",
        "x": 346,
        "y": 146,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "cfbdcbb4.4ab528",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "4",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1340,
        "y": 580,
        "wires": [
            [
                "6b0b04ae.498c7c",
                "347ec7b.6595338"
            ]
        ]
    },
    {
        "id": "ab21644b.e84768",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "    // Sal1  thingspeak\n    // Sal2  mqtt\n    // Sal3  blynk\n    // Sal4  mysql\n    //global.get(\"tempMinExt\")\n\n    context.llenandoTermo = context.llenandoTermo || 0;\n    context.encendidoResistencia = context.encendidoResistencia || 0;\n    context.estAnteriorResistencia = context.estAnteriorResistencia || 0;\n    context.tiempoInicioResistencia = context.tiempoInicioResistencia || 0;\n    context.manualPorAlarma = context.manualPorAlarma || 0;\n    context.tiempo = context.tiempo || 0;\n\n    var topic = msg.topic;\n    var payload = msg.payload;\n    var comienzoLlenado;\n    var terminoLlenado;\n    var valorDia = global.get(\"valorDia\");\n    var valorNoche = global.get(\"valorNoche\");\n    var pin = parseInt(msg.pin);\n    var date = new Date();\n    var tiempo = 0\n\n    if (topic == \"timer\"){\n       if (parseFloat(global.get(\"tempMinExt\")) < 2){tiempo = 12;}else{tiempo = 9;}\n       if (parseInt(global.get(\"mes\")) !== parseInt(global.get(\"mesAnt\"))){\n            global.set(\"mesAnt\", global.get(\"mes\"));\n            global.set(\"tiempoEncResis\", 0);\n            global.set(\"potenciaResistencia\", 0);\n       }\n       if (parseInt(global.get(\"hh\")) === parseInt(tiempo) && parseInt(global.get(\"mm\")) === 0 && parseInt(global.get(\"autoBomba\")) === 0){\n          context.manualPorAlarma = 1; context.tiempo = date.getTime() + 120000; \n          msg = {pin: 127, payload: global.get(\"hsCpu\") + \", paso a AUTO bomba termo por hora (9:00 \\n\"}; node.send([null, null, msg]);\n          if (parseInt(global.get(\"nivTanque\")) > 150){global.set(\"autoBomba\", 1); }\n          // msg = {pin: 102, payload: global.get(\"autoBomba\")}; node.send([null, null, msg, null]);\n            msg = {pin: 127, payload: global.get(\"hsCpu\") + \" -- Apago bomb termo\" + \"\\n\"};\n            node.send([null, null, msg]);\n          enviarBlynk();\n          enviarMQTT();\n       }\n    }\n\n    // PONGO BOMBA EN AUTO UNA VEZ QUE SE APAGO Y PASARON 2' DESDE QUE SE APAGO PRESURIZADORA\n    if (date.getTime() > context.tiempo && parseInt(context.manualPorAlarma) === 1 && parseInt(global.get(\"estBomba\")) === 0){\n    //   msg = {pin: 127, payload: global.get(\"hsCpu\") + \", paso a MANUAL bomba termo por activarse alarma casa o apagarse bomba agua caliente\\n\"}; node.send([null, null, msg]);\n      context.manualPorAlarma = 0;\n      // global.set(\"autoBomba\", 0);   \n      enviarBlynk();\n      enviarMQTT();\n    }\n\n    if (topic == \"ESP/Lavadero/AguaCaliente\"){\n      if (msg.payload.substring(0, 19) == \"BombaAguaCalienteSI\" && parseInt(global.get(\"nivTanque\")) > 100){\n        context.manualPorAlarma = 0; \n        global.set(\"autoBomba\", 1);\n        context.manualPorAlarma = 1; \n        context.tiempo = date.getTime() + 1800000;\n        msg = {pin: 127, payload: global.get(\"hsCpu\") + \" -- prend bomb termo\" + \"\\n\"};\n        node.send([null, null, msg]);\n    \n      // if (msg.payload.substring(0, 19) == \"BombaAguaCalienteNO\"){context.manualPorAlarma = 1; context.tiempo = date.getTime() + 120000; return;}\n\t\tpayload = global.get(\"autoBomba\");\n\t\tpayload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; \n\t\tpayload += global.get(\"tempMaximaTermo\") + \"#\";\n\t\tpayload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n\t\tmsg.payload = payload;  \n\t\tmsg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([null, null, null, msg]); \n\n        payload = \"0#1#\";\n        payload += global.get(\"pedResistencia\") + \"#\"; \n        payload += global.get(\"tempMaximaTermo\") + \"#\";\n        payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n        msg.payload = payload;  \n        msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([null, msg, null]);\n\n      enviarBlynk();\n      return; \n      }  \n    }\n\n    if (topic == \"aviso/Alarma\" && parseInt(global.get(\"estadoAlarma\") === 0 && parseInt(global.get(\"nivTanque\")) > 150) === 0 && parseInt(global.get(\"hh\")) > 6){\n      global.set(\"autoBomba\", 1);   \n      context.manualPorAlarma = 1; context.tiempo = date.getTime() + 120000; \n    //   context.manualPorAlarma = 1;  context.tiempo = date.getTime() + 120000;\n    //   if (parseInt(global.get(\"estadoAlarma\")) === 1) return;\n    //   if (parseInt(global.get(\"estadoAlarma\")) === 0 && parseInt(global.get(\"hh\")) > 6){\n    //     msg = {pin: 127, payload: global.get(\"hsCpu\") + \", paso a AUTO bomba termo por desactivarse alarma casa \\n\"}; node.send([null, null, msg]);\n    //     global.set(\"autoBomba\", 1);       a\n      enviarBlynk();\n      enviarMQTT();\n    //   }\n    } \n\n    switch (pin){\n      case 101:\n        if (parseInt(payload) === 0){\n          context.manualPorAlarma = 1; context.tiempo = date.getTime() + 3600000;\n          global.set(\"pedBomba\", 0); }\n         // if(parseInt(global.get(\"nivTanque\") > 150))\n        global.set(\"autoBomba\", parseInt(payload)); \n        enviarBlynk();\n        enviarMQTT();\n      break;\n\n      case 102:\n        if (parseInt(global.get(\"autoBomba\")) === 0){\n          global.set(\"pedBomba\", payload); \n          enviarMQTT();\n        }\n      break;\n\n      case 103:\n        if (parseInt(payload) === 0){global.set(\"pedResistencia\", 0);}\n        global.set(\"autoResistencia\", payload); \n        controlResistencia();   \n        enviarBlynk();\n        enviarMQTT();\n      break;\n      case 104:\n        if (parseInt(global.get(\"autoResistencia\")) === 0){\n            global.set(\"pedResistencia\", payload); \n            controlResistencia();\n            enviarBlynk();\n            enviarMQTT();}\n      break;\n    }\n\n    if (topic == \"ESP/TermoSolar/controlResistencia\"){\n        controlResistencia();\n        enviarBlynk();\n        enviarMQTT(); \n        return;\n        }\n\n    if (topic == \"ESP/TermoSolar/Envio\"){\n      //0#0#0#15.55#25.55#1020\n        var dato = payload.split(\"#\");\n        global.set(\"estBomba\", parseInt(dato[0])); \n        global.set(\"estResistencia\", parseInt(dato[1])); \n        // global.set(\"estToldo\", parseInt(dato[2]));  \n        if (parseInt(dato[2]) !== 0) global.set(\"tempTermoFin\", parseFloat(dato[2]).toFixed(1)); \n        if (parseInt(dato[3]) !== 0)global.set(\"tempExterior\", parseFloat(dato[3]).toFixed(1)); \n        global.set(\"sensorCrep\", parseInt(dato[4])); \n\n      msg= {topic: \"temperaturaTermo\", payload: global.get(\"tempTermoFin\")}; node.send([msg, null, null]);\n      msg= {topic: \"crepuscular\", payload: global.get(\"sensorCrep\")}; node.send([msg, null, null]);\n      msg= {topic: \"temperaturaExterior\", payload: global.get(\"tempExterior\")}; node.send([msg, null, null]);\n      // msg= {topic: \"tempPileta\", payload: global.get(\"tempPiletaRed\")}; node.send([msg, null, null]); \n      msg= {topic: \"horasDia\", payload: global.get(\"horasDia\")}; node.send([msg, null, null]); \n\n    controlResistencia();\n    enviarBlynk();\n    enviarMQTT(); \n\n     //  if(parseInt(global.get(\"autoResistencia\")) === 1 && parseInt(global.get(\"tempTermoFin\"))  < parseInt(global.get(\"tempMinimaResistenciaAuto\")) && parseInt(global.get(\"pedResistencia\")) === 0){\n     //         global.set(\"pedResistencia\", 1);\n     //         controlResistencia();\n        //  enviarBlynk();\n        //  enviarMQTT();   \n     //  }\n\n     //  if (parseInt(global.get(\"tempTermoFin\"))  > parseInt(global.get(\"tempMaxResistenciaAuto\")) && parseInt(global.get(\"pedResistencia\")) == 1){\n     //     global.set(\"pedResistencia\", 0);\n     //     controlResistencia();\n        // enviarBlynk();\n        // enviarMQTT();\n        // // return;\n        // }\n        // enviarBlynk();\n    }\n      \n\n    if (topic == \"ESP/TermoSolar/EstadoBomba\"){\n      if (payload.substring(0, 11) == \"bombaMarcha\"){\n        global.set(\"estBomba\", parseInt(payload.substring(11)));\n        if (global.get(\"autoBomba\") === 1){estadoBomba = \"Automatico\";}else{estadoBomba = \"Manual\";}\n        msg = {pin: 102, label: estadoBomba, payload: global.get(\"estBomba\")}; node.send([null, null, msg]);\n        controlBomba();\n      }\n    }\n\n    // var status = new Date().getTime() - global.get(\"comienzoLlenado\")\n    // node.status({text: global.get(\"estBomba\") + \" -- \" + status}) ; \n\n    // PARADA BOMBA POR ERROR DE MARCHA\n    if (global.get(\"estBomba\") === 1 && new Date().getTime() - global.get(\"comienzoLlenado\") > 240000){\n      // msg = {topic: \"notifyBlynk\", payload: global.get(\"fechaCompleta\") + \" - ERROR bomba termo paso a manual\"}; node.send([null, msg, null]);\n      // msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" - ERROR bomba termo paso a manual\"}; node.send([null, msg, null]);\n      // global.set(\"autoBomba\", 0);\n      global.set(\"pedBomba\", 0);\n      enviarBlynk();\n      enviarMQTT();\n    }\n\n    if (topic == \"ESP/TermoSolar/Inicio\"){\n        var fallasLivingIluminacion = global.get(\"fallasLivingIluminacion\") + 1;\n        global.set(\"fallasLivingIluminacion\", fallasLivingIluminacion);\n        global.set(\"tipoFallaIlLiving\", msg.payload); \n        enviarMQTT();\n    }\n\n    if (topic == \"crepMQTT\"){\n        if (parseInt(global.get(\"Dia\")) === 0 && parseInt(global.get(\"pedResistencia\")) === 0 && parseInt(global.get(\"tempTermoFin\")) > 45 && parseInt(global.get(\"tempTermoFin\")) <  parseInt(global.get(\"tempMaxResistenciaAuto\"))){\n        global.set(\"pedResistencia\", 1);\n        controlResistencia();\n        enviarBlynk();\n        enviarMQTT();\n        }\n    }\n\n    function controlResistencia(){\n\n      if(parseInt(global.get(\"habilitacionResistenciaTermo\")) === 0){\n        global.set(\"pedResistencia\", 0);\n     //     enviarBlynk();\n        // enviarMQTT();\n        return;\n      }\n      if(parseInt(global.get(\"autoResistencia\")) === 1 && parseInt(global.get(\"tempTermoFin\"))  < parseInt(global.get(\"tempMinimaResistenciaAuto\")) && parseInt(global.get(\"pedResistencia\")) === 0){\n            global.set(\"pedResistencia\", 1);\n        }\n\n      if (parseInt(global.get(\"tempTermoFin\"))  > parseInt(global.get(\"tempMaxResistenciaAuto\")) && parseInt(global.get(\"pedResistencia\")) == 1){\n        global.set(\"pedResistencia\", 0);\n        }\n\n\n      if(parseInt(global.get(\"pedResistencia\")) === 1 && parseInt(context.estAnteriorResistencia) === 0){\n          context.estAnteriorResistencia = 1;\n          context.tiempoInicioResistencia = new Date().getTime();//}\n          msg = {topic: \"borrar\", payload: context.tiempoInicioResistencia}; node.send([null, msg, null]);\n      }\n\n      if (parseInt(global.get(\"pedResistencia\")) === 0 && parseInt(context.estAnteriorResistencia) === 1){// && context.encendidoResistencia === 1){            \n          context.estAnteriorResistencia = 0;\n          var tiempo = (new Date().getTime() - parseInt(context.tiempoInicioResistencia)) / 3600000;\n          \n          // tiempo = parseFloat(tiempo);\n          var potencia = (1.9 * parseFloat(tiempo)).toFixed(5);\n\n          potencia = parseFloat(potencia) + parseFloat(global.get(\"potenciaResistencia\"));\n          // tiempo = parseFloat(tiempo) + parseFloat(global.get(\"tiempoEncResis\", tiempo));   \n\n          // global.set(\"tiempoEncResis\", tiempo);\n          global.set(\"potenciaResistencia\", parseFloat(potencia).toFixed(2));\n\n          msg= {topic: \"potenciaResistencia\", payload: global.get(\"potenciaResistencia\")}; node.send([msg, null, null]); \n          msg = {pin: 105, payload: global.get(\"tiempoLlenado\") + \" - \" + global.get(\"potenciaResistencia\")}; node.send([null, null, msg]);\n        }       \n    }\n\n\n    function controlBomba(){\n      msg = {topic: \"estBomba\", payload: global.get(\"estBomba\")}; node.send([msg, null, null]);\n      if (parseInt(global.get(\"estBomba\")) === 1 && parseInt(context.llenandoTermo) === 0){\n        context.llenandoTermo = 1;\n        global.set(\"comienzoLlenado\", new Date().getTime());}\n      if (parseInt(global.get(\"estBomba\")) === 0 && parseInt(context.llenandoTermo) === 1){\n        context.llenandoTermo = 0;\n        var tiempo = parseInt(new Date().getTime()) - parseInt(global.get(\"comienzoLlenado\"));\n        tiempo = parseFloat(tiempo / 1000).toFixed(2);\n        global.set(\"tiempoLlenado\", tiempo);\n        msg = {topic: \"tiempoLlenado\", payload: global.get(\"tiempoLlenado\")}; node.send([msg, null, null]);\n        enviarBlynk();\n      } \n    }    \n\n    function enviarBlynk(){\n        msg = {pin: 101, payload: global.get(\"autoBomba\")}; node.send([null, null, msg]);\n        msg = {pin: 102, payload: global.get(\"estBomba\")}; node.send([null, null, msg]);\n        msg = {pin: 104, payload: global.get(\"pedResistencia\")}; node.send([null, null, msg]);\n        msg = {pin: 105, payload: global.get(\"tiempoLlenado\") + \" - \" + global.get(\"potenciaResistencia\")}; node.send([null, null, msg]);\n        msg = {pin: 110, payload: global.get(\"tempTermoFin\") + \" - \" + global.get(\"tempExterior\") + \" - \" + global.get(\"sensorCrep\")}; node.send([null, null, msg]);  \n        msg = {pin: 111, payload: global.get(\"sensorCrep\")}; node.send([null, null, msg]);\n        msg = {pin: 112, payload: global.get(\"tempExterior\")}; node.send([null, null, msg]);\n        msg = {pin: 113, payload: global.get(\"tempTermoFin\")}; node.send([null, null, msg]);\n        // msg = {pin: 114, payload: global.get(\"tiempoLlenado\")}; node.send([null, null, msg]);\n    }\n\n    // function enviarMQTT(){   \n    //     payload = global.get(\"autoBomba\");\n    //     // payload =\"0\";    \n    //     payload += \"#\"; payload += global.get(\"autoResistencia\") + \"#\"; payload += global.get(\"autoToldo\") + \"#\"; \n    //     payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; //payload += global.get(\"pedToldo\") + \"#\"; \n    //     payload += global.get(\"tempMaximaTermo\") + \"#\"; payload += global.get(\"tempMaxResistencia\") + \"#\"; \n    //     payload += global.get(\"tempMaxResistenciaManual\") + \"#\"; payload += global.get(\"tempMinimaResistencia\") + \"#\";\n    //     payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n    //     // payload += \"#\" + global.get(\"offsetDia\")  + \"#\"; payload += global.get(\"offsetNoche\");\n    //     msg.payload = payload;  \n    //     msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([null, msg, null]);\n    // }\n\n    function enviarMQTT(){   \n        payload = global.get(\"autoBomba\");\n        payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; \n        payload += global.get(\"tempMaximaTermo\") + \"#\";\n        payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n        msg.payload = payload;  \n        msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([null, msg, null]);\n    }",
        "outputs": 4,
        "noerr": 0,
        "x": 580,
        "y": 250,
        "wires": [
            [
                "2f25b814.9dc9c8",
                "41555cf2.768874"
            ],
            [
                "8168c2be.1f1e8",
                "b8d4156f.274c28"
            ],
            [
                "f0d50320.3b07c",
                "3ab2d3e0.c8ea8c",
                "aefbe126.ba102"
            ],
            [
                "26d4a422.c99a4c",
                "c5428d42.a2211"
            ]
        ]
    },
    {
        "id": "f0d50320.3b07c",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 770,
        "y": 350,
        "wires": []
    },
    {
        "id": "621c21a8.3a2ba",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "Crepuscular",
        "topic": "ESP/TermoSolar/Crepuscular",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 260,
        "y": 600,
        "wires": [
            [
                "918b4e96.a03c1",
                "62ab658a.106c0c"
            ]
        ]
    },
    {
        "id": "c40e9cad.cbe",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "noche",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/TermoSolar/Crepuscular",
        "payload": "0",
        "payloadType": "str",
        "x": 270,
        "y": 520,
        "wires": [
            [
                "62ab658a.106c0c"
            ]
        ]
    },
    {
        "id": "62ab658a.106c0c",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "var payload = parseInt(msg.payload);\ncontext.inicioDia = context.inicioDia || 0;\nvar date = new Date();\n\nif (payload === 1){// payload == valor analogico dia/noche\n\tcontext.inicioDia = date.getTime();\n\tglobal.set(\"Dia\", payload);\n\tglobal.set(\"hsAmanecer\",  global.get(\"hsCpu\"));\n\tmsg = {topic: \"notifyBlynk\", payload: \"Se hizo de dia \" + global.get(\"hsAmanecer\")}; node.send(msg);\n\tmsg = {topic: \"crepMQTT\", payload: payload}; node.send(msg);\n// \tmsg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" se hizo de dia\\n\"}; node.send(msg);\n\tglobal.set(\"avisoMail\", \" se hizo de dia:  \" + global.get(\"hsAmanecer\"));\n}\nif (payload === 0){\n\tvar finDia = date.getTime() - context.inicioDia;\n\tfinDia = finDia / 1000;\n\tvar hhFinDia = parseFloat(finDia / 3600);\n\tvar mmFinDia = parseInt((finDia - hhFinDia) * 60);\n\tvar horasDia = parseInt(hhFinDia) + \".\" + parseInt(mmFinDia);\n\tglobal.set(\"horasDia\",horasDia);\n\tglobal.set(\"Dia\", payload);\n\tglobal.set(\"hsAnochecer\",  global.get(\"hsCpu\"));\n\tmsg = {topic: \"notifyBlynk\", payload: \"Se hizo de noche \" + global.get(\"hsAnochecer\")}; node.send(msg);\n\tmsg = {topic: \"crepMQTT\", payload: payload}; node.send(msg);\t\n// \tmsg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" se hizo de noche defasaje termo 3hs\\n\"}; node.send(msg);\n\tglobal.set(\"avisoMail\", \" se hizo de noche:  \" + global.get(\"hsAnochecer\"));\n}\nif (global.get(\"Dia\") === 1)node.status({text: \"amanecio: \" + global.get(\"hsAmanecer\")})\n\tif (global.get(\"Dia\") === 0)node.status({text: \"hs Dia: \" + global.get(\"horasDia\")})\n\n// if (global.get(\"Dia\") === 0)node.status({text: \"hs Dia: \" + global.get(\"horasDia\")})\n",
        "outputs": 1,
        "noerr": 0,
        "x": 420,
        "y": 550,
        "wires": [
            [
                "3348a52a.b2afaa",
                "6f9ea193.06795"
            ]
        ]
    },
    {
        "id": "6f9ea193.06795",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 570,
        "y": 490,
        "wires": []
    },
    {
        "id": "3a9f7070.1ac67",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "dia",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/TermoSolar/Crepuscular",
        "payload": "1",
        "payloadType": "str",
        "x": 270,
        "y": 560,
        "wires": [
            [
                "62ab658a.106c0c"
            ]
        ]
    },
    {
        "id": "1bb30aa.73dc7f5",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1010,
        "y": 610,
        "wires": []
    },
    {
        "id": "803cd776.b0d768",
        "type": "e-mail",
        "z": "1b403a13.0ec8c6",
        "server": "smtp.mail.yahoo.com",
        "port": "465",
        "secure": true,
        "tls": false,
        "name": "gdietrich22@yahoo.com.ar",
        "dname": "gd28722563",
        "x": 1010,
        "y": 560,
        "wires": []
    },
    {
        "id": "783330d.01a52d",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "crepMQTT",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 730,
        "y": 550,
        "wires": [
            [
                "eca2840c.d24698",
                "36314470.a4bb7c"
            ]
        ]
    },
    {
        "id": "ed7eb6d5.94a428",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "2",
        "payloadType": "global",
        "x": 740,
        "y": 600,
        "wires": [
            [
                "eca2840c.d24698"
            ]
        ]
    },
    {
        "id": "eca2840c.d24698",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg.payload = \"cambio en sensor crepuscular\" + global.get(\"avisoMail\") + \" valor sensor: \" + global.get(\"sensorCrep\");\nif (parseInt(global.get(\"Dia\")) === 1){\n    msg.payload = msg.payload + \",  Potencia Resistencia termo acumulado mes: \" + global.get(\"potenciaResistencia\") + \" Kw\";\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 870,
        "y": 600,
        "wires": [
            [
                "803cd776.b0d768",
                "1bb30aa.73dc7f5"
            ]
        ]
    },
    {
        "id": "36314470.a4bb7c",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 990,
        "y": 520,
        "wires": []
    },
    {
        "id": "918b4e96.a03c1",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 440,
        "y": 600,
        "wires": []
    },
    {
        "id": "3348a52a.b2afaa",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 550,
        "y": 550,
        "wires": []
    },
    {
        "id": "e78455a.6986ca8",
        "type": "delay",
        "z": "1b403a13.0ec8c6",
        "name": "100mS",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 390,
        "y": 260,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "a2044f3e.c75f5",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "timer",
        "repeat": "24",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "timer",
        "payload": "1",
        "payloadType": "str",
        "x": 399,
        "y": 48,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "7e2f87a5.298818",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg = {pin: 127, payload: global.get(\"hsCpu\") + \" -- \" + msg.payload + \"\\n\"};\n// if (msg.payload.includes(\"bomba\") )return msg;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1370,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "52c5ffa0.bffc3",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "EstadoBomba",
        "topic": "ESP/TermoSolar/EstadoBomba",
        "qos": "2",
        "broker": "900627dc.76e6a8",
        "x": 1160,
        "y": 160,
        "wires": [
            [
                "7e2f87a5.298818",
                "96988fbf.aede9"
            ]
        ]
    },
    {
        "id": "8eee94e.8744668",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "sin debug",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/TermoSolar/Recibo",
        "payload": "debug0",
        "payloadType": "str",
        "x": 1270,
        "y": 210,
        "wires": [
            [
                "a71fc5d.4fddb38"
            ]
        ]
    },
    {
        "id": "2cb220ee.0584",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "con debug",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/TermoSolar/Recibo",
        "payload": "debug1",
        "payloadType": "str",
        "x": 1270,
        "y": 250,
        "wires": [
            [
                "a71fc5d.4fddb38"
            ]
        ]
    },
    {
        "id": "a71fc5d.4fddb38",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1410,
        "y": 230,
        "wires": []
    },
    {
        "id": "2f25b814.9dc9c8",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 844,
        "y": 104,
        "wires": []
    },
    {
        "id": "11f6ca6a.334236",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "pruea timer",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/TermoSolar/Recibo",
        "payload": "prueba30",
        "payloadType": "str",
        "x": 1270,
        "y": 290,
        "wires": [
            [
                "a71fc5d.4fddb38"
            ]
        ]
    },
    {
        "id": "58ccdacc.e6a2d4",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "pedido",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1910,
        "y": 550,
        "wires": []
    },
    {
        "id": "96988fbf.aede9",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 1370,
        "y": 160,
        "wires": []
    },
    {
        "id": "b657b0f0.50ad6",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1360,
        "y": 70,
        "wires": []
    },
    {
        "id": "8b86e157.0815c",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg = {topic: \"ESP/TermoSolar/Recibo\", payload: \"prueba40\"}; node.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 1650,
        "y": 550,
        "wires": [
            [
                "58ccdacc.e6a2d4",
                "bf1e07b9.dc63d8"
            ]
        ]
    },
    {
        "id": "6b0b04ae.498c7c",
        "type": "delay",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1510,
        "y": 550,
        "wires": [
            [
                "8b86e157.0815c",
                "424b25d7.2c62cc"
            ]
        ]
    },
    {
        "id": "5578996c.94a0f8",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/TermoSolar/Config",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1230,
        "y": 650,
        "wires": [
            [
                "c835e0e7.94e71",
                "c031c992.88fc38"
            ]
        ]
    },
    {
        "id": "347ec7b.6595338",
        "type": "file in",
        "z": "1b403a13.0ec8c6",
        "name": "recover datos termo",
        "filename": "/home/pi/BackUpNodeRed/DatosTermo.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 1560,
        "y": 600,
        "wires": [
            [
                "e6471751.5c1cc8",
                "e1724aed.64bca8"
            ]
        ]
    },
    {
        "id": "6756c263.6be20c",
        "type": "file",
        "z": "1b403a13.0ec8c6",
        "name": "back datos termo",
        "filename": "/home/pi/BackUpNodeRed/DatosTermo.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 1580,
        "y": 650,
        "wires": [
            []
        ]
    },
    {
        "id": "48534c2.23cc5b4",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0#0#0#0#0#0#80#55#50#40#650#500#60000",
        "payloadType": "str",
        "x": 1390,
        "y": 690,
        "wires": [
            [
                "6756c263.6be20c"
            ]
        ]
    },
    {
        "id": "bf1e07b9.dc63d8",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1900,
        "y": 500,
        "wires": []
    },
    {
        "id": "c835e0e7.94e71",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1560,
        "y": 690,
        "wires": []
    },
    {
        "id": "66e1d024.2d37e",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "15",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1740,
        "y": 110,
        "wires": [
            []
        ]
    },
    {
        "id": "d47448fc.6209e8",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "if (global.get(\"rociadorToldo\") === undefined)global.set(\"rociadorToldo\", 0);\ncontext.contador = context.contador || 0;\ncontext.manual = context.manual || 0;\nvar topic = msg.topic;\n\nif (parseInt(global.get(\"hh\")) === 0 && context.manual === 1)context.manual = 0;\n\nif (topic == \"reset\"){\n  global.set(\"rociadorToldo\", 0);\n    msg.payload = \"reset\"; node.send([msg, null]);\n    context.manual = 0; return;}\n\nif (parseInt(global.get(\"hh\")) >= 10 && parseInt(global.get(\"hh\")) < 20 && global.get(\"tempExterior\") > 28 && global.get(\"rociadorToldo\") === 0 && context.manual === 0){\n    context.contador = 1;\n    global.set(\"rociadorToldo\", 1);\n    msg = {pin: 99, payload: 1}; node.send([null, msg]);\n    msg = {topic: \"USBout\", payload: \"rociar1\"}; node.send([msg, null]);\n    msg = {topic: \"ESP/Lavadero/Presurizadora\", payload: 1}; node.send([msg, null]);\n}\n\nif (global.get(\"rociadorToldo\") === 1){\n  if (parseInt(global.get(\"hh\")) >= 20 || global.get(\"tempExterior\") < 20){\n      context.contador = 0;\n      global.set(\"rociadorToldo\", 0);\n      msg = {pin: 99, payload: 0}; node.send([null, msg]);\n      msg = {topic: \"USBout\", payload: \"rociar0\"}; node.send([msg, null]);\n      // msg = {topic: \"ESP/Lavadero/Presurizadora\", payload: 0}; node.send([msg, null]);\n  }\n}\n\nif (global.get(\"rociadorToldo\") === 1)context.contador++;\n\nif (context.contador === 240 && global.get(\"rociadorToldo\") === 1){\n    context.contador = 0;\n    msg = {topic: \"USBout\", payload: \"rociar1\"}; node.send([msg, null]);\n    msg = {topic: \"ESP/Lavadero/Presurizadora\", payload: 1}; node.send([msg, null]);\n}\n\nif (context.contador === 4 && global.get(\"rociadorToldo\") === 1){\n    msg = {topic: \"USBout\", payload: \"rociar0\"}; node.send([msg, null]);\n    // msg = {topic: \"ESP/Lavadero/Presurizadora\", payload: 0}; node.send([msg, null]);\n}\n\nif (msg.pin == \"99\"){\n  if (parseInt(msg.payload) === 0)context.manual = 1;\n    global.set(\"rociadorToldo\", parseInt(msg.payload)); msg.payload = global.get(\"rociadorToldo\"); node.send([msg, null]);\n    context.contador = 0;\n    if (global.get(\"rociadorToldo\") === 0) {\n        msg = {topic: \"USBout\", payload: \"rociar0\"}; node.send([msg, null]);\n        // msg = {topic: \"ESP/Lavadero/Presurizadora\", payload: 0}; node.send([msg, null]);\n    }\n    if (global.get(\"rociadorToldo\") === 1)  {\n        msg = {topic: \"USBout\", payload: \"rociar1\"}; node.send([msg, null]);\n        msg = {topic: \"ESP/Lavadero/Presurizadora\", payload: 1}; node.send([msg, null]);\n    }\n}\nnode.status({text: global.get(\"rociadorToldo\") + \" --- \" + context.contador + \"   11\"});\n",
        "outputs": 2,
        "noerr": 0,
        "x": 1920,
        "y": 110,
        "wires": [
            [
                "7e927e56.df184",
                "bc335887.16ed48"
            ],
            [
                "e26cc241.b89f1",
                "826e0b7f.79a788"
            ]
        ]
    },
    {
        "id": "81c8c932.e335b8",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1890,
        "y": 180,
        "wires": []
    },
    {
        "id": "7e927e56.df184",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 2100,
        "y": 80,
        "wires": []
    },
    {
        "id": "bc335887.16ed48",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 2100,
        "y": 50,
        "wires": []
    },
    {
        "id": "859f6258.0956b",
        "type": "template",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "debug{{payload}}",
        "output": "str",
        "x": 1610,
        "y": 460,
        "wires": [
            [
                "2ce345cb.64bb4a"
            ]
        ]
    },
    {
        "id": "2ce345cb.64bb4a",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "debug",
        "topic": "ESP/TermoSolar/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1740,
        "y": 460,
        "wires": []
    },
    {
        "id": "424b25d7.2c62cc",
        "type": "delay",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1510,
        "y": 500,
        "wires": [
            [
                "4eaafc40.b6ab34"
            ]
        ]
    },
    {
        "id": "4eaafc40.b6ab34",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg = {topic: \"ESP/TermoSolar/Recibo\", payload: \"debug0\"}; node.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 1650,
        "y": 500,
        "wires": [
            [
                "58ccdacc.e6a2d4"
            ]
        ]
    },
    {
        "id": "64b8c0d1.4d858",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/TermoSolar/pedido",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1380,
        "y": 730,
        "wires": [
            [
                "e8032584.3a14d8"
            ]
        ]
    },
    {
        "id": "e8032584.3a14d8",
        "type": "delay",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1560,
        "y": 730,
        "wires": [
            [
                "b5ee5872.f60828"
            ]
        ]
    },
    {
        "id": "b5ee5872.f60828",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg = {topic: \"ESP/TermoSolar/Recibo\", payload: \"debug0\"}; node.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 1690,
        "y": 730,
        "wires": [
            [
                "45b56431.6ab8cc"
            ]
        ]
    },
    {
        "id": "45b56431.6ab8cc",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "pedido",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1810,
        "y": 730,
        "wires": []
    },
    {
        "id": "78a57b12.83d954",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "1",
        "payloadType": "str",
        "x": 1750,
        "y": 50,
        "wires": [
            [
                "d47448fc.6209e8"
            ]
        ]
    },
    {
        "id": "826e0b7f.79a788",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 2070,
        "y": 170,
        "wires": []
    },
    {
        "id": "48dd7364.e41f1c",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "estadoBomba",
        "topic": "ESP/TermoSolar/EstadoBomba",
        "qos": "2",
        "broker": "900627dc.76e6a8",
        "x": 240,
        "y": 220,
        "wires": [
            [
                "8586171e.8702d8"
            ]
        ]
    },
    {
        "id": "aefbe126.ba102",
        "type": "delay",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pauseType": "delay",
        "timeout": "50",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 897,
        "y": 312,
        "wires": [
            [
                "63fd5113.ae3c2"
            ]
        ]
    },
    {
        "id": "c031c992.88fc38",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "if (msg.payload.substring(0,6) == \"Manual\")return;\nif (msg.payload.includes(\"undefined\"))return;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1410,
        "y": 650,
        "wires": [
            [
                "6756c263.6be20c"
            ]
        ]
    },
    {
        "id": "a0774f9d.da29a",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "ModoBomba",
        "topic": "ESP/TermoSolar/ModoBomba",
        "qos": "2",
        "broker": "900627dc.76e6a8",
        "x": 1160,
        "y": 110,
        "wires": [
            [
                "7e2f87a5.298818"
            ]
        ]
    },
    {
        "id": "aaf71995.b86808",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "// Sal1  thingspeak\n// Sal2  mqtt\n// Sal3  blynk\n// Sal4  mysql\n\ncontext.llenandoTermo = context.llenandoTermo || 0;\ncontext.encendidoResistencia = context.encendidoResistencia || 0;\ncontext.estAnteriorResistencia = context.estAnteriorResistencia || 0;\ncontext.tiempoInicioResistencia = context.tiempoInicioResistencia || 0;\ncontext.bombaAutoAnulada = context.bombaAutoAnulada || 1;\n\nvar topic = msg.topic;\nvar payload = msg.payload;\nvar comienzoLlenado;\nvar terminoLlenado;\nvar valorDia = global.get(\"valorDia\");\nvar valorNoche = global.get(\"valorNoche\");\n\nif (topic == \"crepMQTT\" && payload == \"1\"){\n  global.set(\"millisDia\", new Date().getTime() + 1000 * 60 * 60); \n  msg = {pin: 127, payload: global.get(\"hsCpu\") + \", se hizo de dia defasaje 1hs \\n\"};\n  return([null, null, msg, null]);\n}\nnode.status({text: global.get(\"hh\") + \" -- \" + global.get(\"autoBomba\") + \" -- \" + global.get(\"estBomba\")})\n\nif (topic == \"timer\"){\n if (parseInt(global.get(\"hh\")) === 22 && parseInt(global.get(\"mm\")) === 0 && parseInt(global.get(\"autoBomba\")) === 1 && parseInt(global.get(\"estBomba\")) === 0){\n   msg = {pin: 127, payload: global.get(\"hsCpu\") + \", paso a manual bomba termo \\n\"}; node.send([null, null, msg, null]);\n   global.set(\"autoBomba\", 0);\n   global.set(\"pedBomba\", 0);\n   enviarBlynk();\n   enviarMQTT();\n }\n // if (new Date().getTime() > parseInt(global.get(\"millisDia\")) && parseInt(global.get(\"autoBomba\") === 0)){\n //   msg = {pin: 127, payload: global.get(\"hsCpu\") + \", paso a automatico bomba termo por offset dia \\n\"}; node.send([null, null, msg, null]);\n //   global.set(\"autoBomba\", 1); \n //   enviarMQTT();\n // }\n if (parseInt(global.get(\"hh\")) === 9 && parseInt(global.get(\"mm\")) === 0 && parseInt(global.get(\"autoBomba\")) === 0){\n   msg = {pin: 127, payload: global.get(\"hsCpu\") + \", paso a automatico bomba termo por hora \\n\"}; node.send([null, null, msg, null]);\n   context.bombaAutoAnulada = 0;\n   global.set(\"autoBomba\", 1); \n   // msg = {pin: 102, payload: global.get(\"autoBomba\")}; node.send([null, null, msg, null]);\n   enviarBlynk();\n   enviarMQTT();\n } \n return;\n}\n\n\nif (topic == \"bombaAuto\"){\t\n  if (parseInt(payload) === 0){\n    global.set(\"bombaAutoAnulada\", 0);\n    global.set(\"pedBomba\", 0); }\n    // context.bombaAutoAnulada = 1;} \n  if (parseInt(payload) === 1){\n    global.set(\"bombaAutoAnulada\", 1);}\n    // context.bombaAutoAnulada = 0;}\n  global.set(\"autoBomba\", payload); enviarMQTT();}\n\n// if (topic == \"forzarManual\"){\n//  if (parseInt(payload) === 0){//habilitada\n//    // global.set(\"bombaAutoAnulada\", 1);\n//    global.set(\"autoBomba\", 0); \n//    msg = \"Manual0\";\n//  }\n//    // context.bombaAutoAnulada = 1;} \n//  if (parseInt(payload) === 1){//anulada\n//    // global.set(\"bombaAutoAnulada\", 0);\n//    msg = \"Manual1\";}\n//    // context.bombaAutoAnulada = 0;}\n//  global.set(\"autoBomba\", payload); \n//  msg = {topic:\"ESP/TermoSolar/Config\", payload: msg};\n//     node.send([null, msg, null, null]);\n\n//  // enviarMQTT();}  \n// }\n\nif (topic == \"marchaBomba\" && global.get(\"autoBomba\") === 0){\n  global.set(\"pedBomba\", payload); enviarMQTT();}\n  \nif (topic == \"resistenciaAuto\"){\n  if (parseInt(payload) === 0)global.set(\"pedResistencia\", 0);\n  global.set(\"autoResistencia\", payload); enviarMQTT();}//encendidoResistencia\n\nif (topic == \"encendidoResistencia\" && global.get(\"autoResistencia\") === 0){\n  global.set(\"pedResistencia\", payload); enviarMQTT();}\n\nif (topic == \"ESP/TermoSolar/Envio\"){\n  //0#0#0#15.55#25.55#1020\n  var dato = payload.split(\"#\");\n  global.set(\"estBomba\", parseInt(dato[0])); \n  global.set(\"estResistencia\", parseInt(dato[1])); \n  global.set(\"estToldo\", parseInt(dato[2]));  \n  global.set(\"tempTermoFin\", dato[3]); \n  global.set(\"tempExterior\", dato[4]); \n  global.set(\"sensorCrep\", parseInt(dato[5])); //msg.payload = dato[5]; node.send(msg);\n\n  // msg = {pin: 102, payload: global.get(\"estBomba\")}; node.send([null, null, msg, null]);\n  // msg = {pin: 104, payload: global.get(\"estResistencia\")}; node.send([null, null, msg, null]);\n  // msg = {pin: 110, payload: global.get(\"tempTermoFin\")}; node.send([null, null, msg, null]);\n  // msg = {pin: 111, payload: global.get(\"sensorCrep\")}; node.send([null, null, msg, null]);\n  // msg = {pin: 112, payload: global.get(\"tempExterior\")}; node.send([null, null, msg, null]);\n\n\n  msg= {topic: \"temperaturaTermo\", payload: global.get(\"tempTermoFin\")}; node.send([msg, null, null, null]);\n  // msg = {pin: 113, payload: global.get(\"tempTermoFin\")}; node.send([null, null, msg, null]);\n  // msg = {pin: 110, payload: global.get(\"tempTermoFin\") + \"  --  \" + global.get(\"tempExterior\")}; node.send([null, null, msg, null]);\n\n  msg= {topic: \"crepuscular\", payload: global.get(\"sensorCrep\")}; node.send([msg, null, null, null]);\n  // msg = {pin: 111, payload: global.get(\"sensorCrep\")}; node.send([null, null, msg, null]);\n\n  msg= {topic: \"temperaturaExterior\", payload: global.get(\"tempExterior\")}; node.send([msg, null, null, null]);\n  // msg = {pin: 112, payload: global.get(\"tempExterior\")}; node.send([null, null, msg, null]);  //estBomba\n\n  // msg= {topic: \"estBomba\", payload: global.get(\"estBomba\")}; node.send([msg, null, null, null]);\n  // msg= {topic: \"estResistencia\", payload: global.get(\"estResistencia\")}; node.send([msg, null, null, null]);\n\n//  controlCrepuscular();\n  // controlBomba();\n\n    if(global.get(\"estResistencia\") === 1){\n        if (context.estAnteriorResistencia === 0){\n        context.encendidoResistencia = 1;\n        context.estAnteriorResistencia = 1;\n        // global.set(\"resistenciaEncendida\", new Date().getTime());\n        context.tiempoInicioResistencia = new Date().getTime();}\n\n        var tiempo = (new Date().getTime() - context.tiempoInicioResistencia) / 60000;\n        var potencia = ((1.5/60) * tiempo).toFixed(5);\n        global.set(\"potenciaResistencia\", potencia);\n    // msg = {topic: \"potResistencia\", payload: global.get(\"potenciaResistencia\")}; node.send([msg, null, null, null]);\n    }\n\n    if (global.get(\"estResistencia\") === 0 && context.encendidoResistencia === 1){\n        context.estAnteriorResistencia = 0;\n        context.encendidoResistencia = 0;\n        var tiempo = (new Date().getTime() - context.tiempoInicioResistencia) / 60000;\n        var potencia = ((1.5/60) * tiempo).toFixed(5);\n        tiempo = parseFloat(tiempo).toFixed(2);\n        global.set(\"tiempoEncResis\", tiempo);\n        global.set(\"potenciaResistencia\", potencia);\n\n\n\n        // msg = {topic: \"tiempoEncResis\", payload: global.get(\"tiempoEncResis\")}; node.send([msg, null, null, null]);\n        // msg = {topic: \"potResistencia\", payload: global.get(\"potenciaResistencia\")}; node.send([msg, null, null, null]);\n        // global.set(\"potenciaResistencia\",0);\n    }\n    // if (global.get(\"estResistencia\") === \"0\" && context.encendidoResistencia == \"0\"){\n    //  msg = {topic: \"potResistencia\", payload: global.get(\"potenciaResistencia\")}; \n    //  node.send([msg, null, null, null]);}\n    enviarBlynk();\n}\n\n// if (topic == \"ESP/TermoSolar/ModoBomba\"){\n//  if (payload.substring(0, 9) == \"bombaAuto\"){\n//  // if (payload.includes(\"bombaAuto0\") || payload.includes(\"bombaAuto1\")){\n//    global.set(\"autoBomba\", parseInt(payload.substring(9)));\n//    if (global.get(\"autoBomba\") === 0)global.set(\"pedBomba\", 0);\n//    if (global.get(\"autoBomba\") === 1){estadoBomba = \"Automatico\";}else{estadoBomba = \"Manual\";}\n//    msg = {pin: 102, label: estadoBomba, payload: global.get(\"pedBomba\")}; node.send([null, null, msg, null]);    \n//    // enviarMQTT();\n//    // msg = {pin: 102, payload: global.get(\"autoBomba\")}; node.send([null, null, msg, null]);    \n//  }\n// }\nif (topic == \"ESP/TermoSolar/EstadoBomba\"){//  bombaMarcha1\n  if (payload.substring(0, 11) == \"bombaMarcha\"){// || payload.substring(0, 12) == \"bombaM+archa\"){\n  // if (payload.includes(\"bombaMarcha0\") || payload.includes(\"bombaMarcha1\")){\n    global.set(\"estBomba\", parseInt(payload.substring(11)));\n    if (global.get(\"autoBomba\") === 1){estadoBomba = \"Automatico\";}else{estadoBomba = \"Manual\";}\n    msg = {pin: 102, label: estadoBomba, payload: global.get(\"estBomba\")}; node.send([null, null, msg, null]);\n    // if (global.get(\"estBomba\") === 0)global.set(\"pedBomba\", 0);\n    // msg = {pin: 102, payload: global.get(\"estBomba\")}; node.send([null, null, msg, null]);\n    // enviarMQTT();\n    controlBomba();\n  }\n\n  // global.set(\"estBomba\", parseInt(payload));\n  // msg = {pin: 102, payload: global.get(\"estBomba\")}; node.send([null, null, msg, null]);\n  // controlBomba();\n}\n\nif (topic == \"ESP/TermoSolar/pedido\"){\n    var fallasLivingIluminacion = global.get(\"fallasLivingIluminacion\") + 1;\n    global.set(\"fallasLivingIluminacion\", fallasLivingIluminacion);\n    global.set(\"tipoFallaIlLiving\", msg.payload); \n    enviarMQTT();}\n\nfunction controlBomba(){\n  msg = {topic: \"estBomba\", payload: global.get(\"estBomba\")}; node.send([msg, null, null, null]);\n  if (global.get(\"estBomba\")=== 1 && context.llenandoTermo === 0){\n    context.llenandoTermo = 1;\n    global.set(\"comienzoLlenado\", new Date().getTime());}\n  if (global.get(\"estBomba\") === 0 && context.llenandoTermo === 1){\n    context.llenandoTermo = 0;\n    var tiempo = new Date().getTime() - global.get(\"comienzoLlenado\");\n    tiempo = parseFloat(tiempo / 1000).toFixed(2);\n    global.set(\"tiempoLlenado\", tiempo);\n    msg = {topic: \"tiempoLlenado\", payload: global.get(\"tiempoLlenado\")}; node.send([msg, null, null, null]);\n    enviarBlynk();\n    // msg = {pin: 114, payload: global.get(\"tiempoLlenado\")}; node.send([null, null, msg, null]);\n    // msg = {pin: 105, payload: global.get(\"tiempoLlenado\")}; node.send([null, null, msg, null]);\n  } \n}    \n\n// function controlCrepuscular(){\n//  if (global.get(\"sensorCrep\") > valorDia && global.get(\"Dia\") === 0){global.set(\"Dia\", 1); msg = {topic: \"ESP/TermoSolar/Crepuscular\", payload: global.get(\"Dia\")}; node.send([null, msg, null, null]);}\n//  if (global.get(\"sensorCrep\") < valorNoche && global.get(\"Dia\") === 1){global.set(\"Dia\", 0); msg = {topic: \"ESP/TermoSolar/Crepuscular\", payload: global.get(\"Dia\")}; node.send([null, msg, null, null]);}\n//  // msg = {topic: \"ESP/TermoSolar/Crepuscular\", payload: global.get(\"Dia\")}; node.send([null, msg, null, null]);\n// }\n\nfunction enviarBlynk(){\n    msg = {pin: 101, payload: global.get(\"autoBomba\")}; node.send([null, null, msg, null]);\n    msg = {pin: 102, payload: global.get(\"estBomba\")}; node.send([null, null, msg, null]);\n    msg = {pin: 104, payload: global.get(\"estResistencia\")}; node.send([null, null, msg, null]);\n    msg = {pin: 105, payload: global.get(\"tiempoLlenado\")}; node.send([null, null, msg, null]);\n    msg = {pin: 110, payload: global.get(\"tempTermoFin\") + \"  --  \" + global.get(\"tempExterior\")}; node.send([null, null, msg, null]);  \n    msg = {pin: 111, payload: global.get(\"sensorCrep\")}; node.send([null, null, msg, null]);\n    msg = {pin: 112, payload: global.get(\"tempExterior\")}; node.send([null, null, msg, null]);\n    msg = {pin: 113, payload: global.get(\"tempTermoFin\")}; node.send([null, null, msg, null]);\n    msg = {pin: 114, payload: global.get(\"tiempoLlenado\")}; node.send([null, null, msg, null]);\n}\n\nfunction enviarMQTT(){   \n  // msg = {pin: 101, payload: global.get(\"autoBomba\")}; node.send([null, null, msg, null]);\n  // var estadoBomba;\n  // if (global.get(\"autoBomba\") === 1){estadoBomba = \"Automatico\";}else{estadoBomba = \"Manual\";}\n  // msg = {pin: 102, label: estadoBomba, payload: global.get(\"pedBomba\")}; node.send([null, null, msg, null]);\n  // msg = {pin: 104, payload: global.get(\"pedResistencia\")}; node.send([null, null, msg, null]);\n  // if (topic == \"ESP/TermoSolar/Bomba\")return;\n    // msg.payload = topic; node.send([null, msg, null, null]); \n    payload = global.get(\"autoBomba\") + \"#\"; payload += global.get(\"autoResistencia\") + \"#\"; payload += global.get(\"autoToldo\") + \"#\"; \n    payload += global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; payload += global.get(\"pedToldo\") + \"#\"; \n    payload += global.get(\"tempMaximaTermo\") + \"#\"; payload += global.get(\"tempMaxResistencia\") + \"#\"; \n    payload += global.get(\"tempMaxResistenciaManual\") + \"#\"; payload += global.get(\"tempMinimaResistencia\") + \"#\";\n    payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n    payload += \"#\" + global.get(\"offsetDia\")  + \"#\"; payload += global.get(\"offsetNoche\");\n    // payload += \"#\" + global.get(\"bombaAutoAnulada\");\n    msg.payload = payload;  \n    msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([null, msg, null, null]);\n}",
        "outputs": 4,
        "noerr": 0,
        "x": 170,
        "y": 130,
        "wires": [
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "8586171e.8702d8",
        "type": "delay",
        "z": "1b403a13.0ec8c6",
        "name": "100mS",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 390,
        "y": 220,
        "wires": [
            [
                "ab21644b.e84768",
                "932c6575.0ec8e8",
                "249cc871.8bc848"
            ]
        ]
    },
    {
        "id": "714074bc.f19adc",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/Lavadero/Presurizadora",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1810,
        "y": 230,
        "wires": [
            [
                "1efdc9d5.58a246",
                "2cfcf6cd.bcf37a"
            ]
        ]
    },
    {
        "id": "1efdc9d5.58a246",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "if (msg.payload === \"0\") msg.payload = global.get(\"fechaCompleta\") + \" - Sin Rociar\\n\";\nif (msg.payload === \"1\") msg.payload = global.get(\"fechaCompleta\") + \" - Rociando\\n\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2000,
        "y": 230,
        "wires": [
            [
                "5475e278.3c5b9c"
            ]
        ]
    },
    {
        "id": "5475e278.3c5b9c",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "terminalBlynk",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 2160,
        "y": 230,
        "wires": []
    },
    {
        "id": "2cfcf6cd.bcf37a",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 2020,
        "y": 270,
        "wires": []
    },
    {
        "id": "7ff991b6.a5e4",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/Lavadero/Presurizadora",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 2280,
        "y": 340,
        "wires": []
    },
    {
        "id": "207131b0.1d8eee",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "aviso/Alarma",
        "qos": "2",
        "broker": "6b36e4a.1d30b1c",
        "x": 210,
        "y": 180,
        "wires": [
            [
                "bae3486e.dfcff8"
            ]
        ]
    },
    {
        "id": "6991b26c.c8e9bc",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 560,
        "y": 110,
        "wires": [
            [
                "8176684.e76be98"
            ]
        ]
    },
    {
        "id": "8176684.e76be98",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg.pin = 101;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 690,
        "y": 90,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "c278ff48.39bdd",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 560,
        "y": 70,
        "wires": [
            [
                "8176684.e76be98"
            ]
        ]
    },
    {
        "id": "50158935.a4d658",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/Lavadero/AguaCaliente",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 325,
        "y": 114,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "d4c1348d.835678",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 680,
        "wires": [
            [
                "f6be1ee4.df03e"
            ]
        ]
    },
    {
        "id": "f6be1ee4.df03e",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg.payload = global.get(\"hsCpu\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 310,
        "y": 680,
        "wires": [
            [
                "616f0886.bef8c8"
            ]
        ]
    },
    {
        "id": "616f0886.bef8c8",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 500,
        "y": 680,
        "wires": []
    },
    {
        "id": "e1724aed.64bca8",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1800,
        "y": 630,
        "wires": []
    },
    {
        "id": "24526277.28ed5e",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 2060,
        "y": 310,
        "wires": [
            [
                "7ff991b6.a5e4"
            ]
        ]
    },
    {
        "id": "aeadf4ea.43d888",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 2060,
        "y": 370,
        "wires": [
            [
                "7ff991b6.a5e4"
            ]
        ]
    },
    {
        "id": "f38030c.80697d",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/Lavadero/AguaFria",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 2000,
        "y": 400,
        "wires": [
            [
                "a8d1fe12.dfe07"
            ]
        ]
    },
    {
        "id": "a8d1fe12.dfe07",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "var dato = msg.payload;\nif (dato.substring(0, 15) == \"BombaAguaFriaSI\")msg.payload = 1;\nif (dato.substring(0, 15) == \"BombaAguaFriaNO\")msg.payload = 0;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2180,
        "y": 400,
        "wires": [
            [
                "257fa906.068fd6"
            ]
        ]
    },
    {
        "id": "bae3486e.dfcff8",
        "type": "delay",
        "z": "1b403a13.0ec8c6",
        "name": "100mS",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 390,
        "y": 180,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "52c7b36.5c7ef4c",
        "type": "link in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "links": [
            "744f52d5.ad8ecc"
        ],
        "x": 885,
        "y": 560,
        "wires": [
            [
                "803cd776.b0d768"
            ]
        ]
    },
    {
        "id": "fe798083.6f5ef",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 660,
        "y": 430,
        "wires": [
            [
                "5b8c1bdb.1402c4"
            ]
        ]
    },
    {
        "id": "5b8c1bdb.1402c4",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg= {topic: \"horasDia\", payload: \"1.5\"};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 820,
        "y": 440,
        "wires": [
            [
                "48c20767.e64078"
            ]
        ]
    },
    {
        "id": "ecc24e7c.a4bec",
        "type": "function",
        "z": "950c1426.ff4008",
        "name": "",
        "func": "// global.set(\"incrementoBaño\", 10);\nvar pin = parseInt(msg.pin);\nvar intPayload = parseInt(msg.payload);\nvar topic = msg.topic;\nvar topicInicial = msg.topic;\nvar dato;\nvar timerLuces = 12000;  \ncontext.parcheDejarApagarLuz = context.parcheDejarApagarLuz || 0;\nvar date = new Date();\n\nif (global.get(\"estLuzBano\") === undefined)global.set(\"estLuzBano\", 0);\nif (global.get(\"pwmLuzBano\") === undefined)global.set(\"pwmLuzBano\", 512);\nif (global.get(\"modoDucha\") === undefined)global.set(\"modoDucha\", 0);\nif (global.get(\"estDucha\") === undefined)global.set(\"estDucha\", 0);\nif (global.get(\"pwmDucha\") === undefined)global.set(\"pwmDucha\", 512);\nif (global.get(\"estLuzEspejo\") === undefined)global.set(\"estLuzEspejo\", 0);\nif (global.get(\"estExtractorBano\") === undefined)global.set(\"estExtractorBano\", 0);\nif (global.get(\"timerExtractorBano\") === undefined)global.set(\"timerExtractorBano\", 5);\nif (global.get(\"incrementoBaño\") === undefined)global.set(\"incrementoBaño\", 1);\n\n\nif (topic == \"aviso/Alarma\" && global.get(\"estadoAlarma\") === 1){\n  global.set(\"estLuzBano\", 0);\n  global.set(\"estDucha\", 0);\n  global.set(\"estLuzEspejo\", 0);\n  global.set(\"estExtractorBano\", 0);  \n  enviarBlynk();\n  enviarMQTT();\n}\n\nif (topic == \"aviso/Alarma\"){\n  if (global.get(\"estLuzBano\") === 1 && global.get(\"estadoAlarma\") === 1)apagadoLuces();\n  context.parcheDejarApagarLuz = date.getTime();\n  return;\n}\n\n// if (topic == \"ESP/Bano/Desconectado\") {\n//     enviarMQTT();\n//     return;\n// }\n\nif (topic == \"ESP/Pasillo/Iluminacion/Envio\") {\n  global.set(\"estLuzPasillo\", parseInt(msg.payload.substring(4)));\n  msg = {pin: 44, payload: global.get(\"estLuzPasillo\")}; node.send([null, msg]);  \n  }\n\nif (topic == \"google/Baño\"){\n  enviarBlynk();\n  enviarMQTT();\n}\n\nif (topic == \"crepMQTT\"){enviarMQTT(); return;}\n\nif (topic == \"ESP/Bano/Inicio\"){  \n    var fallasBano = global.get(\"fallasBano\") + 1;\n    global.set(\"fallasBano\", fallasBano);\n    global.set(\"fallasBano\", msg.payload);// msg = {topic: \"fallas_MQTT\", payload: 1}; node.send([msg, null]);\n    msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \"  ResetNano Baño\" + \"\\n\"}; node.send([msg, null]);\n    topicInicial = \"ESP/Bano/Inicio\";\n    enviarMQTT();\n    return;\n}\n\nif (topic == \"ESP/Bano/Envio\"){\n  if (msg.payload == \"timerExtractorSI\"){\n    msg = {pin: 43, color: \"#ED9D00\", payload: global.get(\"estExtractorBano\")}; node.send([null, msg]);\n    return;\n  }\n  if (msg.payload == \"timerExtractorNO\"){\n    global.set(\"estExtractorBano\", 0);\n    msg = {pin: 43, color: \"#23C48E\", payload: global.get(\"estExtractorBano\")}; node.send([null, msg]);\n    return;\n  } \n  dato = msg.payload.split(\"#\");\n  global.set(\"estLuzBano\", parseInt(dato[0]));\n  global.set(\"estLuzEspejo\", parseInt(dato[1]));\n  global.set(\"modoDucha\", parseInt(dato[2]));\n  global.set(\"estDucha\", parseInt(dato[3]));\n  global.set(\"estExtractorBano\", parseInt(dato[4]));  \n  enviarBlynk();\n  return;\n}\n// if (global.get(\"luzBano\") === 0 && context.parcheDejarApagarLuz === 1)context.parcheDejarApagarLuz = 0;\n\nswitch (pin){\n  case 39:  \n    global.set(\"modoDucha\", intPayload);\n    if (msg.tema == \"node\")enviarBlynk();\n    enviarMQTT();\n  break;\n  case 40:\n    if (intPayload === 0){global.set(\"modoDucha\", 1); global.set(\"estDucha\", 0);}\n    if (intPayload === 1){global.set(\"modoDucha\", 0); global.set(\"estDucha\", 1);}\n    if (parseInt(global.get(\"Dia\")) === 0 && parseInt(global.get(\"estDucha\")) === 0)global.set(\"estLuzBano\", 1);\n    if (msg.tema = \"node\")enviarBlynk();\n    enviarBlynk();\n    enviarMQTT();\n  break;\n  case 41:\n    global.set(\"estLuzBano\", intPayload);\n    if (global.get(\"estLuzBano\") === 0)global.set(\"estLuzEspejo\", 0);\n    context.parcheDejarApagarLuz = date.getTime();\n    if (msg.tema = \"node\")enviarBlynk();\n    enviarMQTT();  \n  break;\n  case 42:\n    global.set(\"estLuzEspejo\", intPayload);\n    // context.parcheDejarApagarLuz = date.getTime();\n    if (msg.tema = \"node\")enviarBlynk();\n    enviarMQTT();  \n  break;\n  case 43:\n    global.set(\"estExtractorBano\", intPayload);\n    // context.parcheDejarApagarLuz = date.getTime();\n    if (msg.tema = \"node\")enviarBlynk();\n    enviarMQTT();  \n  break;\n  case 44:\n    global.set(\"estLuzPasillo\", intPayload);\n    // context.parcheDejarApagarLuz = date.getTime();\n    if (msg.tema = \"node\")enviarBlynk();\n    msg = {topic: \"ESP/Pasillo/Iluminacion/Recibo\", payload: global.get(\"estLuzPasillo\")}; node.send([msg, null]);\n  break;    \n}\n\nfunction apagadoLuces(){\n  global.set(\"estLuzBano\", 0);\n  global.set(\"estDucha\", 0);\n  global.set(\"estLuzEspejo\", 0);\n  global.set(\"estExtractorBano\", 0); \n  enviarBlynk();\n  enviarDatos();\n}\n\nnode.status({text: context.parcheDejarApagarLuz});\n\nfunction enviarBlynk(){\n  msg = {pin: 39, payload: global.get(\"modoDucha\")}; node.send([null, msg]);\n  msg = {pin: 40, payload: global.get(\"estDucha\")}; node.send([null, msg]);\n  msg = {pin: 41, payload: global.get(\"estLuzBano\")}; node.send([null, msg]);\n  msg = {pin: 42, payload: global.get(\"estLuzEspejo\")}; node.send([null, msg]);\n  msg = {pin: 43, payload: global.get(\"estExtractorBano\")}; node.send([null, msg]);\n  msg = {pin: 44, payload: global.get(\"estLuzPasillo\")}; node.send([null, msg]);\n  msg = {topic: \"bano/nodeRed\", payload: 1}; node.send([msg, null]);\n}\n\nfunction enviarMQTT(){\n    var dato = \"estado\" + global.get(\"estLuzBano\") + \"#\" + global.get(\"pwmLuzBano\");\n    dato += \"#\" + global.get(\"estLuzEspejo\") + \"#\" + global.get(\"pwmLuzBano\");\n    dato += \"#1\";// + global.get(\"estExtractorBano\");\n    dato += \"#\" + global.get(\"incrementoBaño\");\n    dato += \"#\" + global.get(\"minTeclas\");\n    dato += \"#\" + global.get(\"maxTeclas\");\n    dato += \"#\" + global.get(\"delayBuzzer\");     \n\n  if (topicInicial == \"ESP/Bano/Inicio\" || topicInicial == \"aviso/Alarma\" || topicInicial == \"crepMQTT\") dato = \"$\" + dato;\n\n    msg = {topic: \"ESP/Bano/Recibo\", payload: dato}; node.send([msg, null]);\n    msg = {topic: \"bano/nodeRed\", payload: 1}; node.send([msg, null]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 597,
        "y": 290,
        "wires": [
            [
                "7269b5d7.99336c",
                "a4ace061.8ed99",
                "752e79d6.3f74e8"
            ],
            [
                "a2c7c31d.c89e1",
                "ad5fc954.82ae08",
                "a4ace061.8ed99"
            ]
        ]
    },
    {
        "id": "752e79d6.3f74e8",
        "type": "mqtt out",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 770,
        "y": 240,
        "wires": []
    },
    {
        "id": "7269b5d7.99336c",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 810,
        "y": 200,
        "wires": []
    },
    {
        "id": "a2c7c31d.c89e1",
        "type": "delay",
        "z": "950c1426.ff4008",
        "name": "",
        "pauseType": "delay",
        "timeout": "50",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 750,
        "y": 330,
        "wires": [
            [
                "812daebc.b64d6"
            ]
        ]
    },
    {
        "id": "7899449.c046cbc",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Desconectado",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 360,
        "y": 310,
        "wires": [
            [
                "ecc24e7c.a4bec"
            ]
        ]
    },
    {
        "id": "1de49172.37446f",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 390,
        "y": 270,
        "wires": [
            [
                "ecc24e7c.a4bec",
                "e527c6fe.977b28",
                "d4cc34f1.810498"
            ]
        ]
    },
    {
        "id": "5fb2248c.5ea6dc",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Envio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 390,
        "y": 230,
        "wires": [
            [
                "ecc24e7c.a4bec",
                "c3cff062.b2bab"
            ]
        ]
    },
    {
        "id": "f6460c12.db57b",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "debug1",
        "payloadType": "str",
        "x": 1110,
        "y": 510,
        "wires": [
            [
                "d568dd07.8f5e2"
            ]
        ]
    },
    {
        "id": "d568dd07.8f5e2",
        "type": "mqtt out",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1370,
        "y": 550,
        "wires": []
    },
    {
        "id": "3bc6660d.c1368a",
        "type": "link in",
        "z": "950c1426.ff4008",
        "name": "",
        "links": [
            "a4ace061.8ed99",
            "fdb236.1e712dc8"
        ],
        "x": 205,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "21b0c5b2.1b19aa",
        "type": "function",
        "z": "950c1426.ff4008",
        "name": "",
        "func": "if (msg.topic == \"modoDucha\")msg = {pin: 39, tema: \"node\", payload: msg.payload};\nif (msg.topic == \"estadoDucha\")msg = {pin: 40, tema: \"node\", payload: msg.payload};\nif (msg.topic == \"Bano\")msg = {pin: 41, tema: \"node\", payload: msg.payload};\nif (msg.topic == \"LuzEspejo\")msg = {pin: 42, tema: \"node\", payload: msg.payload};\nif (msg.topic == \"Extractor\")msg = {pin: 43, tema: \"node\", payload: msg.payload};\nif (msg.topic == \"LuzPasillo\")msg = {pin: 44, tema: \"node\", payload: msg.payload};\n\nnode.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 990,
        "y": 750,
        "wires": [
            [
                "5ff65043.e44ec",
                "c766359a.24a6e8"
            ]
        ]
    },
    {
        "id": "cbc33915.1eb6d8",
        "type": "function",
        "z": "950c1426.ff4008",
        "name": "",
        "func": "msg.payload = global.get(\"estLuzBano\"); node.send([msg, null, null, null, null, null]);\nmsg.payload = global.get(\"modoDucha\"); node.send([null, msg, null, null, null, null]);\nmsg.payload = global.get(\"estDucha\"); node.send([null, null, msg, null, null, null]);\nmsg.payload = global.get(\"estLuzEspejo\"); node.send([null, null, null, msg, null, null]);\nmsg.payload = global.get(\"estExtractorBano\"); node.send([null, null, null, null, msg, null]);\nmsg.payload = global.get(\"estLuzPasillo\"); node.send([null, null, null, null, null, msg]);\nnode.status({text: global.get(\"estDucha\")});",
        "outputs": 6,
        "noerr": 0,
        "x": 640,
        "y": 760,
        "wires": [
            [
                "c2e8ba24.39f3b8"
            ],
            [
                "f421502e.fe9ae",
                "ad1b1083.a26f5"
            ],
            [
                "b59774c0.577fd8"
            ],
            [
                "a2dff89e.cf8708"
            ],
            [
                "75b90702.f612f8"
            ],
            [
                "38baede0.8038e2"
            ]
        ]
    },
    {
        "id": "5ff65043.e44ec",
        "type": "link out",
        "z": "950c1426.ff4008",
        "name": "salidaLiving",
        "links": [
            "335c5990.d9cc06"
        ],
        "x": 1090,
        "y": 750,
        "wires": []
    },
    {
        "id": "a4ace061.8ed99",
        "type": "link out",
        "z": "950c1426.ff4008",
        "name": "inluminacionBano",
        "links": [
            "3bc6660d.c1368a"
        ],
        "x": 705,
        "y": 290,
        "wires": []
    },
    {
        "id": "335c5990.d9cc06",
        "type": "link in",
        "z": "950c1426.ff4008",
        "name": "salidaBano",
        "links": [
            "5ff65043.e44ec"
        ],
        "x": 455,
        "y": 690,
        "wires": [
            [
                "ecc24e7c.a4bec"
            ]
        ]
    },
    {
        "id": "38cc6f5f.406e4",
        "type": "delay",
        "z": "950c1426.ff4008",
        "name": "",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 490,
        "y": 760,
        "wires": [
            [
                "cbc33915.1eb6d8",
                "f6336559.461d98"
            ]
        ]
    },
    {
        "id": "c766359a.24a6e8",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1060,
        "y": 810,
        "wires": []
    },
    {
        "id": "b973308d.f8b82",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "google/Baño",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 400,
        "y": 190,
        "wires": [
            [
                "ecc24e7c.a4bec",
                "56bbf874.a0d958"
            ]
        ]
    },
    {
        "id": "e2d0c339.a9215",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 450,
        "y": 860,
        "wires": [
            [
                "e3839d71.17991"
            ]
        ]
    },
    {
        "id": "b92efdc5.61183",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "str",
        "x": 450,
        "y": 900,
        "wires": [
            [
                "e3839d71.17991"
            ]
        ]
    },
    {
        "id": "e3839d71.17991",
        "type": "function",
        "z": "950c1426.ff4008",
        "name": "set Dia",
        "func": "global.set(\"Dia\", parseInt(msg.payload));\nmsg.payload = global.get(\"Dia\"); return msg",
        "outputs": 1,
        "noerr": 0,
        "x": 600,
        "y": 890,
        "wires": [
            [
                "f6336559.461d98"
            ]
        ]
    },
    {
        "id": "f6336559.461d98",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 760,
        "y": 900,
        "wires": []
    },
    {
        "id": "e527c6fe.977b28",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 610,
        "y": 240,
        "wires": []
    },
    {
        "id": "a2597d3.3b1cd8",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "aviso/Alarma",
        "qos": "2",
        "broker": "6b36e4a.1d30b1c",
        "x": 260,
        "y": 130,
        "wires": [
            [
                "12c70ffc.778b9",
                "17c2b740.de06a9"
            ]
        ]
    },
    {
        "id": "12c70ffc.778b9",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 660,
        "y": 140,
        "wires": []
    },
    {
        "id": "7b312ac8.2c4c04",
        "type": "function",
        "z": "950c1426.ff4008",
        "name": "",
        "func": "// if (msg.payload.includes (\"pwmDucha\") || msg.payload.includes (\"LuzBano\")){\n    msg = {topic: \"terminalBlynk\", payload: msg.payload + \"\\n\"};\n    return msg;\n// }",
        "outputs": 1,
        "noerr": 0,
        "x": 1290,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "f3949534.d17538",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "debug1",
        "payloadType": "str",
        "x": 1130,
        "y": 180,
        "wires": [
            [
                "8158b414.794658"
            ]
        ]
    },
    {
        "id": "8158b414.794658",
        "type": "mqtt out",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1300,
        "y": 200,
        "wires": []
    },
    {
        "id": "9e265dda.36651",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "debug0",
        "payloadType": "str",
        "x": 1130,
        "y": 220,
        "wires": [
            [
                "8158b414.794658"
            ]
        ]
    },
    {
        "id": "565363f0.f181ec",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Pasillo/Iluminacion",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 370,
        "y": 410,
        "wires": [
            [
                "ecc24e7c.a4bec"
            ]
        ]
    },
    {
        "id": "d0e1a81.0e9f858",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Debug",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1130,
        "y": 120,
        "wires": [
            [
                "13ffa04d.829bf",
                "7b312ac8.2c4c04",
                "cbca2d76.46fd5"
            ]
        ]
    },
    {
        "id": "13ffa04d.829bf",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1310,
        "y": 100,
        "wires": []
    },
    {
        "id": "5b6c768b.e019f8",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 650,
        "y": 442,
        "wires": []
    },
    {
        "id": "547d49c.a3042b8",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Pasillo/Iluminacion/Envio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 350,
        "y": 350,
        "wires": [
            [
                "895e93af.60dec",
                "ecc24e7c.a4bec"
            ]
        ]
    },
    {
        "id": "895e93af.60dec",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "pasillo baño",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 580,
        "y": 350,
        "wires": []
    },
    {
        "id": "1d72ed23.ba6583",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 500,
        "y": 820,
        "wires": []
    },
    {
        "id": "ee08fcf4.5b87d",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "node-red",
        "topic": "bano/nodeRed",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 330,
        "y": 740,
        "wires": [
            [
                "38cc6f5f.406e4",
                "1d72ed23.ba6583"
            ]
        ]
    },
    {
        "id": "39190795.8dc678",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "debug0",
        "payloadType": "str",
        "x": 1110,
        "y": 550,
        "wires": [
            [
                "d568dd07.8f5e2"
            ]
        ]
    },
    {
        "id": "cb9cee39.4f60c",
        "type": "mqtt out",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1420,
        "y": 140,
        "wires": []
    },
    {
        "id": "4c79eb7e.ac7d54",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/Bano/Inicio",
        "payload": "",
        "payloadType": "date",
        "x": 360,
        "y": 170,
        "wires": [
            [
                "ecc24e7c.a4bec"
            ]
        ]
    },
    {
        "id": "76f917e2.c1a968",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Envio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 850,
        "y": 430,
        "wires": [
            []
        ]
    },
    {
        "id": "97cc195b.022518",
        "type": "function",
        "z": "950c1426.ff4008",
        "name": "",
        "func": "if (msg.payload.substring(0, 14) == \"timerExtractor\"){\n    var dato = global.get(\"hsCpu\") + \" - \" + msg.payload + \"\\n\";\n    msg = {topic: \"notifyBlynk\", payload: dato}; node.send(msg);\n    msg = {topic: \"terminalBlynk\", payload: dato}; node.send(msg);\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1040,
        "y": 430,
        "wires": [
            [
                "baefee38.76404",
                "6538d508.b61d3c"
            ]
        ]
    },
    {
        "id": "6538d508.b61d3c",
        "type": "mqtt out",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1230,
        "y": 440,
        "wires": []
    },
    {
        "id": "c3cff062.b2bab",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 620,
        "y": 190,
        "wires": []
    },
    {
        "id": "baefee38.76404",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1180,
        "y": 390,
        "wires": []
    },
    {
        "id": "d009bb52.8329a8",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "amarillo",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "str",
        "x": 1280,
        "y": 290,
        "wires": [
            [
                "8c82206c.1ebc9"
            ]
        ]
    },
    {
        "id": "b4b11dbc.fa4a",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "verde",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "x": 1280,
        "y": 340,
        "wires": [
            [
                "8c82206c.1ebc9"
            ]
        ]
    },
    {
        "id": "ce01d6d5.e0d9f8",
        "type": "delay",
        "z": "950c1426.ff4008",
        "name": "",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1600,
        "y": 330,
        "wires": [
            [
                "77563552.e99a9c"
            ]
        ]
    },
    {
        "id": "8c82206c.1ebc9",
        "type": "function",
        "z": "950c1426.ff4008",
        "name": "",
        "func": "if (parseInt(msg.payload) === 0){\n    msg.pin = 43;\n    msg.onLabel = \"12\";\n    msg.payload = 1;\n    // msg = {pin: 43, label : \"EXTRACTOR (ESPERA)\", payload: 1};\n    node.send(msg); return;\n}\n\nif (parseInt(msg.payload) === 1){\n    msg = {pin: 43, label: \"EXTRACTOR\", payload: 0};\n        node.send(msg); return;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1420,
        "y": 300,
        "wires": [
            [
                "1067f4ea.ae58eb",
                "ce01d6d5.e0d9f8",
                "4ba37ff.d803d8"
            ]
        ]
    },
    {
        "id": "4ba37ff.d803d8",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1710,
        "y": 230,
        "wires": []
    },
    {
        "id": "17c2b740.de06a9",
        "type": "delay",
        "z": "950c1426.ff4008",
        "name": "100mS",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 410,
        "y": 130,
        "wires": [
            [
                "ecc24e7c.a4bec"
            ]
        ]
    },
    {
        "id": "13a6fa02.a93ff6",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "crepMQTT",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 270,
        "y": 90,
        "wires": [
            [
                "d78cc5a7.f98888"
            ]
        ]
    },
    {
        "id": "d78cc5a7.f98888",
        "type": "delay",
        "z": "950c1426.ff4008",
        "name": "100mS",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 410,
        "y": 90,
        "wires": [
            []
        ]
    },
    {
        "id": "78364cb0.17f444",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "    // global.set(\"incrementoBaño\", 10);\n    var pin = parseInt(msg.pin);\n    var intPayload = parseInt(msg.payload);\n    var topic = msg.topic;\n    var dato;\n    var envioresguardo = 0;  \n    var envioresguardoCrep = 1; \n    var date = new Date();   \n\n\n    if (msg.topic == \"crepMQTT\"){//} || msg.topic == \"PatioLuz/Inicio\" || msg.topic == \"ESP/Escaleras/Inicio\"){\n        envioresguardoCrep = 0;\n        if (parseInt(global.get(\"Dia\")) === 1){\n            global.set(\"estPalioLuz\", 0);\n            global.set(\"estLuzCascada\", 0);\n            global.set(\"estTopeCascada\", 0); \n            global.set(\"estMitadCascada\", 0);\n            global.set(\"estPiletaCascada\", 0); \n            enviarMQTT(\"patioLuz\");\n            global.set(\"estEscaleras\", 0);\n            global.set(\"estReflectorPergola\", 0);\n            global.set(\"estLucesPergola\", 0);\n            global.set(\"estLucesPasadaAuto\", 0);\n            enviarMQTT(\"escaleras\");\n            global.set(\"estLuzPorche\", 0);\n            enviarMQTT(\"porche\");\n            envioresguardoCrep = 1;\n            enviarMQTT(\"resguardo\");\n        }\n        if (parseInt(global.get(\"Dia\")) === 0){\n        \tglobal.set(\"estPalioLuz\", 1);\n            global.set(\"estLuzCascada\", 1);\n            global.set(\"estTopeCascada\", 1); \n            global.set(\"estMitadCascada\", 1);\n            global.set(\"estPiletaCascada\", 1); \n            enviarMQTT(\"patioLuz\"); \n            global.set(\"estEscaleras\", 1); \n            global.set(\"estReflectorPergola\", 0);\n            // global.set(\"pwmReflectorPergola\", 5);\n            global.set(\"estLucesPergola\", 1);\n            // global.set(\"pwmLucesPergola\", 10);      \n            global.set(\"estLucesPasadaAuto\", 1);\n            // global.set(\"pwmLucesPasadaAuto\", 100);\n            enviarMQTT(\"escaleras\");\n            global.set(\"estLuzPorche\", 1);\n            enviarMQTT(\"porche\"); \n            // global.set(\"estLucesRGBPileta\", 1);\n            // enviarMQTT(\"Pileta\");\n            envioresguardoCrep = 1;\n            enviarMQTT(\"resguardo\");         \n      }  \n      return;\n    }\n\n    if (msg.topic == \"PatioLuz/Inicio\"){\n        enviarMQTT(\"patioLuz\"); \n        return;    \n    }\n\n    if (msg.topic == \"ESP/Porche/Inicio\"){\n        enviarMQTT(\"porche\"); \n        return;    \n    }    \n\n    if (msg.topic == \"ESP/Pileta/Inicio\"){\n        enviarMQTT(\"Pileta\"); \n        return;    \n    }\n\n    if (msg.topic == \"ESP/Escaleras/Inicio\"){\n        enviarMQTT(\"escaleras\"); \n        return;    \n    }\n\n    // node.status({text: context.item});\n\n    switch (pin){\n      case 8:\n        switch (parseInt(context.item)){\n            case 4:\n                global.set(\"IslaR\", msg.arrayOfValues[0]);\n                global.set(\"IslaG\", msg.arrayOfValues[1]);\n                global.set(\"IslaB\", msg.arrayOfValues[2]);\n                // msg = {pin: 32, payload: \"12\"}; node.send([null, msg]);\n                global.set(\"estIslaRGB\", 1);\n                enviarMQTT(\"living\");\n                // return;\n            break;\n            case 6:\n                global.set(\"topeCascadaR\", msg.arrayOfValues[0]); global.set(\"mitadCascadaR\", msg.arrayOfValues[0]); global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"topeCascadaG\", msg.arrayOfValues[1]); global.set(\"mitadCascadaG\", msg.arrayOfValues[1]); global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"topeCascadaB\", msg.arrayOfValues[2]); global.set(\"mitadCascadaB\", msg.arrayOfValues[2]); global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\");\n                // return;\n            break;\n            case 7:\n                global.set(\"topeCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"topeCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"topeCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\");\n                // return;\n            break;\n            case 8:\n                global.set(\"mitadCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"mitadCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"mitadCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\");\n                // return;\n            break;\n            case 9:\n                global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\"); \n                // return;\n            break; \n            case 20:\n                global.set(\"PiletaR\", msg.arrayOfValues[0]);\n                global.set(\"PiletaG\", msg.arrayOfValues[1]);\n                global.set(\"PiletaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"Pileta\"); \n                // return;            \n            break;          \n        }  \n        return;\n        // break;  \n\n      case 18:\n        global.set(\"itemPotencia\", msg.payload);\n        // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n          context.item = parseInt(msg.payload);\n          node.status({text: context.item + \" - \" + msg.payload});\n          switch(parseInt(msg.payload)){\n              case 1:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n              break;\n              case 2:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n              break;\n              case 3:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n              break;\n              case 4:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Led Living\", payload: global.get(\"ledLiving\")};\n              break;\n              case 5:\n                  msg = {pin: 21, label: \"Luz Casc\", payload: global.get(\"estLuzCascada\")}; node.send([null, msg]);\n                  msg = {pin: 21, label: \"Patio Luz\", payload: global.get(\"estPalioLuz\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 70, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n              break; \n              case 6:\n                  msg = {pin: 21, label: \"Bomba Cascada\", payload: global.get(\"bombaCascada\")}; node.send([null, msg]);\n              break;               \n              case 7:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Cascada Completa\", payload: global.get(\"ledTopeCascada\")};\n              break;              \n              case 8:\n                  msg = {pin: 21, label: \"Top Casc\", payload: global.get(\"estTopeCascada\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Top Casc\", payload: global.get(\"modoLed3Cascada\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 0, max: 255, label: \"Tope Cascada\", payload: global.get(\"ledTopeCascada\")}; node.send([null, msg]);\n                //   return;\n              break; \n              case 9:\n                  msg = {pin: 21, label: \"Mit Casc\", payload: global.get(\"estMitadCascada\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Mit Casc\", payload: global.get(\"modoLed1Cascada\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 0, max: 255, label: \"Mitad Cascada\", payload: global.get(\"ledMitadCascada\")}; node.send([null, msg]);\n                //   return;\n              break; \n              case 10:\n                  msg = {pin: 21, label: \"Pil Casc\", payload: global.get(\"estPiletaCascada\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Pil Casc\", payload: global.get(\"modoLed2Cascada\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 0, max: 255, label: \"Pileta Cascada\", payload: global.get(\"ledPiletaCascada\")}; node.send([null, msg]);\n                //   return;\n              break;         \n              case 11:\n                  msg = {pin: 19, min: 1, max: 100, label: \"Luz Bano\", payload: global.get(\"pwmLuzBano\")};\n              break;\n              case 12:\n                  msg = {pin: 19, min: 1, max: 100, label: \"Luz Espejo Bano\", payload: global.get(\"pwmLuzEspejo\")};\n              break;         \n              case 13:\n                  msg = {pin: 21, label: \"Escaleras\", payload: global.get(\"estEscaleras\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Pot Escaleras\", payload: global.get(\"pwmEscaleras\")};\n              break;     \n              case 14:\n                  msg = {pin: 21, label: \"Refl Perg\", payload: global.get(\"estReflectorPergola\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Ref Pergola\", payload: global.get(\"pwmReflectorPergola\")};\n              break;                \n              case 15:\n                  msg = {pin: 21, label: \"Luces Perg\", payload: global.get(\"estLucesPergola\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Luces Pergola\", payload: global.get(\"pwmLucesPergola\")};\n              break;  \n              case 16:\n                  msg = {pin: 21, label: \"Luces Pasada Auto\", payload: global.get(\"estLucesPasadaAuto\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Luces Pas Auto\", payload: global.get(\"pwmLucesPasadaAuto\")};\n              break;        \n              case 17:\n                  msg = {pin: 19, min: 0, max: 100, label: \"Potencia Porche\", payload: global.get(\"pwmPorche\")};\n                  msg = {pin: 21, label: \"Luz Porche\", payload: global.get(\"estLuzPorche\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Potencia Luz Porche\", payload: global.get(\"pwmPorche\")};\n              break;                             \n              case 18:\n                  msg = {pin: 19, min: 0, max: 100, label: \"Potencia Dicroicas Porche\", payload: global.get(\"pwmDicroicasPorche\")};\n                  msg = {pin: 21, label: \"Luz Dicroicas Porche\", payload: global.get(\"estLucesDicroicasPorche\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Potencia Dicroicas Porche\", payload: global.get(\"pwmDicroicasPorche\")};                  \n              break;  \n              case 19:\n                  msg = {pin: 21, label: \"Encendido Caldera\", payload: global.get(\"marchaCaldera\")};                 \n              break; \n              case 20:\n                  msg = {pin: 21, label: \"Luces RGB Pileta\", payload: global.get(\"estLucesRGBPileta\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Luz RGB Pil\", payload: global.get(\"modoLucesRGBPileta\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 255, label: \"Luces RGB Pil\", payload: global.get(\"pwmLucesRGBPileta\")};\n              break;  \n             case 21:\n                  msg = {pin: 21, label: \"Luz Pileta\", payload: global.get(\"estLuzPileta\")}; node.send([null, msg]);\n              break; \n             case 22:\n                  msg = {pin: 21, label: \"Bomba Pileta\", payload: global.get(\"estBombaPileta\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Modo Bomba\", payload: global.get(\"modoBombaPileta\")}; node.send([null, msg]);\n              break;\n              case 23: \n                  msg = {pin: 19, min: 1, max: 30, label: \"Tiempo Regando\", payload: global.get(\"tiempoRiegoFrente\")}; node.send([null, msg]);\n                  if (parseInt(global.get(\"tipoRiego\")) === 1){\n                    msg = {pin: 21, label: \"Riego Frente\", payload: 1}; node.send([null, msg]);\n                    }\n                  if (parseInt(global.get(\"tipoRiego\")) !== 1){\n                    msg = {pin: 21, label: \"Riego Frente\", payload: 0}; node.send([null, msg]);\n                    }                    \n                  msg = {pin: 24, label: \"Modo Riego\", payload: global.get(\"modoRiegoFrente\")}; node.send([null, msg]);\n              break;\n              case 24: \n                  msg = {pin: 19, min: 1, max: 30, label: \"Tiempo Regando\", payload: global.get(\"tiempoRiegoPatio\")}; node.send([null, msg]);\n                  if (parseInt(global.get(\"tipoRiego\")) === 2){\n                    msg = {pin: 21, label: \"Riego Patio\", payload: 1}; node.send([null, msg]);\n                    }\n                  if (parseInt(global.get(\"tipoRiego\")) !== 2){\n                    msg = {pin: 21, label: \"Riego Patio\", payload: 0}; node.send([null, msg]);\n                    }      \n                  msg = {pin: 24, label: \"Modo Riego\", payload: global.get(\"modoRiegoPatio\")}; node.send([null, msg]);\n              break;                                                                                                            \n              case 25: \n                  msg = {pin: 21, label: \"Est Dia\", payload: global.get(\"Dia\")}; node.send([null, msg]);\n              break;                                         \n          }\n          node.send([null, msg]);\n          return;\n        // }\n    //   break;\n\n      case 19:\n        // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n          var valor = parseInt(msg.payload);\n          switch(context.item){\n              case 1:\n                  // if (global.get(\"estLiving\") === 0)return;\n                  global.set(\"potLiving\", valor);\n                  global.set(\"potIsla\", valor);\n                  global.set(\"potCielorrazo\", valor);\n                  global.set(\"ledLiving\", valor);\n                  enviarMQTT(\"living\");\n              break;\n              case 2:\n                  // if (global.get(\"estIsla\") === 0)return;\n                  global.set(\"potIsla\", valor);\n                  enviarMQTT(\"living\");\n              break;\n              case 3:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"potCielorrazo\", valor);\n                  enviarMQTT(\"living\");\n              break;\n              case 4:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"ledLiving\", valor);\n                  global.set(\"IslaR\", valor);\n                  global.set(\"IslaG\", valor);\n                  global.set(\"IslaB\", valor);\n                  msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"living\");\n              break;          \n              case 5:\n                  // if (global.get(\"Dia\") === 1)return;\n                  global.set(\"pwmPatioLuz\", valor);\n                  enviarMQTT(\"patioLuz\");\n                  break;\n              case 7:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"topeCascadaR\", valor);\n                  global.set(\"topeCascadaG\", valor);\n                  global.set(\"topeCascadaB\", valor);\n                  global.set(\"mitadCascadaR\", valor);\n                  global.set(\"mitadCascadaG\", valor);\n                  global.set(\"mitadCascadaB\", valor);\n                  global.set(\"piletaCascadaR\", valor);\n                  global.set(\"piletaCascadaG\", valor);\n                  global.set(\"piletaCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break;               \n              case 8:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"topeCascadaR\", valor);\n                  global.set(\"topeCascadaG\", valor);\n                  global.set(\"topeCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break; \n              case 9:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"mitadCascadaR\", valor);\n                  global.set(\"mitadCascadaG\", valor);\n                  global.set(\"mitadCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break; \n              case 10:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"piletaCascadaR\", valor);\n                  global.set(\"piletaCascadaG\", valor);\n                  global.set(\"piletaCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break;                                   \n              case 11:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmLuzBano\", valor);\n                  enviarMQTT(\"bano\");\n                  break;  \n              case 12:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmLuzEspejo\", valor);\n                  enviarMQTT(\"bano\");\n                  break;                   \n              case 13:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmEscaleras\", valor);\n                  enviarMQTT(\"escaleras\");\n                  break;  \n              case 14:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmReflectorPergola\", valor);\n                  enviarMQTT(\"escaleras\");\n                  break;\n              case 15:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmLucesPergola\", valor);\n                  enviarMQTT(\"escaleras\");\n                  break; \n              case 16:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmLucesPasadaAuto\", valor);\n                  enviarMQTT(\"escaleras\");\n                  break;    \n              case 17:\n                  global.set(\"pwmPorche\", valor);\n                  enviarMQTT(\"porche\");\n                  break;   \n              case 18:\n                  global.set(\"pwmDicroicasPorche\", valor);\n                  enviarMQTT(\"porche\");\n                  break;                                        \n              case 20:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"PiletaR\", valor);\n                  global.set(\"PiletaG\", valor);\n                  global.set(\"PiletaB\", valor);\n                  enviarMQTT(\"Pileta\");\n                  break; \n              case 23: \n                  global.set(\"tiempoRiegoFrente\", valor);\n                  enviarMQTT(\"Lavadero\"); \n                  break;\n              case 24:\n                  global.set(\"tiempoRiegoPatio\", valor);\n                  enviarMQTT(\"Lavadero\"); \n                  break;                                               \n                }  \n              return;\n      case 21:\n      // node.status({text: context.item + \" - \" + msg.payload});\n        switch(context.item){\n          case 5:\n            global.set(\"estPalioLuz\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            break;\n        //   break;//global.get(\"bombaCascada\")\n          case 6:\n            global.set(\"bombaCascada\", msg.payload);\n            mensaje = \"bomba\" + global.get(\"bombaCascada\");\n            msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n            // node.send([msg, null]);\n            envioresguardoCrep = 1;\n            envioresguardo = 1;\n            enviarMQTT();\n            break;\n        //   break;    \n          case 7:\n            global.set(\"estLuzCascada\", msg.payload);\n            global.set(\"estTopeCascada\", msg.payload);\n            global.set(\"estMitadCascada\", msg.payload);\n            global.set(\"estPiletaCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            break;\n        //   break;      \n          case 8:\n            global.set(\"estTopeCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            break;\n        //   break;\n          case 9:\n            global.set(\"estMitadCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            break;\n        //   break;\n          case 10:\n            global.set(\"estPiletaCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            break;\n        //   break;\n          case 13:\n            global.set(\"estEscaleras\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            break;\n          case 14:\n            global.set(\"estReflectorPergola\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            break;     \n          case 15:\n            global.set(\"estLucesPergola\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            break;  \n          case 16:\n            global.set(\"estLucesPasadaAuto\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            break;        \n          case 17:\n            global.set(\"estLuzPorche\", msg.payload);\n            enviarMQTT(\"porche\"); \n            break; \n          case 18:\n            global.set(\"estLucesDicroicasPorche\", msg.payload);\n            enviarMQTT(\"porche\"); \n            break; \n          case 19:\n            global.set(\"marchaCaldera\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            break; \n          case 20:\n            global.set(\"estLucesRGBPileta\", msg.payload);\n            enviarMQTT(\"Pileta\"); \n            break;            \n          case 21:\n            global.set(\"estLuzPileta\", msg.payload);\n            enviarMQTT(\"Pileta\"); \n            return; \n          case 22:\n            global.set(\"estBombaPileta\", msg.payload);\n            enviarMQTT(\"Pileta\"); \n            break;       \n          case 23:\n            if (parseInt(msg.payload) === 1){\n                global.set(\"tipoRiego\", 1); \n                valor  = parseInt(date.getTime());\n                global.set(\"dateRiegoFrente\", valor);\n                }\n            if (parseInt(msg.payload) === 0)global.set(\"tipoRiego\", 0);\n            enviarMQTT(\"Lavadero\"); \n            break;              \n          case 24:\n            if (parseInt(msg.payload) === 1){\n                global.set(\"tipoRiego\", 2);\n                valor  = parseInt(date.getTime());\n                global.set(\"dateRiegoPatio\", valor); \n                }\n            if (parseInt(msg.payload) === 0)global.set(\"tipoRiego\", 0);          \n            enviarMQTT(\"Lavadero\"); \n            break;                                      \n          case 25:\n            global.set(\"Dia\", msg.payload);\n            msg = {topic: \"crepMQTT\", payload: global.get(\"Dia\")};\n            node.send([msg, null]);\n            break;                                                 \n        //   break;      \n        }\n        return;\n      case 24:\n          switch(context.item){\n            case 7:\n              global.set(\"modoLed3Cascada\", msg.payload);\n              enviarMQTT(\"patioLuz\"); \n              break;\n            // break;\n            case 8:\n              global.set(\"modoLed1Cascada\", msg.payload);\n              enviarMQTT(\"patioLuz\"); \n              return;\n            // break;\n            case 9:\n              global.set(\"modoLed2Cascada\", msg.payload);\n              enviarMQTT(\"patioLuz\"); \n              break;\n            case 20:\n              global.set(\"modoLucesRGBPileta\", msg.payload);\n              enviarMQTT(\"Pileta\"); \n              break;   \n            case 23:\n              global.set(\"modoRiegoFrente\", msg.payload);\n              enviarMQTT(\"Lavadero\"); \n              break;  \n            case 24:\n              global.set(\"modoRiegoPatio\", msg.payload);\n              enviarMQTT(\"Lavadero\"); \n              break;                 \n        //   break;\n        //   return;\n        }\n        return;\n    }\n\n    function enviarMQTT(caso){\n\n    var dato;\n\n      if (caso == \"Lavadero\"){\n        msg = {topic: \"ESP/Lavadero/riego\", payload: global.get(\"tipoRiego\")};\n        // return ([msg, null, null]);\n      }\n\n      if (caso == \"bano\"){\n        envioresguardo = 1;\n        dato = \"estado\" + global.get(\"estLuzBano\") + \"#\" + global.get(\"pwmLuzBano\");\n        dato += \"#\" + global.get(\"estLuzEspejo\") + \"#\" + global.get(\"pwmLuzBano\");\n        dato += \"#1\" ;//+ global.get(\"estExtractorBano\");\n        dato += \"#\" + global.get(\"incrementoBaño\");\n        dato += \"#\" + global.get(\"minTeclas\");\n        dato += \"#\" + global.get(\"maxTeclas\");\n        dato += \"#\" + global.get(\"delayBuzzer\");          \n        msg = {topic: \"ESP/Bano/Recibo\", payload: dato};\n      }\n\n    if (caso == \"Pileta\"){\n        envioresguardo = 1;\n        if (parseInt(global.get(\"estLucesRGBPileta\")) === 1){\n           dato = \"estado\" + global.get(\"modoLucesRGBPileta\") + \"#\";\n           dato = dato + global.get(\"PiletaR\") + \"#\";\n           dato = dato + global.get(\"PiletaG\") + \"#\";\n           dato = dato + global.get(\"PiletaB\") + \"#\";}\n        else{  \n            dato = \"estado0#0#0#0#\"; \n           }\n       if (parseInt(global.get(\"estBombaPileta\")) == 1){\n            dato = dato + global.get(\"estBombaPileta\") + \"#\";}\n            else{\n                dato = dato + \"0#\";\n            }\n       if (parseInt(global.get(\"estLuzPileta\")) == 1){\n            dato = dato + global.get(\"estLuzPileta\") + \"#\";}\n            else{\n                dato = dato + \"0#\"\n            }        \n       \n        dato = dato + \"1#10#1#255\";\n        msg = {topic: \"ESP/Pileta/Recibo\", payload: dato}; //node.send([msg, null]);\n        }\n\n    if (caso == \"porche\"){\n        envioresguardo = 1;\n      //estado0#100#1\n      //ESP/Porche/Recibo\n    //   dato = \"estado\" + global.get(\"estLuzPorche\") + \"#\" + global.get(\"pwmPorche\") + \"#\";\n    //   dato = dato + global.get(\"estLucesDicroicasPorche\") + \"#\";\n    //   dato = dato + global.get(\"pwmDicroicasPorche\") + \"#\";\n    //   msg = {topic: \"ESP/Porche/BackUp\", payload: dato}; node.send([msg, null]);\n\n      if (parseInt(global.get(\"estLuzPorche\")) === 1){\n         dato = \"estado\" + global.get(\"pwmPorche\") + \"#\";\n         dato = dato + global.get(\"pwmDicroicasPorche\") + \"#1\";}\n      if (parseInt(global.get(\"estLuzPorche\")) === 0){dato = \"estado0#0#1\"}         \n      msg = {topic: \"ESP/Porche/Recibo\", payload: dato};\n    }\n\n    if (caso == \"escaleras\"){\n        envioresguardo = 1;\n\n        // dato = \"estado\" + global.get(\"pwmReflectorPergola\") + \"#\";\n        // dato = dato + global.get(\"pwmEscaleras\") + \"#\";\n        // dato = dato + global.get(\"pwmLucesPergola\") + \"#\";\n        // dato = dato + global.get(\"pwmLucesPasadaAuto\");\n        // msg = {topic: \"ESP/Escaleras/BackUp\", payload: dato}; node.send([msg, null]);\n\n        if (parseInt(global.get(\"estReflectorPergola\")) === 1){\n        dato = \"estado\" + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estReflectorPergola\")) === 0){\n        dato = \"estado0\";//#0#0#0#0#0#1\";\n        }\n        dato = dato + \"#\";\n        if (parseInt(global.get(\"estEscaleras\")) === 1){\n        // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n        dato = dato + global.get(\"pwmEscaleras\");\n        // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estEscaleras\")) === 0){\n        dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n        }    \n        dato = dato + \"#\";\n        if (parseInt(global.get(\"estLucesPergola\")) === 1){\n        // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n        dato = dato + global.get(\"pwmLucesPergola\");\n        // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estLucesPergola\")) === 0){\n        dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n        }   \n        dato = dato + \"#\";\n        if (parseInt(global.get(\"estLucesPasadaAuto\")) === 1){\n        // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n        dato = dato + global.get(\"pwmLucesPasadaAuto\");\n        // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estLucesPasadaAuto\")) === 0){\n        dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n        } \n        dato = dato + \"#1\";                \n        //estado10#0#0#0#0#0#1\n        if (dato.includes(\"desconectado\")) return;\n        msg = {topic: \"ESP/Escaleras/Recibo\", payload: dato};\n    }  \n\n    if (caso == \"patioLuz\"){\n        envioresguardo = 1;\n        var mensaje;\n\n        // mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\";\n        // mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n        // mensaje = mensaje + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n        // mensaje = mensaje + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n        // mensaje = mensaje + global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\n        // msg = {topic: \"PatioLuz/BackUp\", payload: mensaje}; node.send([msg, null]);\n\n        if (parseInt(global.get(\"estMitadCascada\")) === 0){\n          mensaje = \"estado0#0#0#0#\";\n        }\n          else{\n            mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\";\n          }\n\n        if (parseInt(global.get(\"estPalioLuz\")) === 0){\n          mensaje = mensaje + \"0#0#\";\n        }\n          else{\n            mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n          }      \n\n        // mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n\n        if (parseInt(global.get(\"estPiletaCascada\")) === 0){\n          mensaje = mensaje + \"0#0#0#0#\";\n        }\n          else{\n             mensaje = mensaje + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n          }\n\n        if (parseInt(global.get(\"estTopeCascada\")) === 0){\n          mensaje = mensaje + \"0#0#0#0#\";\n        }\n          else{\n             mensaje = mensaje + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n          }\n\n        mensaje = mensaje + global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\n\n        // if (parseInt(global.get(\"Dia\")) === 1){\n        //     msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#0#0#0#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\") + \"#\" + global.get(\"maxAuto\")};\n        //   } \n        //   else{   \n        //     msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n        //   }\n        if (mensaje.includes(\"desconectado\")) return;\n        msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n\n        //1#1023#32#118#118#118#0#1#1#undefined#45#45#45#0#181\n      }\n      \n\n      if (caso == \"living\"){\n        envioresguardo = 1;\n        dato = global.get(\"estIsla\") + \",\";\n        dato += global.get(\"potIsla\") + \"#\";\n        dato += global.get(\"estCielorrazo\") + \",\";\n        dato += global.get(\"potCielorrazo\") + \"#\";  \n        dato += global.get(\"estIslaRGB\") + \",\";\n        dato += global.get(\"IslaR\") + \",\";\n        dato += global.get(\"IslaG\") + \",\";      \n        dato += global.get(\"IslaB\") + \"#\";\n\n        dato += global.get(\"pwmMaxLed\") + \"#\";\n        dato += global.get(\"pwmMinLed\") + \"#\";\n\n        dato += global.get(\"minTeclas\") + \"#\";\n        dato += global.get(\"maxTeclas\") + \"#\";\n        dato += global.get(\"doblePuls\");\n        dato += \"#\" + global.get(\"Dia\");\n\n        msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n        // node.send([msg, null]);\n      }\n      if (caso == \"configGenericas\"){\n        dato = global.get(\"minTeclas\") + \"#\";\n        dato += global.get(\"maxTeclas\") + \"#\";\n        dato += global.get(\"delayBuzzer\");\n        msg = {topic: \"configTeclas\", payload: dato};\n      }\n    // node.send([msg, null]);\n\n    if (caso == \"termoSolar\"){\n        envioresguardo = 1;\n        payload = global.get(\"autoBomba\");\n        payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; \n        payload += global.get(\"tempMaximaTermo\") + \"#\";\n        payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n        msg.payload = payload;  \n        msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; //node.send([msg, null, null]);\n    }\n\n    if (caso != \"resguardo\")node.send([msg, null, null]);\n\n    if (parseInt(envioresguardo) == 1 && parseInt(envioresguardoCrep) == 1){\n        dato = global.get(\"estLuzBano\");\n        dato += \"#\" + global.get(\"pwmLuzBano\");\n        dato += \"#\" + global.get(\"estLuzEspejo\"); \n        dato += \"#\" + global.get(\"pwmLuzEspejo\");\n\n        dato += \"#\" + global.get(\"estLucesRGBPileta\");\n        dato += \"#\" + global.get(\"modoLucesRGBPileta\");\n        dato += \"#\" + global.get(\"PiletaR\");\n        dato += \"#\" + global.get(\"PiletaG\");\n        dato += \"#\" + global.get(\"PiletaB\");\n        dato += \"#\" + global.get(\"estLuzPileta\");\n        dato += \"#\" + global.get(\"estBombaPileta\");\n\n        dato += \"#\" + global.get(\"estLuzPorche\");\n        dato += \"#\" + global.get(\"pwmPorche\");\n        dato += \"#\" + global.get(\"estLucesDicroicasPorche\");\n        dato += \"#\" + global.get(\"pwmDicroicasPorche\");    \n\n        dato += \"#\" + global.get(\"pwmReflectorPergola\");\n        dato += \"#\" + global.get(\"pwmEscaleras\");\n        dato += \"#\" + global.get(\"pwmLucesPergola\");\n        dato += \"#\" + global.get(\"pwmLucesPasadaAuto\");\n\n        dato += \"#\" + global.get(\"bombaCascada\");\n        dato += \"#\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\");\n        dato += \"#\" + global.get(\"pwmPatioLuz\") + \"#0\"\n        dato += \"#\" + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\");\n        dato += \"#\" + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\");\n        dato += \"#\" + global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\n\n        dato += \"#\" + global.get(\"estIsla\") + \"#\" + global.get(\"potIsla\") + \"#\" + global.get(\"estCielorrazo\") + \"#\" + global.get(\"potCielorrazo\");\n        dato += \"#\" + global.get(\"estIslaRGB\") + \"#\" + global.get(\"IslaR\") + \"#\" + global.get(\"IslaG\") + \"#\" + global.get(\"IslaB\");\n\n        dato += \"#\" + global.get(\"autoBomba\") + \"#\" + global.get(\"pedBomba\") + \"#\" + global.get(\"pedResistencia\") + \"#\" + global.get(\"tempMaximaTermo\");\n        //dato += \"#\" + global.get(\"valorDia\")  + \"#\" + global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n\n        msg = {payload: dato}; node.send([null, null, msg]);\n    }\n       \n\n    // function enviarMQTT(){   \n    //     payload = global.get(\"autoBomba\");\n    //     // payload =\"0\";    \n    //     //payload += \"#\"; payload += global.get(\"autoResistencia\") + \"#\"; payload += global.get(\"autoToldo\") + \"#\"; \n    //     payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; //payload += global.get(\"pedToldo\") + \"#\"; \n    //     payload += global.get(\"tempMaximaTermo\");// + \"#\"; payload += global.get(\"tempMaxResistencia\") + \"#\"; \n    //     //payload += global.get(\"tempMaxResistenciaManual\") + \"#\"; payload += global.get(\"tempMinimaResistencia\") + \"#\";\n    //     payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n    //     // payload += \"#\" + global.get(\"offsetDia\")  + \"#\"; payload += global.get(\"offsetNoche\");\n    //     msg.payload = payload;  \n    //     msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([null, msg, null]);\n    // }    \n}\n",
        "outputs": 3,
        "noerr": 0,
        "x": 484,
        "y": 534,
        "wires": [
            [
                "e2ad3d73.1ffd8",
                "b58c2246.7ef8c"
            ],
            [
                "e5d9a366.0b565",
                "d07ce15.d99f32",
                "108e63f1.90676c"
            ],
            [
                "136a4379.5c005d",
                "52206e37.320fc"
            ]
        ]
    },
    {
        "id": "b58c2246.7ef8c",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 702,
        "y": 433,
        "wires": []
    },
    {
        "id": "e2ad3d73.1ffd8",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 701,
        "y": 397,
        "wires": []
    },
    {
        "id": "d07ce15.d99f32",
        "type": "delay",
        "z": "9c63fd61.9908c",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 710,
        "y": 527,
        "wires": [
            [
                "90394f1b.d19f2"
            ]
        ]
    },
    {
        "id": "108e63f1.90676c",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 774,
        "y": 569,
        "wires": []
    },
    {
        "id": "dd0cb6bb.9aa798",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "10",
        "payloadType": "str",
        "x": 450,
        "y": 200,
        "wires": [
            [
                "1f6abca5.9f5c93",
                "87853982.f1a118",
                "3a72cff0.eed6e",
                "9a21c2fc.4e802"
            ]
        ]
    },
    {
        "id": "1f6abca5.9f5c93",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "pwmMinLed",
        "func": "global.set(\"pwmMinLed\", 10);\nnode.status({text: global.get(\"pwmMinLed\")})\n",
        "outputs": 1,
        "noerr": 0,
        "x": 630,
        "y": 190,
        "wires": [
            []
        ]
    },
    {
        "id": "3a72cff0.eed6e",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "pwmMaxLed",
        "func": "global.set(\"pwmMaxLed\", 200);\nnode.status({text: global.get(\"pwmMaxLed\")})",
        "outputs": 1,
        "noerr": 0,
        "x": 630,
        "y": 230,
        "wires": [
            []
        ]
    },
    {
        "id": "4f784ad5.70ddb4",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Bano/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 280,
        "y": 90,
        "wires": [
            [
                "17a5f10e.b3b96f"
            ]
        ]
    },
    {
        "id": "a09215ab.90c218",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/living/Iluminacion/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 240,
        "y": 130,
        "wires": [
            [
                "17a5f10e.b3b96f"
            ]
        ]
    },
    {
        "id": "31d203bd.3e842c",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Lavadero/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 270,
        "y": 170,
        "wires": [
            [
                "17a5f10e.b3b96f"
            ]
        ]
    },
    {
        "id": "17a5f10e.b3b96f",
        "type": "link out",
        "z": "9c63fd61.9908c",
        "name": "configTeclas",
        "links": [
            "75cc688a.19a5e8",
            "a7eebb16.de23f8"
        ],
        "x": 425,
        "y": 150,
        "wires": []
    },
    {
        "id": "511c78ef.861648",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 444.44444274902344,
        "y": 321.1111125946045,
        "wires": []
    },
    {
        "id": "87853982.f1a118",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "delayBuzzer",
        "func": "global.set(\"delayBuzzer\", 60);\nnode.status({text: global.get(\"delayBuzzer\")});\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "x": 630,
        "y": 150,
        "wires": [
            []
        ]
    },
    {
        "id": "51598710.300088",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "var dato = global.get(\"minTeclas\") + \"#\";\ndato += global.get(\"maxTeclas\") + \"#\";\ndato += global.get(\"delayBuzzer\");\nmsg = {topic: \"configTeclas\", payload: dato};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 770,
        "y": 110,
        "wires": [
            [
                "b68c66c0.ead9f8"
            ]
        ]
    },
    {
        "id": "b68c66c0.ead9f8",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 900,
        "y": 110,
        "wires": []
    },
    {
        "id": "9a21c2fc.4e802",
        "type": "delay",
        "z": "9c63fd61.9908c",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 620,
        "y": 110,
        "wires": [
            [
                "51598710.300088"
            ]
        ]
    },
    {
        "id": "a7eebb16.de23f8",
        "type": "link in",
        "z": "9c63fd61.9908c",
        "name": "",
        "links": [
            "17a5f10e.b3b96f"
        ],
        "x": 465,
        "y": 150,
        "wires": [
            [
                "9a21c2fc.4e802"
            ]
        ]
    },
    {
        "id": "1718f5e3.66efaa",
        "type": "mqtt out",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "",
        "broker": "6b36e4a.1d30b1c",
        "x": 874,
        "y": 318,
        "wires": []
    },
    {
        "id": "5b6fe88e.ff3eb8",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/living/Iluminacion/Envio",
        "qos": "2",
        "broker": "6b36e4a.1d30b1c",
        "x": 340,
        "y": 300,
        "wires": [
            [
                "975ffbce.bc05a8",
                "8292bd95.41ac2"
            ]
        ]
    },
    {
        "id": "747a877e.d86508",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/living/Iluminacion/Inicio",
        "qos": "2",
        "broker": "6b36e4a.1d30b1c",
        "x": 340,
        "y": 180,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "f5bf1a9b.495cb8",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "google/Living",
        "qos": "2",
        "broker": "6b36e4a.1d30b1c",
        "x": 390,
        "y": 260,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "fa93d2f6.b18bc",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "aviso/Alarma",
        "qos": "2",
        "broker": "6b36e4a.1d30b1c",
        "x": 385.00000762939453,
        "y": 140.75000190734863,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "79aec6ed.8a6388",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 800,
        "y": 440,
        "wires": []
    },
    {
        "id": "86d15980.93d188",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "crepMQTT",
        "qos": "2",
        "broker": "6b36e4a.1d30b1c",
        "x": 240,
        "y": 220,
        "wires": [
            [
                "322edf46.e112c"
            ]
        ]
    },
    {
        "id": "f6a7289e.12d9f8",
        "type": "delay",
        "z": "a89e305a.c50bb",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 803.0952224731445,
        "y": 395.2142400741577,
        "wires": [
            [
                "c8224508.e2da48"
            ]
        ]
    },
    {
        "id": "975ffbce.bc05a8",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "recibo2",
        "func": " var timerLuces = 12000;\nif (global.get(\"estLiving\") === undefined)global.set(\"estLiving\", 0);\nif (global.get(\"estIsla\") === undefined)global.set(\"estIsla\", 0);\nif (global.get(\"estCielorrazo\") === undefined)global.set(\"estCielorrazo\", 0);\nif (global.get(\"potLiving\") === undefined)global.set(\"potLiving\", 0);\nif (global.get(\"estIslaRGB\") === undefined)global.set(\"estIslaRGB\", 0);\nif (global.get(\"potIsla\") === undefined)global.set(\"potIsla\", 255);\nif (global.get(\"potCielorrazo\") === undefined)global.set(\"potCielorrazo\", 128);\nif (global.get(\"IslaR\") === undefined)global.set(\"IslaR\", 255);\nif (global.get(\"IslaG\") === undefined)global.set(\"IslaG\", 255);\nif (global.get(\"IslaB\") === undefined)global.set(\"IslaB\", 255);\n\nif (global.get(\"dimmerLeds\") === undefined)global.set(\"dimmerLeds\", 200);\nif (global.get(\"minTeclas\") === undefined)global.set(\"minTeclas\", 100);\nif (global.get(\"maxTeclas\") === undefined)global.set(\"maxTeclas\", 600);\nif (global.get(\"doblePuls\") === undefined)global.set(\"doblePuls\", 1);\nif (global.get(\"fallasLivingIluminacion\") === undefined)global.set(\"fallasLivingIluminacion\", 0);\nif (global.get(\"pwmPatioLuz\") === undefined)global.set(\"pwmPatioLuz\", 33);\ncontext.item = context.item || 0;\nvar pin = parseInt(msg.pin);\nvar topic = msg.topic;\nvar payload = parseInt(msg.payload);\nvar dato;\n\nif (topic == \"ESP/living/Iluminacion/Inicio\"){  \n    var fallasLivingIluminacion = global.get(\"fallasLivingIluminacion\") + 1;\n    global.set(\"fallasLivingIluminacion\", fallasLivingIluminacion);\n    global.set(\"tipoFallaIlLiving\", payload); msg = {topic: \"fallas_MQTT\", payload: 1}; node.send([msg, null]);\n    enviarMQTT();\n    return;\n}\n\nif (topic == \"aviso/Alarma\"){\n    if (global.get(\"estadoAlarma\") === 0 && global.get(\"Dia\") === 0){\n    msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")}; node.send([msg, null]);\n    global.set(\"estLiving\", 1); \n    global.set(\"estIsla\", 1); \n    global.set(\"estCielorrazo\", 1); \n    global.set(\"estIslaRGB\", 1);\n    enviarMQTT();\n    return;\n    }\n    if (global.get(\"estadoAlarma\") === 1 && global.get(\"estLiving\") === 1){setTimeout(apagadoLuces, timerLuces);}\n    if (global.get(\"estadoAlarma\") === 1 && global.get(\"Dia\") === 1){\n        // msg = {topic: \"USBout\", payload: \"Dia\"}; node.send([msg, null]);\n        apagadoLuces();}\n}\n\nif (topic == \"crepMQTT\"){\n    if (global.get(\"Dia\") === 1) {msg = {topic: \"USBout\", payload: \"Dia\"}; node.send([msg, null]);}\n    if (global.get(\"Dia\") === 0) {msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")}; node.send([msg, null]);}    \n    // if (global.get(\"Dia\") === 0 && global.get(\"estadoAlarma\") === 0) {msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")}; node.send([msg, null]);}\n    // enviarMQTT();\n}\n\nif (topic == \"google/Living\") {enviarMQTT(); return;}\n\nif (topic == \"ESP/living/Iluminacion/Envio\" && !topic.includes(\"Recibo de ESP\")){\n    dato = msg.payload.split(\"#\");\n    global.set(\"estIsla\", dato[0]); \n    global.set(\"estCielorrazo\", dato[1]); \n    global.set(\"estIslaRGB\", dato[2]); \n    enviarMQTT();\n    return;\n}\n\nswitch (pin){\n\n  case 8:\n    global.set(\"IslaR\", msg.arrayOfValues[0]);\n    global.set(\"IslaG\", msg.arrayOfValues[1]);\n    global.set(\"IslaB\", msg.arrayOfValues[2]);\n    msg = {pin: 32, payload: \"12\"}; node.send([null, msg]);\n    global.set(\"estIslaRGB\", 1);\n    enviarMQTT();\n  break;\n\n  case 14:\n    global.set(\"estLiving\", payload);  \n    global.set(\"estIsla\", payload);\n    global.set(\"estCielorrazo\", payload);\n    global.set(\"estIslaRGB\", payload);\n    enviarMQTT();\n  break;\n\n  case 16:\n    global.set(\"estIsla\", payload);\n    enviarMQTT();\n  break;\n\n  case 17:\n    global.set(\"estCielorrazo\", payload); \n    enviarMQTT();\n  break;\n\n  case 20: \n    if (msg.payload == \"1\"){ \n        dato = \"1,0#1,0#1,50,50,50,#\";\n        dato += global.get(\"pwmMaxLed\") + \"#\";\n        dato += global.get(\"pwmMinLed\") + \"#\";\n        // dato += global.get(\"dimmerLeds\") + \"#\";\n\n        dato += global.get(\"minTeclas\") + \"#\";\n        dato += global.get(\"maxTeclas\") + \"#\";\n        dato += global.get(\"doblePuls\");\n        dato += \"#\" + global.get(\"Dia\");\n        //  msg = {topic: \"ESP/living/Iluminacion/Recibo2\", payload: topicNuevo + \"&\" + global.get(\"estadoAlarma\") + \"&\" + global.get(\"Dia\") + \"\\n\" + dato};    node.send([msg, null]);\n        msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n        node.send([msg, null]); \n        return;  \n    }\n    if (msg.payload == \"0\") enviarMQTT();\n  break;\n\n  case 29:\n    global.set(\"estIslaRGB\", payload); \n    enviarMQTT();\n  break;\n\n  // case 18:\n  //   global.set(\"itemPotencia\", msg.payload);\n  //   if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 4){\n  //     context.item = parseInt(msg.payload);\n  //     switch(parseInt(msg.payload)){\n  //         case 1:\n  //             msg = {pin: 19, min: 4, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n  //         break;\n  //         case 2:\n  //             msg = {pin: 19, min: 4, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n  //         break;\n  //         case 3:\n  //             msg = {pin: 19, min: 4, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n  //         break;\n  //         case 4:\n  //             msg = {pin: 19, min: 1, max: 100, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n  //         break;\n  //         case 5:\n  //             msg = {pin: 19, min: 1, max: 254, label: \"Ducha de baño\", payload: global.get(\"pwmDucha\")};\n  //         break;          \n  //     }\n  //     node.send([null, msg]);\n  //   }\n  // break;\n\n  // case 19:\n  //   if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 4){\n  //     var valor = parseInt(msg.payload);\n  //     switch(context.item){\n  //         case 1:\n  //             if (global.get(\"estLiving\") === 0)return;\n  //             global.set(\"potLiving\", valor);\n  //             global.set(\"potIsla\", valor);\n  //             global.set(\"potCielorrazo\", valor);\n  //         break;\n  //         case 2:\n  //             if (global.get(\"estIsla\") === 0)return;\n  //             global.set(\"potIsla\", valor);\n  //         break;\n  //         case 3:\n  //             if (global.get(\"estCielorrazo\") === 0)return;\n  //             global.set(\"potCielorrazo\", valor);\n  //         break;\n  //         case 4:\n  //             if (global.get(\"Dia\") === 1)return;\n  //             global.set(\"pwmPatioLuz\", valor);\n  //             msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")}; node.send([msg, null]); return;\n  //         break;\n  //         case 5:\n  //             global.set(\"pwmDucha\", valor);\n  //             var dato = global.get(\"modoDucha\") + \"#\" + global.get(\"pedidoDucha\") + \"#\" + global.get(\"pwmDucha\");\n  //             msg = {topic: \"ESP/Bano/Recibo\", payload: dato}; node.send([msg, null]); return;\n  //         break;          \n  //     }\n  //     enviarMQTT();\n  //   }\n  break;\n}\nreturn;\n\nfunction apagadoLuces(){\n    // msg = {topic: \"USBout\", payload: \"Dia\"}; node.send([msg, null]);\n    global.set(\"estLiving\", 0);\n    global.set(\"estIsla\", 0); \n    global.set(\"estCielorrazo\", 0); \n    global.set(\"estIslaRGB\", 0);\n    msg.topic = \"apagadoAuto\";\n    enviarMQTT();\n}\n\nfunction enviarMQTT(){\n    var topicNuevo = msg.topic;\n    if (global.get(\"estLiving\") == \"0\"){\n      msg = {pin: 20, payload: 0}; node.send([null, msg]);\n    }\n    //msg = {pin: 127, payload: global.get(\"hsCpu\") + \", top: \" + topicNuevo + \", D:\" + global.get(\"Dia\") + \", Al:\" + global.get(\"estadoAlarma\") + \"\\n\"}; node.send([null, msg]);\n    // if (global.get(\"estIsla\") === 0 && global.get(\"estCielorrazo\") === 0 && global.get(\"estIslaRGB\") === 0)global.set(\"estLiving\", 0);\n    // if (global.get(\"estIsla\") === 1 || global.get(\"estCielorrazo\") === 1){\n    //     if(topic !== \"Blink/estLiving\" && topicNuevo !== \"fallas_MQTT\")\n    //       if (payload !== 0) global.set(\"estLiving\", 1);\n    //     }\n    // if (topicNuevo !== \"fallas_MQTT\"){\n    msg = {pin: 14, payload: global.get(\"estLiving\")}; node.send([null, msg]);\n    msg = {pin: 16, payload: global.get(\"estIsla\")}; node.send([null, msg]);\n    msg = {pin: 17, payload: global.get(\"estCielorrazo\")}; node.send([null, msg]);\n    msg = {pin: 29, payload: global.get(\"estIslaRGB\")}; node.send([null, msg]);//}\n    if(topicNuevo == \"ESP/living/Iluminacion/Envio\")return;\n    \n    // if (parseInt(global.get(\"estLiving\")) === 0) {\n    //         msg = {pin: 16, payload: \"0\"}; node.send([null, msg]);\n    //         dato = \"0,\"}\n    //     else{\n    //         dato = global.get(\"estIsla\") + \",\";}\n    // dato += global.get(\"potIsla\") + \"#\";\n\n    // if (parseInt(global.get(\"estLiving\")) === 0) {\n    //         msg = {pin: 17, payload: \"0\"}; node.send([null, msg]);\n    //         dato += \"0,\"}\n    //     else{\n    //         dato += global.get(\"estCielorrazo\") + \",\";}\n\n    dato = global.get(\"estIsla\") + \",\";\n    dato += global.get(\"potIsla\") + \"#\";\n    dato += global.get(\"estCielorrazo\") + \",\";\n    dato += global.get(\"potCielorrazo\") + \"#\";  \n    dato += global.get(\"estIslaRGB\") + \",\";\n    dato += global.get(\"IslaR\") + \",\";\n    dato += global.get(\"IslaG\") + \",\";      \n    dato += global.get(\"IslaB\") + \"#\";\n\n  dato += global.get(\"pwmMaxLed\") + \"#\";\n  dato += global.get(\"pwmMinLed\") + \"#\";\n    // dato += global.get(\"dimmerLeds\") + \"#\";\n\n    dato += global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"doblePuls\");\n    dato += \"#\" + global.get(\"Dia\");\n    if (topicNuevo == \"crepMQTT\")dato += \"#\";\n\n//  msg = {topic: \"ESP/living/Iluminacion/Recibo2\", payload: topicNuevo + \"&\" + global.get(\"estadoAlarma\") + \"&\" + global.get(\"Dia\") + \"\\n\" + dato};    node.send([msg, null]);\n    msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n    node.send([msg, null]);     \n}",
        "outputs": 2,
        "noerr": 0,
        "x": 648.952392578125,
        "y": 353.7856750488281,
        "wires": [
            [
                "7d51b41e.96593c",
                "aa2ebf44.36aa7",
                "1718f5e3.66efaa"
            ],
            [
                "f6a7289e.12d9f8",
                "706c129.8f43aec",
                "79aec6ed.8a6388"
            ]
        ]
    },
    {
        "id": "678cccf.f9e5b34",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "Pedido/Living/Iluminacion",
        "payload": "",
        "payloadType": "date",
        "x": 400,
        "y": 100,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "322edf46.e112c",
        "type": "delay",
        "z": "a89e305a.c50bb",
        "name": "",
        "pauseType": "delay",
        "timeout": "20",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 390,
        "y": 220,
        "wires": [
            [
                "975ffbce.bc05a8",
                "963b6ab2.6d64f8"
            ]
        ]
    },
    {
        "id": "3c32c6d4.e47bba",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "Debug esp",
        "topic": "Debug/ESP/Living/Iluminacion",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 780,
        "y": 90,
        "wires": [
            [
                "a3849db1.0b9f9"
            ]
        ]
    },
    {
        "id": "a3849db1.0b9f9",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 940,
        "y": 90,
        "wires": []
    },
    {
        "id": "4dba27a4.caac38",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "recibo2a",
        "func": " var timerLuces = 12000;\nif (global.get(\"estLiving\") === undefined)global.set(\"estLiving\", 0);\nif (global.get(\"estIsla\") === undefined)global.set(\"estIsla\", 0);\nif (global.get(\"estCielorrazo\") === undefined)global.set(\"estCielorrazo\", 0);\nif (global.get(\"potLiving\") === undefined)global.set(\"potLiving\", 0);\nif (global.get(\"estIslaRGB\") === undefined)global.set(\"estIslaRGB\", 0);\nif (global.get(\"potIsla\") === undefined)global.set(\"potIsla\", 255);\nif (global.get(\"potCielorrazo\") === undefined)global.set(\"potCielorrazo\", 128);\nif (global.get(\"IslaR\") === undefined)global.set(\"IslaR\", 255);\nif (global.get(\"IslaG\") === undefined)global.set(\"IslaG\", 255);\nif (global.get(\"IslaB\") === undefined)global.set(\"IslaB\", 255);\n\nif (global.get(\"pwmMinLed\") === undefined)global.set(\"pwmMinLed\", 20);\nif (global.get(\"pwmMaxLed\") === undefined)global.set(\"pwmMaxLed\", 255);\n\nif (global.get(\"dimmerLeds\") === undefined)global.set(\"dimmerLeds\", 200);\nif (global.get(\"minTeclas\") === undefined)global.set(\"minTeclas\", 15);\nif (global.get(\"maxTeclas\") === undefined)global.set(\"maxTeclas\", 600);\nif (global.get(\"doblePuls\") === undefined)global.set(\"doblePuls\", 1);\nif (global.get(\"fallasLivingIluminacion\") === undefined)global.set(\"fallasLivingIluminacion\", 0);\nif (global.get(\"pwmPatioLuz\") === undefined)global.set(\"pwmPatioLuz\", 33);\ncontext.item = context.item || 0;\n\nvar topic = msg.topic;\nvar payload = parseInt(msg.payload);\n// msg = {topic: \" \", payload: topic}; node.send(msg);\nvar dato;\n// if (global.get(\"Dia\") === 1)global.set(\"dimmerLeds\", 200);\n// if (global.get(\"Dia\") === 0)global.set(\"dimmerLeds\", 50);\n\nif (topic == \"Pedido/Living/Iluminacion\"){  \n    var fallasLivingIluminacion = global.get(\"fallasLivingIluminacion\") + 1;\n    global.set(\"fallasLivingIluminacion\", fallasLivingIluminacion);\n    global.set(\"tipoFallaIlLiving\", payload); msg = {topic: \"fallas_MQTT\", payload: 1}; node.send([msg, null]);\n    enviarMQTT();\n//  msg = {topic: \"minTeclas\", payload: global.get(\"minTeclas\")}; node.send(msg);\n//     msg = {topic: \"maxTeclas\", payload: global.get(\"maxTeclas\")}; node.send(msg);\n    return;\n}\n\nif (topic == \"aviso/Alarma\"){\n    if (global.get(\"estadoAlarma\") === 0 && global.get(\"Dia\") === 0){\n    msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")}; node.send([msg, null]);\n    global.set(\"estLiving\", 1); \n    global.set(\"estIslaRGB\", 1);\n    enviarMQTT();\n    return;\n    }\n    if (global.get(\"estadoAlarma\") === 1 && global.get(\"estLiving\") === 1){setTimeout(apagadoLuces, timerLuces);}\n    if (global.get(\"estadoAlarma\") === 1 && global.get(\"Dia\") === 1){\n        // msg = {topic: \"USBout\", payload: \"Dia\"}; node.send([msg, null]);\n        apagadoLuces();}\n    }\n\n\nif (topic == \"crepMQTT\"){\n    if (global.get(\"Dia\") === 1) {msg = {topic: \"USBout\", payload: \"Dia\"}; node.send([msg, null]);}\n    if (global.get(\"Dia\") === 0) {msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")}; node.send([msg, null]);}\n    // enviarMQTT();\n}\n\n\nif (topic == \"google/Living\") {enviarMQTT(); return;}\n\nif (topic == \"ESP/living/Iluminacion/Envio\" && !topic.includes(\"Recibo de ESP\")){\n    dato = payload.split(\"#\");\n    global.set(\"estIsla\", dato[0]); \n    global.set(\"estCielorrazo\", dato[1]); \n    global.set(\"estIslaRGB\", dato[2]); \n    enviarMQTT();\n    return;\n}\n\nif (topic == \"Blink/potItem\"){\n    context.item = parseInt(msg.payload);\n    switch(parseInt(msg.payload)){\n        case 1:\n            msg = {pin: 19, min: 4, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n        break;\n        case 2:\n            msg = {pin: 19, min: 4, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n        break;\n        case 3:\n            msg = {pin: 19, min: 4, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n        break;\n        case 4:\n            msg = {pin: 19, min: 1, max: 100, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n        break;\n    }\n    node.send([null, msg]);\n}\n\nif (topic == \"Blink/potencia\"){\n    var valor = parseInt(msg.payload);\n    switch(context.item){\n        case 1:\n            if (global.get(\"estLiving\") === 0)return;\n            global.set(\"potLiving\", valor);\n            global.set(\"potIsla\", valor);\n            global.set(\"potCielorrazo\", valor);\n        break;\n        case 2:\n            if (global.get(\"estIsla\") === 0)return;\n            global.set(\"potIsla\", valor);\n        break;\n        case 3:\n            if (global.get(\"estCielorrazo\") === 0)return;\n            global.set(\"potCielorrazo\", valor);\n        break;\n        case 4:\n            if (global.get(\"Dia\") === 1)return;\n            global.set(\"pwmPatioLuz\", valor);\n            msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")}; node.send([msg, null]); return;\n    }\n    enviarMQTT();\n}\n\nif (topic == \"Blink/estLiving\"){\n    global.set(\"estLiving\", payload);  \n    global.set(\"estIslaRGB\", payload);\n    // global.set(\"estIsla\", parseInt(msg.payload)); \n    // global.set(\"estCielorrazo\", parseInt(msg.payload));\n\n    // if (msg.payload === 1) global.set(\"estIslaRGB\", 1);\n    // global.set(\"estIslaRGB\", parseInt(msg.payload));\n    // if (msg.payload === 0) global.set(\"estIslaRGB\", parseInt(msg.payload));\n    enviarMQTT();}\n\nif (topic == \"Blink/estIsla\"){\n    // global.set(\"estIslaRGB\", payload);\n    global.set(\"estIsla\", payload);\n    enviarMQTT();}\n\nif (topic == \"Blink/estCielorrazo\"){\n    // global.set(\"estIslaRGB\", payload);\n    global.set(\"estCielorrazo\", payload); \n    enviarMQTT();}\n\nif (topic == \"Blink/estRGB\"){global.set(\"estIslaRGB\", payload); enviarMQTT();}\n\nif (topic == \"Blink/colorRGB\"){\n    global.set(\"IslaR\", msg.arrayOfValues[0]);\n    global.set(\"IslaG\", msg.arrayOfValues[1]);\n    global.set(\"IslaB\", msg.arrayOfValues[2]);\n    msg = {pin: 32, payload: \"12\"}; node.send([null, msg]);\n    global.set(\"estIslaRGB\", 1);\n    enviarMQTT();\n}\n\nreturn;\n\nfunction apagadoLuces(){\n    // if (global.get(\"estadoAlarma\") === 1 || global.get(\"Dia\") === 1){\n    //  // global.set(\"estLiving\", 0); \n    //  // global.set(\"estIsla\", 0); \n    //  // global.set(\"estCielorrazo\", 0);\n    //  // global.set(\"estIslaRGB\", 0);\n    // }\n    msg = {topic: \"USBout\", payload: \"Dia\"}; node.send([msg, null]);\n    global.set(\"estLiving\", \"0\");\n    global.set(\"estIslaRGB\", \"0\");\n    msg.topic = \"apagadoAuto\";\n    enviarMQTT();\n}\n\nfunction enviarMQTT(){\n    var topicNuevo = msg.topic;\n    msg = {pin: 127, payload: global.get(\"hsCpu\") + \", top: \" + topicNuevo + \", D:\" + global.get(\"Dia\") + \", Al:\" + global.get(\"estadoAlarma\") + \"\\n\"}; node.send([null, msg]);\n    // if (global.get(\"estIsla\") === 0 && global.get(\"estCielorrazo\") === 0 && global.get(\"estIslaRGB\") === 0)global.set(\"estLiving\", 0);\n    if (global.get(\"estIsla\") === 1 || global.get(\"estCielorrazo\") === 1){\n        if(topic !== \"Blink/estLiving\" && topicNuevo !== \"fallas_MQTT\")global.set(\"estLiving\", 1);\n        }\n    if (topicNuevo == \"apagadoAuto\") {\n        global.set(\"estLiving\", 0); \n        msg = {pin: 127, payload: \"Apagado auto\\n\"}; node.send([null, msg]);\n    }\n\n    if (topicNuevo !== \"fallas_MQTT\"){\n    msg = {pin: 14, payload: global.get(\"estLiving\")}; node.send([null, msg]);\n    msg = {pin: 16, payload: global.get(\"estIsla\")}; node.send([null, msg]);\n    msg = {pin: 17, payload: global.get(\"estCielorrazo\")}; node.send([null, msg]);\n    msg = {pin: 29, payload: global.get(\"estIslaRGB\")}; node.send([null, msg]);}\n    if(topic == \"ESP/living/Iluminacion/Envio\")return;\n    \n    if (global.get(\"estLiving\") === 0) {\n            msg = {pin: 16, payload: \"0\"}; node.send([null, msg]);\n            dato = \"0,\"}\n        else{\n            dato = global.get(\"estIsla\") + \",\";}\n    dato += global.get(\"potIsla\") + \"#\";\n\n    if (global.get(\"estLiving\") === 0) {\n            msg = {pin: 17, payload: \"0\"}; node.send([null, msg]);\n            dato += \"0,\"}\n        else{\n            dato += global.get(\"estCielorrazo\") + \",\";}\n    dato += global.get(\"potCielorrazo\") + \"#\";  \n    dato += global.get(\"estIslaRGB\") + \",\";\n    dato += global.get(\"IslaR\") + \",\";\n    dato += global.get(\"IslaG\") + \",\";      \n    dato += global.get(\"IslaB\") + \"#\";\n\n  dato += global.get(\"pwmMaxLed\") + \"#\";\n  dato += global.get(\"pwmMinLed\") + \"#\";\n    // dato += global.get(\"dimmerLeds\") + \"#\";\n\n    dato += global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"doblePuls\");\n    dato += \"#\" + global.get(\"Dia\");\n    if (topicNuevo == \"crepMQTT\")dato += \"#\";\n\n//  msg = {topic: \"ESP/living/Iluminacion/Recibo2\", payload: topicNuevo + \"&\" + global.get(\"estadoAlarma\") + \"&\" + global.get(\"Dia\") + \"\\n\" + dato};    node.send([msg, null]);\n    msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n    node.send([msg, null]);     \n}",
        "outputs": 2,
        "noerr": 0,
        "x": 130,
        "y": 80,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "98cfaeee.49f83",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/living/Iluminacion/Envio",
        "payload": "1#0#0#",
        "payloadType": "str",
        "x": 580,
        "y": 150,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "15333381.786d6c",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/living/Iluminacion/Envio",
        "payload": "1#1#0#",
        "payloadType": "str",
        "x": 580,
        "y": 190,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "676b6bd5.c7f514",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/living/Iluminacion/Envio",
        "payload": "0#0#0#",
        "payloadType": "str",
        "x": 580,
        "y": 230,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "7d51b41e.96593c",
        "type": "link out",
        "z": "a89e305a.c50bb",
        "name": "iluminacionLiving",
        "links": [
            "81fe7338.07458",
            "f8163bcc.da6ee8"
        ],
        "x": 775,
        "y": 250,
        "wires": []
    },
    {
        "id": "81fe7338.07458",
        "type": "link in",
        "z": "a89e305a.c50bb",
        "name": "",
        "links": [
            "7d51b41e.96593c"
        ],
        "x": 535,
        "y": 570,
        "wires": [
            [
                "600dc232.0a0b1c"
            ]
        ]
    },
    {
        "id": "1ab2f0fa.9116ef",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "",
        "func": "if (msg.topic == \"Living\")msg = {pin: 14, payload: msg.payload};\n\nif (msg.topic == \"Isla\")msg = {pin: 16, payload: msg.payload};\nif (msg.topic == \"Cielorrazo\")msg = {pin: 17, payload: msg.payload};\nif (msg.topic == \"islaRGB\")msg = {pin: 29, payload: msg.payload};\n\nnode.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 940,
        "y": 570,
        "wires": [
            [
                "decd799b.52caa8"
            ]
        ]
    },
    {
        "id": "600dc232.0a0b1c",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "",
        "func": "msg.payload = global.get(\"estLiving\"); node.send([msg, null]);\nmsg.payload = global.get(\"estIsla\"); node.send([null, msg]);\nmsg.payload = global.get(\"estCielorrazo\"); node.send([null, null, msg]);\nmsg.payload = global.get(\"estIslaRGB\"); node.send([null, null, null, msg]);",
        "outputs": 4,
        "noerr": 0,
        "x": 620,
        "y": 570,
        "wires": [
            [
                "e7995436.864178"
            ],
            [
                "81391af8.a44828"
            ],
            [
                "6f3f19e9.fa3cf8"
            ],
            [
                "1787ebf3.ebb804",
                "95875391.4f5e1"
            ]
        ]
    },
    {
        "id": "73587e0a.317fa",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "recibo2b",
        "func": " var timerLuces = 12000;\nif (global.get(\"estLiving\") === undefined)global.set(\"estLiving\", 0);\nif (global.get(\"estIsla\") === undefined)global.set(\"estIsla\", 0);\nif (global.get(\"estCielorrazo\") === undefined)global.set(\"estCielorrazo\", 0);\nif (global.get(\"potLiving\") === undefined)global.set(\"potLiving\", 0);\nif (global.get(\"estIslaRGB\") === undefined)global.set(\"estIslaRGB\", 0);\nif (global.get(\"potIsla\") === undefined)global.set(\"potIsla\", 255);\nif (global.get(\"potCielorrazo\") === undefined)global.set(\"potCielorrazo\", 128);\nif (global.get(\"IslaR\") === undefined)global.set(\"IslaR\", 255);\nif (global.get(\"IslaG\") === undefined)global.set(\"IslaG\", 255);\nif (global.get(\"IslaB\") === undefined)global.set(\"IslaB\", 255);\n\nif (global.get(\"pwmMinLed\") === undefined)global.set(\"pwmMinLed\", 20);\nif (global.get(\"pwmMaxLed\") === undefined)global.set(\"pwmMaxLed\", 255);\n\nif (global.get(\"dimmerLeds\") === undefined)global.set(\"dimmerLeds\", 200);\nif (global.get(\"minTeclas\") === undefined)global.set(\"minTeclas\", 15);\nif (global.get(\"maxTeclas\") === undefined)global.set(\"maxTeclas\", 600);\nif (global.get(\"doblePuls\") === undefined)global.set(\"doblePuls\", 1);\nif (global.get(\"fallasLivingIluminacion\") === undefined)global.set(\"fallasLivingIluminacion\", 0);\nif (global.get(\"pwmPatioLuz\") === undefined)global.set(\"pwmPatioLuz\", 33);\ncontext.item = context.item || 0;\nvar pin = parseInt(msg.pin);\nvar topic = msg.topic;\nvar payload = parseInt(msg.payload);\nvar dato;\n\nif (topic == \"ESP/living/Iluminacion/Inicio\"){  \n    var fallasLivingIluminacion = global.get(\"fallasLivingIluminacion\") + 1;\n    global.set(\"fallasLivingIluminacion\", fallasLivingIluminacion);\n    global.set(\"tipoFallaIlLiving\", payload); msg = {topic: \"fallas_MQTT\", payload: 1}; node.send([msg, null]);\n    enviarMQTT();\n    return;\n}\n\nif (topic == \"aviso/Alarma\"){\n    if (global.get(\"estadoAlarma\") === 0 && global.get(\"Dia\") === 0){\n    msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")}; node.send([msg, null]);\n    global.set(\"estLiving\", 1); \n    global.set(\"estIslaRGB\", 1);\n    enviarMQTT();\n    return;\n    }\n    if (global.get(\"estadoAlarma\") === 1 && global.get(\"estLiving\") === 1){setTimeout(apagadoLuces, timerLuces);}\n    if (global.get(\"estadoAlarma\") === 1 && global.get(\"Dia\") === 1){\n        // msg = {topic: \"USBout\", payload: \"Dia\"}; node.send([msg, null]);\n        apagadoLuces();}\n}\n\n\nif (topic == \"crepMQTT\"){\n    if (global.get(\"Dia\") === 1) {msg = {topic: \"USBout\", payload: \"Dia\"}; node.send([msg, null]);}\n    if (global.get(\"Dia\") === 0) {msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")}; node.send([msg, null]);}\n    // enviarMQTT();\n}\n\n\nif (topic == \"google/Living\") {enviarMQTT(); return;}\n\nif (topic == \"ESP/living/Iluminacion/Envio\" && !topic.includes(\"Recibo de ESP\")){\n    dato = msg.payload.split(\"#\");\n    global.set(\"estIsla\", dato[0]); \n    global.set(\"estCielorrazo\", dato[1]); \n    global.set(\"estIslaRGB\", dato[2]); \n    enviarMQTT();\n    return;\n}\n\nswitch (pin){\n\n  case 8:\n    global.set(\"IslaR\", msg.arrayOfValues[0]);\n    global.set(\"IslaG\", msg.arrayOfValues[1]);\n    global.set(\"IslaB\", msg.arrayOfValues[2]);\n    msg = {pin: 32, payload: \"12\"}; node.send([null, msg]);\n    global.set(\"estIslaRGB\", 1);\n    enviarMQTT();\n  break;\n\n  case 14:\n    global.set(\"estLiving\", payload);  \n    global.set(\"estIslaRGB\", payload);\n    enviarMQTT();\n  break;\n\n  case 16:\n    global.set(\"estIsla\", payload);\n    enviarMQTT();\n  break;\n\n  case 17:\n    global.set(\"estCielorrazo\", payload); \n    enviarMQTT();\n  break;\n\n  case 29:\n    global.set(\"estIslaRGB\", payload); \n    enviarMQTT();\n  break;\n\n  case 18:\n    global.set(\"itemPotencia\", msg.payload);\n    if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 4){\n      context.item = parseInt(msg.payload);\n      switch(parseInt(msg.payload)){\n          case 1:\n              msg = {pin: 19, min: 4, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n          break;\n          case 2:\n              msg = {pin: 19, min: 4, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n          break;\n          case 3:\n              msg = {pin: 19, min: 4, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n          break;\n          case 4:\n              msg = {pin: 19, min: 1, max: 100, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n          break;\n      }\n      node.send([null, msg]);\n    }\n  break;\n\n  case 19:\n    if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 4){\n      var valor = parseInt(msg.payload);\n      switch(context.item){\n          case 1:\n              if (global.get(\"estLiving\") === 0)return;\n              global.set(\"potLiving\", valor);\n              global.set(\"potIsla\", valor);\n              global.set(\"potCielorrazo\", valor);\n          break;\n          case 2:\n              if (global.get(\"estIsla\") === 0)return;\n              global.set(\"potIsla\", valor);\n          break;\n          case 3:\n              if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"potCielorrazo\", valor);\n          break;\n          case 4:\n              if (global.get(\"Dia\") === 1)return;\n              global.set(\"pwmPatioLuz\", valor);\n              msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")}; node.send([msg, null]); return;\n      }\n      enviarMQTT();\n    }\n  break;\n}\nreturn;\n\nfunction apagadoLuces(){\n    msg = {topic: \"USBout\", payload: \"Dia\"}; node.send([msg, null]);\n    global.set(\"estLiving\", \"0\");\n    global.set(\"estIslaRGB\", \"0\");\n    msg.topic = \"apagadoAuto\";\n    enviarMQTT();\n}\n\nfunction enviarMQTT(){\n    var topicNuevo = msg.topic;\n    //msg = {pin: 127, payload: global.get(\"hsCpu\") + \", top: \" + topicNuevo + \", D:\" + global.get(\"Dia\") + \", Al:\" + global.get(\"estadoAlarma\") + \"\\n\"}; node.send([null, msg]);\n    // if (global.get(\"estIsla\") === 0 && global.get(\"estCielorrazo\") === 0 && global.get(\"estIslaRGB\") === 0)global.set(\"estLiving\", 0);\n    if (global.get(\"estIsla\") === 1 || global.get(\"estCielorrazo\") === 1){\n        if(topic !== \"Blink/estLiving\" && topicNuevo !== \"fallas_MQTT\")\n          if (payload !== 0) global.set(\"estLiving\", 1);\n        }\n    if (topicNuevo == \"apagadoAuto\") {\n        global.set(\"estLiving\", 0); \n        msg = {pin: 127, payload: \"Apagado auto\\n\"}; node.send([null, msg]);\n    }\n\n    if (topicNuevo !== \"fallas_MQTT\"){\n    msg = {pin: 14, payload: global.get(\"estLiving\")}; node.send([null, msg]);\n    msg = {pin: 16, payload: global.get(\"estIsla\")}; node.send([null, msg]);\n    msg = {pin: 17, payload: global.get(\"estCielorrazo\")}; node.send([null, msg]);\n    msg = {pin: 29, payload: global.get(\"estIslaRGB\")}; node.send([null, msg]);}\n    if(topic == \"ESP/living/Iluminacion/Envio\")return;\n    \n    if (parseInt(global.get(\"estLiving\")) === 0) {\n            msg = {pin: 16, payload: \"0\"}; node.send([null, msg]);\n            dato = \"0,\"}\n        else{\n            dato = global.get(\"estIsla\") + \",\";}\n    dato += global.get(\"potIsla\") + \"#\";\n\n    if (parseInt(global.get(\"estLiving\")) === 0) {\n            msg = {pin: 17, payload: \"0\"}; node.send([null, msg]);\n            dato += \"0,\"}\n        else{\n            dato += global.get(\"estCielorrazo\") + \",\";}\n    dato += global.get(\"potCielorrazo\") + \"#\";  \n    dato += global.get(\"estIslaRGB\") + \",\";\n    dato += global.get(\"IslaR\") + \",\";\n    dato += global.get(\"IslaG\") + \",\";      \n    dato += global.get(\"IslaB\") + \"#\";\n\n  dato += global.get(\"pwmMaxLed\") + \"#\";\n  dato += global.get(\"pwmMinLed\") + \"#\";\n    // dato += global.get(\"dimmerLeds\") + \"#\";\n\n    dato += global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"doblePuls\");\n    dato += \"#\" + global.get(\"Dia\");\n    if (topicNuevo == \"crepMQTT\")dato += \"#\";\n\n//  msg = {topic: \"ESP/living/Iluminacion/Recibo2\", payload: topicNuevo + \"&\" + global.get(\"estadoAlarma\") + \"&\" + global.get(\"Dia\") + \"\\n\" + dato};    node.send([msg, null]);\n    msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n    node.send([msg, null]);     \n}",
        "outputs": 2,
        "noerr": 0,
        "x": 650,
        "y": 410,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "decd799b.52caa8",
        "type": "link out",
        "z": "a89e305a.c50bb",
        "name": "salidaLiving",
        "links": [
            "73ae05bd.02fb9c"
        ],
        "x": 1040,
        "y": 570,
        "wires": []
    },
    {
        "id": "73ae05bd.02fb9c",
        "type": "link in",
        "z": "a89e305a.c50bb",
        "name": "",
        "links": [
            "decd799b.52caa8"
        ],
        "x": 542,
        "y": 502,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "9783d076.2a722",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 780,
        "y": 150,
        "wires": [
            [
                "58b90d79.d09bf4"
            ]
        ]
    },
    {
        "id": "58b90d79.d09bf4",
        "type": "mqtt out",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "crepMQTT",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 940,
        "y": 200,
        "wires": []
    },
    {
        "id": "963b6ab2.6d64f8",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 640,
        "y": 280,
        "wires": []
    },
    {
        "id": "9de5bca7.31925",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 770,
        "y": 200,
        "wires": [
            [
                "58b90d79.d09bf4"
            ]
        ]
    },
    {
        "id": "aa2ebf44.36aa7",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 890,
        "y": 280,
        "wires": []
    },
    {
        "id": "cf934abb.45a8e8",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "USBout",
        "qos": "",
        "retain": "",
        "broker": "3fe9d635.ec409a",
        "x": 798.6666259765625,
        "y": 379.00000953674316,
        "wires": []
    },
    {
        "id": "18e89e7a.cf0832",
        "type": "comment",
        "z": "f682d492.22a758",
        "name": "PID Control For CPU Temperature of Raspberry PI",
        "info": "",
        "x": 278.6666259765625,
        "y": 219.00000953674316,
        "wires": []
    },
    {
        "id": "94e31487.9c74d8",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "16",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 218.6666259765625,
        "y": 499.00000953674316,
        "wires": [
            [
                "a80e4842.3b8e58",
                "1e6fdef2.dd07c1"
            ]
        ]
    },
    {
        "id": "a80e4842.3b8e58",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "msg.payload = \"Ser reinicio servidor\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 408.6666259765625,
        "y": 479.00000953674316,
        "wires": [
            [
                "eb9007a.8c8bff8"
            ]
        ]
    },
    {
        "id": "682b5613.2a3718",
        "type": "delay",
        "z": "f682d492.22a758",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 608.6666259765625,
        "y": 379.00000953674316,
        "wires": [
            [
                "cf934abb.45a8e8",
                "cbccd783.cab558"
            ]
        ]
    },
    {
        "id": "1e6fdef2.dd07c1",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "var date = new Date();\nvar hh = date.getHours(); global.set(\"hh\", hh);\nvar mm = date.getMinutes(); global.set(\"mm\", mm);\nvar ss = date.getSeconds(); global.set(\"ss\", ss);\nvar dia = date.getDate(); \nvar mes = date.getMonth()+1;\nvar ano = date.getFullYear(); \n\nvar reinicio = hh + \":\" +mm + \":\" + ss + \" -- \"+ dia + \"/\"+mes+ \"\\n\";\n\n\nmsg.payload = reinicio;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 398.6666259765625,
        "y": 559.0000095367432,
        "wires": [
            [
                "b4a6cd49.2b908",
                "2a31c302.c6da1c"
            ]
        ]
    },
    {
        "id": "b4a6cd49.2b908",
        "type": "file",
        "z": "f682d492.22a758",
        "name": "reinicios",
        "filename": "/home/pi/BackUpNodeRed/reinicios.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "true",
        "x": 548.6666259765625,
        "y": 529.0000095367432,
        "wires": [
            [
                "2a31c302.c6da1c"
            ]
        ]
    },
    {
        "id": "2a31c302.c6da1c",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 748.6666259765625,
        "y": 559.0000095367432,
        "wires": []
    },
    {
        "id": "3a7a53b.5e20bac",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 228.6666259765625,
        "y": 569.0000095367432,
        "wires": [
            [
                "1e6fdef2.dd07c1"
            ]
        ]
    },
    {
        "id": "15f5e9fc.96d0e6",
        "type": "ping",
        "z": "f682d492.22a758",
        "name": "",
        "host": "www.google.com",
        "timer": "15",
        "inputs": 0,
        "x": 1200,
        "y": 110,
        "wires": [
            [
                "8fffeae3.8c4f58",
                "ffc75de3.b748d"
            ]
        ]
    },
    {
        "id": "8fffeae3.8c4f58",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "reinicio por falta de internet",
        "func": "var hh = new Date().getHours();\nvar payload = msg.payload;\ncontext.contador = context.contador || 0;\ncontext.hh = context.hh || 25;\nnode.status({text: context.contador + \" -- \" + hh + \"  --  \" + context.hh});\n\nif (payload === false && context.hh != hh ){\n    context.contador = context.contador + 1;\n    if (context.contador === 4){\n        context.hh = hh;\n        context.contador = 0;\n        msg = {topic: \"reiniciar\", payload: 1};\n        return msg;\n    }\n    return;\n}\nif (payload !== false){context.contador = 0; context.hh = 25;}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1248.6666259765625,
        "y": 164.00000953674316,
        "wires": [
            [
                "e381f13b.67d59",
                "ea330fed.01274"
            ]
        ]
    },
    {
        "id": "81e33838.5108d8",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "af08803a.808f4",
        "x": 1868.6666259765625,
        "y": 189.00000953674316,
        "wires": []
    },
    {
        "id": "ffc75de3.b748d",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1410,
        "y": 110,
        "wires": []
    },
    {
        "id": "e381f13b.67d59",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 1468.6666259765625,
        "y": 164.00000953674316,
        "wires": []
    },
    {
        "id": "ea330fed.01274",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "reinicio auto lunes (02:03:08)",
        "func": "context.reset = context.reset || 0;\nnode.status({text: global.get(\"fechaDia\") + \" - \" + context.reset});\nif (msg.topic == \"reiniciar\"){\n    msg = {topic: \"USBout\", payload: \"resetAntenas\"};\n    node.send(msg);}\n\nif (global.get(\"fechaDia\") === 3 && parseInt(global.get(\"hh\")) === 2 && parseInt(global.get(\"mm\")) === 17 && context.reset >= 1)context.reset = 0;\n\nif (global.get(\"fechaDia\") === 3 && parseInt(global.get(\"hh\")) === 2 && parseInt(global.get(\"mm\")) === 16 && parseInt(global.get(\"ss\")) >= 8 && context.reset === 0){\n    context.reset = 1; msg = {topic: \"USBout\", payload: \"resetAntenas\"}; node.send(msg);}",
        "outputs": 1,
        "noerr": 0,
        "x": 1518.6666259765625,
        "y": 199.00000953674316,
        "wires": [
            [
                "5924c499.efbe5c",
                "e64fa228.ab2f5",
                "cb64b80e.2bae48"
            ]
        ]
    },
    {
        "id": "11c41031.dc0ff",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "14",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1203.6666259765625,
        "y": 204.00000953674316,
        "wires": [
            [
                "ea330fed.01274"
            ]
        ]
    },
    {
        "id": "444b000.6357",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "reinicio manual",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "reiniciar",
        "payload": "",
        "payloadType": "date",
        "x": 1198.6666259765625,
        "y": 239.00000953674316,
        "wires": [
            [
                "ea330fed.01274"
            ]
        ]
    },
    {
        "id": "5924c499.efbe5c",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1588.6666259765625,
        "y": 289.00000953674316,
        "wires": []
    },
    {
        "id": "2bd0f557.1bf01a",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.payload != \"1\")return;\nmsg = {topic: \"reiniciar\", payload: 1};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1308.6666259765625,
        "y": 279.00000953674316,
        "wires": [
            [
                "ea330fed.01274"
            ]
        ]
    },
    {
        "id": "e64fa228.ab2f5",
        "type": "delay",
        "z": "f682d492.22a758",
        "name": "",
        "pauseType": "delay",
        "timeout": "15",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1708.6666259765625,
        "y": 149.00000953674316,
        "wires": [
            [
                "81e33838.5108d8"
            ]
        ]
    },
    {
        "id": "cb64b80e.2bae48",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "msg = {topic: \"notifyBlynk\", payload: global.get(\"hsCpu\") + \" - Reinicio antena en 15\"};\nnode.send(msg);\nmsg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" - ResetAntenas\\n\"};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1708.6666259765625,
        "y": 229.00000953674316,
        "wires": [
            [
                "81e33838.5108d8"
            ]
        ]
    },
    {
        "id": "d63c0df6.57c6d",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "USBin",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 123.6666259765625,
        "y": 418,
        "wires": [
            [
                "4ad52aaf.d04e64"
            ]
        ]
    },
    {
        "id": "4ad52aaf.d04e64",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.payload.substring(0,10) == \"inicioNano\"){\n    msg.payload = global.get(\"hsCpu\") + \" se reinicio el nano de baterias\\n\";\n    node.send(msg);\n    // return msg;\n}//inicioNode-Red\nif (msg.payload == \"inicioNode-Red\"){\n    msg.payload = global.get(\"fechaCompleta\") + \" inicio el servidor\\n\";\n    node.send(msg);\n    // return msg;\n}//inicioNode-Red",
        "outputs": 1,
        "noerr": 0,
        "x": 246.6666259765625,
        "y": 401.00000953674316,
        "wires": [
            [
                "139fd31f.d9d46d",
                "620729d2.70ae88"
            ]
        ]
    },
    {
        "id": "139fd31f.d9d46d",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "terminalBlynk",
        "qos": "",
        "retain": "",
        "broker": "3fe9d635.ec409a",
        "x": 418.6666259765625,
        "y": 373,
        "wires": []
    },
    {
        "id": "19984082.8b92df",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "inicio serv",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "45",
        "topic": "",
        "payload": "inicioNode-Red",
        "payloadType": "str",
        "x": 108.6666259765625,
        "y": 382,
        "wires": [
            [
                "4ad52aaf.d04e64"
            ]
        ]
    },
    {
        "id": "cbccd783.cab558",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 798.6666259765625,
        "y": 309.00000953674316,
        "wires": []
    },
    {
        "id": "b496b6cd.cffae8",
        "type": "delay",
        "z": "f682d492.22a758",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 608.6666259765625,
        "y": 419.00000953674316,
        "wires": [
            [
                "cf934abb.45a8e8",
                "50b13260.8627ec"
            ]
        ]
    },
    {
        "id": "50b13260.8627ec",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 778.6666259765625,
        "y": 449.00000953674316,
        "wires": []
    },
    {
        "id": "ad073b7f.7616d8",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "terminalBlynk",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 138.6666259765625,
        "y": 709.0000095367432,
        "wires": [
            [
                "5ecd3c4a.fa40b4"
            ]
        ]
    },
    {
        "id": "db8d29a9.395938",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "notify blynk",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 638.6666259765625,
        "y": 759.0000095367432,
        "wires": []
    },
    {
        "id": "28e6a691.0c236a",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "notifyBlynk",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 487.9761935642782,
        "y": 733.4285719735282,
        "wires": [
            [
                "bb713a62.b0fdf8",
                "db8d29a9.395938"
            ]
        ]
    },
    {
        "id": "1335719f.0a145e",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/TanqueAgua/Desconectado",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1257.5555114746094,
        "y": 443.4444589614868,
        "wires": [
            [
                "73d128c4.318fd8"
            ]
        ]
    },
    {
        "id": "73d128c4.318fd8",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.topic.includes(\"desconectado\") || msg.topic.includes(\"Desconectado\")){\n    global.set(\"estado-TanqueAgua\", global.get(\"fechaCompleta\") + \" - Desc\\n\");\n    node.send(msg);}\nif (msg.topic.includes(\"Inicio\")){\n    global.set(\"estado-TanqueAgua\", global.get(\"fechaCompleta\") + \" - Con\\n\");\n    node.send(msg);}    \n    \nnode.status({text: global.get(\"estado-TanqueAgua\")});      ",
        "outputs": 1,
        "noerr": 0,
        "x": 1495.333339691162,
        "y": 481.22222900390625,
        "wires": [
            [
                "6e57dcc9.a5e0a4"
            ]
        ]
    },
    {
        "id": "2c6d5499.e60dfc",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/TanqueAgua/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1288.4645080566406,
        "y": 480.6161518096924,
        "wires": [
            [
                "73d128c4.318fd8"
            ]
        ]
    },
    {
        "id": "b581d7d4.c586d8",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.topic.includes(\"desconectado\") || msg.topic.includes(\"Desconectado\")){\n    global.set(\"estado-Lavadero\", global.get(\"fechaCompleta\") + \" - Desc\\n\");\n    node.send(msg);}\nif (msg.topic.includes(\"Inicio\")){\n    global.set(\"estado-Lavadero\", global.get(\"fechaCompleta\") + \" - Con\\n\");\n    node.send(msg);}    \n    \n    node.status({text: global.get(\"estado-Lavadero\")});",
        "outputs": 1,
        "noerr": 0,
        "x": 1493.666591644287,
        "y": 546.7777528762817,
        "wires": [
            [
                "6e57dcc9.a5e0a4"
            ]
        ]
    },
    {
        "id": "1a8fa907.ac3d77",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/Lavadero/Desconectado",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1267.5556106567383,
        "y": 516.7777786254883,
        "wires": [
            [
                "b581d7d4.c586d8"
            ]
        ]
    },
    {
        "id": "921caa7a.92e9a8",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/Lavadero/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1297.5555877685547,
        "y": 551.2222023010254,
        "wires": [
            [
                "b581d7d4.c586d8"
            ]
        ]
    },
    {
        "id": "43fc7397.9a6c8c",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/living/Iluminacion/Desconectado",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1238.6666717529297,
        "y": 585.6666917800903,
        "wires": [
            [
                "a0e5bba2.dd9068"
            ]
        ]
    },
    {
        "id": "3226cbc8.5acec4",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/living/Iluminacion/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1268.1615600585938,
        "y": 627.1818046569824,
        "wires": [
            [
                "a0e5bba2.dd9068"
            ]
        ]
    },
    {
        "id": "a0e5bba2.dd9068",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.topic.includes(\"desconectado\") || msg.topic.includes(\"Desconectado\")){\n    global.set(\"estado-IluminacionLiving\", global.get(\"fechaCompleta\") + \" - Desc\\n\");\n    node.send(msg);}\nif (msg.topic.includes(\"Inicio\")){\n    global.set(\"estado-IluminacionLiving\", global.get(\"fechaCompleta\") + \" - Con\\n\");\n    node.send(msg);}    \n    \n    node.status({text: global.get(\"estado-IluminacionLiving\")});    ",
        "outputs": 1,
        "noerr": 0,
        "x": 1495.6666259765625,
        "y": 607,
        "wires": [
            [
                "6e57dcc9.a5e0a4"
            ]
        ]
    },
    {
        "id": "d8ba8495.1ac0e8",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "USBin",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1121.6666259765625,
        "y": 1413,
        "wires": [
            [
                "e2e4d07c.f032c"
            ]
        ]
    },
    {
        "id": "269fcb97.b09bf4",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "USBout",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1900.6666259765625,
        "y": 1444,
        "wires": []
    },
    {
        "id": "e2e4d07c.f032c",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "var dato = JSON.parse(msg.payload);\n\nif (dato.topic === \"Alarma\"){\n     msg.payload = global.get(\"hsCpu\") + \" -- \" + msg.payload + \"\\n\";\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 1281.6666259765625,
        "y": 1413,
        "wires": [
            [
                "19734678.231f3a"
            ]
        ]
    },
    {
        "id": "c009ce09.2565f",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"topic\":\"Alarma\", \"payload\":1}",
        "payloadType": "str",
        "x": 1125.6666259765625,
        "y": 1378,
        "wires": [
            [
                "e2e4d07c.f032c"
            ]
        ]
    },
    {
        "id": "19734678.231f3a",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1433.6666259765625,
        "y": 1420,
        "wires": []
    },
    {
        "id": "6e57dcc9.a5e0a4",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (global.get(\"estado-TanqueAgua\") === undefined)global.set(\"estado-TanqueAgua\", null);\nif (global.get(\"estado-Lavadero\") === undefined)global.set(\"estado-Lavadero\", null);\nif (global.get(\"estado-IluminacionLiving\") === undefined)global.set(\"estado-IluminacionLiving\", null);\nif (global.get(\"estado-TermoSolar\") === undefined)global.set(\"estado-TermoSolar\", null);\nif (global.get(\"estado-Bano\") === undefined)global.set(\"estado-Bano\", null);\nif (global.get(\"estado-PatioLuz\") === undefined)global.set(\"estado-PatioLuz\", null);\nif (global.get(\"estado-Escaleras\") === undefined)global.set(\"estado-Escaleras\", null);\nif (global.get(\"estado-Caldera\") === undefined)global.set(\"estado-Caldera\", null);\n\n// node.send(msg.payload);\nmsg.payload = \"\";\nfor (i = 0; i < 8; i++) {msg = {topic: \"terminalBlynk\", payload: \"\\n\"};}\n// node.send(msg);\n\nmsg =  \"Tanque  : \" + global.get(\"estado-TanqueAgua\");// + \"\\n\";// + \"\\n\";\nmsg += \"Lav.    : \" + global.get(\"estado-Lavadero\");// + \"\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"Liv.    : \" + global.get(\"estado-IluminacionLiving\");// + \"\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"Termo   : \" + global.get(\"estado-TermoSolar\");// + \"\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"Bano    : \" + global.get(\"estado-Bano\");// + \"\\n\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"PatioLuz: \" + global.get(\"estado-PatioLuz\");// + \"\\n\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"Escalera: \" + global.get(\"estado-Escaleras\");// + \"\\n\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"Porche : \" + global.get(\"estado-Porche\");\n\nmsg += \"\\n\";\n\nmsg = {topic: \"terminalBlynk\", payload: msg};\n// if (parseInt(msg.pin == 100))node.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 1708.6666259765625,
        "y": 539.0000095367432,
        "wires": [
            [
                "e53926c8.eea898",
                "fa6c834e.be6f1"
            ]
        ]
    },
    {
        "id": "97f54fd4.80678",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.payload == 1)return msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1493.6666259765625,
        "y": 1472,
        "wires": [
            []
        ]
    },
    {
        "id": "d7fd4e5c.e7461",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/TermoSolar/Desconectado",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1246.4444274902344,
        "y": 667.8888750076294,
        "wires": [
            [
                "46f76de.72d8f94"
            ]
        ]
    },
    {
        "id": "bd29a9fa.85e6d8",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/TermoSolar/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1275.9392700195312,
        "y": 704.7575511932373,
        "wires": [
            [
                "46f76de.72d8f94"
            ]
        ]
    },
    {
        "id": "46f76de.72d8f94",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.topic.includes(\"desconectado\") || msg.topic.includes(\"Desconectado\")){\n    global.set(\"estado-TermoSolar\", global.get(\"fechaCompleta\") + \" - Desc\\n\");\n    node.send(msg);}\nif (msg.topic.includes(\"Inicio\")){\n    global.set(\"estado-TermoSolar\", global.get(\"fechaCompleta\") + \" - Con\\n\");\n    node.send(msg);}    \n    \n    node.status({text: global.get(\"estado-TermoSolar\")});      ",
        "outputs": 1,
        "noerr": 0,
        "x": 1496.444435119629,
        "y": 660.6666927337646,
        "wires": [
            [
                "6e57dcc9.a5e0a4"
            ]
        ]
    },
    {
        "id": "e53926c8.eea898",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1828.6666259765625,
        "y": 589.0000095367432,
        "wires": []
    },
    {
        "id": "87f3a3d0.62b6e",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/Bano/Desconectado",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1278.666618347168,
        "y": 365.6666307449341,
        "wires": [
            [
                "c5655f3c.f162e",
                "d17301ad.9c6a3"
            ]
        ]
    },
    {
        "id": "dccdb57c.3134b8",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/Bano/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 1306.0402221679688,
        "y": 407.2828016281128,
        "wires": [
            [
                "7e23170c.9a31b8",
                "c5655f3c.f162e"
            ]
        ]
    },
    {
        "id": "c5655f3c.f162e",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.topic.includes(\"desconectado\") || msg.topic.includes(\"Desconectado\")){\n    global.set(\"estado-Bano\", global.get(\"fechaCompleta\") + \" - Desc\\n\");\n    node.send(msg);}\nif (msg.topic.includes(\"Inicio\")){\n    global.set(\"estado-Bano\", global.get(\"fechaCompleta\") + \" - Con\\n\");\n    node.send(msg);}    \n    \nnode.status({text: global.get(\"estado-Bano\")});    ",
        "outputs": 1,
        "noerr": 0,
        "x": 1495.555534362793,
        "y": 420.22221755981445,
        "wires": [
            [
                "6e57dcc9.a5e0a4"
            ]
        ]
    },
    {
        "id": "d362115.3b801f",
        "type": "delay",
        "z": "f682d492.22a758",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 608.6666259765625,
        "y": 339.00000953674316,
        "wires": [
            [
                "cf934abb.45a8e8"
            ]
        ]
    },
    {
        "id": "a0c13759.208ff8",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/Bano/Inicio",
        "payload": "Conectado 0",
        "payloadType": "str",
        "x": 1802.111083984375,
        "y": 671.3333740234375,
        "wires": [
            []
        ]
    },
    {
        "id": "aaebb20e.8ef97",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1728.6666259765625,
        "y": 339.00000953674316,
        "wires": [
            [
                "3b673663.6004da"
            ]
        ]
    },
    {
        "id": "3b673663.6004da",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "node.status({text: global.get(\"estadoEspTanque\")})\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1848.6666259765625,
        "y": 389.00000953674316,
        "wires": [
            []
        ]
    },
    {
        "id": "de20f11c.46b02",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1782.6666259765625,
        "y": 786,
        "wires": []
    },
    {
        "id": "eb67c8bc.3a61e8",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 2218.6666259765625,
        "y": 379.00000953674316,
        "wires": []
    },
    {
        "id": "2313982d.866288",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "msg = {topic: \"reinBano\", payload: global.get(\"tiempoAndando\")}; \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2068.6666259765625,
        "y": 329.00000953674316,
        "wires": [
            [
                "b77070fe.51184",
                "eb67c8bc.3a61e8"
            ]
        ]
    },
    {
        "id": "8d98a034.686d5",
        "type": "delay",
        "z": "f682d492.22a758",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1948.6666259765625,
        "y": 329.00000953674316,
        "wires": [
            [
                "2313982d.866288"
            ]
        ]
    },
    {
        "id": "fbe5b982.1f0278",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "USBin/Baterias",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 188.6666259765625,
        "y": 899.0000095367432,
        "wires": [
            []
        ]
    },
    {
        "id": "f4da8f05.5a80d",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "informarNivel",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 198.6666259765625,
        "y": 859.0000095367432,
        "wires": [
            []
        ]
    },
    {
        "id": "4f1f018.98907",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \"  \" + msg.topic + \"\\n\"};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 408.6666259765625,
        "y": 879.0000095367432,
        "wires": [
            [
                "40d4f530.97cc9c"
            ]
        ]
    },
    {
        "id": "fc965419.7e0fd8",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 558.6666259765625,
        "y": 879.0000095367432,
        "wires": []
    },
    {
        "id": "eb89c027.f0a68",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 568.6666259765625,
        "y": 979.0000095367432,
        "wires": []
    },
    {
        "id": "3cb10e58.2072a2",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "tiempoCargando",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 188.6666259765625,
        "y": 809.0000095367432,
        "wires": [
            [
                "eb89c027.f0a68"
            ]
        ]
    },
    {
        "id": "40d4f530.97cc9c",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 598.6666259765625,
        "y": 939.0000095367432,
        "wires": []
    },
    {
        "id": "fc3e5606.585ee8",
        "type": "inject",
        "z": "7ac92c99.66ea94",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "luces del lavadero alacena",
        "payloadType": "str",
        "x": 260,
        "y": 400,
        "wires": [
            [
                "15d3c9e4.d9caa6"
            ]
        ]
    },
    {
        "id": "f2b6cf60.3bf01",
        "type": "function",
        "z": "7ac92c99.66ea94",
        "name": "",
        "func": "msg.estado = 1;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 421.6071891784668,
        "y": 138.92858457565308,
        "wires": [
            [
                "1e25bad1.b2b155"
            ]
        ]
    },
    {
        "id": "cc1add85.586c5",
        "type": "debug",
        "z": "7ac92c99.66ea94",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 488.3691177368164,
        "y": 599.7857265472412,
        "wires": []
    },
    {
        "id": "5172e6e0.6c63c8",
        "type": "function",
        "z": "7ac92c99.66ea94",
        "name": "Penreder (Nuevo)",
        "func": "var payload = msg.payload;\nvar estado = msg.estado;\n\n// if (!payload.includes(\"living\")) return;\n\nif (payload.includes(\"luces\") || payload.includes(\"luz\")){\n\n    // if (payload.includes(\"apaga\") || payload.includes(\"apagar\")){\n        if (payload.includes(\"apaga\") || payload.includes(\"apagar\") || payload.includes(\"todas\")){\n            global.set(\"estLuzCocina\", 0); global.set(\"estLucesBarraCocina\", 0); \n                msg = {topic: \"ESP/Cocina/Inicio\", payload: \"1\"}; node.send(msg);\n            // global.set(\"estMitadCascada\", 0); global.set(\"estPiletaCascada\", 0);  \n            //     msg = {topic: \"PatioLuz/Inicio\", payload: \"1\"}; node.send(msg);                \n            global.set(\"luzAlacenaLavadero\", 0); global.set(\"luzLavadero\", 0); \n                msg = {topic: \"google/Lavadero\", payload: \"1\"}; node.send(msg);\n            global.set(\"estLuzBano\", 0); global.set(\"estLuzEspejo\", 0); \n                msg = {topic: \"google/Baño\", payload: \"1\"}; node.send(msg);\n            global.set(\"estLiving\", 0); global.set(\"estIsla\", 0); global.set(\"estCielorrazo\", 0); global.set(\"estIslaRGB\", 0); \n                msg = {topic: \"google/Living\", payload: \"estLiving= \" + global.get(\"estLiving\")}; node.send(msg);\n            // global.set(\"luzLavadero\", 0);\n            return;\n        }\n    // }\n\n    if (payload.includes(\"lavadero\") || payload.includes(\"Lavadero\")){\n        if (payload.includes(\"alacena\")){\n            global.set(\"luzAlacenaLavadero\", parseInt(estado));\n            msg = {topic: \"google/Lavadero\", payload: \"1\"};\n            // msg = {pin: 35, payload: estado}; node.send([null, msg]);\n            // msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele0\", payload: estado}; //node.send(msg);    \n            return msg;\n        }             \n        // msg = {pin: 36, payload: estado}; node.send([null, msg]);\n        global.set(\"luzLavadero\", parseInt(estado));\n        // if (global.get(\"luzLavadero\") === 0)global.set(\"luzAlacenaLavadero\", 0); \n        msg = {topic: \"google/Lavadero\", payload: \"1\"};\n        // msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele1\", payload: estado}; //node.send(msg);   \n        return msg;\n    }      \n\n    if (payload.includes(\"baño\") || payload.includes(\"Baño\")){\n        if (payload.includes(\"ducha\") || payload.includes(\"Ducha\")){\n            global.set(\"modoDucha\", 0);\n            global.set(\"pedidoDucha\", parseInt(estado));\n            msg = {topic: \"google/Baño\", payload: \"1\"};\n            return msg;\n        }             \n        global.set(\"luzBano\", parseInt(estado));\n        msg = {topic: \"google/Baño\", payload: \"1\"}; \n        return msg;\n    }     \n\n    if (payload.includes(\"living\")){\n        if (payload.includes(\"isla\")){\n            global.set(\"estIsla\", estado);\n            msg = {topic: \"google/Living\", payload: \"estIsla= \" + global.get(\"estIsla\")};\n            return msg;\n        }\n        if (payload.includes(\"cielo raso\")){\n            global.set(\"estCielorrazo\", estado);\n            msg = {topic: \"google/Living\", payload: \"estCielorrazo= \" + global.get(\"estCielorrazo\")};\n            return msg;\n        }\n        if (payload.includes(\"rgb\")){\n            global.set(\"estIslaRGB\", estado);\n            msg = {topic: \"google/Living\", payload: \"estIslaRGB= \" + global.get(\"estIslaRGB\")};\n            return msg;\n        }\n    }\n        global.set(\"estLiving\", estado); \n        global.set(\"estIsla\", estado);\n        global.set(\"estCielorrazo\", estado);\n        global.set(\"estIslaRGB\", estado);\n        msg = {topic: \"google/Living\", payload: \"estLiving= \" + global.get(\"estLiving\")};\n        return msg;}\n\nif (payload.includes(\"bomba\") && payload.includes(\"centrifuga\") || payload.includes(\"centrífuga\")){\n    global.set(\"bombaPozo\", msg.estado);\n    msg = {topic: \"google/Lavadero\", payload: \"luzLavadero= \" + global.get(\"luzLavadero\")};\n    // msg = {topic: \"google/Tanque\", payload: msg.estado};\n    return msg; \n}",
        "outputs": 1,
        "noerr": 0,
        "x": 644.4642677307129,
        "y": 346.071457862854,
        "wires": [
            [
                "dd2ec6d9.69a7b8",
                "23f16719.2216e8"
            ]
        ]
    },
    {
        "id": "300b7f5b.9609c",
        "type": "debug",
        "z": "7ac92c99.66ea94",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 661.9405250549316,
        "y": 728.1786017417908,
        "wires": []
    },
    {
        "id": "4474aa4a.d59244",
        "type": "debug",
        "z": "7ac92c99.66ea94",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 544.4405250549316,
        "y": 449.42860174179077,
        "wires": []
    },
    {
        "id": "66d6bc25.ebcf74",
        "type": "debug",
        "z": "7ac92c99.66ea94",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 773.9405250549316,
        "y": 116.92860174179077,
        "wires": []
    },
    {
        "id": "beb20938.616a28",
        "type": "http in",
        "z": "7ac92c99.66ea94",
        "name": "prender luces",
        "url": "/prender",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 303.1309623718262,
        "y": 320.85715103149414,
        "wires": [
            [
                "3723238d.48cb5c"
            ]
        ]
    },
    {
        "id": "5fb5c510.42824c",
        "type": "http in",
        "z": "7ac92c99.66ea94",
        "name": "apagar luces",
        "url": "/apagar",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 301.0476417541504,
        "y": 362.6429567337036,
        "wires": [
            [
                "15d3c9e4.d9caa6"
            ]
        ]
    },
    {
        "id": "9e62beff.2ba1f",
        "type": "http in",
        "z": "7ac92c99.66ea94",
        "name": "cambiar color luces",
        "url": "/colorluces",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 267.6548538208008,
        "y": 506.8689994812012,
        "wires": [
            [
                "d0facd41.3bb66",
                "4474aa4a.d59244"
            ]
        ]
    },
    {
        "id": "36115df0.567c42",
        "type": "mqtt out",
        "z": "7ac92c99.66ea94",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "43555c62.30ed34",
        "x": 861.3690605163574,
        "y": 488.9286513328552,
        "wires": []
    },
    {
        "id": "eb1152.3061ceb",
        "type": "function",
        "z": "7ac92c99.66ea94",
        "name": "",
        "func": "msg.estado = 0;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 425.8929214477539,
        "y": 183.21431970596313,
        "wires": [
            [
                "1e25bad1.b2b155",
                "b431a03.de72c6"
            ]
        ]
    },
    {
        "id": "15d3c9e4.d9caa6",
        "type": "function",
        "z": "7ac92c99.66ea94",
        "name": "",
        "func": "msg.estado = 0;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 446.9881582260132,
        "y": 356.92860174179077,
        "wires": [
            [
                "5172e6e0.6c63c8",
                "6fd15169.7f306"
            ]
        ]
    },
    {
        "id": "3723238d.48cb5c",
        "type": "function",
        "z": "7ac92c99.66ea94",
        "name": "",
        "func": "msg.estado = 1;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 449.8571662902832,
        "y": 322.5238199234009,
        "wires": [
            [
                "5172e6e0.6c63c8",
                "6c03eb14.54b114"
            ]
        ]
    },
    {
        "id": "ed33619f.9a01a",
        "type": "function",
        "z": "7ac92c99.66ea94",
        "name": "",
        "func": "msg.payload = msg.payload + \"living color \";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 475.51197814941406,
        "y": 545.5000057220459,
        "wires": [
            [
                "d0facd41.3bb66"
            ]
        ]
    },
    {
        "id": "1e25bad1.b2b155",
        "type": "function",
        "z": "7ac92c99.66ea94",
        "name": "Activacion (Nuevo)",
        "func": "if (msg.payload.includes(\"alarma\") && msg.payload.includes(\"casa\")){\n\tif (msg.estado === 0){\n\t\tif(global.get(\"estadoAlarma\") === 1){\n\t\t\tmsg = {topic: \"google/Alarma\", payload: 1}; return msg;\n\t\t}\n\t\tif(global.get(\"estadoAlarma\") === 0){\n\t\t\tmsg = {topic: \"aviso/Alarma\", payload: 1}; return msg;\n\t\t}\n\t}\n    msg = {topic: \"google/Alarma\", payload: msg.estado}; return msg;\n}\n\nif (msg.payload.includes(\"llenado\") && msg.payload.includes(\"tanque\")){\n\tglobal.set(\"llenarTanque\", parseInt(msg.estado));\n\tmsg = {topic: \"google/Lavadero\", payload: msg.estado};\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 592.5595741271973,
        "y": 156.54764604568481,
        "wires": [
            [
                "33295f84.632f7",
                "66d6bc25.ebcf74"
            ]
        ]
    },
    {
        "id": "838a8e76.22bf4",
        "type": "mqtt out",
        "z": "7ac92c99.66ea94",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "43555c62.30ed34",
        "x": 685.2619438171387,
        "y": 672.476279258728,
        "wires": []
    },
    {
        "id": "a69ff076.ba745",
        "type": "inject",
        "z": "7ac92c99.66ea94",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "desactivar alarma casa",
        "payloadType": "str",
        "x": 315.94052505493164,
        "y": 220.92860174179077,
        "wires": [
            [
                "eb1152.3061ceb"
            ]
        ]
    },
    {
        "id": "f545455.731d8b8",
        "type": "delay",
        "z": "7ac92c99.66ea94",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 859.4642906188965,
        "y": 536.7857308387756,
        "wires": [
            [
                "7f28f9ae.46e9d8"
            ]
        ]
    },
    {
        "id": "7f28f9ae.46e9d8",
        "type": "mqtt out",
        "z": "7ac92c99.66ea94",
        "name": "",
        "topic": "ESP/living/Iluminacion/beep",
        "qos": "",
        "retain": "",
        "broker": "43555c62.30ed34",
        "x": 1068.0357398986816,
        "y": 536.785807132721,
        "wires": []
    },
    {
        "id": "d0facd41.3bb66",
        "type": "function",
        "z": "7ac92c99.66ea94",
        "name": "Cambiar color (Nuevo)",
        "func": "var payload = msg.payload;\n\n// if (global.get(\"estIslaRGB\") === 0)return;\nif (payload.includes(\"living\") && payload.includes(\"color\")){\n\tglobal.set(\"estIslaRGB\", 1);\n\n\tif ((payload.includes(\"azul\") && payload.includes(\"muy\") && payload.includes(\"oscuro\")) || payload.includes(\"1\")){\n\t\tglobal.set(\"IslaR\",  0); global.set(\"IslaG\", 0);\tglobal.set(\"IslaB\", 102);\n\t\tmsg.payload = \"1\"; node.send([null, msg]);\n\t}\n\tif ((payload.includes(\"azul\") && payload.includes(\"oscuro\")) || payload.includes(\"2\")){\n\t\tglobal.set(\"IslaR\", 0);\tglobal.set(\"IslaG\", 0);\tglobal.set(\"IslaB\", 150);\n\t\tmsg.payload = \"2\"; node.send([null, msg]);\n\t}\n\tif (payload.includes(\"azul\")  || payload.includes(\"3\")){\n\t\tglobal.set(\"IslaR\", 0);\tglobal.set(\"IslaG\", 0);\tglobal.set(\"IslaB\", 255);\n\t\tmsg.payload = \"3\"; node.send([null, msg]);\n\t}\n\tif (payload.includes(\"rojo\")  || payload.includes(\"4\")){\n\t\tglobal.set(\"IslaR\", 255); global.set(\"IslaG\", 0); global.set(\"IslaB\", 0);\n\t\tmsg.payload = \"4\"; node.send([null, msg]);\n\t}\n\tif (payload.includes(\"verde\")  || payload.includes(\"5\")){\n\t\tglobal.set(\"IslaR\", 0);\tglobal.set(\"IslaG\", 255); global.set(\"IslaB\", 0);\n\t\tmsg.payload = \"5\"; node.send([null, msg]);\n\t}\n\tif (payload.includes(\"blanco\") || payload.includes(\"6\")){\n\t\tglobal.set(\"IslaR\", 255); global.set(\"IslaG\", 255);\tglobal.set(\"IslaB\", 255);\n\t\tmsg.payload = \"6\"; node.send([null, msg]);\n\t}\n\tif (payload.includes(\"amarillo\")  || payload.includes(\"7\")){\n\t\tglobal.set(\"IslaR\", 255); global.set(\"IslaG\", 255);\tglobal.set(\"IslaB\", 0);\n\t\tmsg.payload = \"7\"; node.send([null, msg]);\n\t}\n\tif (payload.includes(\"lila\") || payload.includes(\"8\")){\n\t\tglobal.set(\"IslaR\", 153); global.set(\"IslaG\", 0);\tglobal.set(\"IslaB\", 204);\n\t\tmsg.payload = \"8\"; node.send([null, msg]);\n\t}\n\tif (payload.includes(\"gris\") || payload.includes(\"9\")){\n\t\tglobal.set(\"IslaR\", 90); global.set(\"IslaG\", 90);\tglobal.set(\"IslaB\", 90);\n\t\tmsg.payload = \"9\"; node.send([null, msg]);\n\t}\t\n\tif ((payload.includes(\"gris\") && payload.includes(\"claro\")) || payload.includes(\"10\")){\n\t\tglobal.set(\"IslaR\", 50); global.set(\"IslaG\", 50);\tglobal.set(\"IslaB\", 50);\n\t\tmsg.payload = \"10\"; node.send([null, msg]);\n\t}\n\tif ((payload.includes(\"gris\") && payload.includes(\"oscuro\")) || payload.includes(\"11\")){\n\t\tglobal.set(\"IslaR\", 15); global.set(\"IslaG\", 15);\tglobal.set(\"IslaB\", 15);\n\t\tmsg.payload = \"11\"; node.send([null, msg]);\n\t}\n\tmsg = {topic: \"google/Living\", payload: \"blanco\"}; return msg;\t\t\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 652.7978210449219,
        "y": 506.7857856750488,
        "wires": [
            [
                "36115df0.567c42",
                "f545455.731d8b8",
                "d0e6ce07.4a58"
            ],
            []
        ]
    },
    {
        "id": "23f16719.2216e8",
        "type": "debug",
        "z": "7ac92c99.66ea94",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 836.9881582260132,
        "y": 346.92860174179077,
        "wires": []
    },
    {
        "id": "bb649691.2325e8",
        "type": "inject",
        "z": "7ac92c99.66ea94",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": " gris muy oscuro",
        "payloadType": "str",
        "x": 334.08337783813477,
        "y": 474.07144594192505,
        "wires": [
            [
                "d0facd41.3bb66"
            ]
        ]
    },
    {
        "id": "22bcd575.30145a",
        "type": "inject",
        "z": "7ac92c99.66ea94",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "color living gris muy oscuro",
        "payloadType": "str",
        "x": 309.464298248291,
        "y": 541.0714249610901,
        "wires": [
            [
                "d0facd41.3bb66"
            ]
        ]
    },
    {
        "id": "a434b87c.353a38",
        "type": "inject",
        "z": "7ac92c99.66ea94",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "activar alarma casa",
        "payloadType": "str",
        "x": 281.94052505493164,
        "y": 103.92860174179077,
        "wires": [
            [
                "f2b6cf60.3bf01"
            ]
        ]
    },
    {
        "id": "93d17e2b.1ecf1",
        "type": "inject",
        "z": "7ac92c99.66ea94",
        "name": "alacena",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "luces del lavadero alacena",
        "payloadType": "str",
        "x": 258.03570556640625,
        "y": 281.6071357727051,
        "wires": [
            [
                "3723238d.48cb5c"
            ]
        ]
    },
    {
        "id": "613374ae.4c1edc",
        "type": "http in",
        "z": "7ac92c99.66ea94",
        "name": "Request",
        "url": "/activar",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 271.94052505493164,
        "y": 138.59526586532593,
        "wires": [
            [
                "f2b6cf60.3bf01"
            ]
        ]
    },
    {
        "id": "33295f84.632f7",
        "type": "mqtt out",
        "z": "7ac92c99.66ea94",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "43555c62.30ed34",
        "x": 781.6072196960449,
        "y": 158.92859745025635,
        "wires": []
    },
    {
        "id": "e0426764.d08828",
        "type": "function",
        "z": "7ac92c99.66ea94",
        "name": "regula potencia (Nuevo)",
        "func": "var payload = msg.payload;\nvar estado = msg.estado;\nvar minimo = 6;\nvar maximo = 255;\n\n// if (!payload.includes(\"living\")) return;\nif (payload.includes(\"luces\") || payload.includes(\"luz\")){\n\tif (payload.includes(\"living\")){\n\t\tvar potencia;\n\t\tpotencia = payload.replace(/\\D/g,'');\n\t\tpotencia = parseInt(potencia * 255 / 100);\n\t\tif (payload.includes(\"minimo\") || payload.includes(\"mínimo\"))var potencia = minimo;\n\t\tif (payload.includes(\"maximo\") || payload.includes(\"máximo\"))var potencia = maximo;\n\t\tif (payload.includes(\"isla\")){\n\t\t\tglobal.set(\"potIsla\", potencia);\n\t\t\tmsg = {topic: \"google/Living\", payload: \"estIsla= \" + global.get(\"estIsla\")};\n\t\t\treturn msg;\n\t\t}\n\t\tif (payload.includes(\"cielo raso\")){\n\t\t\tglobal.set(\"potCielorrazo\", potencia);\n\t\t\tmsg = {topic: \"google/Living\", payload: \"estCielorrazo= \" + global.get(\"estCielorrazo\")};\n\t\t\treturn msg;\n\t\t}\n\t\tglobal.set(\"potLiving\", potencia);\n\t\tglobal.set(\"potIsla\", potencia);\n\t\tglobal.set(\"potCielorrazo\", potencia);\n        global.set(\"IslaR\", potencia);\n        global.set(\"IslaG\", potencia);\n        global.set(\"IslaB\", potencia);\n\t\tmsg = {topic: \"google/Living\", payload: \"estCielorrazo= \" + global.get(\"estCielorrazo\")};\n\t\treturn msg;\n\t}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 481.51206493377686,
        "y": 674.7977213859558,
        "wires": [
            [
                "838a8e76.22bf4",
                "300b7f5b.9609c"
            ]
        ]
    },
    {
        "id": "d0e6ce07.4a58",
        "type": "debug",
        "z": "7ac92c99.66ea94",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 863.3928718566895,
        "y": 451.42860746383667,
        "wires": []
    },
    {
        "id": "f80a5391.65bad",
        "type": "http in",
        "z": "7ac92c99.66ea94",
        "name": "Request",
        "url": "/desactivar",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 276.6071891784668,
        "y": 187.26192045211792,
        "wires": [
            [
                "eb1152.3061ceb"
            ]
        ]
    },
    {
        "id": "c26049d5.571fc8",
        "type": "http in",
        "z": "7ac92c99.66ea94",
        "name": "regular luces",
        "url": "/regularluces",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 238.98815822601318,
        "y": 676.78573179245,
        "wires": [
            [
                "e0426764.d08828",
                "73edbc93.9b89e4"
            ]
        ]
    },
    {
        "id": "73edbc93.9b89e4",
        "type": "debug",
        "z": "7ac92c99.66ea94",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 464.44052505493164,
        "y": 719.4286017417908,
        "wires": []
    },
    {
        "id": "dd2ec6d9.69a7b8",
        "type": "mqtt out",
        "z": "7ac92c99.66ea94",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "43555c62.30ed34",
        "x": 846.9881582260132,
        "y": 296.92860174179077,
        "wires": []
    },
    {
        "id": "94586275.a2467",
        "type": "inject",
        "z": "7ac92c99.66ea94",
        "name": "lavadero",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "luces del lavadero ",
        "payloadType": "str",
        "x": 266.9881582260132,
        "y": 256.92860174179077,
        "wires": [
            [
                "3723238d.48cb5c"
            ]
        ]
    },
    {
        "id": "259024da.a7b9ac",
        "type": "inject",
        "z": "7ac92c99.66ea94",
        "name": "lavadero",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "luces del lavadero ",
        "payloadType": "str",
        "x": 306.9881582260132,
        "y": 406.92860174179077,
        "wires": [
            [
                "15d3c9e4.d9caa6"
            ]
        ]
    },
    {
        "id": "2fa7e13d.b0570e",
        "type": "inject",
        "z": "7ac92c99.66ea94",
        "name": "alacena",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "luces del lavadero alacena",
        "payloadType": "str",
        "x": 298.03570556640625,
        "y": 431.6071357727051,
        "wires": [
            [
                "15d3c9e4.d9caa6"
            ]
        ]
    },
    {
        "id": "b431a03.de72c6",
        "type": "delay",
        "z": "7ac92c99.66ea94",
        "name": "",
        "pauseType": "delay",
        "timeout": "250",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 596.9881582260132,
        "y": 226.92860174179077,
        "wires": [
            [
                "3723238d.48cb5c",
                "8915996e.13abb8"
            ]
        ]
    },
    {
        "id": "3498fc21.c391d4",
        "type": "inject",
        "z": "7ac92c99.66ea94",
        "name": "desactivar alarma casa",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "desactivar alarma casa y prendeme la luz del lavadero",
        "payloadType": "str",
        "x": 256.9881582260132,
        "y": 66.92860174179077,
        "wires": [
            [
                "eb1152.3061ceb"
            ]
        ]
    },
    {
        "id": "8915996e.13abb8",
        "type": "debug",
        "z": "7ac92c99.66ea94",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 776.9881582260132,
        "y": 226.92860174179077,
        "wires": []
    },
    {
        "id": "3cbba0f1.1702a",
        "type": "debug",
        "z": "50119c6e.6ff584",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 430,
        "y": 40,
        "wires": []
    },
    {
        "id": "ea775eb.b6bcba",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2380,
        "y": 520,
        "wires": [
            [
                "5d6a27c3.aa6e28"
            ]
        ]
    },
    {
        "id": "52908e32.a7c6c",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "informarNivel",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 2400,
        "y": 570,
        "wires": [
            [
                "6426f42f.2ca5bc"
            ]
        ]
    },
    {
        "id": "af28e6c5.534938",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "bloqueoTeclas1",
        "payloadType": "str",
        "x": 1140,
        "y": 590,
        "wires": [
            [
                "d568dd07.8f5e2"
            ]
        ]
    },
    {
        "id": "916c08bd.e7ca88",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "bloqueoTeclas0",
        "payloadType": "str",
        "x": 1140,
        "y": 630,
        "wires": [
            [
                "d568dd07.8f5e2"
            ]
        ]
    },
    {
        "id": "49bf1e9d.427ec",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 670,
        "y": 600,
        "wires": [
            [
                "a4e7912a.1db0a"
            ]
        ]
    },
    {
        "id": "a4e7912a.1db0a",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 870,
        "y": 580,
        "wires": []
    },
    {
        "id": "d4599fda.594b8",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "var pin = parseInt(msg.pin);\nvar intPayload = parseInt(msg.payload);\nvar topic = msg.topic;\nvar dato;\n\nswitch (pin){\n  case 18:\n    global.set(\"itemPotencia\", msg.payload);\n    // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n      context.item = parseInt(msg.payload);\n      switch(parseInt(msg.payload)){\n          case 1:\n              msg = {pin: 19, min: 4, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n          break;\n          case 2:\n              msg = {pin: 19, min: 4, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n          break;\n          case 3:\n              msg = {pin: 19, min: 4, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n          break;\n          case 4:\n              msg = {pin: 19, min: 1, max: 255, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n          break;\n          case 5:\n              msg = {pin: 19, min: 1, max: 100, label: \"Ducha de bano\", payload: global.get(\"pwmDucha\")};\n          break;          \n          case 6:\n              msg = {pin: 19, min: 1, max: 100, label: \"Luz Bano\", payload: global.get(\"pwmLuzBano\")};\n          break;     \n          case 7:\n              msg = {pin: 19, min: 15, max: 240, label: \"timer extractor baño\", payload: global.get(\"timerExtractorBano\")};\n          break;\n          case 8:\n              msg = {pin: 19, min: 10, max: 200, label: \"tiempo MIN teclas\", payload: global.get(\"minTeclas\")};\n          break;          \n          case 9:\n              msg = {pin: 19, min: 400, max: 2000, label: \"tiempo MAX teclas\", payload: global.get(\"maxTeclas\")};\n          break;       \n          case 10:\n              msg = {pin: 19, min: 1, max: 100, label: \"delay buzzer\", payload: global.get(\"delayBuzzer\")};\n          break;                      \n      }\n      node.send([null, msg]);\n      return;\n    // }\n  break;\n\n  case 19:\n    // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n      var valor = parseInt(msg.payload);\n      switch(context.item){\n          case 1:\n              // if (global.get(\"estLiving\") === 0)return;\n              global.set(\"potLiving\", valor);\n              global.set(\"potIsla\", valor);\n              global.set(\"potCielorrazo\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 2:\n              // if (global.get(\"estIsla\") === 0)return;\n              global.set(\"potIsla\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 3:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"potCielorrazo\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 4:\n              // if (global.get(\"Dia\") === 1)return;\n              global.set(\"pwmPatioLuz\", valor);\n              enviarMQTT(\"patioLuz\");\n              return;\n          case 5:\n              // if (global.get(\"estDucha\") === 0)return;  \n              global.set(\"pwmDucha\", valor);\n              enviarMQTT(\"bano\");\n              return;\n          case 6:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLuzBano\", valor);\n              enviarMQTT(\"bano\");\n              return;     \n      case 7:\n              global.set(\"timerExtractorBano\", valor);\n              enviarMQTT(\"bano\");\n              return;\n          case 8:\n              global.set(\"minTeclas\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;     \n      case 9:\n              global.set(\"maxTeclas\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;              \n        case 10:  \n              global.set(\"delayBuzzer\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;              \n            }  \n          break;\n}\n\nfunction enviarMQTT(caso){\nvar dato;\n  if (caso == \"bano\"){\n  dato = global.get(\"estLuzBano\") + \"#\" + global.get(\"pwmLuzBano\") + \"#\" + global.get(\"modoDucha\") + \"#\" + global.get(\"estDucha\") + \"#\" + global.get(\"pwmDucha\");\n  dato += \"#\" + global.get(\"estLuzEspejo\") + \"#\" + global.get(\"estExtractorBano\") + \"#\" + global.get(\"timerExtractorBano\") + \"#\" + global.get(\"Dia\");\n    msg = {topic: \"ESP/Bano/Recibo\", payload: dato};\n  }\n\n  if (caso == \"patioLuz\"){msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")};}\n  \n\n  if (caso == \"living\"){\n    dato = global.get(\"estIsla\") + \",\";\n    dato += global.get(\"potIsla\") + \"#\";\n    dato += global.get(\"estCielorrazo\") + \",\";\n    dato += global.get(\"potCielorrazo\") + \"#\";  \n    dato += global.get(\"estIslaRGB\") + \",\";\n    dato += global.get(\"IslaR\") + \",\";\n    dato += global.get(\"IslaG\") + \",\";      \n    dato += global.get(\"IslaB\") + \"#\";\n\n    dato += global.get(\"pwmMaxLed\") + \"#\";\n    dato += global.get(\"pwmMinLed\") + \"#\";\n\n    dato += global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"doblePuls\");\n    dato += \"#\" + global.get(\"Dia\");\n\n    msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n    node.send([msg, null]);\n  }\n  if (caso == \"configGenericas\"){\n    dato = global.get(\"minTeclas\") + \"#\";\n  dato += global.get(\"maxTeclas\") + \"#\";\n  dato += global.get(\"delayBuzzer\");\n  msg = {topic: \"configTeclas\", payload: dato};\n  }\n\nnode.send([msg, null]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 260,
        "y": 280,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "156d91dc.8dc6ce",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "USBin",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1500,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "27246e94.692872",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "if (msg.payload.substring(0, 9) == \"Resultado\"){\n    msg = {topic: \"terminalBlynk\", payload: msg.payload};\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 1700,
        "y": 920,
        "wires": [
            [
                "4bc2da12.2c62d4"
            ]
        ]
    },
    {
        "id": "4bc2da12.2c62d4",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "pedido",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1840,
        "y": 910,
        "wires": []
    },
    {
        "id": "2b6e7641.a45dfa",
        "type": "mqtt out",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "USBout",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 570,
        "y": 1200,
        "wires": []
    },
    {
        "id": "8847dfbb.b88ad",
        "type": "template",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "medicion",
        "output": "str",
        "x": 380,
        "y": 1210,
        "wires": [
            [
                "2b6e7641.a45dfa"
            ]
        ]
    },
    {
        "id": "60955f88.18ba3",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 1180,
        "wires": [
            [
                "8847dfbb.b88ad"
            ]
        ]
    },
    {
        "id": "8491f917.c4e458",
        "type": "inject",
        "z": "230e7f04.aca52",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 410,
        "y": 140,
        "wires": [
            [
                "5cae64fe.b91d4c"
            ]
        ]
    },
    {
        "id": "5cae64fe.b91d4c",
        "type": "mqtt out",
        "z": "230e7f04.aca52",
        "name": "",
        "topic": "app",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 630,
        "y": 150,
        "wires": []
    },
    {
        "id": "b3b788dd.6d8f38",
        "type": "mqtt in",
        "z": "230e7f04.aca52",
        "name": "",
        "topic": "app",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 550,
        "y": 90,
        "wires": [
            [
                "403a458.e829abc"
            ]
        ]
    },
    {
        "id": "403a458.e829abc",
        "type": "debug",
        "z": "230e7f04.aca52",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 710,
        "y": 90,
        "wires": []
    },
    {
        "id": "4db7751a.afaa9c",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 255,
        "y": 281,
        "wires": []
    },
    {
        "id": "20844f68.97aff",
        "type": "http response",
        "z": "65561250.4225fc",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 890,
        "y": 270,
        "wires": []
    },
    {
        "id": "846055d3.225218",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "context.setTempCasa= context.setTempCasa || 0;\ncontext.setTempMinima = context.setTempMinima || 0;\ncontext.setTempPID = context.setTempPID || 0;\n\nif (msg.payload.estado == \"PedidoInicial\"){\n    // msg = {app: 1};\n    msg.app= \"1\";\n    return ([null, msg, null]);\n}\nif (msg.payload.estado == \"Pedido\"){\n    // msg = {app: 1};\n    msg.app= \"1\";\n    return ([null, msg, null]);\n}\n//estado=estadoSalamandra\n\nif (msg.payload.estado.substring(0, 16) == \"estadoSalamandra\"){\n    msg.payload.estado = msg.payload.estado.substring(16);\n    global.set(\"estadoSalamandra\", parseInt(msg.payload.estado));\n    msg.app= \"1\";\n    node.send ([null, msg, null]);\n    msg = {topic: \"salamandra/Encendido\", payload: 1}; \n    return ([null, null, msg]);\n}\n\nif (msg.payload.estado.substring(0, 7) == \"marcha0\"){\n    global.set(\"salamandraPausa\", 1);\n    node.status({text: global.get(\"salamandraPausa\")});\n    msg.app= \"1\"; node.send([null, msg, null]);\n\tmsg = {topic: \"salamandra/Inicio\", payload: 1}; \n    return ([null, null, msg]);\n}    \n    \nif (msg.payload.estado.substring(0, 7) == \"marcha1\"){\n    global.set(\"salamandraPausa\", 2);\n    node.status({text: global.get(\"salamandraPausa\")});\n    msg.app= \"1\"; node.send([null, msg, null]);\n\tmsg = {topic: \"salamandra/Inicio\", payload: 1}; \n    return ([null, null, msg]);\n}     \n    // global.set(\"salamandraPausa\", 0);\n    // if (msg.payload.estado.substring(6, 7) == \"1\")global.set(\"salamandraPausa\", 1);\n    // {global.set(\"salamandraPausa\", 1);}\n    // else{\n    //     global.set(\"salamandraPausa\", 0);\n    // }\n    \n// \tglobal.set(\"salamandraPausa\", msg.payload.estado.substring(6));\n// \tnode.status({text: global.get(\"salamandraPausa\")});\n// // \tnode.status({text: msg.payload.estado.substring(6)});\n// \tmsg = {topic: \"salamandra/Inicio\", payload: 1}; \n//     return ([null, null, msg]);\n// }\n\nif (msg.payload.estado.substring(0, 3) == \"sal\"){\n    msg.payload.estado = msg.payload.estado.substring(3);\n    var dato = msg.payload.estado.split(\"-\");//global.get(\"AutoMan\");\n    if (parseInt(dato[10]) === 0)return;\n    global.set(\"salamandraAuto\", parseInt(dato[0]));\n    global.set(\"salamandraBbaCirc\", parseInt(dato[1]));\n    global.set(\"salamandraBbaRad\", parseInt(dato[2]));\n    global.set(\"salamandraBbaTermo\", parseInt(dato[3]));\n    // global.set(\"estadoTurbo\", parseInt(dato[4]));    \n    global.set(\"aire1\", parseInt(dato[4]));\n    global.set(\"aire2\", parseInt(dato[5]));\n    global.set(\"aire3\", parseInt(dato[6]));\n    global.set(\"aire4\", parseInt(dato[7]));\n    global.set(\"aireChimenea\", parseInt(dato[8]));\n    global.set(\"setPointPID\", parseInt(dato[9]));\n    global.set(\"diffTempMinimoSalamandra\", parseInt(dato[10]));\n    global.set(\"setTempCasa\", parseInt(dato[11]));\n    \n    if (dato[10] != context.setTempPID){\n        context.setTempPID = parseInt(dato[10]);\n        msg = {topic: \"salamandra/inPid\", setpoint: global.get(\"setPointPID\")}; \n        node.send([null, null, msg]);\n    }\n    \n    dato = global.get(\"salamandraAuto\") + \" -- \"\n    dato += global.get(\"bombaCirculadora\") + \" -- \"\n    dato += global.get(\"bombaRadiadores\") + \" -- \"\n    dato += global.get(\"bombaTermo\") + \" -- \"\n    dato += global.get(\"aire1\") + \" -- \"\n    dato += global.get(\"aire2\") + \" -- \"\n    dato += global.get(\"aire3\") + \" -- \"\n    dato += global.get(\"aire4\") + \" -- \"  \n    dato += global.get(\"aireChimenea\") + \" -- \"\n    dato += global.get(\"setPointPID\") + \" -- \"\n    dato += global.get(\"diffTempMinimoSalamandra\") + \" -- \"\n    dato += global.get(\"setTempCasa\");\n    msg.app= \"1\";\n    node.send ([null, msg, null]);\n    msg = {topic: \"salamandra/Inicio\", payload: 1}; node.send ([null, null, msg]);\n    msg = {topic: \"salamandra/Envio/PedidoEstado\", payload: 1}; \n    return ([null, null, msg]);\n}\n\n\n// msg.payload = \"sin estado\"; return msg;",
        "outputs": 3,
        "noerr": 0,
        "x": 345,
        "y": 311,
        "wires": [
            [
                "6f2f50e6.ed7df",
                "ab871406.14a158"
            ],
            [
                "5632122d.b59e1c",
                "36f1eb48.7fcb94"
            ],
            [
                "89cb398.6194fc8",
                "bbae1284.f403b"
            ]
        ]
    },
    {
        "id": "c0e7f8c8.467858",
        "type": "comment",
        "z": "65561250.4225fc",
        "name": "",
        "info": "AutoMan\nbomba Circ\nbomba Rad\nbomba Termo\nAire1\nAire2\nAire3\nAire4\n\n1\n",
        "x": 140,
        "y": 30,
        "wires": []
    },
    {
        "id": "1c3cbb6b.b13a55",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 80,
        "wires": [
            [
                "d361cbfe.b5ce88"
            ]
        ]
    },
    {
        "id": "d361cbfe.b5ce88",
        "type": "file in",
        "z": "65561250.4225fc",
        "name": "recover datos termo",
        "filename": "/home/pi/BackUpNodeRed/Salamandra.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 390,
        "y": 80,
        "wires": [
            [
                "28ccd5a3.d6e7ba",
                "5b4f292a.00ed68"
            ]
        ]
    },
    {
        "id": "e7200e51.1312a",
        "type": "file",
        "z": "65561250.4225fc",
        "name": "back datos termo",
        "filename": "/home/pi/BackUpNodeRed/Salamandra.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 510,
        "y": 198,
        "wires": [
            []
        ]
    },
    {
        "id": "58f7f2da.1362dc",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "inicial",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "2",
        "topic": "inicial",
        "payload": "1#1#0#0#0#0#50#60#70#80#72",
        "payloadType": "str",
        "x": 147,
        "y": 204,
        "wires": [
            [
                "a6ec15ee.8e8e78"
            ]
        ]
    },
    {
        "id": "a6ec15ee.8e8e78",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "// var dato = msg.payload;\n// if (dato.includes(\"undefined\") === true){\n//     msg.payload = 1;\n//     node.send([null, msg]);\n//     return;\n// }\n// if (msg.payload.estado.includes(\"Pedido\"))return;\nglobal.set(\"tempPatioLuz\", 1);\nif (msg.topic == \"inicial\"){// && isNaN(global.get(\"salamandraAuto\"))){\n    global.set(\"estadoSalamandra\", 1);//1\n    global.set(\"salamandraAuto\", 1);\n    global.set(\"salamandraBbaCirc\", 0);\n    global.set(\"salamandraBbaRad\", 1);\n    global.set(\"salamandraBbaTermo\", 0);\n    // global.set(\"estadoTurbo\", 0);    \n    global.set(\"aire1\", 0);\n    global.set(\"aire2\", 0);\n    global.set(\"aire3\", 0);\n    global.set(\"aire4\", 0);\n    global.set(\"aireChimenea\", 0);\n    global.set(\"setPointPID\", 69);    \n    global.set(\"diffTempMinimoSalamandra\", 55);//13\n    global.set(\"setTempCasa\", 23);\n}\n\nvar dato = global.get(\"estadoSalamandra\") + \"-\";\ndato += global.get(\"salamandraAuto\") + \"-\";\ndato += global.get(\"salamandraBbaCirc\") + \"-\";\ndato += global.get(\"salamandraBbaRad\") + \"-\";\ndato += global.get(\"salamandraBbaTermo\") + \"-\";\n// dato += global.get(\"estadoTurbo\") + \"-\";\ndato += global.get(\"aire1\") + \"-\";\ndato += global.get(\"aire2\") + \"-\";\ndato += global.get(\"aire3\") + \"-\";\ndato += global.get(\"aire4\") + \"-\";\ndato += global.get(\"aireChimenea\") + \"-\";\ndato += global.get(\"setPointPID\") + \"-\";\ndato += global.get(\"diffTempMinimoSalamandra\") + \"-\";\ndato += global.get(\"setTempCasa\");\nmsg.payload = dato;\nnode.status({text: dato});\n// if (msg.payload.includes(\"undefined\") === true){\n//     msg = {topic: \"salamandra/backUp/recovery\", payload: 1}; node.send([null, msg]);\n//     return;\n// }\nnode.status({text: \"aa \" + dato});\n// if (msg.payload.estado.includes(\"Pedido\"))return;\nreturn msg;",
        "outputs": 2,
        "noerr": 0,
        "x": 336,
        "y": 218,
        "wires": [
            [
                "45e03c79.d4fad4",
                "e7200e51.1312a"
            ],
            []
        ]
    },
    {
        "id": "d77f0205.e7ea1",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "Salamandra",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 720,
        "y": 20,
        "wires": []
    },
    {
        "id": "5b4f292a.00ed68",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "var dato = msg.payload.split(\"-\");\nglobal.set(\"estadoSalamandra\", dato[0]);\nglobal.set(\"salamandraAuto\", dato[1]);\nglobal.set(\"salamandraBbaCirc\", dato[2]);\nglobal.set(\"salamandraBbaRad\", dato[3]);\nglobal.set(\"salamandraBbaTermo\", dato[4]);\n// global.set(\"estadoTurbo\", dato[5]);\nglobal.set(\"aire1\", dato[5]);\nglobal.set(\"aire2\", dato[6]);\nglobal.set(\"aire3\", dato[7]);\nglobal.set(\"aire4\", dato[8]);\nglobal.set(\"aireChimenea\", dato[9]);\nglobal.set(\"setPointPID\", dato[10]);\nglobal.set(\"diffTempMinimoSalamandra\", dato[12]);\nglobal.set(\"setTempCasa\", dato[13]);\n\nmsg.payload = global.get(\"estadoSalamandra\") + \"-\";\nmsg.payload += global.get(\"salamandraAuto\") + \"-\";\nmsg.payload += global.get(\"salamandraBbaCirc\") + \"-\";\nmsg.payload += global.get(\"salamandraBbaRad\") + \"-\";\nmsg.payload += global.get(\"salamandraBbaTermo\") + \"-\";\n// msg.payload += global.get(\"estadoTurbo\") + \"-\";\nmsg.payload += global.get(\"aire1\") + \"-\";\nmsg.payload += global.get(\"aire2\") + \"-\";\nmsg.payload += global.get(\"aire3\") + \"-\";\nmsg.payload += global.get(\"aire4\") + \"-\";\nmsg.payload += global.get(\"aireChimenea\") + \"-\";\nmsg.payload += global.get(\"setPointPID\") + \"-\";\nmsg.payload += global.get(\"diffTempMinimoSalamandra\") + \"-\";\nmsg.payload += global.get(\"setTempCasa\");\n\nif (msg.topic == \"salamandra/backUp/recovery\"){\n\t msg = {topic: \"salamandra/inPid\", payload: global.get(\"setPointPID\")}; node.send([null, msg]);  \n\t return;\n}\n\n// msg.payload += parseInt(10 * Math.random()) + \"-\";\n// msg.payload += parseInt(10 * Math.random()) + \"-\";\n// msg.payload += parseInt(1 * Math.random()) + \"-\";\n// msg.payload += parseInt(100 * Math.random()) + \"-\";\n// msg.payload += parseInt(100 * Math.random()) + \"-\";\n// msg.payload += parseInt(100 * Math.random()) + \"-\";\n// msg.payload += parseInt(100 * Math.random());\n\nif (msg.app == \"1\"){\n    // msg.payload += \"  - \" + global.get(\"hsCpu\");\n    // msg.payload += \"-\" + global.get(\"tempExterior\");\n    // msg.payload += \"-\" + global.get(\"tempPatioLuz\");\n    // msg.payload += \"-\" + global.get(\"tempLavadero\");\n    // msg.payload += \"-\" + global.get(\"tempPasillo\");\n    // msg.payload += \"-\" + global.get(\"tempLiving\");\n    // msg.payload += \"-\" + global.get(\"tempExterior\");\n    node.send([msg, null]);\n    msg = {topic: \"salamandra/Envio/PedidoEstado\", payload: 1}; node.send([null, msg]);   \n    msg = {topic: \"salamandra/inPid\", payload: global.get(\"setPointPID\")}; node.send([null, msg]); \n    return;\n}\n    \nif (msg.salamandra == \"1\"){\n    msg = {topic: \"salamandra/Envio/PedidoEstado\", payload: 1}; node.send([null, msg]);   \n    msg = {topic: \"salamandra/inPid\", payload: global.get(\"setPointPID\")}; node.send([null, msg]); \n    return;   \n}\n\n",
        "outputs": 2,
        "noerr": 0,
        "x": 570,
        "y": 80,
        "wires": [
            [
                "d77f0205.e7ea1",
                "89c4b954.7c2528"
            ],
            [
                "b55d0684.92dc98",
                "7ead4ddf.087944"
            ]
        ]
    },
    {
        "id": "6f2f50e6.ed7df",
        "type": "link out",
        "z": "65561250.4225fc",
        "name": "pedidoInicialEstadoSalamandra",
        "links": [
            "7d3e3fa9.e0d3c"
        ],
        "x": 470,
        "y": 271,
        "wires": []
    },
    {
        "id": "7d3e3fa9.e0d3c",
        "type": "link in",
        "z": "65561250.4225fc",
        "name": "",
        "links": [
            "6f2f50e6.ed7df",
            "27eb1174.97129e"
        ],
        "x": 235,
        "y": 50,
        "wires": [
            [
                "e035e0d0.d5c2c",
                "d361cbfe.b5ce88"
            ]
        ]
    },
    {
        "id": "89c4b954.7c2528",
        "type": "link out",
        "z": "65561250.4225fc",
        "name": "respuestaApp",
        "links": [],
        "x": 675,
        "y": 60,
        "wires": []
    },
    {
        "id": "76beb0b0.68eb5",
        "type": "link in",
        "z": "65561250.4225fc",
        "name": "",
        "links": [
            "116f9afe.9947c5",
            "df8b4a86.664ce8"
        ],
        "x": 795,
        "y": 250,
        "wires": [
            [
                "b762ebc8.f81368",
                "20844f68.97aff"
            ]
        ]
    },
    {
        "id": "28ccd5a3.d6e7ba",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 560,
        "y": 38,
        "wires": []
    },
    {
        "id": "e035e0d0.d5c2c",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 340,
        "y": 40,
        "wires": []
    },
    {
        "id": "2e188d3a.689a92",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 104,
        "y": 374,
        "wires": [
            [
                "1ad520ae.27b98f"
            ]
        ]
    },
    {
        "id": "1ad520ae.27b98f",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "    msg = {salamandra: \"1\", payload: \"estado\"};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 234,
        "y": 374,
        "wires": [
            [
                "27eb1174.97129e"
            ]
        ]
    },
    {
        "id": "7ead4ddf.087944",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "App",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 710,
        "y": 130,
        "wires": []
    },
    {
        "id": "b55d0684.92dc98",
        "type": "mqtt out",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 710,
        "y": 90,
        "wires": []
    },
    {
        "id": "bdacff03.59e9e",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "App",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 279,
        "y": 416,
        "wires": []
    },
    {
        "id": "3f567b72.9923c4",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 119,
        "y": 416,
        "wires": [
            [
                "bdacff03.59e9e"
            ]
        ]
    },
    {
        "id": "def92016.fba6f",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "Automatico",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "auto",
        "payload": "1",
        "payloadType": "num",
        "x": 150,
        "y": 470,
        "wires": [
            [
                "9620c90.0493538"
            ]
        ]
    },
    {
        "id": "fc476015.19c73",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "Manual",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "auto",
        "payload": "0",
        "payloadType": "num",
        "x": 160,
        "y": 510,
        "wires": [
            [
                "9620c90.0493538"
            ]
        ]
    },
    {
        "id": "9620c90.0493538",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "Auto/Man",
        "func": "if (msg.topic == \"auto\"){\n    global.set(\"salamandraAuto\", parseInt(msg.payload));\n}\n\nmsg.payload = global.get(\"salamandraAuto\") + \"-\";\nmsg.payload += parseInt(10 * Math.random()) + \"-\";\nmsg.payload += parseInt(10 * Math.random()) + \"-\";\nmsg.payload += parseInt(10 * Math.random()) + \"-\";\nmsg.payload += parseInt(100 * Math.random()) + \"-\";\nmsg.payload += parseInt(100 * Math.random()) + \"-\";\nmsg.payload += parseInt(100 * Math.random()) + \"-\";\nmsg.payload += parseInt(100 * Math.random());\nreturn msg;\n\nif (msg.app == \"1\"){\n    // msg.payload += \"  - \" + global.get(\"hsCpu\");\n    return([msg, null]);}\n    \nif (msg.salamandra == \"1\")return([null, msg]);    \n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 300,
        "y": 480,
        "wires": [
            [
                "f31ed485.cf1638"
            ]
        ]
    },
    {
        "id": "825a44b0.f2d258",
        "type": "link in",
        "z": "65561250.4225fc",
        "name": "",
        "links": [
            "5632122d.b59e1c",
            "f31ed485.cf1638",
            "664c1386.9587ec"
        ],
        "x": 63,
        "y": 240,
        "wires": [
            [
                "de8103cc.cf9f7",
                "33f0296.317e7d6"
            ]
        ]
    },
    {
        "id": "ed9ca648.e58918",
        "type": "link in",
        "z": "65561250.4225fc",
        "name": "",
        "links": [
            "5632122d.b59e1c",
            "63eaebae.f4f3e4",
            "664c1386.9587ec"
        ],
        "x": 755,
        "y": 340,
        "wires": [
            [
                "bf604a8b.05ad38",
                "7a152c17.ed02c4"
            ]
        ]
    },
    {
        "id": "bf604a8b.05ad38",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "var dato = global.get(\"salamandraAuto\") + \" -- \"\ndato += global.get(\"salamandraBbaCirc\") + \" -- \"\ndato += global.get(\"salamandraBbaRad\") + \" -- \"\ndato += global.get(\"salamandraBbaTermo\") + \" -- \"\n// dato += global.get(\"estadoTurbo\") + \" -- \"\ndato += global.get(\"aire1\") + \" -- \"\ndato += global.get(\"aire2\") + \" -- \"\ndato += global.get(\"aire3\") + \" -- \"\ndato += global.get(\"aire4\")\n// dato += global.get(\"bombaCirculadora\") + \" -- \"\n\n\nnode.status({text: dato})",
        "outputs": 1,
        "noerr": 0,
        "x": 870,
        "y": 350,
        "wires": [
            []
        ]
    },
    {
        "id": "7a152c17.ed02c4",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "App",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 870,
        "y": 310,
        "wires": []
    },
    {
        "id": "5632122d.b59e1c",
        "type": "link out",
        "z": "65561250.4225fc",
        "name": "PedidoEstadoSalamandra",
        "links": [
            "ed9ca648.e58918",
            "825a44b0.f2d258",
            "fa751805.ebbdd8"
        ],
        "x": 470,
        "y": 311,
        "wires": []
    },
    {
        "id": "27eb1174.97129e",
        "type": "link out",
        "z": "65561250.4225fc",
        "name": "pedidoEstadoSalamandra",
        "links": [
            "7d3e3fa9.e0d3c"
        ],
        "x": 319,
        "y": 374,
        "wires": []
    },
    {
        "id": "78691845.de5d18",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "//1#0#0#0#750.2#125.2#115.2#78.5#10#15#25#35#21.2#22.5#23.6#21.2#22.5#23.6\n// if (isNaN(global.get(\"tempPatioLuz\")))\n\nglobal.set(\"tempPatioLuz\", 1);\nif (global.get(\"tempBajTermo\") === undefined)global.set(\"tempBajTermo\", 0);\nif (global.get(\"tempSubTermo\") === undefined)global.set(\"tempSubTermo\", 0);\n// if (global.get(\"estadoTurboF\") === undefined)global.set(\"estadoTurboF\", 1);\n// if (global.get(\"salamandraPausa\") === undefined)global.set(\"salamandraPausa\", 1);\n\nmsg.payload = global.get(\"estadoSalamandra\");//1\nmsg.payload += \"#\" + global.get(\"salamandraAuto\");//2\nmsg.payload += \"#\" + global.get(\"salamandraBbaCirc\");//3 bomba circ\nmsg.payload += \"#\" + global.get(\"salamandraBbaRad\");//4 bomba radiadores\nmsg.payload += \"#\" + global.get(\"salamandraBbaTermo\");//5 bomba termo\n\n// if ()\n// msg.payload += \"#1\";// + flow.get(\"estadoTurboF\");\n// msg.payload += \"#\" + flow.get(\"estadoTurboF\");\n\nmsg.payload += \"#\" + global.get(\"tempCamara\") + \" (\" + global.get(\"DiftempCamara\") + \")\";//7 temp camara comb\nmsg.payload += \"#\" + global.get(\"tempSerp1Fuego\") + \" (\" + global.get(\"DiftempSerp1Fuego\") + \")\";//8 temp 1 serpentinaFuego\nmsg.payload += \"#\" + global.get(\"tempSerp2Fuego\") + \" (\" + global.get(\"DiftempSerp2Fuego\") + \")\";//9 temp 2 serpentinaFuego\nmsg.payload += \"#\" + global.get(\"tempChimenea\") + \" (\" + global.get(\"DiftempChimenea\") + \")\";//10 temp chimeneaFuego\n\nmsg.payload += \"#\" + global.get(\"tempRetRadiadores\") + \" (\" + global.get(\"DiftempRetRadiadores\") + \")\";//11 tempRetRadiadores\nmsg.payload += \"#\" + global.get(\"tempDepRadiadores\") + \" (\" + global.get(\"DiftempDepRadiadores\") + \")\";//12 tempIdaRadiadores\n\nmsg.payload += \"#\" + global.get(\"tempSerp1Agua\") + \" (\" + global.get(\"DiftempSerp1Agua\") + \")\";//13 temp ida Termo\nmsg.payload += \"#\" + global.get(\"tempSerpCamara\") + \" (\" + global.get(\"DiftempSerpCamara\") + \")\";//14 temp sal. serpentina camara\n\nmsg.payload += \"#\" + global.get(\"tempDepTermo\") + \" (\" + global.get(\"DiftempDepTermo\") + \")\";//15 tempRetRadiadores\n\nmsg.payload += \"#\" + flow.get(\"aire1F\");//16aire encendido\nmsg.payload += \"#\" + flow.get(\"aire2F\");//17 aire primario\nmsg.payload += \"#\" + flow.get(\"aire3F\");//18aire secundario\nmsg.payload += \"#\" + flow.get(\"aire4F\");//19 aire terciario}\n\n// msg.payload += \"#\" + global.get(\"aire1\");//16aire encendido\n// msg.payload += \"#\" + global.get(\"aire2\");//17 aire primario\n// msg.payload += \"#\" + global.get(\"aire3\");//18aire secundario\n// msg.payload += \"#\" + global.get(\"aire4\");//19 aire terciario\nmsg.payload += \"#\" + global.get(\"tempExterior\") + \"º\";//20temp exterior\nmsg.payload += \"#\" + global.get(\"tempPatioLuz\") + \"º\";//21 temp patio luz\nmsg.payload += \"#\" + global.get(\"tempLavadero\") + \"º\";//22 temp lavadero\nmsg.payload += \"#\" + global.get(\"tempPasillo\") + \"º\";//23 temp pasillo\nmsg.payload += \"#\" + parseFloat(global.get(\"tempLiving\")).toFixed(1) + \"º  \" + parseInt(global.get(\"humLiving\")) + \"%\";//24 temp living\nmsg.payload += \"#\" + global.get(\"tempTermoFin\") + \"º\";//25 temp termo\n\nmsg.payload += \"#\" + flow.get(\"aireChimeneaF\");\n\n// msg.payload += \"#\" + global.get(\"aireChimenea\");//26\nmsg.payload += \"#\" + global.get(\"setPointPID\");\nmsg.payload += \"#55\";// + global.get(\"diffTempMinimoSalamandra\");\nmsg.payload += \"#24\";// + global.get(\"setTempCasa\");\n// msg.payload += \"#\" + parseFloat(global.get(\"tempLiving\")).toFixed(0) + \"º - \" + parseFloat(global.get(\"humLiving\")).toFixed(0) + \"%\";\nmsg.payload += \"#\" + global.get(\"tempBajTermo\");\nmsg.payload += \"#\" + global.get(\"tempSubTermo\");\nif (parseInt(global.get(\"salamandraPausa\")) === 1)msg.payload += \"#0\";// + global.get(\"salamandraPausa\");\nif (parseInt(global.get(\"salamandraPausa\")) === 2)msg.payload += \"#1\";// + global.get(\"salamandraPausa\");\nmsg.payload += \"#\" + global.get(\"salamandraPausa\");//global.get(\"tempHabitacion\")\nmsg.payload += \"#\" + parseFloat(global.get(\"tempHabitacion\")).toFixed(1) + \"º  \" + parseInt(global.get(\"humHabitacion\")) + \"%\";//24 temp living\nnode.status({text: msg.payload});\n// msg.payload += \"#\" + global.get(\"tempTermoFin\") + \" ºC\";\n// msg.payload += \"#\" + global.get(\"tempTermoFin\") + \" ºC\";\n\n// if (msg.payload.includes(\"undefined\")){\n// \tmsg = {topic: \"salamandra/backUp/recovery\", payload: 1}; node.send([null, msg]); return;\n// }\n\nreturn msg; \n\n\n",
        "outputs": 2,
        "noerr": 0,
        "x": 932,
        "y": 167,
        "wires": [
            [
                "df8b4a86.664ce8",
                "3b4fa2da.6010ce"
            ],
            [
                "cc34fc4c.203c2"
            ]
        ]
    },
    {
        "id": "fa751805.ebbdd8",
        "type": "link in",
        "z": "65561250.4225fc",
        "name": "",
        "links": [
            "5632122d.b59e1c"
        ],
        "x": 645,
        "y": 190,
        "wires": [
            [
                "78402b6c.725834",
                "e1585581.43a3a8"
            ]
        ]
    },
    {
        "id": "df8b4a86.664ce8",
        "type": "link out",
        "z": "65561250.4225fc",
        "name": "respuestaApp",
        "links": [
            "76beb0b0.68eb5"
        ],
        "x": 1079,
        "y": 125,
        "wires": []
    },
    {
        "id": "f31ed485.cf1638",
        "type": "link out",
        "z": "65561250.4225fc",
        "name": "EstadoSalamandra",
        "links": [
            "825a44b0.f2d258"
        ],
        "x": 385,
        "y": 480,
        "wires": []
    },
    {
        "id": "b762ebc8.f81368",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 890,
        "y": 230,
        "wires": []
    },
    {
        "id": "3b4fa2da.6010ce",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 944,
        "y": 76,
        "wires": []
    },
    {
        "id": "78402b6c.725834",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 880,
        "y": 130,
        "wires": []
    },
    {
        "id": "ac1dab87.86d418",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "Si",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "auto",
        "payload": "1",
        "payloadType": "num",
        "x": 160,
        "y": 550,
        "wires": [
            [
                "facf49d2.b050d8"
            ]
        ]
    },
    {
        "id": "bf877ba0.b56668",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "No",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "auto",
        "payload": "0",
        "payloadType": "num",
        "x": 160,
        "y": 590,
        "wires": [
            [
                "facf49d2.b050d8"
            ]
        ]
    },
    {
        "id": "facf49d2.b050d8",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "bombaTermo",
        "func": "    global.set(\"salamandraBbaTermo\", parseInt(msg.payload));\n",
        "outputs": 1,
        "noerr": 0,
        "x": 310,
        "y": 570,
        "wires": [
            []
        ]
    },
    {
        "id": "c6d6e9de.d973a8",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "Si",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "auto",
        "payload": "1",
        "payloadType": "num",
        "x": 158.75,
        "y": 705.0000104904175,
        "wires": [
            [
                "b0de88a.72fd078"
            ]
        ]
    },
    {
        "id": "b0de88a.72fd078",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "bombaCirc",
        "func": "    global.set(\"bombaCirculadora\", parseInt(msg.payload));\n",
        "outputs": 1,
        "noerr": 0,
        "x": 308.75,
        "y": 725.0000104904175,
        "wires": [
            []
        ]
    },
    {
        "id": "95b8d4b1.31ad38",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "No",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "auto",
        "payload": "0",
        "payloadType": "num",
        "x": 158.75,
        "y": 745.0000104904175,
        "wires": [
            [
                "b0de88a.72fd078"
            ]
        ]
    },
    {
        "id": "2d192673.7154ba",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "Si",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "auto",
        "payload": "1",
        "payloadType": "num",
        "x": 160,
        "y": 630,
        "wires": [
            [
                "842c5e52.33947"
            ]
        ]
    },
    {
        "id": "842c5e52.33947",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "bombaRad",
        "func": "    global.set(\"bombaRadiadores\", parseInt(msg.payload));\n",
        "outputs": 1,
        "noerr": 0,
        "x": 310,
        "y": 650,
        "wires": [
            []
        ]
    },
    {
        "id": "5ba7d7e5.ca4f18",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "No",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "auto",
        "payload": "0",
        "payloadType": "num",
        "x": 160,
        "y": 670,
        "wires": [
            [
                "842c5e52.33947"
            ]
        ]
    },
    {
        "id": "dc70c9c.2b0bc38",
        "type": "function",
        "z": "7ac92c99.66ea94",
        "name": "",
        "func": "if (msg.payload == \"1\"){\n    msg = {estado: 0, payload: \"apaga todas luces\"}; \n    return msg;}",
        "outputs": 1,
        "noerr": 0,
        "x": 170,
        "y": 350,
        "wires": [
            [
                "5172e6e0.6c63c8"
            ]
        ]
    },
    {
        "id": "56bbf874.a0d958",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 690,
        "y": 100,
        "wires": []
    },
    {
        "id": "6fd15169.7f306",
        "type": "debug",
        "z": "7ac92c99.66ea94",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 640,
        "y": 300,
        "wires": []
    },
    {
        "id": "6c03eb14.54b114",
        "type": "debug",
        "z": "7ac92c99.66ea94",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 720,
        "y": 270,
        "wires": []
    },
    {
        "id": "22b80324.69601c",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "ESP/PatioLuz/Sens/Temp/Resp",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 2540,
        "y": 820,
        "wires": [
            [
                "899168e0.b0a6b8"
            ]
        ]
    },
    {
        "id": "899168e0.b0a6b8",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg.payload = \"Temp Termo: \" + global.get(\"tempTermoFin\") + \"ºC          --          Ext.: \" + global.get(\"tempExterior\")+ \"ºC\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2760,
        "y": 820,
        "wires": [
            [
                "e4abd47d.da0148"
            ]
        ]
    },
    {
        "id": "4b27d3c9.db51fc",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2570,
        "y": 890,
        "wires": [
            [
                "899168e0.b0a6b8",
                "f821222.7f29be"
            ]
        ]
    },
    {
        "id": "f821222.7f29be",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg.payload = \"Temp CPU: \" + global.get(\"tempCPU\") + \"ºC\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2760,
        "y": 860,
        "wires": [
            [
                "a1ec76c.03b9088"
            ]
        ]
    },
    {
        "id": "1582d2b5.75d17d",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "reset Nano",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "reset",
        "payloadType": "str",
        "x": 1130,
        "y": 670,
        "wires": [
            [
                "d568dd07.8f5e2"
            ]
        ]
    },
    {
        "id": "a394c137.035f6",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1205,
        "y": 748,
        "wires": []
    },
    {
        "id": "4b3547d6.50abb8",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "85",
        "payloadType": "num",
        "x": 680,
        "y": 910,
        "wires": [
            [
                "44bad6f6.392098"
            ]
        ]
    },
    {
        "id": "97a06aa9.7a52a8",
        "type": "mqtt in",
        "z": "deff4396.4722a",
        "name": "",
        "topic": "cortinas/living/mando",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 660,
        "y": 350,
        "wires": [
            [
                "95952e02.a4fb4"
            ]
        ]
    },
    {
        "id": "95952e02.a4fb4",
        "type": "debug",
        "z": "deff4396.4722a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 900,
        "y": 350,
        "wires": []
    },
    {
        "id": "328e56ab.38360a",
        "type": "function",
        "z": "deff4396.4722a",
        "name": "",
        "func": "context.cortina = context.cortina || \"\";\ncontext.item = context.item || 0;\ncontext.valor = context.valor || 0;\ncontext.limMax = context.limMax || 0;\ncontext.velSubir = context.velSubir || 0;\ncontext.velParar = context.velParar || 0;\ncontext.velBajar = context.velBajar || 0;\ncontext.limMinimo = context.limMinimo || 0;\ncontext.posicion = context.posicion || 0;\nvar mensaje;\n\nif (msg.topic == \"respuestaSetCortina\"){\n\tmensaje = msg.payload.split(\"#\");\n\tcontext.limMax = mensaje[0];\n\tcontext.velSubir = mensaje[1];\n\tcontext.velParar = mensaje[2];\n\tcontext.velBajar = mensaje[3];\n\tcontext.limMinimo = mensaje[4];\n\tcontext.posicion = mensaje[5];\n\tmensaje = context.limMax;\n\tmensaje += \"#\" + context.velSubir;\n\tmensaje += \"#\" + context.velParar;\n\tmensaje += \"#\" + context.velBajar;\n\tmensaje += \"#\" + context.limMinimo;\n\tmensaje += \"#\" + context.posicion;\n\tmsg.payload = mensaje; node.send ([null, msg]);\n\tmsg = {topic: \"terminal/Cortinas\", payload: context.cortina + \": \" + mensaje + \"\\n\"}; return([null, null, null, null, msg]);\n\t}\n\nif (msg.pin == \"90\"){\n\tif (msg.payload == \"1\")context.cortina = \"Living\";\n\tif (msg.payload == \"2\")context.cortina = \"ComedorFrente\";\n\tif (msg.payload == \"3\")context.cortina = \"ComedorLateral\";\n\tif (msg.payload == \"4\")context.cortina = \"CocinaEsquinero\";\n\tif (msg.payload == \"5\")context.cortina = \"CocinaLateral\";\n\tif (msg.payload == \"6\")context.cortina = \"LavaderoVentana\";\n\tif (msg.payload == \"7\")context.cortina = \"LavaderoPuerta\";\t\n\tmsg = {filename : \"/home/pi/BackUpNodeRed/Cortinas/\" + context.cortina + \".txt\", payload : msg.payload};\n\treturn ([null, null, msg]);\t\n}\t\nif (msg.topic == \"cortina\"){\n\tcontext.cortina = msg.payload;\n\tmsg = {filename : \"/home/pi/BackUpNodeRed/Cortinas/\" + context.cortina + \".txt\", payload : msg.payload};\n\treturn ([null, null, msg]);\n}\n\n\nif (msg.pin == \"91\"){\n\tif (msg.payload == \"1\"){context.item = 1; msg.payload = parseInt(context.limMax);}\n\tif (msg.payload == \"2\"){context.item = 2; msg.payload = parseInt(context.velSubir);}\n\tif (msg.payload == \"3\"){context.item = 3; msg.payload = parseInt(context.velParar);}\n\tif (msg.payload == \"4\"){context.item = 4; msg.payload = parseInt(context.velBajar);}\n\tif (msg.payload == \"5\"){context.item = 5; msg.payload = parseInt(context.limMinimo);}\n\tif (msg.payload == \"6\"){context.item = 6; msg.payload = parseInt(context.posicion);}\n\treturn([null, null, null, msg]);\n}\nif (msg.topic == \"item\"){\n\tif (msg.payload == \"limMax\" || msg.payload == \"1\"){context.item = 1; msg.payload = parseInt(context.limMax);}\n\tif (msg.payload == \"velSubir\" || msg.payload == \"2\"){context.item = 2; msg.payload = parseInt(context.velSubir);}\n\tif (msg.payload == \"velParar\" || msg.payload == \"3\"){context.item = 3; msg.payload = parseInt(context.velParar);}\n\tif (msg.payload == \"velBajar\" || msg.payload == \"4\"){context.item = 4; msg.payload = parseInt(context.velBajar);}\n\tif (msg.payload == \"limMinimo\" || msg.payload == \"5\"){context.item = 5; msg.payload = parseInt(context.limMinimo);}\n\tif (msg.payload == \"posicion\" || msg.payload == \"6\"){context.item = 6; msg.payload = parseInt(context.posicion);}\n\treturn([null, null, null, msg]);\n}\n\n\nif (msg.topic == \"valor\" || msg.pin == \"92\"){\n\tif (context.item === 1)context.limMax = msg.payload;\n\tif (context.item === 2)context.velSubir = msg.payload;\n\tif (context.item === 3)context.velParar = msg.payload;\n\tif (context.item === 4)context.velBajar = msg.payload;\n\tif (context.item === 5)context.limMinimo = msg.payload;\n\tif (context.item === 6)context.posicion = msg.payload;\n}\n\nif (msg.topic == \"guardar\" || msg.pin == \"93\"){\n\tmensaje = context.limMax;\n\tmensaje += \"#\" + context.velSubir;\n\tmensaje += \"#\" + context.velParar;\n\tmensaje += \"#\" + context.velBajar;\n\tmensaje += \"#\" + context.limMinimo;\n\tmensaje += \"#\" + context.posicion;\n\t// crearCadena();\n\tmsg = {filename : \"/home/pi/BackUpNodeRed/Cortinas/\" + context.cortina + \".txt\", payload : mensaje}; node.send ([msg, msg]);\n\tmsg = {topic: \"terminal/Cortinas\", payload: context.cortina + \": \" + mensaje + \"\\n\"}; return([null, null, null, null, msg]);\n}\n\nif (msg.topic == \"subir\" || msg.pin == \"95\"){msg = {topic: \"ESP/Cortina/\" + context.cortina + \"/Recibo\", payload: \"subir\"}; return([null, null, null, null, msg]);};\nif (msg.topic == \"parar\" || msg.pin == \"96\"){msg = {topic: \"ESP/Cortina/\" + context.cortina + \"/Recibo\", payload: \"parar\"}; return([null, null, null, null, msg]);};\nif (msg.topic == \"bajar\" || msg.pin == \"97\"){msg = {topic: \"ESP/Cortina/\" + context.cortina + \"/Recibo\", payload: \"bajar\"}; return([null, null, null, null, msg]);};",
        "outputs": 5,
        "noerr": 0,
        "x": 480,
        "y": 160,
        "wires": [
            [
                "cc3d13b.cf5c6f"
            ],
            [
                "29561e60.eebfd2"
            ],
            [
                "d879585a.4165e8",
                "165e6249.7594de"
            ],
            [
                "16610236.793cee"
            ],
            [
                "967c6e7f.974c"
            ]
        ]
    },
    {
        "id": "cc3d13b.cf5c6f",
        "type": "file",
        "z": "deff4396.4722a",
        "name": "back Cortinas",
        "filename": "",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 680,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "d879585a.4165e8",
        "type": "file in",
        "z": "deff4396.4722a",
        "name": "back Cortinas",
        "filename": "",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 670,
        "y": 150,
        "wires": [
            [
                "4e11b9e1.de1478"
            ]
        ]
    },
    {
        "id": "f6af298f.ffc118",
        "type": "link out",
        "z": "deff4396.4722a",
        "name": "respuestaSetCortina",
        "links": [
            "863b906c.c63a8"
        ],
        "x": 955,
        "y": 150,
        "wires": []
    },
    {
        "id": "4e11b9e1.de1478",
        "type": "function",
        "z": "deff4396.4722a",
        "name": "",
        "func": "msg = {topic: \"respuestaSetCortina\", payload: msg.payload};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 870,
        "y": 150,
        "wires": [
            [
                "f6af298f.ffc118"
            ]
        ]
    },
    {
        "id": "863b906c.c63a8",
        "type": "link in",
        "z": "deff4396.4722a",
        "name": "",
        "links": [
            "f6af298f.ffc118"
        ],
        "x": 325,
        "y": 350,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "16610236.793cee",
        "type": "link out",
        "z": "deff4396.4722a",
        "name": "valorItem",
        "links": [
            "70408250.d216dc",
            "7d9c24f8.82a52c"
        ],
        "x": 575,
        "y": 180,
        "wires": []
    },
    {
        "id": "70408250.d216dc",
        "type": "link in",
        "z": "deff4396.4722a",
        "name": "",
        "links": [
            "16610236.793cee"
        ],
        "x": 65,
        "y": 160,
        "wires": [
            [
                "de146c4e.373df"
            ]
        ]
    },
    {
        "id": "967c6e7f.974c",
        "type": "mqtt out",
        "z": "deff4396.4722a",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 640,
        "y": 220,
        "wires": []
    },
    {
        "id": "328af9c9.887df6",
        "type": "mqtt in",
        "z": "deff4396.4722a",
        "name": "",
        "topic": "ESP/Cortina/Living/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 150,
        "y": 630,
        "wires": [
            [
                "bd55d9ae.794ee8"
            ]
        ]
    },
    {
        "id": "62882fb1.862ab",
        "type": "mqtt in",
        "z": "deff4396.4722a",
        "name": "",
        "topic": "terminal/Cortinas",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 660,
        "y": 300,
        "wires": [
            [
                "f84ee0c0.77286"
            ]
        ]
    },
    {
        "id": "7d9c24f8.82a52c",
        "type": "link in",
        "z": "deff4396.4722a",
        "name": "",
        "links": [
            "16610236.793cee"
        ],
        "x": 195,
        "y": 430,
        "wires": [
            [
                "6e68ecc4.cf3184"
            ]
        ]
    },
    {
        "id": "fe384b08.9d9d98",
        "type": "function",
        "z": "deff4396.4722a",
        "name": "",
        "func": "msg.payload = 0;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 133.3333339691162,
        "y": 469.9999885559082,
        "wires": [
            [
                "3443c861.a5ee58",
                "2f97fc11.e764a4"
            ]
        ]
    },
    {
        "id": "8474c43e.6fad38",
        "type": "link out",
        "z": "deff4396.4722a",
        "name": "pararBlynk",
        "links": [
            "e334256d.0578d8"
        ],
        "x": 395,
        "y": 280,
        "wires": []
    },
    {
        "id": "e334256d.0578d8",
        "type": "link in",
        "z": "deff4396.4722a",
        "name": "",
        "links": [
            "8474c43e.6fad38"
        ],
        "x": 43.88889122009277,
        "y": 469.9999885559082,
        "wires": [
            [
                "fe384b08.9d9d98"
            ]
        ]
    },
    {
        "id": "42a422be.f1f79c",
        "type": "function",
        "z": "deff4396.4722a",
        "name": "",
        "func": "msg = {topic: \"terminal/Cortinas\", payload: \"Rec. living: \" + msg.payload + \"\\n\"};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 810,
        "y": 490,
        "wires": [
            [
                "f13d2094.f3ff9"
            ]
        ]
    },
    {
        "id": "f13d2094.f3ff9",
        "type": "mqtt out",
        "z": "deff4396.4722a",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 930,
        "y": 490,
        "wires": []
    },
    {
        "id": "13b4eca7.bbdef3",
        "type": "inject",
        "z": "deff4396.4722a",
        "name": "basico Living",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "490#122#97#81#101#81",
        "payloadType": "str",
        "x": 240,
        "y": 670,
        "wires": [
            [
                "be327a78.688fb8"
            ]
        ]
    },
    {
        "id": "165e6249.7594de",
        "type": "debug",
        "z": "deff4396.4722a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 800,
        "y": 220,
        "wires": []
    },
    {
        "id": "fb84d14.d29f73",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 290,
        "y": 1200,
        "wires": [
            [
                "44a49ae0.78b014"
            ]
        ]
    },
    {
        "id": "44a49ae0.78b014",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "msg.payload = global.get(\"llenarTanque\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 500,
        "y": 1210,
        "wires": [
            [
                "70a83477.f8e40c"
            ]
        ]
    },
    {
        "id": "70a83477.f8e40c",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 640,
        "y": 1210,
        "wires": []
    },
    {
        "id": "7c3a631d.b269ac",
        "type": "mqtt in",
        "z": "deff4396.4722a",
        "name": "",
        "topic": "ESP/Cortina/Living/Envio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 630,
        "y": 460,
        "wires": [
            [
                "62e689d8.1d5d18",
                "16e3b756.f95069"
            ]
        ]
    },
    {
        "id": "63c0ed73.1d09d4",
        "type": "debug",
        "z": "deff4396.4722a",
        "name": "inicioCortinaLiving",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 550,
        "y": 610,
        "wires": []
    },
    {
        "id": "16e3b756.f95069",
        "type": "debug",
        "z": "deff4396.4722a",
        "name": "ReciboCortinaLiving",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 910,
        "y": 410,
        "wires": []
    },
    {
        "id": "bd55d9ae.794ee8",
        "type": "file in",
        "z": "deff4396.4722a",
        "name": "back Cortinas",
        "filename": "/home/pi/BackUpNodeRed/Cortinas/living.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 360,
        "y": 630,
        "wires": [
            [
                "63c0ed73.1d09d4",
                "59e6b1a4.8b009"
            ]
        ]
    },
    {
        "id": "59e6b1a4.8b009",
        "type": "mqtt out",
        "z": "deff4396.4722a",
        "name": "",
        "topic": "ESP/Cortina/Living/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 580,
        "y": 650,
        "wires": []
    },
    {
        "id": "191adbf.f1b7d24",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "prueba autoPID12/09/2049",
        "func": "var dato;\nvar date = new Date();\nvar minAire1 = 5;\nvar minAire2 = 15;\nvar minAire3 = 15;\nvar minAire4 = 15;\nvar tiempo = 0;\nvar escalon = 0;\nvar valor = 0;\nvar topicInicial = msg.topic;\nvar mm = 0;\n\nvar tempMarchaBomba = 72;\nvar enviarDato = 0;\n\ncontext.prendiendo = context.prendiendo || 0;\ncontext.tiempoEncendido = context.tiempoEncendido || 0;\n\ncontext.esperaPrendiendo = context.esperaPrendiendo || 0;\ncontext.tiempoEsperaEncendido = context.tiempoEsperaEncendido || 0;\n\ncontext.tiempoApagado = context.tiempoApagado || 0;\ncontext.apagando = context.apagando || 0;\ncontext.mmAnt = context.mmAnt || 0;\ncontext.avivadoFuego = context.avivadoFuego || 0;\ncontext.boolavivadoFuego = context.boolavivadoFuego || 0;\n\n\nif (global.get(\"tempCamara\") === undefined)global.set(\"tempCamara\", 1); if (global.get(\"DiftempCamara\") === undefined)global.set(\"DiftempCamara\", 1); \nif (global.get(\"tempSerp1Fuego\") === undefined)global.set(\"tempSerp1Fuego\", 2); if (global.get(\"DiftempSerp1Fuego\") === undefined)global.set(\"DiftempSerp1Fuego\", 2); \nif (global.get(\"tempSerp2Fuego\") === undefined)global.set(\"tempSerp2Fuego\", 3); if (global.get(\"DiftempSerp2Fuego\") === undefined)global.set(\"DiftempSerp2Fuego\", 3); \nif (global.get(\"tempChimenea\") === undefined)global.set(\"tempChimenea\", 4); if (global.get(\"DiftempChimenea\") === undefined)global.set(\"DiftempChimenea\", 4); \n\nif (global.get(\"tempDepTermo\") === undefined)global.set(\"tempDepTermo\", 5); if (global.get(\"DiftempDepTermo\") === undefined)global.set(\"DiftempDepTermo\", 5); \nif (global.get(\"tempDepRadiadores\") === undefined)global.set(\"tempDepRadiadores\", 6); if (global.get(\"DiftempDepRadiadores\") === undefined)global.set(\"DiftempDepRadiadores\", 6); \nif (global.get(\"tempSerp1Agua\") === undefined)global.set(\"tempSerp1Agua\", 7); if (global.get(\"DiftempSerp1Agua\") === undefined)global.set(\"DiftempSerp1Agua\", 7); \nif (global.get(\"tempRetRadiadores\") === undefined)global.set(\"tempRetRadiadores\", 8); if (global.get(\"DiftempRetRadiadores\") === undefined)global.set(\"DiftempRetRadiadores\", 8); \nif (global.get(\"tempSerpCamara\") === undefined)global.set(\"tempSerpCamara\", 9); if (global.get(\"DiftempSerpCamara\") === undefined) global.set(\"DiftempSerpCamara\", 9); \n\nif (global.get(\"pidAnterior\") === undefined)global.set(\"pidAnterior\", 0);\nif (global.get(\"tiempoMarchaBomba\") === undefined)global.set(\"tiempoMarchaBomba\", 0);\nif (global.get(\"setPointPID\") === undefined)global.set(\"setPointPID\", 72);\nif (global.get(\"tempAdmision\") === undefined)global.set(\"tempAdmision\", 0);\nif (global.get(\"potenciaSalamandra\") === undefined)global.set(\"potenciaSalamandra\", 1);\nif (global.get(\"salamandraPausa\") === undefined)global.set(\"salamandraPausa\", 0);\nif (global.get(\"aire1F\") === undefined)global.set(\"aire1F\", 0);\nif (global.get(\"aire2F\") === undefined)global.set(\"aire2F\", 0);\nif (global.get(\"aire3F\") === undefined)global.set(\"aire3F\", 0);\nif (global.get(\"aire4F\") === undefined)global.set(\"aire4F\", 0);\nif (global.get(\"aireChimeneaF\") === undefined)global.set(\"aireChimeneaF\", 0);\n\nif (msg.topic == \"med\"){\n  msg = {topic: \"salamandra/Recibo\", payload: \"pedidoTemp\"}; \n  return ([msg, null, null, null]);\n}\n\nif (msg.topic == \"timer\"){\n  // if (parseInt(global.get(\"salamandraAuto\")) === 1){\n  //   var valor = global.get(\"setPointPID\");\n  //   if(parseInt(global.get(\"estadoSalamandra\")) === 1 && parseInt(global.get(\"tempDepRadiadores\")) > parseInt(valor)){//} && global.get(\"tempSerp1Agua\") > 35){\n  //     mm = date.getMinutes();\n  //     var ss = date.getSeconds();\n  //     // tiempo = mm%2;\n  //     if (parseInt(mm%5) === 0 && parseInt(context.prendiendo) === 0 && parseInt(context.boolavivadoFuego) === 0){//} && parseInt(global.get(\"salamandraAuto\")) === 1){//} && paresInt(global.get(\"tempDepTermo\")) < 100) {\n  //       msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Descanso Fuego\\n\"}; node.send([msg, null, null, null]);\n  //       context.boolavivadoFuego = 1;\n  //       context.avivadoFuego = date.getTime() + 300000;// 5'\n  //       global.set(\"estadoTurbo\", 0);    \n  //       global.set(\"aire1\", 100);\n  //       global.set(\"aire2\", 50);\n  //       global.set(\"aire3\", 100);\n  //       global.set(\"aire4\", 100);\n  //       global.set(\"aireChimenea\", 100);\n  //       enviarDato = 1;\n  //       }\n  //     }    \n  //   if(parseInt(date.getTime()) > parseInt(context.avivadoFuego)){\n  //     var pid = parseInt(global.get(\"setPointPID\")) - 10;\n  //     if(parseInt(global.get(\"tempDepRadiadores\")) < parseInt(pid)){global.set(\"estadoTurbo\", 1); global.set(\"aireChimenea\", 30); enviarDato = 1;}\n  //     if (parseInt(context.boolavivadoFuego) === 1 && parseInt(context.prendiendo) === 0){//} && parseInt(global.get(\"salamandraAuto\")) === 1) {\n  //       msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Avivo Fuego\\n\"}; node.send([msg, null, null, null]);\n  //       context.boolavivadoFuego = 0; \n  //       pid = parseInt(global.get(\"setPointPID\")) - 5;\n  //       if(parseInt(global.get(\"tempDepRadiadores\")) > parseInt(pid)){global.set(\"estadoTurbo\", 0); global.set(\"aireChimenea\", 100); enviarDato = 1;}\n  //       global.set(\"aire1\", 100);\n  //       global.set(\"aire2\", 40);\n  //       global.set(\"aire3\", 100);\n  //       global.set(\"aire4\", 100);\n  //       // global.set(\"aireChimenea\", 30);\n  //       enviarDato = 1;\n  //     }\n  //   } \n\n    if (parseInt(context.prendiendo) === 1 && parseInt(date.getTime()) > parseInt(context.tiempoEncendido) && parseInt(global.get(\"estadoSalamandra\")) === 1){// && parseInt(global.get(\"salamandraAuto\")) === 1){\n        msg = {topic: \"notifyBlynk\", payload: \"Ciclo de encendido terminado\"}; node.send([msg, null, null, null]);\n        msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Ciclo de encendido terminado\\n\"}; node.send([msg, null, null, null]);\n        context.prendiendo = 0;\n        return;\n  }\n  //     context.esperaPrendiendo = 1;\n  //     context.tiempoEsperaEncendido = date.getTime();\n  //     context.prendiendo = 0;\n  //     // context.boolavivadoFuego = 1;\n  //     global.set(\"estadoTurbo\", 1);    \n  //     global.set(\"aire1\", 50);\n  //     global.set(\"aire2\", 100);\n  //     global.set(\"aire3\", 100);\n  //     global.set(\"aire4\", 100);\n  //     global.set(\"aireChimenea\", 40);\n  //     enviarSalamandra();\n  //     return;\n  //   }\n  // }\n    // tiempo = context.tiempoApagado + 300000;//5'\n    // tiempo = tiempo - date.getTime();\n    //parseInt(context.prendiendo) === 0 && \n  if (parseInt(context.apagando) === 1 && date.getTime() > parseInt(context.tiempoApagado)){//} && parseInt(global.get(\"estadoSalamandra\") === 1)){\n  // if (parseInt(global.get(\"tempCamara\")) < 90 && parseInt(context.prendiendo) === 0 && parseInt(global.get(\"estadoSalamandra\") === 1)){//} && date.getTime() > paresInt(tiempo)){\n    msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Apago automatico Salamandra\\n\"}; node.send([msg, null, null, null]);\n    context.apagando = 0;\n    context.esperaPrendiendo = 0;\n    context.tiempoEsperaEncendido = 0;\n    global.set(\"salamandraPausa\", 1);\n    global.set(\"estadoSalamandra\", 0);\n    // global.set(\"estadoTurbo\", 0);    \n    global.set(\"aire1\", 0);\n    global.set(\"aire2\", 0);\n    global.set(\"aire3\", 0);\n    global.set(\"aire4\", 0);\n    global.set(\"aireChimenea\", 0);  \n    // global.set(\"salamandraBbaRad\", 0); \n    enviarSalamandra();   \n    return;\n  }\n\n\n  // Esto maneja \n    // if (parseInt(global.get(\"tempDepRadiadores\")) < parseInt(\"diffTempMinimoSalamandra\")){\n    //   dato = date.getTime() - parseInt(global.get(\"tiempoMarchaBomba\"));\n    //   if (parseInt(dato) > 60000){//1 minuto\n    //     global.set(\"salamandraBbaRad\", 0); \n    //   }\n    //   enviarSalamandra(); \n    //   return;  \n    // }\n\n      // var cuenta = tiempo;// - date.getTime();\n      // var estado = context.prendiendo + \" - (\" + cuenta + \") - \" + global.get(\"estadoSalamandra\");\n      // node.status({text: estado});\n      //parseInt(global.get(\"estadoSalamandra\")) === 1 &&\n\n  node.status({text: global.get(\"tempCamara\") + \" - \" + global.get(\"tempSerp2Fuego\") + \" - \" + context.prendiendo + \" - \" + context.apagando});\n  if (parseInt(global.get(\"tempCamara\")) < 80 && parseInt(global.get(\"tempSerp2Fuego\")) < 80 && parseInt(context.prendiendo) === 0 && parseInt(context.apagando) === 0){\n    // if (parseInt(context.apagando) === 0){\n      msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Inicio timer apagado salamandra\\n\"}; node.send([msg, null, null, null]);\n      context.apagando = 1;\n      context.tiempoApagado = date.getTime() + 300000;// 5'\n    // }\n    // else{\n    //   context.apagando = 0;\n    // }\n  }\n\n  if (parseInt(global.get(\"tempCamara\")) > 81)context.apagando = 0;\n  if (parseInt(global.get(\"tempSerp2Fuego\")) > 81)context.apagando = 0;\n\n    if (parseInt(global.get(\"mm\")) != context.mmAnt){\n      var enviar = 0;\n      context.mmAnt = global.get(\"mm\");\n      if (context.prendiendo === 1) enviar = 1;\n\n      if (parseInt(global.get(\"salamandraBbaRad\")) === 1) enviar = 1;\n\n      if (parseInt(global.get(\"tempCamara\")) > 70 || parseInt(global.get(\"tempSerp2Fuego\")) > 70) enviar = 1;\n\n      // if (parseInt(enviar) === 1){\n        msg = {topic: \"salamandra/Recibo\", payload: \"pedidoTemp\"}; \n        return ([msg, null, null, null]);\n      // }\n  }\n}\n\nif (msg.topic == \"salamandra/Encendido\"){\n  if (parseInt(global.get(\"estadoSalamandra\")) === 0){\n    msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Apago Manual Salamandra\\n\"}; node.send([msg, null, null, null]);\n    context.apagando = 0;\n    global.set(\"salamandraPausa\", 1);\n    // global.set(\"estadoTurbo\", 0);    \n    global.set(\"aire1\", 0);\n    global.set(\"aire2\", 0);\n    global.set(\"aire3\", 0);\n    global.set(\"aire4\", 0);\n    global.set(\"aireChimenea\", 25);\n    }\n  if (parseInt(global.get(\"estadoSalamandra\")) === 1){\n    context.apagando = 0;\n    msg = {topic: \"terminalSalamandra\", payload: \"\\n\" + global.get(\"hsCpu\") + \"  Prendo Salamandra\\n\"}; node.send([msg, null, null, null]);\n    global.set(\"salamandraPausa\", 2);   \n    context.prendiendo = 1;\n    context.tiempoEncendido = date.getTime() + 300000;\n    // global.set(\"estadoTurbo\", 1); \n    global.set(\"aire1\", 100);\n    global.set(\"aire2\", 100);\n    global.set(\"aire3\", 100);\n    global.set(\"aire4\", 100);    \n    global.set(\"aireChimenea\", 100);\n    }\n  enviarSalamandra();\n  return;\n}\n\nif (msg.topic == \"salamandra/Inicio\"){\n  enviarSalamandra();\n  return;\n}\n\nif (msg.topic == \"salamandra/NodeRed\"){\n  enviarSalamandra();\n  return;\n}\n\nif (msg.topic == \"termoSolar/Salamandra\"){\n  dato = msg.payload.split(\"#\");\n  global.set(\"tempBajTermo\", dato[0]);\n  global.set(\"tempSubTermo\", dato[1]);\n  return;\n}\n\nif (msg.topic == \"salamandra/Envio\"){\n  if (msg.payload.substring(0, 6) == \"temp 5\")return;// temp 5\n  valor = 0;\n  dato = msg.payload.substring(8);\n  dato = dato.split(\"#\");\n\n  valor = parseFloat(dato[0] - global.get(\"tempCamara\")).toFixed(1);\n  global.set(\"tempCamara\", dato[0]); global.set(\"DiftempCamara\", valor);// - parseFloat(global.get(\"tempCamara\")));//).toFixed(1)); \n  // dato = global.get(\"DiftempCamara\"); msg.payload = dato; node.send([null, msg]);\n\n\n  valor = parseFloat(dato[1] - global.get(\"tempSerp1Fuego\")).toFixed(1);\n  global.set(\"tempSerp1Fuego\", dato[1]); global.set(\"DiftempSerp1Fuego\", valor); \n\n  valor = parseFloat(dato[2] - global.get(\"tempSerp2Fuego\")).toFixed(1);\n  global.set(\"tempSerp2Fuego\", dato[2]); global.set(\"DiftempSerp2Fuego\", valor); \n\n  valor = parseFloat(dato[3] - global.get(\"tempChimenea\")).toFixed(1);\n  global.set(\"tempChimenea\", dato[3]); global.set(\"DiftempChimenea\", valor); \n\n  valor = parseFloat(dato[4] - global.get(\"tempDepTermo\")).toFixed(1);\n  // global.set(\"tempDepTermo\", dato[4]); global.set(\"DiftempDepTermo\", valor); \n\n  valor = parseFloat(dato[5] - global.get(\"tempDepTermo\")).toFixed(1);\n  global.set(\"tempDepTermo\", dato[5]); global.set(\"DiftempDepTermo\", valor);\n  // global.set(\"tempLiving\", valor);// global.set(\"DiftempDepRadiadores\", valor); \n\n  valor = parseFloat(dato[7] - global.get(\"tempSerpCamara\")).toFixed(1);\n  global.set(\"tempSerpCamara\", dato[7]); global.set(\"DiftempSerpCamara\", valor); \n\n  valor = parseFloat(dato[7] - global.get(\"tempSerp1Agua\")).toFixed(1);\n  global.set(\"tempSerp1Agua\", dato[7]); global.set(\"DiftempSerp1Agua\", valor); \n\n  valor = parseFloat(dato[8] - global.get(\"tempRetRadiadores\")).toFixed(1);\n  global.set(\"tempRetRadiadores\", dato[8]); global.set(\"DiftempRetRadiadores\", valor); \n\n  global.set(\"tempLiving\", dato[9]); \n  global.set(\"humLiving\", dato[10]); \n\n  var valor1 = parseFloat((parseInt(global.get(\"tempDepTermo\")) + parseInt(global.get(\"tempSerpCamara\")) + parseInt(global.get(\"tempSerp1Agua\"))) / 3).toFixed(1);\n  valor = parseFloat(valor1 - global.get(\"tempDepRadiadores\")).toFixed(1);\n  global.set(\"tempDepRadiadores\", valor1); global.set(\"DiftempDepRadiadores\", valor);\n\n  if (parseInt(global.get(\"tempDepRadiadores\")) > 80){msg = {topic: \"notifyBlynk\", payload: \"Error Deposito Radiadores muy caliente: \" + global.get(\"tempDepRadiadores\")}; node.send([msg, null, null, null]);} \n\n/// Marcha y parada bomba radiadores////\n  // var valor1  = parseInt(global.get(\"tempSerpCamara\")) - 5;\n  // var valor2  = parseInt(global.get(\"tempSerp1Agua\")) - 5;\n\n  // if (parseInt(global.get(\"salamandraAuto\")) === 0 && parseInt(global.get(\"tempDepRadiadores\")) > parseInt(global.get(\"setPointPID\")) && parseInt(global.get(\"hh\")) > 8 && parseInt(global.get(\"hh\")) < 23)global.set(\"salamandraAuto\", 1);\n\n  if (parseInt(global.get(\"tempSerp1Fuego\")) > 170 || parseInt(global.get(\"tempSerp2Fuego\")) > 170 || parseInt(global.get(\"tempCamara\")) > 230 || parseInt(global.get(\"tempSerpCamara\")) > 85 || parseInt(global.get(\"tempSerp1Agua\")) > 85){\n    if (parseInt(global.get(\"salamandraBbaRad\")) === 0){global.set(\"salamandraBbaRad\", 1); enviarDato = 1;} \n  }\n\n  if (parseInt(global.get(\"tempSerp1Fuego\")) < 155 && parseInt(global.get(\"tempSerp2Fuego\")) < 155 && parseInt(global.get(\"tempCamara\")) < 200 && parseInt(global.get(\"tempSerpCamara\")) < 55 && parseInt(global.get(\"tempSerp1Agua\")) < 55 && context.prendiendo === 0){//} || parseInt(global.get(\"tempSerpCamara\")) < 40 || parseInt(global.get(\"tempSerp1Agua\")) < 40){\n    if (parseInt(global.get(\"salamandraBbaRad\")) === 1){global.set(\"salamandraBbaRad\", 0); enviarDato = 1;}\n  }\n\n\n  // if (parseInt(global.get(\"tempSerp2Fuego\")) > 150 || parseInt(global.get(\"tempDepTermo\")) > parseInt(global.get(\"tempTermoFin\"))){//} || parseInt(global.get(\"tempSerp1Agua\")) > 75){\n  //   global.set(\"salamandraBbaTermo\", 1); \n  //   enviarDato = 1; \n  // }\n\n  // if (parseInt(global.get(\"tempSerp2Fuego\")) < 100){//} || parseInt(global.get(\"tempDepTermo\")) < parseInt(global.get(\"tempTermoFin\"))){//} || parseInt(global.get(\"tempSerpCamara\")) < 40 || parseInt(global.get(\"tempSerp1Agua\")) < 40){\n  //   global.set(\"salamandraBbaTermo\", 0); \n  //   enviarDato = 1; \n  // }  \n\n  if (parseInt(enviarDato) === 1)enviarSalamandra(); \n\n  // if (parseInt(global.get(\"tempDepRadiadores\")) > parseInt(tempMarchaBomba) || parseInt(global.get(\"tempSerpCamara\")) > 85 || parseInt(global.get(\"tempSerp1Agua\")) > 85){\n  //   if (parseInt(global.get(\"tempSerpCamara\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error SERPENTINA CAMARA muy caliente\"}; node.send([msg, null, null, null]);}\n  //   if (parseInt(global.get(\"tempSerp1Agua\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error primer serpentina cobre muy caliente\"}; node.send([msg, null, null, null]);}\n  //   global.set(\"salamandraBbaRad\", 1); \n  //   global.set(\"tiempoMarchaBomba\", date.getTime());\n  //   enviarSalamandra(); \n  // }\n  // if (parseInt(global.get(\"salamandraAuto\")) === 1 && parseInt(global.get(\"tempDepRadiadores\")) < parseInt(\"diffTempMinimoSalamandra\") && parseInt(global.get(\"tempSerpCamara\")) < 80 && parseInt(global.get(\"tempSerp1Agua\")) < 80){\n  //   dato = date.getTime() - parseInt(global.get(\"tiempoMarchaBomba\"));\n  //   if (parseInt(dato) > 60000){//1 minuto\n  //     global.set(\"salamandraBbaRad\", 0); \n  //   }\n  //   enviarSalamandra();   \n  // }\n\n  // if (parseInt(global.get(\"tempCamara\")) < 70){\n  //   global.set(\"estadoSalamandra\", 0)\n  //   global.set(\"aire1\", 0);\n  //   global.set(\"aire2\", 0);\n  //   global.set(\"aire3\", 0);\n  //   global.set(\"aire4\", 0);\n  //   global.set(\"aireChimenea\", 0)\n  //   global.set(\"salamandraBbaRad\", 0); \n  //   enviarSalamandra();  \n  //   return;\n  // }\n/// FIN Marcha y parada bomba radiadores////  \n\n  // if (parseInt(global.get(\"estadoSalamandra\")) === 0){\n  //  if (parseInt(global.get(\"tempDepRadiadores\")) > 70 || parseInt(global.get(\"tempSerpCamara\")) > 85 || parseInt(global.get(\"tempSerp1Agua\")) > 85){\n  //    // if (parseInt(global.get(\"tempSerpCamara\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error SERPENTINA CAMARA muy caliente\"}; node.send([msg, null, null, null]);}\n  //    // if (parseInt(global.get(\"tempSerp1Agua\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error primer serpentina cobre muy caliente\"}; node.send([msg, null, null, null]);}\n  //    global.set(\"salamandraBbaRad\", 1); \n  //    global.set(\"tiempoMarchaBomba\", date.getTime());\n  //    enviarSalamandra(); \n  //  }\n  // }\n  if (parseInt(global.get(\"estadoSalamandra\")) === 1){msg = {topic: \"salamandra/inPid\", payload: global.get(\"tempDepRadiadores\")}; node.send([msg]);}\n  // msg = {topic: \"salamandra/inPid\", payload: global.get(\"tempDepRadiadores\")}; node.send([msg]);\n\n  return;\n}\n\nif (msg.topic == \"salamandra/outPid\"){\n  if (parseInt(global.get(\"salamandraAuto\")) === 1){\n    var payload = msg.payload;\n  /// Control setPoint PID///\n    // if(parseInt(global.get(\"tempLiving\")) >= parseInt(global.get(\"setTempCasa\")) && parseInt(global.get(\"tempPasillo\")) >= parseInt(global.get(\"setTempCasa\")) && parseInt(global.get(\"potenciaSalamandra\")) === 1){\n    //   msg = {topic: \"salamandra/inPid\", setpoint: parseInt(global.get(\"diffTempMinimoSalamandra\"))}; \n    //   global.set(\"potenciaSalamandra\", 0);\n    //   node.send([msg]);\n    //   return;\n    //   // return;diffTempMinimoSalamandra\n    // }\n\n    // var tempMinima = parseInt(global.get(\"setTempCasa\")) - 5;\n    // if(parseInt(global.get(\"tempLiving\")) <= parseInt(tempMinima) || parseInt(global.get(\"tempPasillo\")) <= parseInt(tempMinima)){\n    //   if (parseInt(global.get(\"potenciaSalamandra\")) === 0){\n    //     global.set(\"potenciaSalamandra\", 1);\n    //     msg = {topic: \"salamandra/inPid\", setpoint: parseInt(global.get(\"setPointPID\"))}; \n    //     // global.set(\"setPointPID\", parseInt(global.get(\"diffTempMinimoSalamandra\")));\n    //     node.send([msg]);\n    //     return;\n    //   }\n    // }   \n  /// FIN Control setPoint PID////  \n\n    /// Regulaciones de aires y turbo////\n    dato = Math.abs(parseInt(global.get(\"pidAnterior\")) - parseInt(payload));\n    var dato2 = global.get(\"pidAnterior\") - parseInt(payload);\n    node.status({text: dato + \" - \" + global.get(\"salamandraAuto\") + \" - \" + payload + \" -- (\" + dato2 + \")\"});\n    if (dato > 50){// 50 es diferencia de respuesta minima para que actue correcion de aires\n\n      escalon = 0;// valor de incremento de regulacion de aire\n      if (parseInt(payload) > 50 && parseInt(payload) < 100)escalon = 5;\n      if (parseInt(payload) > 101 && parseInt(payload) < 150)escalon = 8;\n      if (parseInt(payload) > 151 && parseInt(payload) < 200)escalon = 12;\n      if (parseInt(payload) > 201 && parseInt(payload) < 250)escalon = 15;\n      if (parseInt(payload) > 251 && parseInt(payload) < 300)escalon = 18;\n      if (parseInt(payload) > 301 && parseInt(payload) < 350)escalon = 22;\n      if (parseInt(payload) > 351 && parseInt(payload) < 400)escalon = 25;\n      if (parseInt(payload) > 401 && parseInt(payload) < 450)escalon = 28;\n      if (parseInt(payload) > 451 && parseInt(payload) < 500)escalon = 32;\n      if (parseInt(payload) > 501)escalon = 50;\n\n\n      if (parseInt(global.get(\"pidAnterior\")) > parseInt(payload)){\n        msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" -- Cierro aire modo auto\\n\"}; node.send([msg, null, null, null]);\n\n        context.esperaPrendiendo = 0;\n\n        global.set(\"pidAnterior\", parseInt(payload));\n\n        valor = parseInt(global.get(\"aire1\")) - parseInt(escalon);\n        if (parseInt(valor) >= minAire1){global.set(\"aire1\", valor);} else{global.set(\"aire1\", minAire1);}\n\n        // if (parseInt(valor) < 5){\n          if (parseInt(global.get(\"aire1\")) === parseInt(minAire1)){\n        valor = parseInt(global.get(\"aire2\")) - parseInt(escalon);\n        if (parseInt(valor) >= minAire2){global.set(\"aire2\", valor);} else{global.set(\"aire2\", minAire2);}\n\n        // if (parseInt(valor) < 5){\n        if (parseInt(global.get(\"aire2\")) === parseInt(minAire2)){\n          valor = parseInt(global.get(\"aire3\")) - parseInt(escalon);\n          if (parseInt(valor) >= minAire3){global.set(\"aire3\", valor);} else{global.set(\"aire3\", minAire3);}\n\n          // if (parseInt(valor) < 5){\n          if (parseInt(global.get(\"aire3\")) === parseInt(minAire3)){\n            valor = parseInt(global.get(\"aire4\")) - parseInt(escalon);\n            if (parseInt(valor) >= minAire4){global.set(\"aire4\", valor);} else{global.set(\"aire4\", minAire4);}\n            }\n          }\n        }\n        // if (parseInt(global.get(\"aire3\")) < 80)global.set(\"estadoTurbo\", 0); \n      }\n\n\n      if (parseInt(global.get(\"pidAnterior\")) < parseInt(payload) && parseInt(global.get(\"estadoSalamandra\")) === 1){\n\n        if (parseInt(context.esperaPrendiendo) === 1){\n          tiempo = 0;\n          tiempo = context.tiempoEsperaEncendido + 1800000;//30'\n          tiempo = tiempo - date.getTime();\n        }\n        else{\n          tiempo = -10;\n        }\n\n        if (parseInt(tiempo) < 0){// si variable tiempo es menos a 0 paso mas de 1/2hs y habre aire encendido\n            msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" -- Habro aire modo auto\\n\"}; node.send([msg, null, null, null]);\n          context.esperaPrendiendo = 0;\n          global.set(\"pidAnterior\", parseInt(payload));\n          valor = parseInt(global.get(\"aire4\")) + parseInt(escalon);\n          if (parseInt(valor) < 100){global.set(\"aire4\", valor);}else{global.set(\"aire4\", 100)}\n            if (parseInt(valor) > 90){\n            valor = parseInt(global.get(\"aire3\")) + parseInt(escalon);\n            if (parseInt(valor) < 100){global.set(\"aire3\", valor);}else{global.set(\"aire3\", 100)}\n              if (parseInt(valor) > 90){\n              valor = parseInt(global.get(\"aire2\")) + parseInt(escalon);\n              if (parseInt(valor) < 100){global.set(\"aire2\", valor);}else{global.set(\"aire2\", 100)}\n                if (parseInt(valor) > 90){\n                valor = parseInt(global.get(\"aire1\")) + parseInt(escalon);\n                if (parseInt(valor) < 100){global.set(\"aire1\", valor);}\n                    else{\n                    // if (parseInt(global.get(\"estadoTurbo\")) === 0)global.set(\"estadoTurbo\", 1); \n                    global.set(\"aire1\", 100);}\n                }\n              }\n            }\n          // if (parseInt(global.get(\"aire1\")) === 100)global.set(\"estadoTurbo\", 1); \n        }\n      }\n    global.set(\"aireChimenea\", 100);\n    // if (parseInt(global.get(\"estadoTurboF\") === 0))global.set(\"aireChimenea\", 100);\n    // if (parseInt(global.get(\"estadoTurboF\")) === 1){\n      // global.set(\"aireChimenea\", 100);\n    if (parseInt(global.get(\"tempDepRadiadores\")) > 60)global.set(\"aireChimenea\", 50);\n    // }\n    enviarSalamandra(); \n    }\n  // FIN Regulaciones de aires y turbo//// \n  }\n\n  msg = {topic: \"tempLiving\", payload: global.get(\"tempLiving\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempPasillo\", payload: global.get(\"tempPasillo\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempBano\", payload: global.get(\"tempBano\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempHab1\", payload: global.get(\"tempHab1\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempHab2\", payload: global.get(\"tempHab2\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempComedor\", payload: global.get(\"tempComedor\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempCocina\", payload: global.get(\"tempCocina\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempLavadero\", payload: global.get(\"tempLavadero\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempExterior\", payload: global.get(\"tempExterior\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempTermo\", payload: global.get(\"tempTermoFin\")}; node.send([null, null, msg, null]);\n\n  msg = {topic: \"tempBajTermo\", payload: global.get(\"tempBajTermo\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempSubTermo\", payload: global.get(\"tempSubTermo\")}; node.send([null, null, msg, null]);\n\n  msg = {topic: \"tempDepTermo\", payload: global.get(\"tempDepTermo\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempDepRadiadores\", payload: global.get(\"tempDepRadiadores\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempSerpCamara\", payload: global.get(\"tempSerpCamara\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempSerp1Agua\", payload: global.get(\"tempSerp1Agua\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempRetRadiadores\", payload: global.get(\"tempRetRadiadores\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempCamara\", payload: global.get(\"tempCamara\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempSerp1Fuego\", payload: global.get(\"tempSerp1Fuego\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempSerp2Fuego\", payload: global.get(\"tempSerp2Fuego\")}; node.send([null, null, msg, null]);\n\n  msg = {topic: \"aire1\", payload: global.get(\"aire1\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"aire2\", payload: global.get(\"aire2\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"aire3\", payload: global.get(\"aire3\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"aire4\", payload: global.get(\"aire4\")}; node.send([null, null, msg, null]);\n  // msg = {topic: \"estadoTurbo\", payload: global.get(\"estadoTurbo\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"salamandraBbaRad\", payload: global.get(\"salamandraBbaRad\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"salamandraBbaCirc\", payload: global.get(\"salamandraBbaCirc\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"salamandraBbaTermo\", payload: global.get(\"salamandraBbaTermo\")}; node.send([null, null, msg, null]);\n\n/// Guardado en mysql////\n    mm = date.getMinutes();\n  tiempo = mm%5;\n  if (parseInt(global.get(\"estadoSalamandra\")) === 1 && tiempo === 0){\n    var mysql = \"INSERT INTO \\`salamandra\\`(\\`tiempo\\`, \\`tempLiving\\`, \\`tempPasillo\\`, \\`tempBano\\`, \\`tempHab1\\`, \\`tempHab2\\`, \\`tempComedor\\`, \\`tempCocina\\`, \\`tempLavadero\\`, \\`tempExterior\\`, \\`tempTermo\\`,\";\n    mysql += \" \\`tempBajTermo\\`, \\`tempSubTermo\\`,\";\n    mysql += \" \\`tempDepTermo\\`, \\`tempSerpCamara\\`, \\`temp1Serp\\`, \\`tempRetRad\\`, \\`tempDepRad\\`, \\`tempCamara\\`, \\`temp1SerpFuego\\`, \\`temp2SerpFuego\\`, \\`tempChimenea\\`,\";\n    mysql += \" \\`aireEnc\\`, \\`airePrim\\`, \\`aireSec\\`, \\`aireTerc\\`, \\`turbo\\`, \\`bombaRad\\`, \\`bombaRec\\`, \\`bombaTermo\\`) VALUES (now(),\";\n    \n    mysql += global.get(\"tempLiving\") + \",\"; mysql += global.get(\"tempPasillo\") + \",\"; \n    mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; \n    mysql += global.get(\"tempLavadero\") + \",\"; mysql += global.get(\"tempExterior\") + \",\"; mysql += global.get(\"tempTermoFin\") + \",\";\n\n    mysql += global.get(\"tempBajTermo\") + \",\" + global.get(\"tempSubTermo\") + \",\";\n\n    mysql += global.get(\"tempDepTermo\") + \",\" + global.get(\"tempDepRadiadores\") + \",\" + global.get(\"tempSerpCamara\") + \",\" + global.get(\"tempSerp1Agua\") + \",\";\n    mysql += global.get(\"tempRetRadiadores\") + \",\" + global.get(\"tempCamara\") + \",\" + global.get(\"tempSerp1Fuego\") + \",\" + global.get(\"tempSerp2Fuego\") + \",\";\n    mysql += global.get(\"tempChimenea\") + \",\";\n\n    mysql += global.get(\"aire1\") + \",\" + global.get(\"aire2\") + \",\" + global.get(\"aire3\") + \",\" + global.get(\"aire4\") + \",\";\n    // mysql += global.get(\"estadoTurbo\") + \",\" + global.get(\"salamandraBbaRad\") + \",\" + global.get(\"salamandraBbaCirc\") + \",\" + global.get(\"salamandraBbaTermo\") + \")\";\n    mysql += \"0,\" + global.get(\"salamandraBbaRad\") + \",\" + global.get(\"salamandraBbaCirc\") + \",\" + global.get(\"salamandraBbaTermo\") + \")\";\n    msg.topic = mysql;\n    return ([null, null, null, msg]);   \n  }\n/// FIN Guardado en mysql//// \n}\n\nfunction enviarSalamandra(){\n  enviarDato = 0;\n  if (parseInt(global.get(\"tempDepRadiadores\")) > 85){\n    // global.set(\"estadoTurbo\", 0);\n    global.set(\"aire1\", 0);\n    global.set(\"aire2\", 0);\n    global.set(\"aire3\", 0);\n    global.set(\"aire4\", 0);\n    msg = {topic: \"notifyBlynk\", payload: \"Error exeso temperatura salamandra\"}; node.send([msg, null, null, null]);\n    msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" -- Error exeso temperatura salamandra\\n\"}; node.send([msg, null, null, null]);\n  }\n  \n    if (parseInt(global.get(\"salamandraPausa\")) === 1){\n      // flow.set(\"estadoTurboF\", 0);//salamandraPausa == 0 esta en marcha\n      flow.set(\"aire1F\", 0);\n      flow.set(\"aire2F\", 40);\n      flow.set(\"aire3F\", 0);\n      flow.set(\"aire4F\", 0);\n      flow.set(\"aireChimeneaF\", 100); \n    }\n    if (parseInt(global.get(\"salamandraPausa\")) === 2){\n      // flow.set(\"estadoTurboF\", global.get(\"estadoTurbo\"));//salamandraPausa == 0 esta en marcha\n      flow.set(\"aire1F\", global.get(\"aire1\"));\n      flow.set(\"aire2F\", global.get(\"aire2\"));\n      // flow.set(\"aire3F\", global.get(\"aire3\"));\n      // flow.set(\"aire4F\", global.get(\"aire4\"));\n      flow.set(\"aire3F\", 0);\n      flow.set(\"aire4F\", 0);      \n      flow.set(\"aireChimeneaF\", global.get(\"aireChimenea\"));  \n      // flow.set(\"aireChimeneaF\", 100);  \n    } \n\n    if (parseInt(global.get(\"estadoSalamandra\")) === 0){\n      // flow.set(\"estadoTurboF\", 0);//salamandraPausa == 0 esta en marcha\n      flow.set(\"aire1F\", 0);\n      flow.set(\"aire2F\", 0);\n      flow.set(\"aire3F\", 0);\n      flow.set(\"aire4F\", 0);\n      flow.set(\"aireChimeneaF\", 0);       \n    }\n  \n  //  msg = {topic: \"salamandra/backUp\", payload: \"estado\" };\n  //  node.send([msg, null, null, null]);\n    // dato = global.get(\"salamandraAuto\") + \"#\";\n//   dato = global.get(\"salamandraBbaCirc\") + \"#\";\n//   dato += global.get(\"salamandraBbaRad\") + \"#\";\n  dato = global.get(\"salamandraBbaRad\") + \"#\";\n  dato += global.get(\"salamandraBbaRad\") + \"#\";\n  dato += global.get(\"salamandraBbaTermo\") + \"#\";\n  // dato += flow.get(\"estadoTurboF\") + \"#\";//salamandraPausa == 0 esta en marcha\n  dato += flow.get(\"aire1F\") + \"#\";\n  dato += flow.get(\"aire2F\") + \"#\";\n  dato += flow.get(\"aire3F\") + \"#\";\n  dato += flow.get(\"aire4F\") + \"#\";\n  dato += flow.get(\"aireChimeneaF\");    \n  \n  // dato += global.get(\"estadoTurbo\") + \"#\";\n\n\n  // if (dato.includes(\"undefined\")){\n  //   msg = {topic: \"salamandra/backUp/recovery\", payload: 1}; \n  //   node.send([msg, null]); \n  //   return;\n  // }\n  msg = {topic: \"salamandra/backUp\", payload: \"estado\" };\n  node.send([msg, null, null, null]);\n  msg = {estado: \"node\", topic: \"salamandra/Recibo\", payload: \"estado\" + dato}; \n  if (topicInicial == \"salamandra/NodeRed\")msg = {estado: \"node\", topic: \"salamandra/Recibo\", payload: \"estado\" + dato};\n  node.send([msg, null, null, null]);\n}\n\n\n\n\n// var mysql = \"INSERT INTO \\\\`salamandra\\\\`(\\\\`tiempo\\\\`, \\\\`tempLiving\\\\`, \\\\`tempPasillo\\\\`, \\\\`tempBano\\\\`, \\\\`tempHab1\\\\`, \\\\`tempHab2\\\\`, \\\\`tempComedor\\\\`, \\\\`tempCocina\\\\`, \\\\`tempLavadero\\\\`, \\\\`tempExterior\\\\`, \\\\`tempTermo\\\\`, \\\\`tempBajTermo\\\\`, \\\\`tempSubTermo\\\\`, \\\\`tempDepTermo\\\\`, \\\\`tempSerpCamara\\\\`, \\\\`temp1Serp\\\\`, \\\\`tempChimenea\\\\`, \\\\`tempRetRad\\\\`, \\\\`tempDepRad\\\\`, \\\\`aireEnc\\\\`, \\\\`airePrim\\\\`, \\\\`aireSec\\\\`, \\\\`aireTerc\\\\`, \\\\`turbo\\\\`, \\\\`bombaRad\\\\`, \\\\`bombaRec\\\\`, \\\\`bombaTermo\\\\`) VALUES (now(),\";\n// mysql += 55 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \")\";\n// msg.topic = mysql;\n// return msg;\n",
        "outputs": 4,
        "noerr": 0,
        "x": 950.4444580078125,
        "y": 485.888916015625,
        "wires": [
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "1f9a8b7a.160ec5",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 574.4444694519043,
        "y": 468.88888931274414,
        "wires": [
            [
                "4871aabf.bf0cd4"
            ]
        ]
    },
    {
        "id": "d49172fe.f82d",
        "type": "mqtt out",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1325.1110534667969,
        "y": 460.88888359069824,
        "wires": []
    },
    {
        "id": "6e69b3c3.10e39c",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1205.6665573120117,
        "y": 393.5555667877197,
        "wires": []
    },
    {
        "id": "49e6f5a8.62d5dc",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "timer",
        "repeat": "14",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "timer",
        "payload": "",
        "payloadType": "date",
        "x": 758.4444580078125,
        "y": 396.8888854980469,
        "wires": [
            []
        ]
    },
    {
        "id": "89cb398.6194fc8",
        "type": "mqtt out",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 505,
        "y": 351,
        "wires": []
    },
    {
        "id": "824d7e7b.545c5",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 640,
        "y": 470,
        "wires": []
    },
    {
        "id": "ad1b1083.a26f5",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 940,
        "y": 980,
        "wires": []
    },
    {
        "id": "fd46a1ee.e820e",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 580,
        "y": 660,
        "wires": [
            [
                "f421502e.fe9ae"
            ]
        ]
    },
    {
        "id": "55216813.2b1c08",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 580,
        "y": 700,
        "wires": [
            [
                "f421502e.fe9ae"
            ]
        ]
    },
    {
        "id": "44bad6f6.392098",
        "type": "PID control",
        "z": "65561250.4225fc",
        "name": "",
        "target": "72",
        "kp": "50",
        "ki": "10",
        "kd": "10",
        "x": 1022,
        "y": 755,
        "wires": [
            [
                "a394c137.035f6",
                "f58c878e.4e9d48",
                "41b63f75.50e6c"
            ]
        ]
    },
    {
        "id": "df618569.a65f68",
        "type": "ui_button",
        "z": "deff4396.4722a",
        "name": "",
        "group": "ff8a613f.fd5b7",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Guardar",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "1",
        "payloadType": "str",
        "topic": "guardar",
        "x": 130,
        "y": 200,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "cc191962.60c108",
        "type": "ui_button",
        "z": "deff4396.4722a",
        "name": "",
        "group": "ff8a613f.fd5b7",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Subir",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "1",
        "payloadType": "str",
        "topic": "subir",
        "x": 140,
        "y": 240,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "978ba17a.9fec4",
        "type": "ui_button",
        "z": "deff4396.4722a",
        "name": "",
        "group": "ff8a613f.fd5b7",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Parar",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "1",
        "payloadType": "str",
        "topic": "parar",
        "x": 140,
        "y": 280,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "53e48a11.985b34",
        "type": "ui_button",
        "z": "deff4396.4722a",
        "name": "",
        "group": "ff8a613f.fd5b7",
        "order": 9,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Bajar",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "1",
        "payloadType": "str",
        "topic": "bajar",
        "x": 140,
        "y": 320,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "82f47ef0.ce954",
        "type": "ui_dropdown",
        "z": "deff4396.4722a",
        "name": "",
        "label": "Cortina",
        "place": "Select option",
        "group": "ff8a613f.fd5b7",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "options": [
            {
                "label": "Living",
                "value": "Living",
                "type": "str"
            },
            {
                "label": "Frente comedor ",
                "value": "ComedorFrente",
                "type": "str"
            },
            {
                "label": "Lateral comedor ",
                "value": "ComedorLateral",
                "type": "str"
            },
            {
                "label": "Esquinero cocina ",
                "value": "CocinaEsquinero",
                "type": "str"
            },
            {
                "label": "Lateral cocina",
                "value": "CocinaLateral",
                "type": "str"
            },
            {
                "label": "Ventana lavedero ",
                "value": "LavaderoVentana",
                "type": "str"
            },
            {
                "label": "Puerta Lavadero",
                "value": "LavaderoPuerta",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "cortina",
        "x": 130,
        "y": 80,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "461a1cac.111c04",
        "type": "ui_dropdown",
        "z": "deff4396.4722a",
        "name": "",
        "label": "Item",
        "place": "Select option",
        "group": "ff8a613f.fd5b7",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "options": [
            {
                "label": "Limite Maximo",
                "value": "limMax",
                "type": "str"
            },
            {
                "label": "Velocidad Subir",
                "value": "velSubir",
                "type": "str"
            },
            {
                "label": "Velocidad Parar",
                "value": "velParar",
                "type": "str"
            },
            {
                "label": "Velocidad Bajar",
                "value": "velBajar",
                "type": "str"
            },
            {
                "label": "Limite Minimo",
                "value": "limMinimo",
                "type": "str"
            },
            {
                "label": "Posicion",
                "value": "posicion",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "item",
        "x": 140,
        "y": 120,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "24d7f863.61d028",
        "type": "ui_switch",
        "z": "230e7f04.aca52",
        "name": "",
        "label": "D0",
        "group": "ff2252ef.d12aa",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "0",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 210,
        "y": 70,
        "wires": [
            [
                "411b27cf.122ad8"
            ]
        ]
    },
    {
        "id": "b72e08a8.825f08",
        "type": "ui_switch",
        "z": "230e7f04.aca52",
        "name": "",
        "label": "D1",
        "group": "ff2252ef.d12aa",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "1",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 210,
        "y": 110,
        "wires": [
            [
                "411b27cf.122ad8"
            ]
        ]
    },
    {
        "id": "cc6a27e0.7872a8",
        "type": "ui_switch",
        "z": "230e7f04.aca52",
        "name": "",
        "label": "D2",
        "group": "ff2252ef.d12aa",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "2",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 210,
        "y": 150,
        "wires": [
            [
                "411b27cf.122ad8"
            ]
        ]
    },
    {
        "id": "7de9350c.2c638c",
        "type": "ui_switch",
        "z": "230e7f04.aca52",
        "name": "",
        "label": "D3",
        "group": "ff2252ef.d12aa",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "3",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 210,
        "y": 190,
        "wires": [
            [
                "411b27cf.122ad8"
            ]
        ]
    },
    {
        "id": "c0c34e09.35861",
        "type": "ui_switch",
        "z": "230e7f04.aca52",
        "name": "",
        "label": "D5",
        "group": "ff2252ef.d12aa",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "5",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 210,
        "y": 270,
        "wires": [
            [
                "411b27cf.122ad8"
            ]
        ]
    },
    {
        "id": "f9c62d54.7f094",
        "type": "ui_switch",
        "z": "230e7f04.aca52",
        "name": "",
        "label": "D6",
        "group": "ff2252ef.d12aa",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "6",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 210,
        "y": 310,
        "wires": [
            [
                "411b27cf.122ad8"
            ]
        ]
    },
    {
        "id": "93568155.14a6e",
        "type": "ui_switch",
        "z": "230e7f04.aca52",
        "name": "",
        "label": "D7",
        "group": "ff2252ef.d12aa",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "7",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 210,
        "y": 350,
        "wires": [
            [
                "411b27cf.122ad8"
            ]
        ]
    },
    {
        "id": "97f851d.49cc7b",
        "type": "ui_switch",
        "z": "230e7f04.aca52",
        "name": "",
        "label": "D8",
        "group": "ff2252ef.d12aa",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "8",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 210,
        "y": 390,
        "wires": [
            [
                "411b27cf.122ad8"
            ]
        ]
    },
    {
        "id": "dcf8322b.95d13",
        "type": "ui_switch",
        "z": "230e7f04.aca52",
        "name": "",
        "label": "D4",
        "group": "ff2252ef.d12aa",
        "order": 10,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "4",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 210,
        "y": 230,
        "wires": [
            [
                "411b27cf.122ad8"
            ]
        ]
    },
    {
        "id": "34a42ed0.f6adc2",
        "type": "ui_switch",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "label": "Alarma",
        "group": "1134b585.4c9e0a",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 1760,
        "y": 1110,
        "wires": [
            [
                "11075f36.1f5d01"
            ]
        ]
    },
    {
        "id": "17d6214.c6c9bdf",
        "type": "ui_switch",
        "z": "73083520.75304c",
        "name": "",
        "label": "Luz Lavadero",
        "group": "1c362bad.cfd2e4",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "Lavadero",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 1380,
        "y": 110,
        "wires": [
            [
                "ad875658.859188"
            ]
        ]
    },
    {
        "id": "84176557.cef1e8",
        "type": "ui_switch",
        "z": "73083520.75304c",
        "name": "",
        "label": "Luz Alacena Lavadero",
        "group": "1c362bad.cfd2e4",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "alacenaLavadero",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 1390,
        "y": 160,
        "wires": [
            [
                "ad875658.859188"
            ]
        ]
    },
    {
        "id": "1dc88260.6fd34e",
        "type": "ui_switch",
        "z": "73083520.75304c",
        "name": "",
        "label": "llenar Tanque",
        "group": "1c362bad.cfd2e4",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "llenarTanque",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 1370,
        "y": 210,
        "wires": [
            [
                "ad875658.859188"
            ]
        ]
    },
    {
        "id": "d7c0da49.673d58",
        "type": "ui_switch",
        "z": "73083520.75304c",
        "name": "",
        "label": "bomba Centrifuga",
        "group": "1c362bad.cfd2e4",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "bombaPozo",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 1390,
        "y": 250,
        "wires": [
            [
                "ad875658.859188"
            ]
        ]
    },
    {
        "id": "6f669d4b.6dda34",
        "type": "ui_switch",
        "z": "73083520.75304c",
        "name": "",
        "label": "bomba Pileta",
        "group": "1c362bad.cfd2e4",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "bombaPileta",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 1380,
        "y": 300,
        "wires": [
            [
                "ad875658.859188"
            ]
        ]
    },
    {
        "id": "c2e8ba24.39f3b8",
        "type": "ui_switch",
        "z": "950c1426.ff4008",
        "name": "",
        "label": "Luz Baño",
        "group": "1a0f799.46f9186",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "Bano",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 820,
        "y": 650,
        "wires": [
            [
                "21b0c5b2.1b19aa"
            ]
        ]
    },
    {
        "id": "f421502e.fe9ae",
        "type": "ui_switch",
        "z": "950c1426.ff4008",
        "name": "",
        "label": "Modo Ducha",
        "group": "1a0f799.46f9186",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "modoDucha",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 820,
        "y": 690,
        "wires": [
            [
                "21b0c5b2.1b19aa"
            ]
        ]
    },
    {
        "id": "b59774c0.577fd8",
        "type": "ui_switch",
        "z": "950c1426.ff4008",
        "name": "",
        "label": "estado Ducha",
        "group": "1a0f799.46f9186",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "estadoDucha",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 820,
        "y": 730,
        "wires": [
            [
                "21b0c5b2.1b19aa"
            ]
        ]
    },
    {
        "id": "a2dff89e.cf8708",
        "type": "ui_switch",
        "z": "950c1426.ff4008",
        "name": "",
        "label": "Luz Espejo",
        "group": "1a0f799.46f9186",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "LuzEspejo",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 820,
        "y": 770,
        "wires": [
            [
                "21b0c5b2.1b19aa"
            ]
        ]
    },
    {
        "id": "75b90702.f612f8",
        "type": "ui_switch",
        "z": "950c1426.ff4008",
        "name": "",
        "label": "Extractor",
        "group": "1a0f799.46f9186",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "Extractor",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 820,
        "y": 810,
        "wires": [
            [
                "21b0c5b2.1b19aa"
            ]
        ]
    },
    {
        "id": "38baede0.8038e2",
        "type": "ui_switch",
        "z": "950c1426.ff4008",
        "name": "",
        "label": "Luz Pasillo",
        "group": "1a0f799.46f9186",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "false",
        "topic": "LuzPasillo",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 820,
        "y": 850,
        "wires": [
            [
                "21b0c5b2.1b19aa"
            ]
        ]
    },
    {
        "id": "e7995436.864178",
        "type": "ui_switch",
        "z": "a89e305a.c50bb",
        "name": "",
        "label": "Living",
        "group": "6a6e2505.7b8a5c",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "Living",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 760,
        "y": 520,
        "wires": [
            [
                "1ab2f0fa.9116ef"
            ]
        ]
    },
    {
        "id": "81391af8.a44828",
        "type": "ui_switch",
        "z": "a89e305a.c50bb",
        "name": "",
        "label": "Isla",
        "group": "6a6e2505.7b8a5c",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "Isla",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 760,
        "y": 560,
        "wires": [
            [
                "1ab2f0fa.9116ef"
            ]
        ]
    },
    {
        "id": "6f3f19e9.fa3cf8",
        "type": "ui_switch",
        "z": "a89e305a.c50bb",
        "name": "",
        "label": "Cielorrazo",
        "group": "6a6e2505.7b8a5c",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "Cielorrazo",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 780,
        "y": 600,
        "wires": [
            [
                "1ab2f0fa.9116ef"
            ]
        ]
    },
    {
        "id": "1787ebf3.ebb804",
        "type": "ui_switch",
        "z": "a89e305a.c50bb",
        "name": "",
        "label": "isla RGB",
        "group": "6a6e2505.7b8a5c",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "islaRGB",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 770,
        "y": 640,
        "wires": [
            [
                "1ab2f0fa.9116ef"
            ]
        ]
    },
    {
        "id": "50a1b16c.2984",
        "type": "ui_text_input",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "label": "Serial Arduino Nano",
        "group": "177e0064.22348",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": "0",
        "topic": "",
        "x": 370,
        "y": 680,
        "wires": [
            [
                "97f0b2f0.7fe07"
            ]
        ]
    },
    {
        "id": "de146c4e.373df",
        "type": "ui_text_input",
        "z": "deff4396.4722a",
        "name": "",
        "label": "valor",
        "group": "ff8a613f.fd5b7",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "number",
        "delay": 300,
        "topic": "valor",
        "x": 140,
        "y": 160,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "f1992d54.9e6b6",
        "type": "ui_text",
        "z": "230e7f04.aca52",
        "group": "ff2252ef.d12aa",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Debug",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "x": 580,
        "y": 300,
        "wires": []
    },
    {
        "id": "a0fdce3d.0029a",
        "type": "ui_text",
        "z": "3ce5b54a.127d6a",
        "group": "1134b585.4c9e0a",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "est. bat.: ",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 2858.6428451538086,
        "y": 644.4999935286387,
        "wires": []
    },
    {
        "id": "d1b1c079.3077f",
        "type": "ui_text",
        "z": "3ce5b54a.127d6a",
        "group": "177e0064.22348",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "info arduino",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 760,
        "y": 590,
        "wires": []
    },
    {
        "id": "e68fc671.d485c8",
        "type": "ui_text",
        "z": "3ce5b54a.127d6a",
        "group": "1134b585.4c9e0a",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "x": 830,
        "y": 360,
        "wires": []
    },
    {
        "id": "cbca2d76.46fd5",
        "type": "ui_text",
        "z": "950c1426.ff4008",
        "group": "1134b585.4c9e0a",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "text",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1300,
        "y": 40,
        "wires": []
    },
    {
        "id": "25e92b87.f7d434",
        "type": "ui_text",
        "z": "50119c6e.6ff584",
        "group": "1c362bad.cfd2e4",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Temp Lavadero",
        "format": "{{msg.payload}} ºC",
        "layout": "row-spread",
        "x": 660,
        "y": 240,
        "wires": []
    },
    {
        "id": "7aaed2d0.0da38c",
        "type": "ui_text",
        "z": "50119c6e.6ff584",
        "group": "6a6e2505.7b8a5c",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Temp Living",
        "format": "{{msg.payload}} ºC",
        "layout": "row-spread",
        "x": 660,
        "y": 400,
        "wires": []
    },
    {
        "id": "e4abd47d.da0148",
        "type": "ui_text",
        "z": "3ce5b54a.127d6a",
        "group": "1134b585.4c9e0a",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 2910,
        "y": 820,
        "wires": []
    },
    {
        "id": "a1ec76c.03b9088",
        "type": "ui_text",
        "z": "3ce5b54a.127d6a",
        "group": "1134b585.4c9e0a",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 2910,
        "y": 860,
        "wires": []
    },
    {
        "id": "29561e60.eebfd2",
        "type": "ui_text",
        "z": "deff4396.4722a",
        "group": "ff8a613f.fd5b7",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "limMax-velSub-velPar-velBaj-limMin-Pos",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 750,
        "y": 110,
        "wires": []
    },
    {
        "id": "62e689d8.1d5d18",
        "type": "ui_text",
        "z": "deff4396.4722a",
        "group": "ff8a613f.fd5b7",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "recibo Cortina",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 920,
        "y": 450,
        "wires": []
    },
    {
        "id": "f172b930.5a1238",
        "type": "ui_gauge",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "group": "177e0064.22348",
        "order": 3,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "Temp Bat1",
        "label": "units",
        "format": "{{value}}",
        "min": "0",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 2850,
        "y": 250,
        "wires": []
    },
    {
        "id": "c50fec05.b4a01",
        "type": "ui_gauge",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "group": "1134b585.4c9e0a",
        "order": 6,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "Voltaje Bat.",
        "label": "units",
        "format": "{{value}}",
        "min": "9",
        "max": "16",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 2857.880958557129,
        "y": 552.5952598026824,
        "wires": []
    },
    {
        "id": "2d31d0b7.e3314",
        "type": "ui_gauge",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "group": "177e0064.22348",
        "order": 1,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "Temp CPU",
        "label": "units",
        "format": "{{value}}",
        "min": "30",
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 2838.8807258605957,
        "y": 696.6428856168477,
        "wires": []
    },
    {
        "id": "8af0a3fa.e59e7",
        "type": "ui_gauge",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "group": "177e0064.22348",
        "order": 2,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "Amb. Baterias",
        "label": "units",
        "format": "{{value}}",
        "min": "0",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 2865.023780822754,
        "y": 511.1666731153218,
        "wires": []
    },
    {
        "id": "649cd037.becf5",
        "type": "ui_gauge",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "group": "1134b585.4c9e0a",
        "order": 8,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "Niv Tanque",
        "label": "units",
        "format": "{{value}}",
        "min": "100",
        "max": "550",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 2856.4999389648438,
        "y": 604.976184027536,
        "wires": []
    },
    {
        "id": "d4a94829.9d2278",
        "type": "ui_gauge",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "group": "177e0064.22348",
        "order": 4,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "Temp Bat2",
        "label": "units",
        "format": "{{value}}",
        "min": "0",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 2840,
        "y": 300,
        "wires": []
    },
    {
        "id": "a300fbef.9d5148",
        "type": "ui_gauge",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "group": "1134b585.4c9e0a",
        "order": 7,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "Corr. Carga",
        "label": "Ampers",
        "format": "{{value}}",
        "min": "0",
        "max": "20",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 2840,
        "y": 340,
        "wires": []
    },
    {
        "id": "bee9f645.f336a8",
        "type": "ui_gauge",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "group": "1134b585.4c9e0a",
        "order": 9,
        "width": "2",
        "height": "2",
        "gtype": "gage",
        "title": "temp. Termo",
        "label": "Ampers",
        "format": "{{value}}",
        "min": "20",
        "max": "105",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 2840,
        "y": 380,
        "wires": []
    },
    {
        "id": "de866222.be3ce",
        "type": "ui_chart",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "group": "177e0064.22348",
        "order": 9,
        "width": "16",
        "height": "10",
        "label": "Tanque",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "150",
        "ymax": "450",
        "removeOlder": "3",
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": true,
        "x": 2839.8810119628906,
        "y": 178.285699571882,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "c886ed5f.c4e19",
        "type": "ui_chart",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "group": "177e0064.22348",
        "order": 8,
        "width": "16",
        "height": "10",
        "label": "Temperaturas",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "bezier",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "100",
        "removeOlder": "3",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": true,
        "x": 2855.0238723754883,
        "y": 221.16658374241422,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "455e965f.effd68",
        "type": "blynk-ws-in-write",
        "z": "e364a467.07a6a8",
        "name": "",
        "pin": "58",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 252.4999771118164,
        "y": 106.25000095367432,
        "wires": [
            [
                "b9c8c2ba.5fe5c"
            ]
        ]
    },
    {
        "id": "c0ac8ea4.256ab",
        "type": "blynk-ws-in-write",
        "z": "e364a467.07a6a8",
        "name": "",
        "pin": "52",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 252.50000762939453,
        "y": 156.25,
        "wires": [
            [
                "c4d6adc9.7d5d7"
            ]
        ]
    },
    {
        "id": "8b4d983f.4cde68",
        "type": "blynk-ws-in-write",
        "z": "e364a467.07a6a8",
        "name": "",
        "pin": "57",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 248.2222442626953,
        "y": 55.75000190734863,
        "wires": [
            [
                "23a53a0d.bc6c56"
            ]
        ]
    },
    {
        "id": "ffde6b3a.171c38",
        "type": "blynk-ws-in-write",
        "z": "3ce5b54a.127d6a",
        "name": "Blynk",
        "pin": "1",
        "client": "2c18e412.5f5cbc",
        "x": 1370,
        "y": 960,
        "wires": [
            [
                "da17eae0.10cf48"
            ]
        ]
    },
    {
        "id": "c500e5cf.a925d8",
        "type": "blynk-ws-in-write",
        "z": "73083520.75304c",
        "name": "llenar tanque",
        "pin": "34",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 350,
        "y": 190,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "653959cc.7d0be8",
        "type": "blynk-ws-in-write",
        "z": "73083520.75304c",
        "name": "marcha Bomba",
        "pin": "2",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 340,
        "y": 150,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "f992f6b3.5ca268",
        "type": "blynk-ws-in-write",
        "z": "73083520.75304c",
        "name": "Luz Lavadero",
        "pin": "35",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 350,
        "y": 270,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "1061c31a.83e24d",
        "type": "blynk-ws-in-write",
        "z": "73083520.75304c",
        "name": "Bomba Pil",
        "pin": "37",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 360,
        "y": 230,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "c0e91452.73c0e8",
        "type": "blynk-ws-in-write",
        "z": "73083520.75304c",
        "name": "Luz Alacena",
        "pin": "36",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 350,
        "y": 310,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "887abd1a.c9f08",
        "type": "blynk-ws-in-write",
        "z": "73083520.75304c",
        "name": "Electrovalvula",
        "pin": "38",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 350,
        "y": 110,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "4ecbbc81.f52434",
        "type": "blynk-ws-in-write",
        "z": "73083520.75304c",
        "name": "",
        "pin": "74",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 340,
        "y": 890,
        "wires": [
            [
                "55b57916.538338"
            ]
        ]
    },
    {
        "id": "d86d70ac.fb902",
        "type": "blynk-ws-in-write",
        "z": "1b403a13.0ec8c6",
        "name": "bomba man/auto",
        "pin": "101",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 370,
        "y": 300,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "b9342d19.8889d",
        "type": "blynk-ws-in-write",
        "z": "1b403a13.0ec8c6",
        "name": "marcha bomba",
        "pin": "102",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 370,
        "y": 350,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "21c78482.1c0bdc",
        "type": "blynk-ws-in-write",
        "z": "1b403a13.0ec8c6",
        "name": "resistencia man/auto",
        "pin": "103",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 360,
        "y": 400,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "410759b4.a87158",
        "type": "blynk-ws-in-write",
        "z": "1b403a13.0ec8c6",
        "name": "encendido resistencia",
        "pin": "104",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 350,
        "y": 450,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "cc8ef2c4.e89bf",
        "type": "blynk-ws-in-write",
        "z": "1b403a13.0ec8c6",
        "name": "Rociador 99",
        "pin": "99",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 1740,
        "y": 160,
        "wires": [
            [
                "d47448fc.6209e8",
                "81c8c932.e335b8"
            ]
        ]
    },
    {
        "id": "8817dbe1.b5ce48",
        "type": "blynk-ws-in-write",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pin": "98",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 2010,
        "y": 340,
        "wires": [
            [
                "7ff991b6.a5e4"
            ]
        ]
    },
    {
        "id": "a1bcce76.9236b",
        "type": "blynk-ws-in-write",
        "z": "950c1426.ff4008",
        "name": "",
        "pin": "39",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 370,
        "y": 450,
        "wires": [
            [
                "ecc24e7c.a4bec"
            ]
        ]
    },
    {
        "id": "733629df.764a18",
        "type": "blynk-ws-in-write",
        "z": "950c1426.ff4008",
        "name": "",
        "pin": "40",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 370,
        "y": 490,
        "wires": [
            [
                "ecc24e7c.a4bec",
                "5b6c768b.e019f8"
            ]
        ]
    },
    {
        "id": "a09c99c5.f37d68",
        "type": "blynk-ws-in-write",
        "z": "950c1426.ff4008",
        "name": "",
        "pin": "41",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 370,
        "y": 530,
        "wires": [
            [
                "ecc24e7c.a4bec",
                "5b6c768b.e019f8",
                "3ab3f828.cf2788"
            ]
        ]
    },
    {
        "id": "aa04336b.4ba64",
        "type": "blynk-ws-in-write",
        "z": "950c1426.ff4008",
        "name": "",
        "pin": "42",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 370,
        "y": 570,
        "wires": [
            [
                "ecc24e7c.a4bec"
            ]
        ]
    },
    {
        "id": "15c50044.b9249",
        "type": "blynk-ws-in-write",
        "z": "950c1426.ff4008",
        "name": "",
        "pin": "43",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 370,
        "y": 610,
        "wires": [
            [
                "ecc24e7c.a4bec"
            ]
        ]
    },
    {
        "id": "bbb5de09.2dafa",
        "type": "blynk-ws-in-write",
        "z": "950c1426.ff4008",
        "name": "",
        "pin": "44",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 370,
        "y": 650,
        "wires": [
            [
                "ecc24e7c.a4bec"
            ]
        ]
    },
    {
        "id": "6270b00f.b76af",
        "type": "blynk-ws-in-write",
        "z": "9c63fd61.9908c",
        "name": "item a correguir",
        "pin": "18",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 234,
        "y": 345,
        "wires": [
            [
                "78364cb0.17f444",
                "511c78ef.861648"
            ]
        ]
    },
    {
        "id": "eea067e9.de8c78",
        "type": "blynk-ws-in-write",
        "z": "9c63fd61.9908c",
        "name": "valor a correguir",
        "pin": "19",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 236,
        "y": 391,
        "wires": [
            [
                "78364cb0.17f444",
                "511c78ef.861648"
            ]
        ]
    },
    {
        "id": "b5a4419.4319dc",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": "16",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 360,
        "y": 380,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "cc5a4c07.31051",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": "19",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 360,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "3f72ed79.5ffed2",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": "14",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 360,
        "y": 340,
        "wires": [
            [
                "975ffbce.bc05a8",
                "824d7e7b.545c5",
                "44609e54.87142"
            ]
        ]
    },
    {
        "id": "d387673.cfc7398",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": "29",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 360,
        "y": 460,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "1999084e.05e4d8",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": "17",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 360,
        "y": 420,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "11c34e0b.b2b172",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": "8",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 370,
        "y": 583,
        "wires": [
            []
        ]
    },
    {
        "id": "47e1f4a0.2f8bec",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": "18",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 360,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "d9d79109.95d2",
        "type": "blynk-ws-in-write",
        "z": "f682d492.22a758",
        "name": "reset router",
        "pin": "117",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 1168.6666259765625,
        "y": 279.00000953674316,
        "wires": [
            [
                "2bd0f557.1bf01a"
            ]
        ]
    },
    {
        "id": "fa12fe6a.a3741",
        "type": "blynk-ws-in-write",
        "z": "f682d492.22a758",
        "name": "",
        "pin": "124",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 1680.6666259765625,
        "y": 1444,
        "wires": [
            [
                "269fcb97.b09bf4"
            ]
        ]
    },
    {
        "id": "13ae8396.95201c",
        "type": "blynk-ws-in-write",
        "z": "f682d492.22a758",
        "name": "",
        "pin": "125",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 1323.6666259765625,
        "y": 1472,
        "wires": [
            [
                "97f54fd4.80678"
            ]
        ]
    },
    {
        "id": "853fe079.6d881",
        "type": "blynk-ws-in-write",
        "z": "f682d492.22a758",
        "name": "",
        "pin": "73",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 1521.9999237060547,
        "y": 370.44443702697754,
        "wires": [
            [
                "6e57dcc9.a5e0a4"
            ]
        ]
    },
    {
        "id": "e4cf65a4.859558",
        "type": "blynk-ws-in-write",
        "z": "7ac92c99.66ea94",
        "name": "",
        "pin": "32",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 261.94055557250977,
        "y": 576.9286065101624,
        "wires": [
            [
                "cc1add85.586c5",
                "ed33619f.9a01a"
            ]
        ]
    },
    {
        "id": "e8d96369.eb6f2",
        "type": "blynk-ws-in-write",
        "z": "7ac92c99.66ea94",
        "name": "Apagar luces",
        "pin": "13",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 90,
        "y": 300,
        "wires": [
            [
                "dc70c9c.2b0bc38"
            ]
        ]
    },
    {
        "id": "e4e59e31.5f96",
        "type": "blynk-ws-in-write",
        "z": "deff4396.4722a",
        "name": "Cortinas (90)",
        "pin": "90",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 270,
        "y": 80,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "3d5b0886.05c928",
        "type": "blynk-ws-in-write",
        "z": "deff4396.4722a",
        "name": "Cortinas (91)",
        "pin": "91",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 270,
        "y": 120,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "38ed1e27.dd87c2",
        "type": "blynk-ws-in-write",
        "z": "deff4396.4722a",
        "name": "Cortinas (92)",
        "pin": "92",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 270,
        "y": 160,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "26aad263.d1a57e",
        "type": "blynk-ws-in-write",
        "z": "deff4396.4722a",
        "name": "Cortinas (93)",
        "pin": "93",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 270,
        "y": 200,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "3c9eb739.a3d0f8",
        "type": "blynk-ws-in-write",
        "z": "deff4396.4722a",
        "name": "Cortinas (95)",
        "pin": "95",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 270,
        "y": 240,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "7e7fc0dd.3b4ec",
        "type": "blynk-ws-in-write",
        "z": "deff4396.4722a",
        "name": "Cortinas (96)",
        "pin": "96",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 270,
        "y": 280,
        "wires": [
            [
                "328e56ab.38360a",
                "8474c43e.6fad38"
            ]
        ]
    },
    {
        "id": "29b51cd7.7edf94",
        "type": "blynk-ws-in-write",
        "z": "deff4396.4722a",
        "name": "Cortinas (97)",
        "pin": "97",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 270,
        "y": 320,
        "wires": [
            [
                "328e56ab.38360a"
            ]
        ]
    },
    {
        "id": "9f8c863a.5e4538",
        "type": "blynk-ws-out-write",
        "z": "e364a467.07a6a8",
        "name": "",
        "pin": "65",
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 677.0833206176758,
        "y": 561.5277709960938,
        "wires": []
    },
    {
        "id": "2d7d44ee.9b478c",
        "type": "blynk-ws-out-write",
        "z": "e364a467.07a6a8",
        "name": "",
        "pin": "55",
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 806.5000076293945,
        "y": 511.25,
        "wires": []
    },
    {
        "id": "e7f57541.097388",
        "type": "blynk-ws-out-write",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 2111.3927841186523,
        "y": 635.9643287658691,
        "wires": []
    },
    {
        "id": "1f81c83c.68a278",
        "type": "blynk-ws-out-write",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 2116.381134033203,
        "y": 223.5357119696481,
        "wires": []
    },
    {
        "id": "74700a6b.b7b424",
        "type": "blynk-ws-out-write",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 2059.7374954223633,
        "y": 970.8214833395822,
        "wires": []
    },
    {
        "id": "746f78d9.9ca9d8",
        "type": "blynk-ws-out-write",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pin": "6",
        "pinmode": 0,
        "client": "2c18e412.5f5cbc",
        "x": 1735.9761123657227,
        "y": 617.6429290771484,
        "wires": []
    },
    {
        "id": "f77a9f41.1fd82",
        "type": "blynk-ws-out-write",
        "z": "73083520.75304c",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 910,
        "y": 360,
        "wires": []
    },
    {
        "id": "63fd5113.ae3c2",
        "type": "blynk-ws-out-write",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 1077,
        "y": 305,
        "wires": []
    },
    {
        "id": "fce35841.951a48",
        "type": "blynk-ws-out-write",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 1550,
        "y": 120,
        "wires": []
    },
    {
        "id": "e26cc241.b89f1",
        "type": "blynk-ws-out-write",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 2100,
        "y": 130,
        "wires": []
    },
    {
        "id": "257fa906.068fd6",
        "type": "blynk-ws-out-write",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pin": "98",
        "pinmode": 0,
        "client": "2c18e412.5f5cbc",
        "x": 2330,
        "y": 400,
        "wires": []
    },
    {
        "id": "812daebc.b64d6",
        "type": "blynk-ws-out-write",
        "z": "950c1426.ff4008",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 950,
        "y": 330,
        "wires": []
    },
    {
        "id": "77563552.e99a9c",
        "type": "blynk-ws-out-write",
        "z": "950c1426.ff4008",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 1790,
        "y": 330,
        "wires": []
    },
    {
        "id": "90394f1b.d19f2",
        "type": "blynk-ws-out-write",
        "z": "9c63fd61.9908c",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 884,
        "y": 527,
        "wires": []
    },
    {
        "id": "c8224508.e2da48",
        "type": "blynk-ws-out-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 991.8810272216797,
        "y": 397.7499885559082,
        "wires": []
    },
    {
        "id": "5ecd3c4a.fa40b4",
        "type": "blynk-ws-out-write",
        "z": "f682d492.22a758",
        "name": "",
        "pin": "127",
        "pinmode": 0,
        "client": "2c18e412.5f5cbc",
        "x": 318.6666259765625,
        "y": 709.0000095367432,
        "wires": []
    },
    {
        "id": "f84ee0c0.77286",
        "type": "blynk-ws-out-write",
        "z": "deff4396.4722a",
        "name": "",
        "pin": "94",
        "pinmode": 0,
        "client": "2c18e412.5f5cbc",
        "x": 850,
        "y": 300,
        "wires": []
    },
    {
        "id": "6e68ecc4.cf3184",
        "type": "blynk-ws-out-write",
        "z": "deff4396.4722a",
        "name": "",
        "pin": "92",
        "pinmode": 0,
        "client": "2c18e412.5f5cbc",
        "x": 310,
        "y": 430,
        "wires": []
    },
    {
        "id": "3443c861.a5ee58",
        "type": "blynk-ws-out-write",
        "z": "deff4396.4722a",
        "name": "",
        "pin": "95",
        "pinmode": 0,
        "client": "2c18e412.5f5cbc",
        "x": 310,
        "y": 460,
        "wires": []
    },
    {
        "id": "2f97fc11.e764a4",
        "type": "blynk-ws-out-write",
        "z": "deff4396.4722a",
        "name": "",
        "pin": "97",
        "pinmode": 0,
        "client": "2c18e412.5f5cbc",
        "x": 310,
        "y": 490,
        "wires": []
    },
    {
        "id": "5909a72.73bd158",
        "type": "blynk-ws-out-set-property",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "prop": "bycode",
        "client": "2c18e412.5f5cbc",
        "x": 1927.951431274414,
        "y": 932.0714795248849,
        "wires": []
    },
    {
        "id": "d15959e0.b491f8",
        "type": "blynk-ws-out-set-property",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "prop": "bycode",
        "client": "2c18e412.5f5cbc",
        "x": 1967.4522857666016,
        "y": 177.64284678867887,
        "wires": []
    },
    {
        "id": "1fa1bbd5.dc54e4",
        "type": "blynk-ws-out-set-property",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "prop": "bycode",
        "client": "2c18e412.5f5cbc",
        "x": 2001.3927841186523,
        "y": 675.9643287658691,
        "wires": []
    },
    {
        "id": "3ab2d3e0.c8ea8c",
        "type": "blynk-ws-out-set-property",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "prop": "bycode",
        "client": "2c18e412.5f5cbc",
        "x": 840,
        "y": 270,
        "wires": []
    },
    {
        "id": "ad5fc954.82ae08",
        "type": "blynk-ws-out-set-property",
        "z": "950c1426.ff4008",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "prop": "bycode",
        "client": "2c18e412.5f5cbc",
        "x": 930,
        "y": 280,
        "wires": []
    },
    {
        "id": "1067f4ea.ae58eb",
        "type": "blynk-ws-out-set-property",
        "z": "950c1426.ff4008",
        "name": "",
        "pin": 48,
        "pinmode": "1",
        "prop": "bycode",
        "client": "2c18e412.5f5cbc",
        "x": 1770,
        "y": 290,
        "wires": []
    },
    {
        "id": "e5d9a366.0b565",
        "type": "blynk-ws-out-set-property",
        "z": "9c63fd61.9908c",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "prop": "bycode",
        "client": "2c18e412.5f5cbc",
        "x": 772,
        "y": 480,
        "wires": []
    },
    {
        "id": "706c129.8f43aec",
        "type": "blynk-ws-out-set-property",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "prop": "bycode",
        "client": "2c18e412.5f5cbc",
        "x": 910,
        "y": 360,
        "wires": []
    },
    {
        "id": "eb9007a.8c8bff8",
        "type": "blynk-ws-out-notify",
        "z": "f682d492.22a758",
        "name": "",
        "client": "2c18e412.5f5cbc",
        "queue": false,
        "rate": 15,
        "x": 548.6666259765625,
        "y": 479.00000953674316,
        "wires": []
    },
    {
        "id": "bb713a62.b0fdf8",
        "type": "blynk-ws-out-notify",
        "z": "f682d492.22a758",
        "name": "",
        "client": "2c18e412.5f5cbc",
        "queue": false,
        "rate": 1,
        "x": 628.6666259765625,
        "y": 709.0000095367432,
        "wires": []
    },
    {
        "id": "1f5e6cad.b1cab3",
        "type": "thingspeak42",
        "z": "50119c6e.6ff584",
        "name": "DPO83R5G06KFD4UD",
        "delay": "15",
        "topic1": "tempPasillo",
        "topic2": "tempLiving",
        "topic3": "humLiving",
        "topic4": "tempComedor",
        "topic5": "tempCocina",
        "topic6": "tempLavadero",
        "topic7": "tempExterior",
        "topic8": "estQuemador",
        "endpoint": "https://thingspeak.com",
        "x": 703.761890411377,
        "y": 337.47623348236084,
        "wires": []
    },
    {
        "id": "490a73a0.04a99c",
        "type": "thingspeak42",
        "z": "3ce5b54a.127d6a",
        "name": "YJCFSNIEZMNH6U0G",
        "delay": "15",
        "topic1": "voltajeBat",
        "topic2": "corrienteCarga",
        "topic3": "cargador",
        "topic4": "tiempoCargando",
        "topic5": "tiempoEspera",
        "topic6": "nivTanque",
        "topic7": "tasaLlenado",
        "topic8": "",
        "endpoint": "https://thingspeak.com",
        "x": 782.2221984863281,
        "y": 891.1111125946045,
        "wires": []
    },
    {
        "id": "62525e7.2f30ca",
        "type": "thingspeak42",
        "z": "3ce5b54a.127d6a",
        "name": "FUVQOCDCDSQ684O3",
        "delay": "15",
        "topic1": "tempAmbiente",
        "topic2": "tempBat1",
        "topic3": "tempBat2",
        "topic4": "tempCPU",
        "topic5": "",
        "topic6": "",
        "topic7": "",
        "topic8": "",
        "endpoint": "https://thingspeak.com",
        "x": 730,
        "y": 990,
        "wires": []
    },
    {
        "id": "41555cf2.768874",
        "type": "thingspeak42",
        "z": "1b403a13.0ec8c6",
        "name": "4EICHLJL446HHU1Z",
        "delay": "15",
        "topic1": "temperaturaTermo",
        "topic2": "temperaturaExterior",
        "topic3": "crepuscular",
        "topic4": "estBomba",
        "topic5": "tiempoLlenado",
        "topic6": "tempPileta",
        "topic7": "potenciaResistencia",
        "topic8": "horasDia",
        "endpoint": "https://thingspeak.com",
        "x": 887,
        "y": 118,
        "wires": []
    },
    {
        "id": "48c20767.e64078",
        "type": "thingspeak42",
        "z": "1b403a13.0ec8c6",
        "name": "4EICHLJL446HHU1Z",
        "delay": "1",
        "topic1": "temperaturaTermo",
        "topic2": "temperaturaExterior",
        "topic3": "crepuscular",
        "topic4": "estBomba",
        "topic5": "tiempoLlenado",
        "topic6": "estResistencia",
        "topic7": "potenciaResistencia",
        "topic8": "horasDia",
        "endpoint": "https://thingspeak.com",
        "x": 1050,
        "y": 420,
        "wires": []
    },
    {
        "id": "b77070fe.51184",
        "type": "thingspeak42",
        "z": "f682d492.22a758",
        "name": "reinicions",
        "delay": "2",
        "topic1": "reinBano",
        "topic2": "",
        "topic3": "",
        "topic4": "",
        "topic5": "",
        "topic6": "",
        "topic7": "",
        "topic8": "",
        "endpoint": "https://thingspeak.com",
        "x": 2218.6666259765625,
        "y": 329.00000953674316,
        "wires": []
    },
    {
        "id": "c73e087.839dbf8",
        "type": "thingspeak42",
        "z": "e364a467.07a6a8",
        "name": "NBKVMGLFCL4MD6XC",
        "delay": "5",
        "topic1": "DolarVenta",
        "topic2": "DolarCompra",
        "topic3": "BitCoinUSD",
        "topic4": "BitCoinPesos",
        "topic5": "",
        "topic6": "",
        "topic7": "",
        "topic8": "",
        "endpoint": "https://thingspeak.com",
        "x": 770,
        "y": 250,
        "wires": []
    },
    {
        "id": "e05432b5.73a34",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 582.7777777777777,
        "y": 355.55555555555554,
        "wires": []
    },
    {
        "id": "44609e54.87142",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 669.4444444444445,
        "y": 737.7777777777777,
        "wires": []
    },
    {
        "id": "49bb5a50.c72c84",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "ESP/TermoSolar/Envio",
        "qos": "2",
        "datatype": "auto",
        "broker": "c339edbf.39572",
        "x": 107.77777099609375,
        "y": 926.5555419921875,
        "wires": [
            [
                "b50751d4.0745",
                "99ff2535.0c1838",
                "7187c2e5.d9c10c"
            ]
        ]
    },
    {
        "id": "fa6c834e.be6f1",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "terminalBlynk",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1873.5554542541504,
        "y": 537.9999599456787,
        "wires": []
    },
    {
        "id": "be327a78.688fb8",
        "type": "file",
        "z": "deff4396.4722a",
        "name": "Living",
        "filename": "/home/pi/BackUpNodeRed/Cortinas/Living.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 387.7777633666992,
        "y": 683.3333206176758,
        "wires": [
            []
        ]
    },
    {
        "id": "c0d2001d.8e91b",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 741,
        "y": 851,
        "wires": []
    },
    {
        "id": "f0e8ac88.addef",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/living/Iluminacion/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "6b36e4a.1d30b1c",
        "x": 530,
        "y": 40,
        "wires": [
            [
                "af5e970.dfc2168"
            ]
        ]
    },
    {
        "id": "af5e970.dfc2168",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 774,
        "y": 43,
        "wires": []
    },
    {
        "id": "577fff27.098f7",
        "type": "blynk-ws-out-write",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 934,
        "y": 923,
        "wires": []
    },
    {
        "id": "9469939c.74979",
        "type": "inject",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "5",
        "topic": "informarNivel",
        "payload": "",
        "payloadType": "date",
        "x": 272,
        "y": 847,
        "wires": [
            [
                "99ff2535.0c1838"
            ]
        ]
    },
    {
        "id": "fcc8fe1f.82cfe",
        "type": "mqtt in",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "topic": "ESP/Lavadero/Temperatura",
        "qos": "2",
        "datatype": "auto",
        "broker": "c339edbf.39572",
        "x": 2378,
        "y": 406,
        "wires": [
            [
                "19fdb46e.72052c",
                "6426f42f.2ca5bc",
                "942c7922.626f58",
                "b7217fe3.78b27",
                "f20c8fe3.a0061"
            ]
        ]
    },
    {
        "id": "27971f19.75688",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "Prueba insertar",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "INSERT INTO `salamandra`(`tiempo`, `tempLiving`, `tempPasillo`, `tempBano`, `tempHab1`, `tempHab2`, `tempComedor`, `tempCocina`, `tempLavadero`, `tempExterior`, `tempTermo`, `tempBajTermo`, `tempSubTermo`, `tempDepTermo`, `tempSerpCamara`, `temp1Serp`, `tempChimenea`, `tempRetRad`, `tempDepRad`, `aireEnc`, `airePrim`, `aireSec`, `aireTerc`, `turbo`, `bombaRad`, `bombaRec`, `bombaTermo`) VALUES (now(),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)",
        "payload": "",
        "payloadType": "date",
        "x": 331.5,
        "y": 1034,
        "wires": [
            []
        ]
    },
    {
        "id": "4178563f.d9c9d8",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "var mysql = \"INSERT INTO \\`salamandra\\`(\\`tiempo\\`, \\`tempLiving\\`, \\`tempPasillo\\`, \\`tempBano\\`, \\`tempHab1\\`, \\`tempHab2\\`, \\`tempComedor\\`, \\`tempCocina\\`, \\`tempLavadero\\`, \\`tempExterior\\`, \\`tempTermo\\`, \\`tempBajTermo\\`, \\`tempSubTermo\\`, \\`tempDepTermo\\`, \\`tempSerpCamara\\`, \\`temp1Serp\\`, \\`tempChimenea\\`, \\`tempRetRad\\`, \\`tempDepRad\\`, \\`aireEnc\\`, \\`airePrim\\`, \\`aireSec\\`, \\`aireTerc\\`, \\`turbo\\`, \\`bombaRad\\`, \\`bombaRec\\`, \\`bombaTermo\\`) VALUES (now(),\";\nmysql += 55 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \",\";\nmysql += 0 + \")\";\nmsg.topic = mysql;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 484.5,
        "y": 1156,
        "wires": [
            [
                "be1e12a6.9a7f8"
            ]
        ]
    },
    {
        "id": "113481ef.252bee",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 691.5,
        "y": 1087,
        "wires": []
    },
    {
        "id": "31d831c2.6b225e",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "consulta gral",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "SELECT * FROM `salamandra` WHERE 1",
        "payload": "",
        "payloadType": "date",
        "x": 340.5,
        "y": 1076,
        "wires": [
            []
        ]
    },
    {
        "id": "5a9198c5.692d88",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "Vaciar",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "DELETE FROM `salamandra` WHERE 1",
        "payload": "",
        "payloadType": "date",
        "x": 322,
        "y": 1116,
        "wires": [
            []
        ]
    },
    {
        "id": "9f007328.7ff43",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 267.5,
        "y": 1191,
        "wires": [
            [
                "4178563f.d9c9d8"
            ]
        ]
    },
    {
        "id": "be1e12a6.9a7f8",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "topic",
        "targetType": "msg",
        "x": 703,
        "y": 1157,
        "wires": []
    },
    {
        "id": "148f0752.92ea69",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "salamandra/Envio",
        "topic": "salamandra/Envio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 565.9444694519043,
        "y": 554.8888893127441,
        "wires": [
            [
                "dc89ff68.1264c"
            ]
        ]
    },
    {
        "id": "dc89ff68.1264c",
        "type": "delay",
        "z": "65561250.4225fc",
        "name": "100mS",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 733.9444580078125,
        "y": 573.888916015625,
        "wires": [
            [
                "245b8b96.8775c4"
            ]
        ]
    },
    {
        "id": "3d9cd840.f417c8",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "termoSolar/Salamandra",
        "topic": "termoSolar/Salamandra",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 536.5556030273438,
        "y": 510.111083984375,
        "wires": [
            [
                "1924d45c.22d92c"
            ]
        ]
    },
    {
        "id": "52f9a6c1.0b7488",
        "type": "ui_chart",
        "z": "65561250.4225fc",
        "name": "tempSalamandra",
        "group": "bb26301d.077de",
        "order": 1,
        "width": "14",
        "height": "10",
        "label": "chart",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "100",
        "removeOlder": "8",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "x": 1285.2221755981445,
        "y": 538.4444789886475,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "374fe1d.731cf1e",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "func": "msg = {topic: \"tempTermoSolar\", payload: global.get(\"tempTermoFin\")}; node.send(msg);\nreturn;\n//tempTermoFin",
        "outputs": 1,
        "noerr": 0,
        "x": 2621.111083984375,
        "y": 136.66665649414062,
        "wires": [
            []
        ]
    },
    {
        "id": "b831424a.5150e",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 2855,
        "y": 135.55555555555554,
        "wires": []
    },
    {
        "id": "e8f48f89.564fe",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1232.0000457763672,
        "y": 504.99999928474426,
        "wires": []
    },
    {
        "id": "bdef3232.c00d3",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[]",
        "payloadType": "json",
        "x": 905,
        "y": 586,
        "wires": [
            [
                "52f9a6c1.0b7488"
            ]
        ]
    },
    {
        "id": "6c5ec0fd.a07b9",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/inPid",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 862.5,
        "y": 738,
        "wires": [
            [
                "44bad6f6.392098"
            ]
        ]
    },
    {
        "id": "41b63f75.50e6c",
        "type": "mqtt out",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/outPid",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1225.6667022705078,
        "y": 785.6666374206543,
        "wires": []
    },
    {
        "id": "f58c878e.4e9d48",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "context.ant = context.ant || 1;\n\nvar resto = Math.abs(context.ant - msg.payload);\ncontext.ant = msg.payload;\nnode.status({text: resto});",
        "outputs": 1,
        "noerr": 0,
        "x": 1085.944480895996,
        "y": 837.1110992431641,
        "wires": [
            [
                "ac713742.35f178"
            ]
        ]
    },
    {
        "id": "ac713742.35f178",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1247.3333320617676,
        "y": 834.2222290039062,
        "wires": []
    },
    {
        "id": "9f95f91a.002938",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "var dato;\ncontext.mmAnt == context.mmAnt || 0;\nif (global.get(\"tempCamara\") === undefined)global.set(\"tempCamara\", 1); if (global.get(\"DiftempCamara\") === undefined)global.set(\"DiftempCamara\", 1); \nif (global.get(\"tempSerp1Fuego\") === undefined)global.set(\"tempSerp1Fuego\", 2); if (global.get(\"DiftempSerp1Fuego\") === undefined)global.set(\"DiftempSerp1Fuego\", 2); \nif (global.get(\"tempSerp2Fuego\") === undefined)global.set(\"tempSerp2Fuego\", 3); if (global.get(\"DiftempSerp2Fuego\") === undefined)global.set(\"DiftempSerp2Fuego\", 3); \nif (global.get(\"tempChimenea\") === undefined)global.set(\"tempChimenea\", 4); if (global.get(\"DiftempChimenea\") === undefined)global.set(\"DiftempChimenea\", 4); \n\nif (global.get(\"tempDepTermo\") === undefined)global.set(\"tempDepTermo\", 5); if (global.get(\"DiftempDepTermo\") === undefined)global.set(\"DiftempDepTermo\", 5); \nif (global.get(\"tempDepRadiadores\") === undefined)global.set(\"tempDepRadiadores\", 6); if (global.get(\"DiftempDepRadiadores\") === undefined)global.set(\"DiftempDepRadiadores\", 6); \nif (global.get(\"tempSerp1Agua\") === undefined)global.set(\"tempSerp1Agua\", 7); if (global.get(\"DiftempSerp1Agua\") === undefined)global.set(\"DiftempSerp1Agua\", 7); \nif (global.get(\"tempRetRadiadores\") === undefined)global.set(\"tempRetRadiadores\", 8); if (global.get(\"DiftempRetRadiadores\") === undefined)global.set(\"DiftempRetRadiadores\", 8); \nif (global.get(\"tempSerpCamara\") === undefined)global.set(\"tempSerpCamara\", 9); if (global.get(\"DiftempSerpCamara\") === undefined) global.set(\"DiftempSerpCamara\", 9); \n\nif (global.get(\"pidAnterior\") === undefined)global.set(\"pidAnterior\", 0);\n\nif (msg.topic == \"timer\"){\n// \tif (parseInt(global.get(\"mm\")) !== context.mmAnt){\n// \t\tcontext.mmAnt = global.get(\"mm\");\n\t\tmsg = {topic: \"salamandra/Recibo\", payload: \"pedidoTemp\"}; return ([msg, null, null, null]);\n// \t}\n}\n\nif (msg.topic == \"salamandra/Envio/PedidoEstado\"){\n    // dato = global.get(\"salamandraAuto\") + \"#\";\n    dato = global.get(\"salamandraBbaCirc\") + \"#\";\n    dato += global.get(\"salamandraBbaRad\") + \"#\";\n    dato += global.get(\"salamandraBbaTermo\") + \"#\";\n    dato += global.get(\"estadoTurbo\") + \"#\";\n    dato += global.get(\"aire1\") + \"#\";\n    dato += global.get(\"aire2\") + \"#\";\n    dato += global.get(\"aire3\") + \"#\";\n    dato += global.get(\"aire4\");\n    msg = {topic: \"salamandra/Recibo\", payload: \"estado\" + dato};\n    return ([msg, null, null, null]);\n}\n\nif (msg.topic == \"termoSolar/Salamandra\"){\n\tdato = msg.payload.split(\"#\");\n\tglobal.set(\"tempBajTermo\", dato[0]);\n\tglobal.set(\"tempSubTermo\", dato[1]);\n\treturn;\n}\n\nif (msg.topic == \"salamandra/Envio\"){\n\tvar valor = 0;\n\tdato = msg.payload.split(\"#\");\n\t\n\tvalor = parseFloat(dato[0] - global.get(\"tempCamara\")).toFixed(1);\n\tglobal.set(\"tempCamara\", dato[0]); global.set(\"DiftempCamara\", valor);// - parseFloat(global.get(\"tempCamara\")));//).toFixed(1)); \n\t// dato = global.get(\"DiftempCamara\"); msg.payload = dato; node.send([null, msg]);\n\n\n\tvalor = parseFloat(dato[1] - global.get(\"tempSerp1Fuego\")).toFixed(1);\n\tglobal.set(\"tempSerp1Fuego\", dato[1]); global.set(\"DiftempSerp1Fuego\", valor); \n\t\n\tvalor = parseFloat(dato[2] - global.get(\"tempSerp2Fuego\")).toFixed(1);\n\tglobal.set(\"tempSerp2Fuego\", dato[2]); global.set(\"DiftempSerp2Fuego\", valor); \n\t\n\tvalor = parseFloat(dato[3] - global.get(\"tempChimenea\")).toFixed(1);\n\tglobal.set(\"tempChimenea\", dato[3]); global.set(\"DiftempChimenea\", valor); \n\t\n\tvalor = parseFloat(dato[4] - global.get(\"tempDepTermo\")).toFixed(1);\n\tglobal.set(\"tempDepTermo\", dato[4]); global.set(\"DiftempDepTermo\", valor); \n\t\n\tvalor = parseFloat(dato[5] - global.get(\"tempDepRadiadores\")).toFixed(1);\n\tglobal.set(\"tempDepRadiadores\", dato[5]); global.set(\"DiftempDepRadiadores\", valor); \n\t\n\tvalor = parseFloat(dato[6] - global.get(\"tempSerpCamara\")).toFixed(1);\n\tglobal.set(\"tempSerpCamara\", dato[6]); global.set(\"DiftempSerpCamara\", valor); \n\t\n\tvalor = parseFloat(dato[7] - global.get(\"tempSerp1Agua\")).toFixed(1);\n\tglobal.set(\"tempSerp1Agua\", dato[7]); global.set(\"DiftempSerp1Agua\", valor); \n\t\n\tvalor = parseFloat(dato[8] - global.get(\"tempRetRadiadores\")).toFixed(1);\n\tglobal.set(\"tempRetRadiadores\", dato[8]); global.set(\"DiftempRetRadiadores\", valor); \n\n\tmsg = {topic: \"tempLiving\", payload: global.get(\"tempLiving\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempPasillo\", payload: global.get(\"tempPasillo\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempBano\", payload: global.get(\"tempBano\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempHab1\", payload: global.get(\"tempHab1\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempHab2\", payload: global.get(\"tempHab2\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempComedor\", payload: global.get(\"tempComedor\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempCocina\", payload: global.get(\"tempCocina\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempLavadero\", payload: global.get(\"tempLavadero\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempExterior\", payload: global.get(\"tempExterior\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempTermo\", payload: global.get(\"tempTermo\")}; node.send([null, null, msg, null]);\n\n\tmsg = {topic: \"tempBajTermo\", payload: global.get(\"tempBajTermo\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempSubTermo\", payload: global.get(\"tempSubTermo\")}; node.send([null, null, msg, null]);\n\n\tmsg = {topic: \"tempDepTermo\", payload: global.get(\"tempDepTermo\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempDepRadiadores\", payload: global.get(\"tempDepRadiadores\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempSerpCamara\", payload: global.get(\"tempSerpCamara\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempSerp1Agua\", payload: global.get(\"tempSerp1Agua\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempRetRadiadores\", payload: global.get(\"tempRetRadiadores\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempCamara\", payload: global.get(\"tempCamara\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempSerp1Fuego\", payload: global.get(\"tempSerp1Fuego\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"tempSerp2Fuego\", payload: global.get(\"tempSerp2Fuego\")}; node.send([null, null, msg, null]);\n\n\tmsg = {topic: \"aire1\", payload: global.get(\"aire1\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"aire2\", payload: global.get(\"aire2\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"aire3\", payload: global.get(\"aire3\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"aire4\", payload: global.get(\"aire4\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"estadoTurbo\", payload: global.get(\"estadoTurbo\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"salamandraBbaRad\", payload: global.get(\"salamandraBbaRad\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"salamandraBbaCirc\", payload: global.get(\"salamandraBbaCirc\")}; node.send([null, null, msg, null]);\n\tmsg = {topic: \"salamandraBbaTermo\", payload: global.get(\"salamandraBbaTermo\")}; node.send([null, null, msg, null]);\n\n\tmsg = {topic: \"salamandra/inPid\", payload: global.get(\"tempDepRadiadores\")}; node.send([msg]);\t\n\treturn;\n}\n\n\tif (parseInt(global.get(\"tempCamara\")) > 50){\n\t\tvar mysql = \"INSERT INTO \\`salamandra\\`(\\`tiempo\\`, \\`tempLiving\\`, \\`tempPasillo\\`, \\`tempBano\\`, \\`tempHab1\\`, \\`tempHab2\\`, \\`tempComedor\\`, \\`tempCocina\\`, \\`tempLavadero\\`, \\`tempExterior\\`, \\`tempTermo\\`,\";\n\t\tmysql += \" \\`tempBajTermo\\`, \\`tempSubTermo\\`,\";\n\t\tmysql += \" \\`tempDepTermo\\`, \\`tempSerpCamara\\`, \\`temp1Serp\\`, \\`tempRetRad\\`, \\`tempDepRad\\`, \\`tempCamara\\`, \\`temp1SerpFuego\\`, \\`temp2SerpFuego\\`, \\`tempChimenea\\`,\";\n\t\tmysql += \" \\`aireEnc\\`, \\`airePrim\\`, \\`aireSec\\`, \\`aireTerc\\`, \\`turbo\\`, \\`bombaRad\\`, \\`bombaRec\\`, \\`bombaTermo\\`) VALUES (now(),\";\n\t\t\n\t\tmysql += 55 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n\t\tmysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; \n\t\tmysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n\n\t\tmysql += global.get(\"tempBajTermo\") + \",\" + global.get(\"tempSubTermo\") + \",\";\n\n\t\tmysql += global.get(\"tempDepTermo\") + \",\" + global.get(\"tempDepRadiadores\") + \",\" + global.get(\"tempSerpCamara\") + \",\" + global.get(\"tempSerp1Agua\") + \",\";\n\t\tmysql += global.get(\"tempRetRadiadores\") + \",\" + global.get(\"tempCamara\") + \",\" + global.get(\"tempSerp1Fuego\") + \",\" + global.get(\"tempSerp2Fuego\") + \",\";\n\t\tmysql += global.get(\"tempChimenea\") + \",\";\n\n\t\tmysql += global.get(\"aire1\") + \",\" + global.get(\"aire2\") + \",\" + global.get(\"aire3\") + \",\" + global.get(\"aire4\") + \",\";\n\t\tmysql += global.get(\"estadoTurbo\") + \",\" + global.get(\"salamandraBbaRad\") + \",\" + global.get(\"salamandraBbaCirc\") + \",\" + global.get(\"salamandraBbaTermo\") + \")\";\n\t\tmsg.topic = mysql;\n\t\treturn ([null, null, null, msg]);\t\t\n\t}\n\nif (msg.topic == \"salamandra/outPid\"){\n\n\tdato = 0;\n\tdato = Math.abs(parseInt(global.get(\"pidAnterior\")) - parseInte(msg.payload));\n\n\tif (dato > 50 && parseInt(global.get(\"salamandraAuto\")) === 1){\n\t\tif (parseInt(global.get(\"pidAnterior\")) > parseInte(msg.payload)){\n\t\t\tglobal.set(\"pidAnterior\", parseInte(msg.payload));\n\t\t\tvalor = parseInt(global.get(\"aire2\")) - 5;\n\t\t\tif (parseInt(valor) > 10)global.set(\"aire2\", valor);\n\t\t\tif (parseInt(valor) < 10){\n\t\t\t\tvalor = parseInt(global.get(\"aire3\")) - 5;\n\t\t\t\tif (parseInt(valor) > 10)global.set(\"aire3\", valor);\n\t\t\t\tif (parseInt(valor) < 10){\n\t\t\t\t\tvalor = parseInt(global.get(\"aire4\")) - 5;\n\t\t\t\t\tif (parseInt(valor) > 10)global.set(\"aire4\", valor);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (parseInt(global.get(\"pidAnterior\")) < parseInte(msg.payload)){\n\t\t\tglobal.set(\"pidAnterior\", parseInte(msg.payload));\n\t\t\tvar valor = parseInt(global.get(\"aire4\")) + 5;\n\t\t\tif (parseInt(valor) < 100){global.set(\"aire4\", valor);}else{global.set(\"aire4\", 100)}\n\t\t\tif (parseInt(valor) > 90){\n\t\t\t\tvalor = parseInt(global.get(\"aire3\")) + 5;\n\t\t\t\tif (parseInt(valor) < 100){global.set(\"aire3\", valor);}else{global.set(\"aire3\", 100)}\n\t\t\t\tif (parseInt(valor) > 90){\n\t\t\t\t\tvalor = parseInt(global.get(\"aire2\")) + 5;\n\t\t\t\t\tif (parseInt(valor) < 100){global.set(\"aire2\", valor);}else{global.set(\"aire2\", 100)}\n\t\t\t\t\tif (parseInt(valor) > 90){\n\t\t\t\t\t\tvalor = parseInt(global.get(\"aire1\")) + 5;\n\t\t\t\t\t\tif (parseInt(valor) < 100){global.set(\"aire2\", valor);}else{global.set(\"aire2\", 100)}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\n\t}\n\n\tif (parseInt(global.get(\"tempCamara\")) > 50){\n\t\tvar mysql = \"INSERT INTO \\`salamandra\\`(\\`tiempo\\`, \\`tempLiving\\`, \\`tempPasillo\\`, \\`tempBano\\`, \\`tempHab1\\`, \\`tempHab2\\`, \\`tempComedor\\`, \\`tempCocina\\`, \\`tempLavadero\\`, \\`tempExterior\\`, \\`tempTermo\\`,\";\n\t\tmysql += \" \\`tempBajTermo\\`, \\`tempSubTermo\\`,\";\n\t\tmysql += \" \\`tempDepTermo\\`, \\`tempSerpCamara\\`, \\`temp1Serp\\`, \\`tempRetRad\\`, \\`tempDepRad\\`, \\`tempCamara\\`, \\`temp1SerpFuego\\`, \\`temp2SerpFuego\\`, \\`tempChimenea\\`,\";\n\t\tmysql += \" \\`aireEnc\\`, \\`airePrim\\`, \\`aireSec\\`, \\`aireTerc\\`, \\`turbo\\`, \\`bombaRad\\`, \\`bombaRec\\`, \\`bombaTermo\\`) VALUES (now(),\";\n\t\t\n\t\tmysql += 55 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n\t\tmysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; \n\t\tmysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n\n\t\tmysql += global.get(\"tempBajTermo\") + \",\" + global.get(\"tempSubTermo\") + \",\";\n\n\t\tmysql += global.get(\"tempDepTermo\") + \",\" + global.get(\"tempDepRadiadores\") + \",\" + global.get(\"tempSerpCamara\") + \",\" + global.get(\"tempSerp1Agua\") + \",\";\n\t\tmysql += global.get(\"tempRetRadiadores\") + \",\" + global.get(\"tempCamara\") + \",\" + global.get(\"tempSerp1Fuego\") + \",\" + global.get(\"tempSerp2Fuego\") + \",\";\n\t\tmysql += global.get(\"tempChimenea\") + \",\";\n\n\t\tmysql += global.get(\"aire1\") + \",\" + global.get(\"aire2\") + \",\" + global.get(\"aire3\") + \",\" + global.get(\"aire4\") + \",\";\n\t\tmysql += global.get(\"estadoTurbo\") + \",\" + global.get(\"salamandraBbaRad\") + \",\" + global.get(\"salamandraBbaCirc\") + \",\" + global.get(\"salamandraBbaTermo\") + \")\";\n\t\tmsg.topic = mysql;\n\t\treturn ([null, null, null, msg]);\t\t\n\t}\n}\n\n\n\n\n\n// var mysql = \"INSERT INTO \\\\`salamandra\\\\`(\\\\`tiempo\\\\`, \\\\`tempLiving\\\\`, \\\\`tempPasillo\\\\`, \\\\`tempBano\\\\`, \\\\`tempHab1\\\\`, \\\\`tempHab2\\\\`, \\\\`tempComedor\\\\`, \\\\`tempCocina\\\\`, \\\\`tempLavadero\\\\`, \\\\`tempExterior\\\\`, \\\\`tempTermo\\\\`, \\\\`tempBajTermo\\\\`, \\\\`tempSubTermo\\\\`, \\\\`tempDepTermo\\\\`, \\\\`tempSerpCamara\\\\`, \\\\`temp1Serp\\\\`, \\\\`tempChimenea\\\\`, \\\\`tempRetRad\\\\`, \\\\`tempDepRad\\\\`, \\\\`aireEnc\\\\`, \\\\`airePrim\\\\`, \\\\`aireSec\\\\`, \\\\`aireTerc\\\\`, \\\\`turbo\\\\`, \\\\`bombaRad\\\\`, \\\\`bombaRec\\\\`, \\\\`bombaTermo\\\\`) VALUES (now(),\";\n// mysql += 55 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \")\";\n// msg.topic = mysql;\n// return msg;",
        "outputs": 4,
        "noerr": 0,
        "x": 1704.1429290771484,
        "y": 142.42856693267822,
        "wires": [
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "625090a5.57254",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "salamandra/outPid",
        "topic": "salamandra/outPid",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 566,
        "y": 595,
        "wires": [
            [
                "dc89ff68.1264c"
            ]
        ]
    },
    {
        "id": "d9022a91.8ed228",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "msg.setpoint = msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 718.5,
        "y": 958,
        "wires": [
            [
                "44bad6f6.392098"
            ]
        ]
    },
    {
        "id": "13e16841.e85c88",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "72",
        "payloadType": "num",
        "x": 590.5,
        "y": 951,
        "wires": [
            [
                "d9022a91.8ed228"
            ]
        ]
    },
    {
        "id": "573a726a.0ad37c",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "60",
        "payloadType": "num",
        "x": 594,
        "y": 988,
        "wires": [
            [
                "d9022a91.8ed228"
            ]
        ]
    },
    {
        "id": "8561716f.3e95f",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/backUp",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 128,
        "y": 169,
        "wires": [
            [
                "a6ec15ee.8e8e78"
            ]
        ]
    },
    {
        "id": "36f1eb48.7fcb94",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 588.5,
        "y": 306,
        "wires": []
    },
    {
        "id": "ab871406.14a158",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 580,
        "y": 275,
        "wires": []
    },
    {
        "id": "8292bd95.41ac2",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1091,
        "y": 244,
        "wires": []
    },
    {
        "id": "c4a94a46.929788",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/backUp/recovery",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 143,
        "y": 112,
        "wires": [
            [
                "d361cbfe.b5ce88"
            ]
        ]
    },
    {
        "id": "cc34fc4c.203c2",
        "type": "mqtt out",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1145,
        "y": 150,
        "wires": []
    },
    {
        "id": "45e03c79.d4fad4",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 521,
        "y": 163,
        "wires": []
    },
    {
        "id": "de8103cc.cf9f7",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "if (msg.payload.estado == \"Pedido\")return;\n// if (msg.payload.app == 1)return;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 145.5,
        "y": 241,
        "wires": [
            [
                "a6ec15ee.8e8e78"
            ]
        ]
    },
    {
        "id": "5db14d72.12a114",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 883.5,
        "y": 688,
        "wires": [
            [
                "3b953994.79bf56"
            ]
        ]
    },
    {
        "id": "3b953994.79bf56",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "if (msg.payload == \"pedidoTemp\")return\nnode.status({text: msg.payload})\n// return msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1055.5,
        "y": 688,
        "wires": [
            []
        ]
    },
    {
        "id": "bbae1284.f403b",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 571,
        "y": 400,
        "wires": []
    },
    {
        "id": "33f0296.317e7d6",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 321,
        "y": 148,
        "wires": []
    },
    {
        "id": "ff56bc6d.bdc64",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Encendido",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 555,
        "y": 437,
        "wires": [
            [
                "4871aabf.bf0cd4"
            ]
        ]
    },
    {
        "id": "e1585581.43a3a8",
        "type": "delay",
        "z": "65561250.4225fc",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 762.5,
        "y": 191,
        "wires": [
            [
                "78691845.de5d18"
            ]
        ]
    },
    {
        "id": "4871aabf.bf0cd4",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1007,
        "y": 397,
        "wires": []
    },
    {
        "id": "ebb696a3.aa7358",
        "type": "http in",
        "z": "65561250.4225fc",
        "name": "Request",
        "url": "/salamandra",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 115,
        "y": 311,
        "wires": [
            [
                "4db7751a.afaa9c",
                "846055d3.225218"
            ]
        ]
    },
    {
        "id": "245b8b96.8775c4",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1043,
        "y": 350,
        "wires": []
    },
    {
        "id": "6b3cf483.d4919c",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "salamandra/Recibo",
        "payload": "pedidoTemp",
        "payloadType": "str",
        "x": 887.5,
        "y": 628,
        "wires": [
            [
                "79c5fca9.4651a4"
            ]
        ]
    },
    {
        "id": "79c5fca9.4651a4",
        "type": "mqtt out",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1123.5,
        "y": 625,
        "wires": []
    },
    {
        "id": "c973e18.66b952",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Debug",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1329.6666793823242,
        "y": 628.6666898727417,
        "wires": [
            [
                "ac7fc1b0.ddf5e"
            ]
        ]
    },
    {
        "id": "ac7fc1b0.ddf5e",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1513.6666793823242,
        "y": 621.6666898727417,
        "wires": []
    },
    {
        "id": "3d7e38fe.af40d8",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "76",
        "payloadType": "num",
        "x": 680,
        "y": 870,
        "wires": [
            [
                "44bad6f6.392098"
            ]
        ]
    },
    {
        "id": "4875db01.ff4204",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "72",
        "payloadType": "num",
        "x": 680,
        "y": 840,
        "wires": [
            [
                "44bad6f6.392098"
            ]
        ]
    },
    {
        "id": "df0e99cb.bdbd38",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "55",
        "payloadType": "num",
        "x": 680,
        "y": 800,
        "wires": [
            [
                "44bad6f6.392098"
            ]
        ]
    },
    {
        "id": "eea9634f.09fe1",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "45",
        "payloadType": "num",
        "x": 680,
        "y": 770,
        "wires": [
            [
                "44bad6f6.392098"
            ]
        ]
    },
    {
        "id": "d4698233.0ebe1",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "35",
        "payloadType": "num",
        "x": 680,
        "y": 740,
        "wires": [
            [
                "44bad6f6.392098"
            ]
        ]
    },
    {
        "id": "82ff517a.1fe18",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "25",
        "payloadType": "num",
        "x": 680,
        "y": 710,
        "wires": [
            [
                "44bad6f6.392098"
            ]
        ]
    },
    {
        "id": "620729d2.70ae88",
        "type": "file",
        "z": "f682d492.22a758",
        "name": "reinicios Serv",
        "filename": "/home/gaston/BackUp-Node-Red/ReiniciosNode-Red.txt",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "x": 419,
        "y": 419,
        "wires": [
            []
        ]
    },
    {
        "id": "73d4fe9c.65497",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 114,
        "y": 300,
        "wires": [
            [
                "152c1010.b18a4"
            ]
        ]
    },
    {
        "id": "152c1010.b18a4",
        "type": "file in",
        "z": "f682d492.22a758",
        "name": "Reinicios Serv",
        "filename": "/home/gaston/BackUp-Node-Red/ReiniciosNode-Red.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 294,
        "y": 300,
        "wires": [
            [
                "3de170b6.f5794",
                "7108fd4e.0d52e4"
            ]
        ]
    },
    {
        "id": "3de170b6.f5794",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 482,
        "y": 299,
        "wires": []
    },
    {
        "id": "b7731dcb.672d1",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 104,
        "y": 335,
        "wires": [
            [
                "780a1bc2.19fcf4"
            ]
        ]
    },
    {
        "id": "780a1bc2.19fcf4",
        "type": "file",
        "z": "f682d492.22a758",
        "name": "borrar archivo",
        "filename": "/home/gaston/BackUp-Node-Red/ReiniciosNode-Red.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "delete",
        "x": 324,
        "y": 335,
        "wires": [
            []
        ]
    },
    {
        "id": "8ae3d492.7462d8",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/living/Iluminacion/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1327.250015258789,
        "y": 576.0000076293945,
        "wires": [
            [
                "3c24c007.2b0db",
                "84a5e84a.653358"
            ]
        ]
    },
    {
        "id": "3c24c007.2b0db",
        "type": "file",
        "z": "a89e305a.c50bb",
        "name": "IluminacionLiving",
        "filename": "/home/gaston/BackUp-Node-Red/IluminacionLiving.txt",
        "appendNewline": false,
        "createDir": true,
        "overwriteFile": "true",
        "x": 1583.750015258789,
        "y": 573.0000076293945,
        "wires": [
            []
        ]
    },
    {
        "id": "f5775447.ed26a8",
        "type": "file",
        "z": "a89e305a.c50bb",
        "name": "borrar archivo",
        "filename": "/home/gaston/BackUp-Node-Red/IluminacionLiving.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "delete",
        "x": 1477.750015258789,
        "y": 406.0000057220459,
        "wires": [
            []
        ]
    },
    {
        "id": "5e03f92f.420ff8",
        "type": "file in",
        "z": "a89e305a.c50bb",
        "name": "IluminacionLiving",
        "filename": "/home/gaston/BackUp-Node-Red/IluminacionLiving.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 1470.500015258789,
        "y": 471.5000066757202,
        "wires": [
            [
                "34f397cd.f32c38",
                "40bcc969.95ae78",
                "107210cc.b6bccf"
            ]
        ]
    },
    {
        "id": "5dd40c48.b76474",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1295.000015258789,
        "y": 471.5000066757202,
        "wires": [
            [
                "5e03f92f.420ff8"
            ]
        ]
    },
    {
        "id": "34f397cd.f32c38",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "",
        "func": "var dato;\nvar dato2;\ndato = msg.payload.split(\"#\");\n\n\ndato2 = dato[0].split(\",\");\n\nglobal.set(\"estIsla\", dato2[0]);// + \",\";\nglobal.set(\"potIsla\", dato2[1]);\n\ndato2 = dato[1].split(\",\");\nglobal.set(\"estCielorrazo\", dato2[0]);// + \",\";\nglobal.set(\"potCielorrazo\", dato2[1]);\n\ndato2 = dato[2].split(\",\");\nglobal.set(\"estIslaRGB\", dato2[0]);// + \",\";\nglobal.set(\"IslaR\", dato2[1]);\nglobal.set(\"IslaG\", dato2[2]);\nglobal.set(\"IslaB\", dato2[3]);\n\nglobal.set(\"pwmMaxLed\",dato[3]);\nglobal.set(\"pwmMinLed\",dato[4]);\nglobal.set(\"minTeclas\",dato[5]);\nglobal.set(\"maxTeclas\",dato[6]);\nglobal.set(\"doblePuls\",dato[7]);\n\ndato = global.get(\"estIsla\") + \",\";\ndato += global.get(\"potIsla\") + \"#\";\ndato += global.get(\"estCielorrazo\") + \",\";\ndato += global.get(\"potCielorrazo\") + \"#\";  \ndato += global.get(\"estIslaRGB\") + \",\";\ndato += global.get(\"IslaR\") + \",\";\ndato += global.get(\"IslaG\") + \",\";      \ndato += global.get(\"IslaB\") + \"#\";\n\ndato += global.get(\"pwmMaxLed\") + \"#\";\ndato += global.get(\"pwmMinLed\") + \"#\";\n// dato += global.get(\"dimmerLeds\") + \"#\";\n\ndato += global.get(\"minTeclas\") + \"#\";\ndato += global.get(\"maxTeclas\") + \"#\";\ndato += global.get(\"doblePuls\");\nnode.status({text: dato})\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1647.000015258789,
        "y": 469.5000066757202,
        "wires": [
            []
        ]
    },
    {
        "id": "84a5e84a.653358",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1584.750015258789,
        "y": 631.0000076293945,
        "wires": []
    },
    {
        "id": "d17301ad.9c6a3",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1795.5555419921875,
        "y": 432.2221984863281,
        "wires": []
    },
    {
        "id": "7e23170c.9a31b8",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1802.22216796875,
        "y": 469.9999694824219,
        "wires": []
    },
    {
        "id": "40bcc969.95ae78",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1652.5000152587888,
        "y": 528.8636430393565,
        "wires": []
    },
    {
        "id": "c0fa403.b10e0c",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1280.1136627197266,
        "y": 411.3636226654053,
        "wires": [
            [
                "f5775447.ed26a8"
            ]
        ]
    },
    {
        "id": "804ff6d1.8ba5b8",
        "type": "mqtt out",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/living/Iluminacion/Inicio",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1856.1364135742188,
        "y": 433.4090852737427,
        "wires": []
    },
    {
        "id": "107210cc.b6bccf",
        "type": "delay",
        "z": "a89e305a.c50bb",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1659.7728805541992,
        "y": 433.4091205596924,
        "wires": [
            [
                "804ff6d1.8ba5b8"
            ]
        ]
    },
    {
        "id": "82391d3a.3caeb",
        "type": "mqtt in",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1660,
        "y": 606.25,
        "wires": [
            [
                "b675a2c6.b67e3",
                "5d8331d6.22c84"
            ]
        ]
    },
    {
        "id": "b675a2c6.b67e3",
        "type": "file",
        "z": "950c1426.ff4008",
        "name": "IluminacionLiving",
        "filename": "/home/gaston/BackUp-Node-Red/Bano.txt",
        "appendNewline": false,
        "createDir": true,
        "overwriteFile": "true",
        "x": 1946.5,
        "y": 603.25,
        "wires": [
            []
        ]
    },
    {
        "id": "625026ac.d6b688",
        "type": "file",
        "z": "950c1426.ff4008",
        "name": "borrar archivo",
        "filename": "/home/gaston/BackUp-Node-Red/Bano.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "delete",
        "x": 1840.5,
        "y": 436.24999809265137,
        "wires": [
            []
        ]
    },
    {
        "id": "d304480e.704888",
        "type": "file in",
        "z": "950c1426.ff4008",
        "name": "IluminacionLiving",
        "filename": "/home/gaston/BackUp-Node-Red/Bano.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 1833.25,
        "y": 501.7499990463257,
        "wires": [
            [
                "97831ac8.f778f8",
                "4186f117.cbf74",
                "aaa3a380.2baeb"
            ]
        ]
    },
    {
        "id": "20c05524.0805da",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1657.75,
        "y": 501.7499990463257,
        "wires": [
            [
                "d304480e.704888"
            ]
        ]
    },
    {
        "id": "97831ac8.f778f8",
        "type": "function",
        "z": "950c1426.ff4008",
        "name": "",
        "func": "var dato2 = msg.payload.split(\"#\");\n\nglobal.set(\"estLuzBano\", dato2[0]);// + \",\";\nglobal.set(\"pwmLuzBano\", dato2[1]);\nglobal.set(\"modoDucha\", dato2[2]);\nglobal.set(\"estDucha\", dato2[3]);\n\nglobal.set(\"pwmDucha\",dato2[4]);\nglobal.set(\"estLuzEspejo\",dato2[5]);\nglobal.set(\"estExtractorBano\",dato2[6]);\nglobal.set(\"timerExtractorBano\",dato2[7]);\n\ndato = global.get(\"estLuzBano\") + \"#\";\ndato += global.get(\"pwmLuzBano\") + \"#\";\ndato += global.get(\"modoDucha\") + \"#\";\ndato += global.get(\"estDucha\") + \"#\";  \ndato += global.get(\"pwmDucha\") + \"#\";\ndato += global.get(\"estLuzEspejo\") + \"#\";\ndato += global.get(\"estExtractorBano\") + \"#\";      \ndato += global.get(\"timerExtractorBano\") + \"#\";\n\nnode.status({text: dato})\n",
        "outputs": 1,
        "noerr": 0,
        "x": 2009.75,
        "y": 499.7499990463257,
        "wires": [
            []
        ]
    },
    {
        "id": "5d8331d6.22c84",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1947.5,
        "y": 661.25,
        "wires": []
    },
    {
        "id": "4186f117.cbf74",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 2015.25,
        "y": 559.113635409962,
        "wires": []
    },
    {
        "id": "3788be57.e35842",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1642.8636474609375,
        "y": 441.61361503601074,
        "wires": [
            [
                "625026ac.d6b688"
            ]
        ]
    },
    {
        "id": "22c03eaa.79d582",
        "type": "mqtt out",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Inicio",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 2178.8863983154297,
        "y": 463.65907764434814,
        "wires": []
    },
    {
        "id": "aaa3a380.2baeb",
        "type": "delay",
        "z": "950c1426.ff4008",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 2022.5228652954102,
        "y": 463.65911293029785,
        "wires": [
            [
                "22c03eaa.79d582"
            ]
        ]
    },
    {
        "id": "5fcc8075.23006",
        "type": "inject",
        "z": "e364a467.07a6a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 603.5,
        "y": 32,
        "wires": [
            [
                "7663d2dd.d9b21c"
            ]
        ]
    },
    {
        "id": "7663d2dd.d9b21c",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "",
        "func": "node.status({text: \"MinimoComprar:\" + global.get(\"MinimoComprar\")});",
        "outputs": 1,
        "noerr": 0,
        "x": 732.5,
        "y": 69,
        "wires": [
            []
        ]
    },
    {
        "id": "8cab0534.a18808",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1378.3333333333333,
        "y": 256.6666666666667,
        "wires": [
            [
                "254654b4.88ecbc"
            ]
        ]
    },
    {
        "id": "254654b4.88ecbc",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "",
        "func": "msg.payload = global.get(\"pwmMaxLed\") + \"#\";\nmsg.payload += global.get(\"pwmMinLed\") + \"#\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1537.2222222222222,
        "y": 252.22222222222223,
        "wires": [
            [
                "a064acc6.d311b"
            ]
        ]
    },
    {
        "id": "a064acc6.d311b",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1686.6666259765625,
        "y": 242.2222137451172,
        "wires": []
    },
    {
        "id": "1924d45c.22d92c",
        "type": "delay",
        "z": "65561250.4225fc",
        "name": "150mS",
        "pauseType": "delay",
        "timeout": "150",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 718.5,
        "y": 509,
        "wires": [
            []
        ]
    },
    {
        "id": "5d9df7b5.9aa328",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1264.3333473205566,
        "y": 692.0000247955322,
        "wires": [
            [
                "ecc90ea4.c4cb1"
            ]
        ]
    },
    {
        "id": "ecc90ea4.c4cb1",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "var mysql = \"INSERT INTO \\`salamandra\\`(\\`tiempo\\`, \\`tempLiving\\`, \\`tempPasillo\\`, \\`tempBano\\`, \\`tempHab1\\`, \\`tempHab2\\`, \\`tempComedor\\`, \\`tempCocina\\`, \\`tempLavadero\\`, \\`tempExterior\\`, \\`tempTermo\\`,\";\n    mysql += \" \\`tempBajTermo\\`, \\`tempSubTermo\\`,\";\n    mysql += \" \\`tempDepTermo\\`, \\`tempSerpCamara\\`, \\`temp1Serp\\`, \\`tempRetRad\\`, \\`tempDepRad\\`, \\`tempCamara\\`, \\`temp1SerpFuego\\`, \\`temp2SerpFuego\\`, \\`tempChimenea\\`,\";\n    mysql += \" \\`aireEnc\\`, \\`airePrim\\`, \\`aireSec\\`, \\`aireTerc\\`, \\`turbo\\`, \\`bombaRad\\`, \\`bombaRec\\`, \\`bombaTermo\\`) VALUES (now(),\";\n    \n    mysql += global.get(\"tempLiving\") + \",\"; mysql += global.get(\"tempPasillo\") + \",\"; \n    mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; \n    mysql += global.get(\"tempLavadero\") + \",\"; mysql += global.get(\"tempExterior\") + \",\"; mysql += global.get(\"tempTermoFin\") + \",\";\n\n    mysql += global.get(\"tempBajTermo\") + \",\" + global.get(\"tempSubTermo\") + \",\";\n\n    mysql += global.get(\"tempDepTermo\") + \",\" + global.get(\"tempDepRadiadores\") + \",\" + global.get(\"tempSerpCamara\") + \",\" + global.get(\"tempSerp1Agua\") + \",\";\n    mysql += global.get(\"tempRetRadiadores\") + \",\" + global.get(\"tempCamara\") + \",\" + global.get(\"tempSerp1Fuego\") + \",\" + global.get(\"tempSerp2Fuego\") + \",\";\n    mysql += global.get(\"tempChimenea\") + \",\";\n\n    mysql += global.get(\"aire1\") + \",\" + global.get(\"aire2\") + \",\" + global.get(\"aire3\") + \",\" + global.get(\"aire4\") + \",\";\n    mysql += global.get(\"estadoTurbo\") + \",\" + global.get(\"salamandraBbaRad\") + \",\" + global.get(\"salamandraBbaCirc\") + \",\" + global.get(\"salamandraBbaTermo\") + \")\";\n    msg.topic = mysql;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1410,
        "y": 680,
        "wires": [
            [
                "876287ef.b44bf8"
            ]
        ]
    },
    {
        "id": "876287ef.b44bf8",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "topic",
        "targetType": "msg",
        "x": 1509.5,
        "y": 755,
        "wires": []
    },
    {
        "id": "93908c30.1973d",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "SHOW INDEX FROM salamandra",
        "payload": "",
        "payloadType": "date",
        "x": 1469,
        "y": 805,
        "wires": [
            []
        ]
    },
    {
        "id": "5424076d.242268",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1770.5,
        "y": 785,
        "wires": []
    },
    {
        "id": "58921b45.47b0b4",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1505.500015258789,
        "y": 308.333345413208,
        "wires": [
            []
        ]
    },
    {
        "id": "4a712767.bd17b8",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "\nnode.status({text: global.get(\"estadoSalamandra\")})\n// if (msg.payload == \"pedidoTemp\" && parseInt(global.get(\"estadoSalamandra\")) == 1)return msg;\nif (msg.payload == \"pedidoTemp\")return msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1661.5,
        "y": 324,
        "wires": [
            [
                "26d46b9f.e9cdc4"
            ]
        ]
    },
    {
        "id": "26d46b9f.e9cdc4",
        "type": "delay",
        "z": "65561250.4225fc",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1518.5,
        "y": 386,
        "wires": [
            [
                "57df9c56.eb4054"
            ]
        ]
    },
    {
        "id": "57df9c56.eb4054",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "var tempMinima = 100;\nif (parseFloat(global.get(\"tempLiving\")) < parseFloat(tempMinima))tempMinima = global.get(\"tempLiving\");\nif (parseFloat(global.get(\"tempPasillo\")) < parseFloat(tempMinima))tempMinima = global.get(\"tempPasillo\");\nif (parseFloat(global.get(\"tempLavadero\")) < parseFloat(tempMinima))tempMinima = global.get(\"tempLavadero\");\n// if (parseFloat(global.get(\"tempLiving\")) < parseFloat(tempMinima))tempMinima = global.get(\"tempLiving\");\n\nmsg= {topic: \"tempMinCasa\", payload: tempMinima}; node.send(msg);\nmsg= {topic: \"tempDepRad\", payload: global.get(\"tempDepRadiadores\")}; node.send(msg); \nmsg= {topic: \"tempRetRad\", payload: global.get(\"tempRetRadiadores\")}; node.send(msg); \nmsg= {topic: \"tempDepTermo\", payload: global.get(\"tempDepTermo\")}; node.send(msg); \nmsg= {topic: \"tempTermoSolar\", payload: global.get(\"tempTermoFin\")}; node.send(msg); \nmsg= {topic: \"estBombaRad\", payload: global.get(\"salamandraBbaRad\")}; node.send(msg); \nmsg= {topic: \"tempCamara\", payload: global.get(\"tempCamara\")}; node.send(msg); \nmsg= {topic: \"salidaChimenea\", payload: global.get(\"tempChimenea\")}; node.send(msg); \nreturn ;",
        "outputs": 1,
        "noerr": 0,
        "x": 1668.5,
        "y": 386,
        "wires": [
            [
                "f2f0447.f4543b8"
            ]
        ]
    },
    {
        "id": "f2f0447.f4543b8",
        "type": "thingspeak42",
        "z": "65561250.4225fc",
        "name": "BDX88EB6QMF2IKY0",
        "delay": "15",
        "topic1": "tempMinCasa",
        "topic2": "tempDepRad",
        "topic3": "tempRetRad",
        "topic4": "tempDepTermo",
        "topic5": "tempTermoSolar",
        "topic6": "estBombaRad",
        "topic7": "tempCamara",
        "topic8": "salidaChimenea",
        "endpoint": "https://thingspeak.com",
        "x": 1876,
        "y": 381,
        "wires": []
    },
    {
        "id": "1a21d23e.5dd23e",
        "type": "function",
        "z": "3ce5b54a.127d6a",
        "name": "no borrar",
        "func": "// var dato = JSON.parse(msg.payload);\nif (global.get(\"tiempoEspera\") === undefined)global.set(\"tiempoEspera\", 0);\nif (global.get(\"tiempoCargando\") === undefined)global.set(\"tiempoCargando\", 0);\n// context.cont = context.cont || 0;\n// context.voltaje = context.voltaje || 0;\n// context.nivTanque = context.nivTanque || 0;\n// context.tempAmb = context.tempAmb || 0;\n// context.tempCPU = context.tempCPU || 0;\n// context.PWMCooler = context.PWMCooler || 0;\n// context.Crep = context.Crep || 0;\n\n// context.cont++;\n// context.voltaje += parseFloat(global.get(\"voltajeBaterias\"));\n// context.nivTanque += parseFloat(global.get(\"nivTanque\"));\n// context.tempAmb += parseFloat(global.get(\"tempAmbienteBat\"));\n// context.tempCPU += parseFloat(global.get(\"tempCPU\"));\n// context.PWMCooler += parseFloat(global.get(\"PWM-Cooler\"));\n// context.Crep += parseFloat(global.get(\"LDR\"));\n\n// node.status({text: context.cont});\n// if (context.cont >= 10){\n// \tcontext.voltaje = context.voltaje / context.cont;\n// \tcontext.nivTanque = context.nivTanque / context.cont;\n// \tcontext.tempAmb = context.tempAmb / context.cont;\n// \tcontext.tempCPU = context.tempCPU / context.cont;\n// \tcontext.PWMCooler = context.PWMCooler / context.cont;\n// \tcontext.Crep = context.Crep / context.cont;\nif (dato.topic == \"Baterias/Est/Pedido/Resp\"){\n\n// \tmsg= {topic: \"voltajeBat\", payload: global.get(\"voltajeBaterias\")}; node.send(msg);\n// \tmsg= {topic: \"corrienteCarga\", payload: global.get(\"corrienteCarga\")}; node.send(msg);\n// \tmsg= {topic: \"cargador\", payload: global.get(\"estadoCargador\")}; node.send(msg);\n\tmsg= {topic: \"tiempoCargando\", payload: global.get(\"tiempoCargando\").toFixed(2)}; node.send(msg);\n\tmsg= {topic: \"tiempoEspera\", payload: global.get(\"tiempoEspera\").toFixed(2)}; node.send(msg);\n\tif (parseInt(global.get(\"llenarTanque\")) === 0){\n    \tmsg= {topic: \"nivTanque\", payload: global.get(\"nivTanque\")}; node.send(msg);\n    \tmsg= {topic: \"tasaLlenado\", payload: parseFloat(global.get(\"tasaLlenadoTanque\")).toFixed(2)}; node.send(msg);\n    // \tmsg = {pin: 33, payload: global.get(\"nivTanque\")}; node.send([null, msg]);\n    \tmsg = {pin: 33, payload: global.get(\"nivTanque\")}; node.send([msg, null]);\n    // \tmsg = {pin: 33, payload: global.get(\"nivTanque\")}; node.send([null, msg]);\n\t}\n// \tmsg= {topic: \"tempAmb\", payload: global.get(\"tempAmbienteBat\")}; node.send(msg);\n// \tnode.status ({text: global.get(\"tempAmbienteBat\")});\n// \tmsg= {topic: \"tempBat1\", payload: global.get(\"tempBat1\")}; node.send(msg);\n}\nif (dato.topic === \"Cargador\"){\n\tglobal.set(\"voltajeBaterias\", parseFloat(dato.volt).toFixed(2));\n\tglobal.set(\"voltajeBat\", dato.voltajeBat);\n\tglobal.set(\"cargador\", dato.payload);\n\t\n\tmsg= {topic: \"voltajeBat\", payload: global.get(\"voltajeBaterias\")}; node.send(msg);\n\tmsg= {topic: \"corrienteCarga\", payload: global.get(\"corrienteCarga\")}; node.send(msg);\n\tmsg= {topic: \"cargador\", payload: global.get(\"estadoCargador\")}; node.send(msg);\n\n\t// msg= {topic: \"cargador\", payload: dato.payload}; node.send(msg);\n\t// global.set(\"voltajeBaterias\", dato.volt);\n\t// msg= {topic: \"voltajeBat\", payload: global.get(\"voltajeBaterias\")}; node.send(msg);\n}\n\n\t// msg= {topic: \"voltajeBat\", payload: context.voltaje.toFixed(2)}; node.send(msg);\n\t// msg= {topic: \"nivTanque\", payload: context.nivTanque.toFixed(2)}; node.send(msg);\n\t// msg= {topic: \"tempAmb\", payload: context.tempAmb.toFixed(2)}; node.send(msg);\n\t// msg= {topic: \"tempCPU\", payload: context.tempCPU.toFixed(2)}; node.send(msg);\n\t// msg= {topic: \"PWM-Cooler\", payload: context.PWMCooler.toFixed(2)}; node.send(msg);\n\t// msg= {topic: \"Crep\", payload: context.Crep.toFixed(2)}; node.send(msg);\n\n// \tcontext.cont = 0;\n// \tcontext.voltaje = 0;\n// \tcontext.nivTanque = 0;\n// \tcontext.tempAmb = 0;\n// \tcontext.tempCPU = 0;\n// \tcontext.PWMCooler = 0;\n// \tcontext.Crep = 0;\n// }",
        "outputs": 2,
        "noerr": 0,
        "x": 527,
        "y": 1029,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "aee62ee9.faccc",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "var dato;\nvar date = new Date();\nvar minAire1 = 5;\nvar minAire2 = 15;\nvar minAire3 = 15;\nvar minAire4 = 15;\nvar tiempo = 0;\nvar escalon = 0;\nvar valor = 0;\n\ncontext.prendiendo = context.prendiendo || 0;\ncontext.tiempoEncendido = context.tiempoEncendido || 0;\n\ncontext.esperaPrendiendo = context.esperaPrendiendo || 0;\ncontext.tiempoEsperaEncendido = context.tiempoEsperaEncendido || 0;\n\ncontext.tiempoApagado = context.tiempoApagado || 0;\ncontext.apagando = context.apagando || 0;\ncontext.mmAnt = context.mmAnt || 0;\n\n\nif (global.get(\"tempCamara\") === undefined)global.set(\"tempCamara\", 1); if (global.get(\"DiftempCamara\") === undefined)global.set(\"DiftempCamara\", 1); \nif (global.get(\"tempSerp1Fuego\") === undefined)global.set(\"tempSerp1Fuego\", 2); if (global.get(\"DiftempSerp1Fuego\") === undefined)global.set(\"DiftempSerp1Fuego\", 2); \nif (global.get(\"tempSerp2Fuego\") === undefined)global.set(\"tempSerp2Fuego\", 3); if (global.get(\"DiftempSerp2Fuego\") === undefined)global.set(\"DiftempSerp2Fuego\", 3); \nif (global.get(\"tempChimenea\") === undefined)global.set(\"tempChimenea\", 4); if (global.get(\"DiftempChimenea\") === undefined)global.set(\"DiftempChimenea\", 4); \n\nif (global.get(\"tempDepTermo\") === undefined)global.set(\"tempDepTermo\", 5); if (global.get(\"DiftempDepTermo\") === undefined)global.set(\"DiftempDepTermo\", 5); \nif (global.get(\"tempDepRadiadores\") === undefined)global.set(\"tempDepRadiadores\", 6); if (global.get(\"DiftempDepRadiadores\") === undefined)global.set(\"DiftempDepRadiadores\", 6); \nif (global.get(\"tempSerp1Agua\") === undefined)global.set(\"tempSerp1Agua\", 7); if (global.get(\"DiftempSerp1Agua\") === undefined)global.set(\"DiftempSerp1Agua\", 7); \nif (global.get(\"tempRetRadiadores\") === undefined)global.set(\"tempRetRadiadores\", 8); if (global.get(\"DiftempRetRadiadores\") === undefined)global.set(\"DiftempRetRadiadores\", 8); \nif (global.get(\"tempSerpCamara\") === undefined)global.set(\"tempSerpCamara\", 9); if (global.get(\"DiftempSerpCamara\") === undefined) global.set(\"DiftempSerpCamara\", 9); \n\nif (global.get(\"pidAnterior\") === undefined)global.set(\"pidAnterior\", 0);\nif (global.get(\"tiempoMarchaBomba\") === undefined)global.set(\"tiempoMarchaBomba\", 0);\nif (global.get(\"setPointPID\") === undefined)global.set(\"setPointPID\", 72);\nif (global.get(\"tempAdmision\") === undefined)global.set(\"tempAdmision\", 0);\nif (global.get(\"potenciaSalamandra\") === undefined)global.set(\"potenciaSalamandra\", 1);\nif (global.get(\"salamandraPausa\") === undefined)global.set(\"salamandraPausa\", 0);\n\nif (msg.topic == \"timer\"){\n    tiempo = 0;\n    tiempo = context.tiempoEncendido + 300000;//5'\n    tiempo = tiempo - date.getTime();\n    if (parseInt(context.prendiendo) === 1 && tiempo < 0 && parseInt(global.get(\"estadoSalamandra\")) === 1){\n    \tcontext.esperaPrendiendo = 1;\n    \tcontext.tiempoEsperaEncendido = date.getTime();\n\t\tcontext.prendiendo = 0;\n\t\tglobal.set(\"estadoTurbo\", 1);    \n\t\tglobal.set(\"aire1\", 10);\n\t\tglobal.set(\"aire2\", 100);\n\t\tglobal.set(\"aire3\", 100);\n\t\tglobal.set(\"aire4\", 100);\n\t\tglobal.set(\"aireChimenea\", 100);\n\t\tenviarSalamandra();\n    }\n    tiempo = context.tiempoApagado + 900000;//15'\n    tiempo = tiempo - date.getTime();\n    if (parseInt(context.prendiendo) === 0 && parseInt(context.apagando) === 1 && tiempo < 0 && parseInt(global.get(\"estadoSalamandra\") === 1)){\n\t\tcontext.apagando = 0;\n\t\tcontext.esperaPrendiendo = 0;\n\t\tcontext.tiempoEsperaEncendido = 0;\n\t\tglobal.set(\"estadoSalamandra\", 0);\n\t\tglobal.set(\"estadoTurbo\", 0);    \n\t\tglobal.set(\"aire1\", 0);\n\t\tglobal.set(\"aire2\", 0);\n\t\tglobal.set(\"aire3\", 0);\n\t\tglobal.set(\"aire4\", 0);\n\t\tglobal.set(\"aireChimenea\", 0);  \n\t\tenviarSalamandra();   \n    }\n\n\tif (parseInt(global.get(\"tempDepRadiadores\")) < parseInt(\"diffTempMinimoSalamandra\")){\n\t\tdato = date.getTime() - parseInt(global.get(\"tiempoMarchaBomba\"));\n\t\tif (parseInt(dato) > 60000){//1 minuto\n\t\t\tglobal.set(\"salamandraBbaRad\", 0); \n\t\t}\n\t\tenviarSalamandra();   \n\t}\n\n    // var cuenta = tiempo;// - date.getTime();\n    // var estado = context.prendiendo + \" - (\" + cuenta + \") - \" + global.get(\"estadoSalamandra\");\n    // node.status({text: estado});\n\tif (parseInt(global.get(\"mm\")) != context.mmAnt){\n\t\tcontext.mmAnt = global.get(\"mm\");\n\t\tmsg = {topic: \"salamandra/Recibo\", payload: \"pedidoTemp\"}; return ([msg, null, null, null]);\n\t}\t\n}\n\nif (msg.topic == \"salamandra/Encendido\"){\n  if (parseInt(global.get(\"estadoSalamandra\")) === 0){\n  \t\tglobal.set(\"salamandraPausa\", 1);\n        global.set(\"estadoTurbo\", 0);    \n        global.set(\"aire1\", 0);\n        global.set(\"aire2\", 0);\n        global.set(\"aire3\", 0);\n        global.set(\"aire4\", 0);\n        global.set(\"aireChimenea\", 0);\n    }\n    if (parseInt(global.get(\"estadoSalamandra\")) === 1){\n\t\tglobal.set(\"salamandraPausa\", 2);\t\t\n\t\tcontext.prendiendo = 1;\n\t\tcontext.tiempoEncendido = date.getTime();\n\t\tglobal.set(\"estadoTurbo\", 1); \n\t\tglobal.set(\"aire1\", 100);\n\t\tglobal.set(\"aire2\", 30);\n\t\tglobal.set(\"aireChimenea\", 100);\n    }\n    enviarSalamandra();\n  return;\n}\n\nif (msg.topic == \"salamandra/Inicio\"){\n  enviarSalamandra();\n  return;\n}\n\nif (msg.topic == \"termoSolar/Salamandra\"){\n  dato = msg.payload.split(\"#\");\n  global.set(\"tempBajTermo\", dato[0]);\n  global.set(\"tempSubTermo\", dato[1]);\n  return;\n}\n\nif (msg.topic == \"salamandra/Envio\"){\n\tif (msg.payload.substring(0, 6) == \"temp 5\")return;// temp 5\n\tvalor = 0;\n\tdato = msg.payload.split(\"#\");\n\n\tvalor = parseFloat(dato[0] - global.get(\"tempCamara\")).toFixed(1);\n\tglobal.set(\"tempCamara\", dato[0]); global.set(\"DiftempCamara\", valor);// - parseFloat(global.get(\"tempCamara\")));//).toFixed(1)); \n\t// dato = global.get(\"DiftempCamara\"); msg.payload = dato; node.send([null, msg]);\n\n\n\tvalor = parseFloat(dato[1] - global.get(\"tempSerp1Fuego\")).toFixed(1);\n\tglobal.set(\"tempSerp1Fuego\", dato[1]); global.set(\"DiftempSerp1Fuego\", valor); \n\n\tvalor = parseFloat(dato[2] - global.get(\"tempSerp2Fuego\")).toFixed(1);\n\tglobal.set(\"tempSerp2Fuego\", dato[2]); global.set(\"DiftempSerp2Fuego\", valor); \n\n\tvalor = parseFloat(dato[3] - global.get(\"tempChimenea\")).toFixed(1);\n\tglobal.set(\"tempChimenea\", dato[3]); global.set(\"DiftempChimenea\", valor); \n\n\tvalor = parseFloat(dato[4] - global.get(\"tempDepTermo\")).toFixed(1);\n\tglobal.set(\"tempDepTermo\", dato[4]); global.set(\"DiftempDepTermo\", valor); \n\n\tvalor = parseFloat(dato[5] - global.get(\"tempDepRadiadores\")).toFixed(1);\n\tglobal.set(\"tempDepRadiadores\", dato[5]); global.set(\"DiftempDepRadiadores\", valor); \n\n\tvalor = parseFloat(dato[6] - global.get(\"tempSerpCamara\")).toFixed(1);\n\tglobal.set(\"tempSerpCamara\", dato[6]); global.set(\"DiftempSerpCamara\", valor); \n\n\tvalor = parseFloat(dato[7] - global.get(\"tempSerp1Agua\")).toFixed(1);\n\tglobal.set(\"tempSerp1Agua\", dato[7]); global.set(\"DiftempSerp1Agua\", valor); \n\n\tvalor = parseFloat(dato[8] - global.get(\"tempRetRadiadores\")).toFixed(1);\n\tglobal.set(\"tempRetRadiadores\", dato[8]); global.set(\"DiftempRetRadiadores\", valor); \n\n\tglobal.set(\"tempAdmision\", dato[9]); \n\tglobal.set(\"humAdmision\", dato[10]); \n\n\tif (parseInt(global.get(\"tempDepTermo\")) > 90){msg = {topic: \"notifyBlynk\", payload: \"Error Deposito termo muy caliente\"}; node.send([msg, null, null, null]);}\n\n\tif (parseInt(global.get(\"estadoSalamandra\")) === 0){\n\t\tif (parseInt(global.get(\"tempDepRadiadores\")) > 70 || parseInt(global.get(\"tempSerpCamara\")) > 85 || parseInt(global.get(\"tempSerp1Agua\")) > 85){\n\t\t\t// if (parseInt(global.get(\"tempSerpCamara\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error SERPENTINA CAMARA muy caliente\"}; node.send([msg, null, null, null]);}\n\t\t\t// if (parseInt(global.get(\"tempSerp1Agua\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error primer serpentina cobre muy caliente\"}; node.send([msg, null, null, null]);}\n\t\t\tglobal.set(\"salamandraBbaRad\", 1); \n\t\t\tglobal.set(\"tiempoMarchaBomba\", date.getTime());\n\t\t\tenviarSalamandra(); \n\t\t}\n\t}\n\n\tif (parseInt(global.get(\"estadoSalamandra\")) === 1){msg = {topic: \"salamandra/inPid\", payload: global.get(\"tempDepRadiadores\")}; node.send([msg]);}\n\n\tif (parseInt(global.get(\"tempCamara\")) < 100){\n\t\tcontext.tiempoApagado = date.getTime();\n\t\tcontext.apagando = 1;\n\t}\n\telse{\n\t\tcontext.apagando = 0;\n\t}\n\treturn;\n}\n\n\nif (msg.topic == \"salamandra/outPid\"){\n  var payload = msg.payload;\n/// Control setPoint PID///\n  if(parseInt(global.get(\"tempLiving\")) >= parseInt(global.get(\"setTempCasa\")) && parseInt(global.get(\"tempPasillo\")) >= parseInt(global.get(\"setTempCasa\")) && parseInt(global.get(\"potenciaSalamandra\")) === 1){\n    msg = {topic: \"salamandra/inPid\", setpoint: parseInt(global.get(\"diffTempMinimoSalamandra\"))}; \n    global.set(\"potenciaSalamandra\", 0);\n    node.send([msg]);\n    return;\n    // return;diffTempMinimoSalamandra\n  }\n\n  var tempMinima = parseInt(global.get(\"setTempCasa\")) - 5;\n  if(parseInt(global.get(\"tempLiving\")) <= parseInt(tempMinima) || parseInt(global.get(\"tempPasillo\")) <= parseInt(tempMinima)){\n  \tif (parseInt(global.get(\"potenciaSalamandra\")) === 0){\n\t  \tglobal.set(\"potenciaSalamandra\", 1);\n\t    msg = {topic: \"salamandra/inPid\", setpoint: parseInt(global.get(\"setPointPID\"))}; \n\t    // global.set(\"setPointPID\", parseInt(global.get(\"diffTempMinimoSalamandra\")));\n\t    node.send([msg]);\n\t    return;\n\t}\n  }   \n/// FIN Control setPoint PID////  \n\n/// Marcha y parada bomba radiadores////\n\t// var valor1  = parseInt(global.get(\"tempSerpCamara\")) - 5;\n\t// var valor2  = parseInt(global.get(\"tempSerp1Agua\")) - 5;\n  if (parseInt(global.get(\"tempDepRadiadores\")) > parseInt(\"setPointPID\") || parseInt(global.get(\"tempSerpCamara\")) > 85 || parseInt(global.get(\"tempSerp1Agua\")) > 85){\n    if (parseInt(global.get(\"tempSerpCamara\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error SERPENTINA CAMARA muy caliente\"}; node.send([msg, null, null, null]);}\n    if (parseInt(global.get(\"tempSerp1Agua\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error primer serpentina cobre muy caliente\"}; node.send([msg, null, null, null]);}\n    global.set(\"salamandraBbaRad\", 1); \n    global.set(\"tiempoMarchaBomba\", date.getTime());\n    enviarSalamandra(); \n  }\n  if (parseInt(global.get(\"tempDepRadiadores\")) < parseInt(\"diffTempMinimoSalamandra\")){\n    dato = date.getTime() - parseInt(global.get(\"tiempoMarchaBomba\"));\n    if (parseInt(dato) > 60000){//1 minuto\n      global.set(\"salamandraBbaRad\", 0); \n    }\n    enviarSalamandra();   \n  }\n/// FIN Marcha y parada bomba radiadores////\n\n/// Regulaciones de aires y turbo////\n  dato = Math.abs(parseInt(global.get(\"pidAnterior\")) - parseInt(payload));\n  var dato2 = global.get(\"pidAnterior\") - parseInt(payload);\n  node.status({text: dato + \" - \" + global.get(\"salamandraAuto\") + \" - \" + payload + \" -- (\" + dato2 + \")\"});\n  if (dato > 50 && parseInt(global.get(\"salamandraAuto\")) == 1){// 50 es diferencia de respuesta minima para que actue correcion de aires\n\n    if (parseInt(global.get(\"pidAnterior\")) > parseInt(payload)){\n      global.set(\"pidAnterior\", parseInt(payload));\n\n      escalon = 0;// valor de incremento de regulacion de aire\n      if (parseInt(payload) > 50 && parseInt(payload) < 100)escalon = 5;\n      if (parseInt(payload) > 101 && parseInt(payload) < 150)escalon = 10;\n      if (parseInt(payload) > 151 && parseInt(payload) < 200)escalon = 15;\n      if (parseInt(payload) > 201 && parseInt(payload) < 250)escalon = 20;\n      if (parseInt(payload) > 251 && parseInt(payload) < 300)escalon = 25;\n      if (parseInt(payload) > 301 && parseInt(payload) < 350)escalon = 30;\n      if (parseInt(payload) > 351 && parseInt(payload) < 400)escalon = 35;\n      if (parseInt(payload) > 401 && parseInt(payload) < 450)escalon = 40;\n      if (parseInt(payload) > 451 && parseInt(payload) < 500)escalon = 45;\n      if (parseInt(payload) > 501)escalon = 50;\n\n      valor = parseInt(global.get(\"aire1\")) - parseInt(escalon);\n      if (parseInt(valor) >= minAire1){global.set(\"aire1\", valor);} else{global.set(\"aire1\", minAire1);}\n\n      // if (parseInt(valor) < 5){\n  \t  if (parseInt(global.get(\"aire1\")) === parseInt(minAire1)){\n        valor = parseInt(global.get(\"aire2\")) - parseInt(escalon);\n        if (parseInt(valor) >= minAire2){global.set(\"aire2\", valor);} else{global.set(\"aire2\", minAire2);}\n\n        // if (parseInt(valor) < 5){\n    \tif (parseInt(global.get(\"aire2\")) === parseInt(minAire2)){\n          valor = parseInt(global.get(\"aire3\")) - parseInt(escalon);\n          if (parseInt(valor) >= minAire3){global.set(\"aire3\", valor);} else{global.set(\"aire3\", minAire3);}\n\n          // if (parseInt(valor) < 5){\n      \tif (parseInt(global.get(\"aire3\")) === parseInt(minAire3)){\n            valor = parseInt(global.get(\"aire4\")) - parseInt(escalon);\n            if (parseInt(valor) >= minAire4){global.set(\"aire4\", valor);} else{global.set(\"aire4\", minAire4);}\n            }\n          }\n        }\n      if (parseInt(global.get(\"aire2\")) < 70)global.set(\"estadoTurbo\", 0); \n    }\n\n\n    if (parseInt(global.get(\"pidAnterior\")) < parseInt(payload) && parseInt(global.get(\"estadoSalamandra\")) === 1){\n\n    if (parseInt(context.esperaPrendiendo) === 1){\n\t    tiempo = 0;\n\t    tiempo = context.tiempoEsperaEncendido + 1800000;//30'\n\t    tiempo = tiempo - date.getTime();\n\t\t}\n\n\tif (parseInt(tiempo) < 0){// si variable tiempo es menos a 0 paso mas de 1/2hs y habre aire encendido\n\t\tcontext.esperaPrendiendo = 0;\n\t\tglobal.set(\"pidAnterior\", parseInt(payload));\n\t\tvalor = parseInt(global.get(\"aire4\")) + parseInt(escalon);\n\t\tif (parseInt(valor) < 100){global.set(\"aire4\", valor);}else{global.set(\"aire4\", 100)}\n\t\t\tif (parseInt(valor) > 90){\n\t\t\tvalor = parseInt(global.get(\"aire3\")) + parseInt(escalon);\n\t\t\tif (parseInt(valor) < 100){global.set(\"aire3\", valor);}else{global.set(\"aire3\", 100)}\n\t\t\t\tif (parseInt(valor) > 90){\n\t\t\t\tvalor = parseInt(global.get(\"aire2\")) + parseInt(escalon);\n\t\t\t\tif (parseInt(valor) < 100){global.set(\"aire2\", valor);}else{global.set(\"aire2\", 100)}\n\t\t\t\t\tif (parseInt(valor) > 90){\n\t\t\t\t\tvalor = parseInt(global.get(\"aire1\")) + parseInt(escalon);\n\t\t\t\t\tif (parseInt(valor) < 100){global.set(\"aire1\", valor);}else{global.set(\"aire1\", 100)}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\tif (parseInt(global.get(\"aire2\")) > 70)global.set(\"estadoTurbo\", 1); \n\t}\n    }\n    enviarSalamandra(); \n  }\n/// FIN Regulaciones de aires y turbo//// \n\n  msg = {topic: \"tempLiving\", payload: global.get(\"tempLiving\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempPasillo\", payload: global.get(\"tempPasillo\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempBano\", payload: global.get(\"tempBano\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempHab1\", payload: global.get(\"tempHab1\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempHab2\", payload: global.get(\"tempHab2\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempComedor\", payload: global.get(\"tempComedor\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempCocina\", payload: global.get(\"tempCocina\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempLavadero\", payload: global.get(\"tempLavadero\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempExterior\", payload: global.get(\"tempExterior\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempTermo\", payload: global.get(\"tempTermoFin\")}; node.send([null, null, msg, null]);\n\n  msg = {topic: \"tempBajTermo\", payload: global.get(\"tempBajTermo\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempSubTermo\", payload: global.get(\"tempSubTermo\")}; node.send([null, null, msg, null]);\n\n  msg = {topic: \"tempDepTermo\", payload: global.get(\"tempDepTermo\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempDepRadiadores\", payload: global.get(\"tempDepRadiadores\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempSerpCamara\", payload: global.get(\"tempSerpCamara\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempSerp1Agua\", payload: global.get(\"tempSerp1Agua\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempRetRadiadores\", payload: global.get(\"tempRetRadiadores\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempCamara\", payload: global.get(\"tempCamara\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempSerp1Fuego\", payload: global.get(\"tempSerp1Fuego\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"tempSerp2Fuego\", payload: global.get(\"tempSerp2Fuego\")}; node.send([null, null, msg, null]);\n\n  msg = {topic: \"aire1\", payload: global.get(\"aire1\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"aire2\", payload: global.get(\"aire2\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"aire3\", payload: global.get(\"aire3\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"aire4\", payload: global.get(\"aire4\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"estadoTurbo\", payload: global.get(\"estadoTurbo\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"salamandraBbaRad\", payload: global.get(\"salamandraBbaRad\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"salamandraBbaCirc\", payload: global.get(\"salamandraBbaCirc\")}; node.send([null, null, msg, null]);\n  msg = {topic: \"salamandraBbaTermo\", payload: global.get(\"salamandraBbaTermo\")}; node.send([null, null, msg, null]);\n\n/// Guardado en mysql////\n  if (parseInt(global.get(\"tempCamara\")) > 50){\n    var mysql = \"INSERT INTO \\`salamandra\\`(\\`tiempo\\`, \\`tempLiving\\`, \\`tempPasillo\\`, \\`tempBano\\`, \\`tempHab1\\`, \\`tempHab2\\`, \\`tempComedor\\`, \\`tempCocina\\`, \\`tempLavadero\\`, \\`tempExterior\\`, \\`tempTermo\\`,\";\n    mysql += \" \\`tempBajTermo\\`, \\`tempSubTermo\\`,\";\n    mysql += \" \\`tempDepTermo\\`, \\`tempSerpCamara\\`, \\`temp1Serp\\`, \\`tempRetRad\\`, \\`tempDepRad\\`, \\`tempCamara\\`, \\`temp1SerpFuego\\`, \\`temp2SerpFuego\\`, \\`tempChimenea\\`,\";\n    mysql += \" \\`aireEnc\\`, \\`airePrim\\`, \\`aireSec\\`, \\`aireTerc\\`, \\`turbo\\`, \\`bombaRad\\`, \\`bombaRec\\`, \\`bombaTermo\\`) VALUES (now(),\";\n    \n    mysql += global.get(\"tempLiving\") + \",\"; mysql += global.get(\"tempPasillo\") + \",\"; \n    mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; \n    mysql += global.get(\"tempLavadero\") + \",\"; mysql += global.get(\"tempExterior\") + \",\"; mysql += global.get(\"tempTermoFin\") + \",\";\n\n    mysql += global.get(\"tempBajTermo\") + \",\" + global.get(\"tempSubTermo\") + \",\";\n\n    mysql += global.get(\"tempDepTermo\") + \",\" + global.get(\"tempDepRadiadores\") + \",\" + global.get(\"tempSerpCamara\") + \",\" + global.get(\"tempSerp1Agua\") + \",\";\n    mysql += global.get(\"tempRetRadiadores\") + \",\" + global.get(\"tempCamara\") + \",\" + global.get(\"tempSerp1Fuego\") + \",\" + global.get(\"tempSerp2Fuego\") + \",\";\n    mysql += global.get(\"tempChimenea\") + \",\";\n\n    mysql += global.get(\"aire1\") + \",\" + global.get(\"aire2\") + \",\" + global.get(\"aire3\") + \",\" + global.get(\"aire4\") + \",\";\n    mysql += global.get(\"estadoTurbo\") + \",\" + global.get(\"salamandraBbaRad\") + \",\" + global.get(\"salamandraBbaCirc\") + \",\" + global.get(\"salamandraBbaTermo\") + \")\";\n    msg.topic = mysql;\n    return ([null, null, null, msg]);   \n  }\n/// FIN Guardado en mysql//// \n}\n\nfunction enviarSalamandra(){\n\tif (parseInt(global.get(\"tempDepRadiadores\")) > 85){\n\t\tglobal.set(\"estadoTurbo\", 0);\n\t\tglobal.set(\"aire1\", 0);\n\t\tglobal.set(\"aire2\", 0);\n\t\tglobal.set(\"aire3\", 0);\n\t\tglobal.set(\"aire4\", 0);\n\t\tmsg = {topic: \"notifyBlynk\", payload: \"Error exeso temperatura salamandra\"}; node.send([msg, null, null, null]);\n\t\tmsg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" -- Error exeso temperatura salamandra\\n\"}; node.send([msg, null, null, null]);\n\t}\n\t\n    if (parseInt(global.get(\"salamandraPausa\")) === 1){\n    \tflow.set(\"estadoTurboF\", 0);//salamandraPausa == 0 esta en marcha\n    \tflow.set(\"aire1F\", 0);\n    \tflow.set(\"aire2F\", 40);\n    \tflow.set(\"aire3F\", 0);\n    \tflow.set(\"aire4F\", 0);\n    \tflow.set(\"aireChimeneaF\", 100);\t\n    }\n    if (parseInt(global.get(\"salamandraPausa\")) === 2){\n    \tflow.set(\"estadoTurboF\", global.get(\"estadoTurbo\"));//salamandraPausa == 0 esta en marcha\n    \tflow.set(\"aire1F\", global.get(\"aire1\"));\n    \tflow.set(\"aire2F\", global.get(\"aire2\"));\n    \tflow.set(\"aire3F\", global.get(\"aire3\"));\n    \tflow.set(\"aire4F\", global.get(\"aire4\"));\n    \tflow.set(\"aireChimeneaF\", global.get(\"aireChimenea\"));\t\n    }\t\n\n    if (parseInt(global.get(\"estadoSalamandra\")) === 0){\n    \tflow.set(\"estadoTurboF\", 0);//salamandraPausa == 0 esta en marcha\n    \tflow.set(\"aire1F\", 0);\n    \tflow.set(\"aire2F\", 0);\n    \tflow.set(\"aire3F\", 0);\n    \tflow.set(\"aire4F\", 0);\n    \tflow.set(\"aireChimeneaF\", 0);\t    \t\n    }\n\t\n\t//  msg = {topic: \"salamandra/backUp\", payload: \"estado\" };\n\t//  node.send([msg, null, null, null]);\n\t  // dato = global.get(\"salamandraAuto\") + \"#\";\n\tdato = global.get(\"salamandraBbaCirc\") + \"#\";\n\tdato += global.get(\"salamandraBbaRad\") + \"#\";\n\tdato += global.get(\"salamandraBbaTermo\") + \"#\";\n\tdato += flow.get(\"estadoTurboF\") + \"#\";//salamandraPausa == 0 esta en marcha\n\tdato += flow.get(\"aire1F\") + \"#\";\n\tdato += flow.get(\"aire2F\") + \"#\";\n\tdato += flow.get(\"aire3F\") + \"#\";\n\tdato += flow.get(\"aire4F\") + \"#\";\n\tdato += flow.get(\"aireChimeneaF\");\t\t\n\t\n\t// dato += global.get(\"estadoTurbo\") + \"#\";\n\n\n\tif (dato.includes(\"undefined\")){\n\t\tmsg = {topic: \"salamandra/backUp/recovery\", payload: 1}; \n\t\tnode.send([msg, null]); \n\t\treturn;\n\t}\n\tmsg = {topic: \"salamandra/backUp\", payload: \"estado\" };\n\tnode.send([msg, null, null, null]);\n\tmsg = {topic: \"salamandra/Recibo\", payload: \"estado\" + dato};\n\tnode.send([msg, null, null, null]);\n}\n\n\n\n\n// var mysql = \"INSERT INTO \\\\`salamandra\\\\`(\\\\`tiempo\\\\`, \\\\`tempLiving\\\\`, \\\\`tempPasillo\\\\`, \\\\`tempBano\\\\`, \\\\`tempHab1\\\\`, \\\\`tempHab2\\\\`, \\\\`tempComedor\\\\`, \\\\`tempCocina\\\\`, \\\\`tempLavadero\\\\`, \\\\`tempExterior\\\\`, \\\\`tempTermo\\\\`, \\\\`tempBajTermo\\\\`, \\\\`tempSubTermo\\\\`, \\\\`tempDepTermo\\\\`, \\\\`tempSerpCamara\\\\`, \\\\`temp1Serp\\\\`, \\\\`tempChimenea\\\\`, \\\\`tempRetRad\\\\`, \\\\`tempDepRad\\\\`, \\\\`aireEnc\\\\`, \\\\`airePrim\\\\`, \\\\`aireSec\\\\`, \\\\`aireTerc\\\\`, \\\\`turbo\\\\`, \\\\`bombaRad\\\\`, \\\\`bombaRec\\\\`, \\\\`bombaTermo\\\\`) VALUES (now(),\";\n// mysql += 55 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \")\";\n// msg.topic = mysql;\n// return msg;\n",
        "outputs": 4,
        "noerr": 0,
        "x": 1359.2857666015625,
        "y": 260.4285583496094,
        "wires": [
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "8b0611c9.25273",
        "type": "debug",
        "z": "3ce5b54a.127d6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 922.142857142857,
        "y": 1115.7142857142856,
        "wires": []
    },
    {
        "id": "e74f2ba6.057988",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Reset",
        "payloadType": "str",
        "x": 1230.7143173217773,
        "y": 341.428560256958,
        "wires": [
            [
                "8013b199.fbd79"
            ]
        ]
    },
    {
        "id": "8013b199.fbd79",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/TermoSolar/Config",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1460.714210510254,
        "y": 341.4285659790039,
        "wires": []
    },
    {
        "id": "1dd34ae5.8df655",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/temp5",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1011.2498931884766,
        "y": 899.7222814559937,
        "wires": [
            [
                "6d7165f8.55371c",
                "e9700e1b.2d668",
                "86b88f32.1c0e"
            ]
        ]
    },
    {
        "id": "2bf72be0.6c1c54",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1044.9999313354492,
        "y": 938.8889751434326,
        "wires": [
            [
                "6d7165f8.55371c"
            ]
        ]
    },
    {
        "id": "6d7165f8.55371c",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "msg.payload = global.get(\"fechaCompleta\") + \" - \" + msg.payload + \"\\n\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1172.777687072754,
        "y": 902.2221183776855,
        "wires": [
            []
        ]
    },
    {
        "id": "a68012d9.8ecc1",
        "type": "blynk-ws-in-write",
        "z": "e364a467.07a6a8",
        "name": "",
        "pin": "59",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 208.88888549804688,
        "y": 214.44444274902344,
        "wires": [
            [
                "6d084c4d.880404"
            ]
        ]
    },
    {
        "id": "6d084c4d.880404",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "",
        "func": "msg.payload = msg.payload.replace(\",\", \".\");\nglobal.set(\"MaximoComprar\", parseFloat(msg.payload).toFixed(2));\nnode.status({text: \"MaximoComprar:\" + global.get(\"MaximoComprar\")});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 410.1388473510742,
        "y": 213.19444274902344,
        "wires": [
            [
                "33996b47.4d3bc4"
            ]
        ]
    },
    {
        "id": "d5d77ad9.876498",
        "type": "mqtt out",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1405.0000076293945,
        "y": 945.5555725097656,
        "wires": []
    },
    {
        "id": "1bff58f3.250b67",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "SI temp5",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "temp51",
        "payloadType": "str",
        "x": 1209.444492340088,
        "y": 944.4444751739502,
        "wires": [
            [
                "d5d77ad9.876498"
            ]
        ]
    },
    {
        "id": "e61e222f.ffbd",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "NO temp5",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "temp50",
        "payloadType": "str",
        "x": 1207.777774810791,
        "y": 986.6666812896729,
        "wires": [
            [
                "d5d77ad9.876498"
            ]
        ]
    },
    {
        "id": "48fcd5d4.e9776c",
        "type": "file",
        "z": "e364a467.07a6a8",
        "name": "IluminacionLiving",
        "filename": "/home/gaston/BackUp-Node-Red/dolar.txt",
        "appendNewline": false,
        "createDir": true,
        "overwriteFile": "true",
        "x": 776.6666622161865,
        "y": 126.66666984558105,
        "wires": [
            []
        ]
    },
    {
        "id": "92de1d98.98ef1",
        "type": "file in",
        "z": "e364a467.07a6a8",
        "name": "IluminacionLiving",
        "filename": "/home/gaston/BackUp-Node-Red/dolar.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 1166.6666259765625,
        "y": 97.77777099609375,
        "wires": [
            [
                "deab6409.34d778",
                "b21ff3fd.2338d"
            ]
        ]
    },
    {
        "id": "deab6409.34d778",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "",
        "func": "var dato;\ndato = msg.payload.split(\"#\");\n\nglobal.set(\"MinimoComprar\",dato[0]); msg = {pin: 57, payload: dato[0]}; node.send(msg);\nglobal.set(\"MinimoVender\",dato[1]); msg = {pin: 58, payload: dato[1]}; node.send(msg);\nglobal.set(\"MaximoVender\",dato[2]); msg = {pin: 52, payload: dato[2]}; node.send(msg);\nglobal.set(\"MaximoComprar\",dato[3]); msg = {pin: 59, payload: dato[3]}; node.send(msg);\n\ndato = global.get(\"MinimoComprar\") + \"#\";\ndato += global.get(\"MinimoVender\") + \"#\";\ndato += global.get(\"MaximoVender\") + \"#\";\ndato += global.get(\"MaximoComprar\");  \n\nnode.status({text: dato})\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1343.1666259765625,
        "y": 95.77777099609375,
        "wires": [
            [
                "db11bc39.aa0a4"
            ]
        ]
    },
    {
        "id": "b21ff3fd.2338d",
        "type": "debug",
        "z": "e364a467.07a6a8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1348.6666259765623,
        "y": 155.14140735973,
        "wires": []
    },
    {
        "id": "28f7991.baeae66",
        "type": "inject",
        "z": "e364a467.07a6a8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 991.1666259765625,
        "y": 97.77777099609375,
        "wires": [
            [
                "92de1d98.98ef1"
            ]
        ]
    },
    {
        "id": "33996b47.4d3bc4",
        "type": "function",
        "z": "e364a467.07a6a8",
        "name": "",
        "func": "msg.payload = global.get(\"MinimoComprar\") + \"#\" + global.get(\"MinimoVender\") + \"#\" + global.get(\"MaximoVender\") + \"#\" + global.get(\"MaximoComprar\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 616.1111111111111,
        "y": 125.55555555555556,
        "wires": [
            [
                "48fcd5d4.e9776c"
            ]
        ]
    },
    {
        "id": "db11bc39.aa0a4",
        "type": "blynk-ws-out-write",
        "z": "e364a467.07a6a8",
        "name": "",
        "pin": "0",
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 1540.5555725097656,
        "y": 91.11110496520996,
        "wires": []
    },
    {
        "id": "4c64b352.0b60ec",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 712.2222290039062,
        "y": 1254.444317817688,
        "wires": [
            [
                "50aa91ae.92201"
            ]
        ]
    },
    {
        "id": "a98df01a.451ad",
        "type": "ui_switch",
        "z": "65561250.4225fc",
        "name": "",
        "label": "Automatico/Manual",
        "group": "ce850dc4.5180c",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "automatico",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 1269.4443448384602,
        "y": 1131.1111929151748,
        "wires": [
            [
                "bfdea506.6351b8"
            ]
        ]
    },
    {
        "id": "19f02ab3.ad8e95",
        "type": "ui_switch",
        "z": "65561250.4225fc",
        "name": "",
        "label": "Encendido",
        "group": "ce850dc4.5180c",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "encendido",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 1252.7778027852376,
        "y": 1092.2221033308242,
        "wires": [
            [
                "4100656.949849c"
            ]
        ]
    },
    {
        "id": "a39f4828.21f618",
        "type": "ui_switch",
        "z": "65561250.4225fc",
        "name": "",
        "label": "Marcha/Pausa",
        "group": "ce850dc4.5180c",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "pausa",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 1260.555539449056,
        "y": 1167.7777683469985,
        "wires": [
            [
                "f280c142.8403d"
            ]
        ]
    },
    {
        "id": "1c7a8a4b.afe9c6",
        "type": "ui_switch",
        "z": "65561250.4225fc",
        "name": "",
        "label": "Bomba Radiadores",
        "group": "ce850dc4.5180c",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "bomba",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 1267.2221387227376,
        "y": 1241.1111166212295,
        "wires": [
            [
                "3dca3c92.6cee54"
            ]
        ]
    },
    {
        "id": "48ea6cc.dbdd994",
        "type": "ui_slider",
        "z": "65561250.4225fc",
        "name": "",
        "label": "Aire Encendido",
        "group": "ce850dc4.5180c",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "topic": "aireencendido",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 1258.3332977294922,
        "y": 1278.8888592190212,
        "wires": [
            [
                "a47d1a3c.ad4458"
            ]
        ]
    },
    {
        "id": "fcb2aed.736a95",
        "type": "ui_slider",
        "z": "65561250.4225fc",
        "name": "",
        "label": "Aire Primario",
        "group": "ce850dc4.5180c",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "topic": "aire1",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 1248.3332977294922,
        "y": 1317.7777481079102,
        "wires": [
            [
                "85076239.db096"
            ]
        ]
    },
    {
        "id": "cd13e18c.dfbc3",
        "type": "ui_slider",
        "z": "65561250.4225fc",
        "name": "",
        "label": "Aire Secundario",
        "group": "ce850dc4.5180c",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "topic": "aire2",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 1256.1110755072698,
        "y": 1353.3333036634658,
        "wires": [
            [
                "abf5a44d.2da028"
            ]
        ]
    },
    {
        "id": "5be16588.93e50c",
        "type": "ui_slider",
        "z": "65561250.4225fc",
        "name": "",
        "label": "Aire Terciario",
        "group": "ce850dc4.5180c",
        "order": 9,
        "width": 0,
        "height": 0,
        "passthru": false,
        "topic": "aire3",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 1247.2222646077473,
        "y": 1387.7777349683975,
        "wires": [
            [
                "30e60327.ea933c"
            ]
        ]
    },
    {
        "id": "34ee7474.df8cfc",
        "type": "ui_slider",
        "z": "65561250.4225fc",
        "name": "",
        "label": "Salida Chimenea",
        "group": "ce850dc4.5180c",
        "order": 10,
        "width": 0,
        "height": 0,
        "passthru": false,
        "topic": "salidachimenea",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 1266.111176808675,
        "y": 1422.222166273329,
        "wires": [
            [
                "3842a747.6a58a8"
            ]
        ]
    },
    {
        "id": "7952e7a.a102a18",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "msg.payload = global.get(\"estadoSalamandra\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1091.6666107177734,
        "y": 1091.1110734939575,
        "wires": [
            [
                "19f02ab3.ad8e95"
            ]
        ]
    },
    {
        "id": "c6be6115.cdf31",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "msg.payload = global.get(\"salamandraAuto\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1091.111083984375,
        "y": 1132.22216796875,
        "wires": [
            [
                "a98df01a.451ad"
            ]
        ]
    },
    {
        "id": "9e39136f.6c61c",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "if (parseInt(global.get(\"salamandraPausa\")) == 2)msg.payload = 0;\nif (parseInt(global.get(\"salamandraPausa\")) == 1)msg.payload = 1;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1091.111083984375,
        "y": 1167.7777099609375,
        "wires": [
            [
                "a39f4828.21f618"
            ]
        ]
    },
    {
        "id": "b21a6aee.b66c68",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "if (parseInt(global.get(\"salamandraAuto\")) === 0 && global.get(\"estadoSalamandra\") === 1){msg = {enabled: 1}; node.send(msg);}\nif (parseInt(global.get(\"salamandraAuto\")) === 1 || global.get(\"estadoSalamandra\") === 0){msg = {enabled: 0}; node.send(msg)}\nmsg = {payload: flow.get(\"salamandraBbaRad\")};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1094.4444580078125,
        "y": 1244.4443359375,
        "wires": [
            [
                "1c7a8a4b.afe9c6"
            ]
        ]
    },
    {
        "id": "8a790297.b3a3f",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "if (parseInt(global.get(\"salamandraAuto\")) === 0 && global.get(\"estadoSalamandra\") === 1){msg = {enabled: 1}; node.send(msg);}\nif (parseInt(global.get(\"salamandraAuto\")) === 1 || global.get(\"estadoSalamandra\") === 0){msg = {enabled: 0}; node.send(msg);}\nmsg = {payload: flow.get(\"aire1F\")};\nnode.send(msg);\nreturn ",
        "outputs": 1,
        "noerr": 0,
        "x": 1096.6666259765625,
        "y": 1281.111083984375,
        "wires": [
            [
                "48ea6cc.dbdd994"
            ]
        ]
    },
    {
        "id": "88942a02.ef3eb8",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "if (parseInt(global.get(\"salamandraAuto\")) === 0 && global.get(\"estadoSalamandra\") === 1){msg = {enabled: 1}; node.send(msg);}\nif (parseInt(global.get(\"salamandraAuto\")) === 1 || global.get(\"estadoSalamandra\") === 0){msg = {enabled: 0}; node.send(msg)}\nmsg = {payload: flow.get(\"aire2F\")};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1098.8887939453125,
        "y": 1316.6666259765625,
        "wires": [
            [
                "fcb2aed.736a95"
            ]
        ]
    },
    {
        "id": "3d97416e.6dc06e",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "if (parseInt(global.get(\"salamandraAuto\")) === 0 && global.get(\"estadoSalamandra\") === 1){msg = {enabled: 1}; node.send(msg);}\nif (parseInt(global.get(\"salamandraAuto\")) === 1 || global.get(\"estadoSalamandra\") === 0){msg = {enabled: 0}; node.send(msg)}\nmsg = {payload: flow.get(\"aire3F\")};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1100,
        "y": 1354.4443359375,
        "wires": [
            [
                "cd13e18c.dfbc3"
            ]
        ]
    },
    {
        "id": "2015632b.0c902c",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "if (parseInt(global.get(\"salamandraAuto\")) === 0 && global.get(\"estadoSalamandra\") === 1){msg = {enabled: 1}; node.send(msg);}\nif (parseInt(global.get(\"salamandraAuto\")) === 1 || global.get(\"estadoSalamandra\") === 0){msg = {enabled: 0}; node.send(msg)}\nmsg = {payload: flow.get(\"aire4F\")};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1096.6666259765625,
        "y": 1390,
        "wires": [
            [
                "5be16588.93e50c"
            ]
        ]
    },
    {
        "id": "334d5a5e.6ba046",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "msg.payload = flow.get(\"aireChimeneaF\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1097.7777099609375,
        "y": 1427.7777099609375,
        "wires": [
            [
                "34ee7474.df8cfc"
            ]
        ]
    },
    {
        "id": "e6945c4b.222eb",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "if (msg.app == \"node\")return;\nif (msg.payload.substring(0, 6) == \"estado\")return msg;\n// msg.payload = msg.payload.split(0, 6); return msg\n",
        "outputs": 1,
        "noerr": 0,
        "x": 896.1110572814941,
        "y": 1247.7776670455933,
        "wires": [
            [
                "334d5a5e.6ba046",
                "2015632b.0c902c",
                "3d97416e.6dc06e",
                "88942a02.ef3eb8",
                "8a790297.b3a3f",
                "b21a6aee.b66c68",
                "9e39136f.6c61c",
                "c6be6115.cdf31",
                "7952e7a.a102a18",
                "3ac00fcc.3a7d1"
            ]
        ]
    },
    {
        "id": "50aa91ae.92201",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 869.4444444444445,
        "y": 1361.111111111111,
        "wires": []
    },
    {
        "id": "3ac00fcc.3a7d1",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1111.111083984375,
        "y": 1478.8887939453125,
        "wires": []
    },
    {
        "id": "4100656.949849c",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "global.set(\"estadoSalamandra\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1428.8887939453125,
        "y": 1088.8887939453125,
        "wires": [
            [
                "1cb38ffb.b167f"
            ]
        ]
    },
    {
        "id": "bfdea506.6351b8",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "global.set(\"salamandraAuto\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1452.22216796875,
        "y": 1130,
        "wires": [
            [
                "1cb38ffb.b167f"
            ]
        ]
    },
    {
        "id": "f280c142.8403d",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "global.set(\"salamandraPausa\",  msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1452.22216796875,
        "y": 1168.8887939453125,
        "wires": [
            [
                "1cb38ffb.b167f"
            ]
        ]
    },
    {
        "id": "3dca3c92.6cee54",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "global.set(\"salamandraBbaRad\",  msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1454.4443359375,
        "y": 1243.333251953125,
        "wires": [
            [
                "1cb38ffb.b167f"
            ]
        ]
    },
    {
        "id": "a47d1a3c.ad4458",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "global.set(\"aire1\",  msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1454.4443359375,
        "y": 1276.6666259765625,
        "wires": [
            [
                "1cb38ffb.b167f"
            ]
        ]
    },
    {
        "id": "85076239.db096",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "global.set(\"aire2\",  msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1437.7777099609375,
        "y": 1314.4443359375,
        "wires": [
            [
                "1cb38ffb.b167f"
            ]
        ]
    },
    {
        "id": "abf5a44d.2da028",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "global.set(\"aire3\",  msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1440,
        "y": 1353.333251953125,
        "wires": [
            [
                "1cb38ffb.b167f"
            ]
        ]
    },
    {
        "id": "30e60327.ea933c",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "global.set(\"aire4\",  msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1450,
        "y": 1386.6666259765625,
        "wires": [
            [
                "1cb38ffb.b167f"
            ]
        ]
    },
    {
        "id": "3842a747.6a58a8",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "global.set(\"aireChimenea\",  msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1453.333251953125,
        "y": 1422.22216796875,
        "wires": [
            [
                "1cb38ffb.b167f"
            ]
        ]
    },
    {
        "id": "481c50ee.12c1c",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1527.7777099609375,
        "y": 1487.7777099609375,
        "wires": []
    },
    {
        "id": "1e467bb.3c8ff84",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1350.5555555555554,
        "y": 1484.4444444444443,
        "wires": [
            [
                "481c50ee.12c1c"
            ]
        ]
    },
    {
        "id": "1cb38ffb.b167f",
        "type": "mqtt out",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/NodeRed",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1726.111111111111,
        "y": 1266.6666666666667,
        "wires": []
    },
    {
        "id": "4c108a5d.b46fc4",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/NodeRed",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 585.4545288085938,
        "y": 490.9090881347656,
        "wires": [
            []
        ]
    },
    {
        "id": "e9700e1b.2d668",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1596.4285714285713,
        "y": 952.8571428571428,
        "wires": []
    },
    {
        "id": "9d06c246.e27f1",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "salamandra/Envio",
        "topic": "salamandra/Envio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1526.6666564941406,
        "y": 458.571439743042,
        "wires": [
            [
                "60a7b28d.298c6c"
            ]
        ]
    },
    {
        "id": "60a7b28d.298c6c",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1641.1904602050781,
        "y": 540.2381076812744,
        "wires": []
    },
    {
        "id": "fe49e63b.8b06b8",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1040.7142857142856,
        "y": 35.71428571428571,
        "wires": [
            [
                "78691845.de5d18"
            ]
        ]
    },
    {
        "id": "7b932c9c.0ed1f4",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1072.5,
        "y": 296,
        "wires": [
            []
        ]
    },
    {
        "id": "f6cdd630.082658",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "var men = msg.payload;//msg.payload.includes(\"undefined\")\nif (men.includes(\"fuego\"))return;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1186.833339691162,
        "y": 433.00000858306885,
        "wires": [
            [
                "d49172fe.f82d",
                "2cf49f83.4d4e5"
            ]
        ]
    },
    {
        "id": "2cf49f83.4d4e5",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1320,
        "y": 424,
        "wires": []
    },
    {
        "id": "8da5f9a0.e732f8",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "topic",
        "targetType": "msg",
        "x": 1283.3332595825195,
        "y": 574.999981880188,
        "wires": []
    },
    {
        "id": "f5e45037.d37eb",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "terminalSalamandra",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1016,
        "y": 982,
        "wires": [
            []
        ]
    },
    {
        "id": "a9d852d5.43883",
        "type": "exec",
        "z": "3ce5b54a.127d6a",
        "command": "cat /sys/class/thermal/thermal_zone0/temp ",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": true,
        "name": "tempCPU",
        "x": 150,
        "y": 1100,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "13c5a473.90fc8c",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 676.5,
        "y": 240,
        "wires": [
            [
                "78691845.de5d18"
            ]
        ]
    },
    {
        "id": "ed6393ea.747df",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1057.5,
        "y": 222,
        "wires": [
            [
                "6048869b.2889f8"
            ]
        ]
    },
    {
        "id": "6048869b.2889f8",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "msg.payload = global.get(\"tempDepTermo\") + \"#\" + global.get(\"tempSerpCamara\") +\"#\"+global.get(\"tempSerp1Agua\") + \"##\" + (parseInt(global.get(\"tempDepTermo\")) + parseInt(global.get(\"tempSerpCamara\")) + parseInt(global.get(\"tempSerp1Agua\"))) / 3;// + \" -- \" + global.get(\"estadoTurbo\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1202.5,
        "y": 223,
        "wires": [
            [
                "cca223f2.6a3a2"
            ]
        ]
    },
    {
        "id": "cca223f2.6a3a2",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1338.5,
        "y": 225,
        "wires": []
    },
    {
        "id": "fdbf5b6e.e180d8",
        "type": "mqtt in",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1028,
        "y": 1026,
        "wires": [
            [
                "4501a66.3b69858"
            ]
        ]
    },
    {
        "id": "4501a66.3b69858",
        "type": "delay",
        "z": "65561250.4225fc",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1184.5,
        "y": 1027,
        "wires": [
            [
                "e019e42a.385bc8"
            ]
        ]
    },
    {
        "id": "e019e42a.385bc8",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "",
        "func": "msg.payload = \"temp50\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1309.5,
        "y": 1025,
        "wires": [
            [
                "d5d77ad9.876498"
            ]
        ]
    },
    {
        "id": "8e48488a.71ff48",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "Tomar med",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "med",
        "payload": "",
        "payloadType": "date",
        "x": 765.5,
        "y": 433,
        "wires": [
            []
        ]
    },
    {
        "id": "20da1901.f4c886",
        "type": "function",
        "z": "65561250.4225fc",
        "name": "andando 12/09/2049",
        "func": "var dato;\nvar date = new Date();\nvar minAire1 = 5;\nvar minAire2 = 15;\nvar minAire3 = 15;\nvar minAire4 = 15;\nvar tiempo = 0;\nvar escalon = 0;\nvar valor = 0;\nvar topicInicial = msg.topic;\nvar mm = 0;\n\nvar tempMarchaBomba = 72;\nvar enviarDato = 0;\n\ncontext.prendiendo = context.prendiendo || 0;\ncontext.tiempoEncendido = context.tiempoEncendido || 0;\n\ncontext.esperaPrendiendo = context.esperaPrendiendo || 0;\ncontext.tiempoEsperaEncendido = context.tiempoEsperaEncendido || 0;\n\ncontext.tiempoApagado = context.tiempoApagado || 0;\ncontext.apagando = context.apagando || 0;\ncontext.mmAnt = context.mmAnt || 0;\ncontext.avivadoFuego = context.avivadoFuego || 0;\ncontext.boolavivadoFuego = context.boolavivadoFuego || 0;\n\n\nif (global.get(\"tempCamara\") === undefined)global.set(\"tempCamara\", 1); if (global.get(\"DiftempCamara\") === undefined)global.set(\"DiftempCamara\", 1); \nif (global.get(\"tempSerp1Fuego\") === undefined)global.set(\"tempSerp1Fuego\", 2); if (global.get(\"DiftempSerp1Fuego\") === undefined)global.set(\"DiftempSerp1Fuego\", 2); \nif (global.get(\"tempSerp2Fuego\") === undefined)global.set(\"tempSerp2Fuego\", 3); if (global.get(\"DiftempSerp2Fuego\") === undefined)global.set(\"DiftempSerp2Fuego\", 3); \nif (global.get(\"tempChimenea\") === undefined)global.set(\"tempChimenea\", 4); if (global.get(\"DiftempChimenea\") === undefined)global.set(\"DiftempChimenea\", 4); \n\nif (global.get(\"tempDepTermo\") === undefined)global.set(\"tempDepTermo\", 5); if (global.get(\"DiftempDepTermo\") === undefined)global.set(\"DiftempDepTermo\", 5); \nif (global.get(\"tempDepRadiadores\") === undefined)global.set(\"tempDepRadiadores\", 6); if (global.get(\"DiftempDepRadiadores\") === undefined)global.set(\"DiftempDepRadiadores\", 6); \nif (global.get(\"tempSerp1Agua\") === undefined)global.set(\"tempSerp1Agua\", 7); if (global.get(\"DiftempSerp1Agua\") === undefined)global.set(\"DiftempSerp1Agua\", 7); \nif (global.get(\"tempRetRadiadores\") === undefined)global.set(\"tempRetRadiadores\", 8); if (global.get(\"DiftempRetRadiadores\") === undefined)global.set(\"DiftempRetRadiadores\", 8); \nif (global.get(\"tempSerpCamara\") === undefined)global.set(\"tempSerpCamara\", 9); if (global.get(\"DiftempSerpCamara\") === undefined) global.set(\"DiftempSerpCamara\", 9); \n\nif (global.get(\"pidAnterior\") === undefined)global.set(\"pidAnterior\", 0);\nif (global.get(\"tiempoMarchaBomba\") === undefined)global.set(\"tiempoMarchaBomba\", 0);\nif (global.get(\"setPointPID\") === undefined)global.set(\"setPointPID\", 72);\nif (global.get(\"tempAdmision\") === undefined)global.set(\"tempAdmision\", 0);\nif (global.get(\"potenciaSalamandra\") === undefined)global.set(\"potenciaSalamandra\", 1);\nif (global.get(\"salamandraPausa\") === undefined)global.set(\"salamandraPausa\", 0);\n\nif (msg.topic == \"med\"){\n  msg = {topic: \"salamandra/Recibo\", payload: \"pedidoTemp\"}; \n  return ([msg, null, null, null]);\n}\n\nif (msg.topic == \"timer\"){\n  if (parseInt(global.get(\"salamandraAuto\")) === 1){\n    var valor = global.get(\"setPointPID\");\n    if(parseInt(global.get(\"estadoSalamandra\")) === 1 && parseInt(global.get(\"tempDepRadiadores\")) > parseInt(valor)){//} && global.get(\"tempSerp1Agua\") > 35){\n      mm = date.getMinutes();\n      var ss = date.getSeconds();\n      // tiempo = mm%2;\n      if (parseInt(mm%5) === 0 && parseInt(context.prendiendo) === 0 && parseInt(context.boolavivadoFuego) === 0){//} && parseInt(global.get(\"salamandraAuto\")) === 1){//} && paresInt(global.get(\"tempDepTermo\")) < 100) {\n        msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Descanso Fuego\\n\"}; node.send([msg, null, null, null]);\n        context.boolavivadoFuego = 1;\n        context.avivadoFuego = date.getTime() + 300000;// 5'\n        global.set(\"estadoTurbo\", 0);    \n        global.set(\"aire1\", 100);\n        global.set(\"aire2\", 50);\n        global.set(\"aire3\", 100);\n        global.set(\"aire4\", 100);\n        global.set(\"aireChimenea\", 100);\n        enviarDato = 1;\n        }\n      }    \n    if(parseInt(date.getTime()) > parseInt(context.avivadoFuego)){\n      var pid = parseInt(global.get(\"setPointPID\")) - 10;\n      if(parseInt(global.get(\"tempDepRadiadores\")) < parseInt(pid)){global.set(\"estadoTurbo\", 1); global.set(\"aireChimenea\", 30); enviarDato = 1;}\n      if (parseInt(context.boolavivadoFuego) === 1 && parseInt(context.prendiendo) === 0){//} && parseInt(global.get(\"salamandraAuto\")) === 1) {\n        msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Avivo Fuego\\n\"}; node.send([msg, null, null, null]);\n        context.boolavivadoFuego = 0; \n        pid = parseInt(global.get(\"setPointPID\")) - 5;\n        if(parseInt(global.get(\"tempDepRadiadores\")) > parseInt(pid)){global.set(\"estadoTurbo\", 0); global.set(\"aireChimenea\", 100); enviarDato = 1;}\n        global.set(\"aire1\", 100);\n        global.set(\"aire2\", 40);\n        global.set(\"aire3\", 100);\n        global.set(\"aire4\", 100);\n        // global.set(\"aireChimenea\", 30);\n        enviarDato = 1;\n      }\n    } \n\n    if (parseInt(context.prendiendo) === 1 && parseInt(date.getTime()) > parseInt(context.tiempoEncendido) && parseInt(global.get(\"estadoSalamandra\")) === 1 && parseInt(global.get(\"salamandraAuto\")) === 1){\n      msg = {topic: \"notifyBlynk\", payload: \"Ciclo de encendido terminado\"}; node.send([msg, null, null, null]);\n      msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Ciclo de encendido terminado\\n\"}; node.send([msg, null, null, null]);\n      context.esperaPrendiendo = 1;\n      context.tiempoEsperaEncendido = date.getTime();\n      context.prendiendo = 0;\n      // context.boolavivadoFuego = 1;\n      global.set(\"estadoTurbo\", 1);    \n      global.set(\"aire1\", 50);\n      global.set(\"aire2\", 100);\n      global.set(\"aire3\", 100);\n      global.set(\"aire4\", 100);\n      global.set(\"aireChimenea\", 40);\n      enviarSalamandra();\n      return;\n    }\n  }\n    // tiempo = context.tiempoApagado + 300000;//5'\n    // tiempo = tiempo - date.getTime();\n    //parseInt(context.prendiendo) === 0 && \n  if (parseInt(context.apagando) === 1 && date.getTime() > parseInt(context.tiempoApagado)){//} && parseInt(global.get(\"estadoSalamandra\") === 1)){\n  // if (parseInt(global.get(\"tempCamara\")) < 90 && parseInt(context.prendiendo) === 0 && parseInt(global.get(\"estadoSalamandra\") === 1)){//} && date.getTime() > paresInt(tiempo)){\n    msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Apago automatico Salamandra\\n\"}; node.send([msg, null, null, null]);\n    context.apagando = 0;\n    context.esperaPrendiendo = 0;\n    context.tiempoEsperaEncendido = 0;\n    global.set(\"salamandraPausa\", 1);\n    global.set(\"estadoSalamandra\", 0);\n    global.set(\"estadoTurbo\", 0);    \n    global.set(\"aire1\", 0);\n    global.set(\"aire2\", 0);\n    global.set(\"aire3\", 0);\n    global.set(\"aire4\", 0);\n    global.set(\"aireChimenea\", 0);  \n    // global.set(\"salamandraBbaRad\", 0); \n    enviarSalamandra();   \n    return;\n  }\n\n\n  // Esto maneja \n    // if (parseInt(global.get(\"tempDepRadiadores\")) < parseInt(\"diffTempMinimoSalamandra\")){\n    //   dato = date.getTime() - parseInt(global.get(\"tiempoMarchaBomba\"));\n    //   if (parseInt(dato) > 60000){//1 minuto\n    //     global.set(\"salamandraBbaRad\", 0); \n    //   }\n    //   enviarSalamandra(); \n    //   return;  \n    // }\n\n      // var cuenta = tiempo;// - date.getTime();\n      // var estado = context.prendiendo + \" - (\" + cuenta + \") - \" + global.get(\"estadoSalamandra\");\n      // node.status({text: estado});\n      //parseInt(global.get(\"estadoSalamandra\")) === 1 &&\n\n  node.status({text: global.get(\"tempCamara\") + \" - \" + global.get(\"tempSerp2Fuego\") + \" - \" + context.prendiendo + \" - \" + context.apagando});\n  if (parseInt(global.get(\"tempCamara\")) < 80 && parseInt(global.get(\"tempSerp2Fuego\")) < 80 && parseInt(context.prendiendo) === 0 && parseInt(context.apagando) === 0){\n    // if (parseInt(context.apagando) === 0){\n      msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Inicio timer apagado salamandra\\n\"}; node.send([msg, null, null, null]);\n      context.apagando = 1;\n      context.tiempoApagado = date.getTime() + 300000;// 5'\n    // }\n    // else{\n    //   context.apagando = 0;\n    // }\n  }\n\n  if (parseInt(global.get(\"tempCamara\")) > 80)context.apagando = 0;\n  if (parseInt(global.get(\"tempSerp2Fuego\")) > 80)context.apagando = 0;\n\n    if (parseInt(global.get(\"mm\")) != context.mmAnt){\n      var enviar = 0;\n      context.mmAnt = global.get(\"mm\");\n      if (context.prendiendo === 1) enviar = 1;\n\n      if (parseInt(global.get(\"salamandraBbaRad\")) === 1) enviar = 1;\n\n      if (parseInt(global.get(\"tempCamara\")) > 78 || parseInt(global.get(\"tempSerp2Fuego\")) > 78) enviar = 1;\n\n      if (parseInt(enviar) === 1){\n        msg = {topic: \"salamandra/Recibo\", payload: \"pedidoTemp\"}; \n        return ([msg, null, null, null]);\n      }\n  }\n}\n\nif (msg.topic == \"salamandra/Encendido\"){\n  if (parseInt(global.get(\"estadoSalamandra\")) === 0){\n    msg = {topic: \"terminalSalamandra\", payload: global.get(\"hsCpu\") + \"  Apago Manual Salamandra\\n\"}; node.send([msg, null, null, null]);\n    context.apagando = 0;\n    global.set(\"salamandraPausa\", 1);\n    global.set(\"estadoTurbo\", 0);    \n    global.set(\"aire1\", 0);\n    global.set(\"aire2\", 0);\n    global.set(\"aire3\", 0);\n    global.set(\"aire4\", 0);\n    global.set(\"aireChimenea\", 0);\n    }\n  if (parseInt(global.get(\"estadoSalamandra\")) === 1){\n    msg = {topic: \"terminalSalamandra\", payload: \"\\n\" + global.get(\"hsCpu\") + \"  Prendo Salamandra\\n\"}; node.send([msg, null, null, null]);\n    global.set(\"salamandraPausa\", 2);   \n    context.prendiendo = 1;\n    context.tiempoEncendido = date.getTime() + 300000;\n    global.set(\"estadoTurbo\", 1); \n    global.set(\"aire1\", 100);\n    global.set(\"aire2\", 100);\n    global.set(\"aire3\", 100);\n    global.set(\"aire4\", 100);    \n    global.set(\"aireChimenea\", 100);\n    }\n  enviarSalamandra();\n  return;\n}\n\nif (msg.topic == \"salamandra/Inicio\"){\n  enviarSalamandra();\n  return;\n}\n\nif (msg.topic == \"salamandra/NodeRed\"){\n  enviarSalamandra();\n  return;\n}\n\nif (msg.topic == \"termoSolar/Salamandra\"){\n  dato = msg.payload.split(\"#\");\n  global.set(\"tempBajTermo\", dato[0]);\n  global.set(\"tempSubTermo\", dato[1]);\n  return;\n}\n\nif (msg.topic == \"salamandra/Envio\"){\n  if (msg.payload.substring(0, 6) == \"temp 5\")return;// temp 5\n  valor = 0;\n  dato = msg.payload.substring(8);\n  dato = dato.split(\"#\");\n\n  valor = parseFloat(dato[0] - global.get(\"tempCamara\")).toFixed(1);\n  global.set(\"tempCamara\", dato[0]); global.set(\"DiftempCamara\", valor);// - parseFloat(global.get(\"tempCamara\")));//).toFixed(1)); \n  // dato = global.get(\"DiftempCamara\"); msg.payload = dato; node.send([null, msg]);\n\n\n  valor = parseFloat(dato[1] - global.get(\"tempSerp1Fuego\")).toFixed(1);\n  global.set(\"tempSerp1Fuego\", dato[1]); global.set(\"DiftempSerp1Fuego\", valor); \n\n  valor = parseFloat(dato[2] - global.get(\"tempSerp2Fuego\")).toFixed(1);\n  global.set(\"tempSerp2Fuego\", dato[2]); global.set(\"DiftempSerp2Fuego\", valor); \n\n  valor = parseFloat(dato[3] - global.get(\"tempChimenea\")).toFixed(1);\n  global.set(\"tempChimenea\", dato[3]); global.set(\"DiftempChimenea\", valor); \n\n  valor = parseFloat(dato[4] - global.get(\"tempDepTermo\")).toFixed(1);\n  global.set(\"tempDepTermo\", dato[4]); global.set(\"DiftempDepTermo\", valor); \n\n  valor = parseFloat(dato[5]).toFixed(1);\n  global.set(\"tempLiving\", valor);// global.set(\"DiftempDepRadiadores\", valor); \n\n  valor = parseFloat(dato[6] - global.get(\"tempSerpCamara\")).toFixed(1);\n  global.set(\"tempSerpCamara\", dato[6]); global.set(\"DiftempSerpCamara\", valor); \n\n  valor = parseFloat(dato[7] - global.get(\"tempSerp1Agua\")).toFixed(1);\n  global.set(\"tempSerp1Agua\", dato[7]); global.set(\"DiftempSerp1Agua\", valor); \n\n  valor = parseFloat(dato[8] - global.get(\"tempRetRadiadores\")).toFixed(1);\n  global.set(\"tempRetRadiadores\", dato[8]); global.set(\"DiftempRetRadiadores\", valor); \n\n  global.set(\"tempAdmision\", dato[9]); \n  global.set(\"humAdmision\", dato[10]); \n\n  var valor1 = parseFloat((parseInt(global.get(\"tempDepTermo\")) + parseInt(global.get(\"tempSerpCamara\")) + parseInt(global.get(\"tempSerp1Agua\"))) / 3).toFixed(1);\n  valor = parseFloat(valor1 - global.get(\"tempDepRadiadores\")).toFixed(1);\n  global.set(\"tempDepRadiadores\", valor1); global.set(\"DiftempDepRadiadores\", valor);\n\n  if (parseInt(global.get(\"tempDepRadiadores\")) > 80){msg = {topic: \"notifyBlynk\", payload: \"Error Deposito Radiadores muy caliente: \" + global.get(\"tempDepRadiadores\")}; node.send([msg, null, null, null]);} \n\n/// Marcha y parada bomba radiadores////\n  // var valor1  = parseInt(global.get(\"tempSerpCamara\")) - 5;\n  // var valor2  = parseInt(global.get(\"tempSerp1Agua\")) - 5;\n\n  if (parseInt(global.get(\"salamandraAuto\")) === 0 && parseInt(global.get(\"tempDepRadiadores\")) > parseInt(global.get(\"setPointPID\")))global.set(\"salamandraAuto\", 1);\n\n  if (parseInt(global.get(\"tempCamara\")) > 150 || parseInt(global.get(\"tempSerpCamara\")) > 75 || parseInt(global.get(\"tempSerp1Agua\")) > 75){\n    global.set(\"salamandraBbaRad\", 1); \n    enviarDato = 1; \n  }\n\n  if (parseInt(global.get(\"tempCamara\")) < 140 && context.prendiendo === 0){//} || parseInt(global.get(\"tempSerpCamara\")) < 40 || parseInt(global.get(\"tempSerp1Agua\")) < 40){\n    global.set(\"salamandraBbaRad\", 0); \n    enviarDato = 1;\n  }\n\n\n  // if (parseInt(global.get(\"tempSerp2Fuego\")) > 150 || parseInt(global.get(\"tempDepTermo\")) > parseInt(global.get(\"tempTermoFin\"))){//} || parseInt(global.get(\"tempSerp1Agua\")) > 75){\n  //   global.set(\"salamandraBbaTermo\", 1); \n  //   enviarDato = 1; \n  // }\n\n  // if (parseInt(global.get(\"tempSerp2Fuego\")) < 100){//} || parseInt(global.get(\"tempDepTermo\")) < parseInt(global.get(\"tempTermoFin\"))){//} || parseInt(global.get(\"tempSerpCamara\")) < 40 || parseInt(global.get(\"tempSerp1Agua\")) < 40){\n  //   global.set(\"salamandraBbaTermo\", 0); \n  //   enviarDato = 1; \n  // }  \n\n  if (parseInt(enviarDato) === 1)enviarSalamandra(); \n\n  // if (parseInt(global.get(\"tempDepRadiadores\")) > parseInt(tempMarchaBomba) || parseInt(global.get(\"tempSerpCamara\")) > 85 || parseInt(global.get(\"tempSerp1Agua\")) > 85){\n  //   if (parseInt(global.get(\"tempSerpCamara\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error SERPENTINA CAMARA muy caliente\"}; node.send([msg, null, null, null]);}\n  //   if (parseInt(global.get(\"tempSerp1Agua\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error primer serpentina cobre muy caliente\"}; node.send([msg, null, null, null]);}\n  //   global.set(\"salamandraBbaRad\", 1); \n  //   global.set(\"tiempoMarchaBomba\", date.getTime());\n  //   enviarSalamandra(); \n  // }\n  // if (parseInt(global.get(\"salamandraAuto\")) === 1 && parseInt(global.get(\"tempDepRadiadores\")) < parseInt(\"diffTempMinimoSalamandra\") && parseInt(global.get(\"tempSerpCamara\")) < 80 && parseInt(global.get(\"tempSerp1Agua\")) < 80){\n  //   dato = date.getTime() - parseInt(global.get(\"tiempoMarchaBomba\"));\n  //   if (parseInt(dato) > 60000){//1 minuto\n  //     global.set(\"salamandraBbaRad\", 0); \n  //   }\n  //   enviarSalamandra();   \n  // }\n\n  // if (parseInt(global.get(\"tempCamara\")) < 70){\n  //   global.set(\"estadoSalamandra\", 0)\n  //   global.set(\"aire1\", 0);\n  //   global.set(\"aire2\", 0);\n  //   global.set(\"aire3\", 0);\n  //   global.set(\"aire4\", 0);\n  //   global.set(\"aireChimenea\", 0)\n  //   global.set(\"salamandraBbaRad\", 0); \n  //   enviarSalamandra();  \n  //   return;\n  // }\n/// FIN Marcha y parada bomba radiadores////  \n\n  // if (parseInt(global.get(\"estadoSalamandra\")) === 0){\n  //  if (parseInt(global.get(\"tempDepRadiadores\")) > 70 || parseInt(global.get(\"tempSerpCamara\")) > 85 || parseInt(global.get(\"tempSerp1Agua\")) > 85){\n  //    // if (parseInt(global.get(\"tempSerpCamara\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error SERPENTINA CAMARA muy caliente\"}; node.send([msg, null, null, null]);}\n  //    // if (parseInt(global.get(\"tempSerp1Agua\")) > 85){msg = {topic: \"notifyBlynk\", payload: \"Error primer serpentina cobre muy caliente\"}; node.send([msg, null, null, null]);}\n  //    global.set(\"salamandraBbaRad\", 1); \n  //    global.set(\"tiempoMarchaBomba\", date.getTime());\n  //    enviarSalamandra(); \n  //  }\n  // }\n  if (parseInt(global.get(\"estadoSalamandra\")) === 1){msg = {topic: \"salamandra/inPid\", payload: global.get(\"tempDepRadiadores\")}; node.send([msg]);}\n\n  return;\n}\n\nif (msg.topic == \"salamandra/outPid\"){\n//   var payload = msg.payload;\n// /// Control setPoint PID///\n//   if(parseInt(global.get(\"tempLiving\")) >= parseInt(global.get(\"setTempCasa\")) && parseInt(global.get(\"tempPasillo\")) >= parseInt(global.get(\"setTempCasa\")) && parseInt(global.get(\"potenciaSalamandra\")) === 1){\n//     msg = {topic: \"salamandra/inPid\", setpoint: parseInt(global.get(\"diffTempMinimoSalamandra\"))}; \n//     global.set(\"potenciaSalamandra\", 0);\n//     node.send([msg]);\n//     return;\n//     // return;diffTempMinimoSalamandra\n//   }\n\n//   var tempMinima = parseInt(global.get(\"setTempCasa\")) - 5;\n//   if(parseInt(global.get(\"tempLiving\")) <= parseInt(tempMinima) || parseInt(global.get(\"tempPasillo\")) <= parseInt(tempMinima)){\n//     if (parseInt(global.get(\"potenciaSalamandra\")) === 0){\n//       global.set(\"potenciaSalamandra\", 1);\n//       msg = {topic: \"salamandra/inPid\", setpoint: parseInt(global.get(\"setPointPID\"))}; \n//       // global.set(\"setPointPID\", parseInt(global.get(\"diffTempMinimoSalamandra\")));\n//       node.send([msg]);\n//       return;\n//   }\n//   }   \n// /// FIN Control setPoint PID////  \n\n//   /// Regulaciones de aires y turbo////\n//   dato = Math.abs(parseInt(global.get(\"pidAnterior\")) - parseInt(payload));\n//   var dato2 = global.get(\"pidAnterior\") - parseInt(payload);\n//   node.status({text: dato + \" - \" + global.get(\"salamandraAuto\") + \" - \" + payload + \" -- (\" + dato2 + \")\"});\n//   if (dato > 50 && parseInt(global.get(\"salamandraAuto\")) === 1){// 50 es diferencia de respuesta minima para que actue correcion de aires\n\n//     escalon = 0;// valor de incremento de regulacion de aire\n//     if (parseInt(payload) > 50 && parseInt(payload) < 100)escalon = 5;\n//     if (parseInt(payload) > 101 && parseInt(payload) < 150)escalon = 10;\n//     if (parseInt(payload) > 151 && parseInt(payload) < 200)escalon = 15;\n//     if (parseInt(payload) > 201 && parseInt(payload) < 250)escalon = 20;\n//     if (parseInt(payload) > 251 && parseInt(payload) < 300)escalon = 25;\n//     if (parseInt(payload) > 301 && parseInt(payload) < 350)escalon = 30;\n//     if (parseInt(payload) > 351 && parseInt(payload) < 400)escalon = 35;\n//     if (parseInt(payload) > 401 && parseInt(payload) < 450)escalon = 40;\n//     if (parseInt(payload) > 451 && parseInt(payload) < 500)escalon = 45;\n//     if (parseInt(payload) > 501)escalon = 50;\n\n\n//       if (parseInt(global.get(\"pidAnterior\")) > parseInt(payload)){\n\n//       context.esperaPrendiendo = 0;\n\n//       global.set(\"pidAnterior\", parseInt(payload));\n\n//       valor = parseInt(global.get(\"aire1\")) - parseInt(escalon);\n//       if (parseInt(valor) >= minAire1){global.set(\"aire1\", valor);} else{global.set(\"aire1\", minAire1);}\n\n//       // if (parseInt(valor) < 5){\n//         if (parseInt(global.get(\"aire1\")) === parseInt(minAire1)){\n//       valor = parseInt(global.get(\"aire2\")) - parseInt(escalon);\n//       if (parseInt(valor) >= minAire2){global.set(\"aire2\", valor);} else{global.set(\"aire2\", minAire2);}\n\n//       // if (parseInt(valor) < 5){\n//       if (parseInt(global.get(\"aire2\")) === parseInt(minAire2)){\n//         valor = parseInt(global.get(\"aire3\")) - parseInt(escalon);\n//         if (parseInt(valor) >= minAire3){global.set(\"aire3\", valor);} else{global.set(\"aire3\", minAire3);}\n\n//         // if (parseInt(valor) < 5){\n//         if (parseInt(global.get(\"aire3\")) === parseInt(minAire3)){\n//           valor = parseInt(global.get(\"aire4\")) - parseInt(escalon);\n//           if (parseInt(valor) >= minAire4){global.set(\"aire4\", valor);} else{global.set(\"aire4\", minAire4);}\n//           }\n//         }\n//       }\n//       if (parseInt(global.get(\"aire2\")) < 70)global.set(\"estadoTurbo\", 0); \n//       }\n\n\n//       if (parseInt(global.get(\"pidAnterior\")) < parseInt(payload) && parseInt(global.get(\"estadoSalamandra\")) === 1){\n\n//         if (parseInt(context.esperaPrendiendo) === 1){\n//             tiempo = 0;\n//             tiempo = context.tiempoEsperaEncendido + 1800000;//30'\n//             tiempo = tiempo - date.getTime();\n//         }\n//         else{\n//           tiempo = -10;\n//         }\n\n//       if (parseInt(tiempo) < 0){// si variable tiempo es menos a 0 paso mas de 1/2hs y habre aire encendido\n//         context.esperaPrendiendo = 0;\n//         global.set(\"pidAnterior\", parseInt(payload));\n//         valor = parseInt(global.get(\"aire4\")) + parseInt(escalon);\n//         if (parseInt(valor) < 100){global.set(\"aire4\", valor);}else{global.set(\"aire4\", 100)}\n//           if (parseInt(valor) > 90){\n//           valor = parseInt(global.get(\"aire3\")) + parseInt(escalon);\n//           if (parseInt(valor) < 100){global.set(\"aire3\", valor);}else{global.set(\"aire3\", 100)}\n//             if (parseInt(valor) > 90){\n//             valor = parseInt(global.get(\"aire2\")) + parseInt(escalon);\n//             if (parseInt(valor) < 100){global.set(\"aire2\", valor);}else{global.set(\"aire2\", 100)}\n//               if (parseInt(valor) > 90){\n//               valor = parseInt(global.get(\"aire1\")) + parseInt(escalon);\n//               if (parseInt(valor) < 100){global.set(\"aire1\", valor);}else{global.set(\"aire1\", 100)}\n//               }\n//             }\n//           }\n//         if (parseInt(global.get(\"aire2\")) > 70)global.set(\"estadoTurbo\", 1); \n//       }\n//       }\n//     enviarSalamandra(); \n//   }\n/// FIN Regulaciones de aires y turbo//// \n\n//   msg = {topic: \"tempLiving\", payload: global.get(\"tempLiving\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempPasillo\", payload: global.get(\"tempPasillo\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempBano\", payload: global.get(\"tempBano\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempHab1\", payload: global.get(\"tempHab1\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempHab2\", payload: global.get(\"tempHab2\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempComedor\", payload: global.get(\"tempComedor\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempCocina\", payload: global.get(\"tempCocina\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempLavadero\", payload: global.get(\"tempLavadero\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempExterior\", payload: global.get(\"tempExterior\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempTermo\", payload: global.get(\"tempTermoFin\")}; node.send([null, null, msg, null]);\n\n//   msg = {topic: \"tempBajTermo\", payload: global.get(\"tempBajTermo\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempSubTermo\", payload: global.get(\"tempSubTermo\")}; node.send([null, null, msg, null]);\n\n//   msg = {topic: \"tempDepTermo\", payload: global.get(\"tempDepTermo\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempDepRadiadores\", payload: global.get(\"tempDepRadiadores\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempSerpCamara\", payload: global.get(\"tempSerpCamara\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempSerp1Agua\", payload: global.get(\"tempSerp1Agua\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempRetRadiadores\", payload: global.get(\"tempRetRadiadores\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempCamara\", payload: global.get(\"tempCamara\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempSerp1Fuego\", payload: global.get(\"tempSerp1Fuego\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"tempSerp2Fuego\", payload: global.get(\"tempSerp2Fuego\")}; node.send([null, null, msg, null]);\n\n//   msg = {topic: \"aire1\", payload: global.get(\"aire1\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"aire2\", payload: global.get(\"aire2\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"aire3\", payload: global.get(\"aire3\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"aire4\", payload: global.get(\"aire4\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"estadoTurbo\", payload: global.get(\"estadoTurbo\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"salamandraBbaRad\", payload: global.get(\"salamandraBbaRad\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"salamandraBbaCirc\", payload: global.get(\"salamandraBbaCirc\")}; node.send([null, null, msg, null]);\n//   msg = {topic: \"salamandraBbaTermo\", payload: global.get(\"salamandraBbaTermo\")}; node.send([null, null, msg, null]);\n\n/// Guardado en mysql////\n    mm = date.getMinutes();\n  tiempo = mm%5;\n  if (parseInt(global.get(\"estadoSalamandra\")) === 1 && tiempo === 0){\n    var mysql = \"INSERT INTO \\`salamandra\\`(\\`tiempo\\`, \\`tempLiving\\`, \\`tempPasillo\\`, \\`tempBano\\`, \\`tempHab1\\`, \\`tempHab2\\`, \\`tempComedor\\`, \\`tempCocina\\`, \\`tempLavadero\\`, \\`tempExterior\\`, \\`tempTermo\\`,\";\n    mysql += \" \\`tempBajTermo\\`, \\`tempSubTermo\\`,\";\n    mysql += \" \\`tempDepTermo\\`, \\`tempSerpCamara\\`, \\`temp1Serp\\`, \\`tempRetRad\\`, \\`tempDepRad\\`, \\`tempCamara\\`, \\`temp1SerpFuego\\`, \\`temp2SerpFuego\\`, \\`tempChimenea\\`,\";\n    mysql += \" \\`aireEnc\\`, \\`airePrim\\`, \\`aireSec\\`, \\`aireTerc\\`, \\`turbo\\`, \\`bombaRad\\`, \\`bombaRec\\`, \\`bombaTermo\\`) VALUES (now(),\";\n    \n    mysql += global.get(\"tempLiving\") + \",\"; mysql += global.get(\"tempPasillo\") + \",\"; \n    mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; \n    mysql += global.get(\"tempLavadero\") + \",\"; mysql += global.get(\"tempExterior\") + \",\"; mysql += global.get(\"tempTermoFin\") + \",\";\n\n    mysql += global.get(\"tempBajTermo\") + \",\" + global.get(\"tempSubTermo\") + \",\";\n\n    mysql += global.get(\"tempDepTermo\") + \",\" + global.get(\"tempDepRadiadores\") + \",\" + global.get(\"tempSerpCamara\") + \",\" + global.get(\"tempSerp1Agua\") + \",\";\n    mysql += global.get(\"tempRetRadiadores\") + \",\" + global.get(\"tempCamara\") + \",\" + global.get(\"tempSerp1Fuego\") + \",\" + global.get(\"tempSerp2Fuego\") + \",\";\n    mysql += global.get(\"tempChimenea\") + \",\";\n\n    mysql += global.get(\"aire1\") + \",\" + global.get(\"aire2\") + \",\" + global.get(\"aire3\") + \",\" + global.get(\"aire4\") + \",\";\n    mysql += global.get(\"estadoTurbo\") + \",\" + global.get(\"salamandraBbaRad\") + \",\" + global.get(\"salamandraBbaCirc\") + \",\" + global.get(\"salamandraBbaTermo\") + \")\";\n    msg.topic = mysql;\n    return ([null, null, null, msg]);   \n  }\n/// FIN Guardado en mysql//// \n}\n\nfunction enviarSalamandra(){\n  enviarDato = 0;\n  if (parseInt(global.get(\"tempDepRadiadores\")) > 85){\n    global.set(\"estadoTurbo\", 0);\n    global.set(\"aire1\", 0);\n    global.set(\"aire2\", 0);\n    global.set(\"aire3\", 0);\n    global.set(\"aire4\", 0);\n    msg = {topic: \"notifyBlynk\", payload: \"Error exeso temperatura salamandra\"}; node.send([msg, null, null, null]);\n    msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" -- Error exeso temperatura salamandra\\n\"}; node.send([msg, null, null, null]);\n  }\n  \n    if (parseInt(global.get(\"salamandraPausa\")) === 1){\n      flow.set(\"estadoTurboF\", 0);//salamandraPausa == 0 esta en marcha\n      flow.set(\"aire1F\", 0);\n      flow.set(\"aire2F\", 40);\n      flow.set(\"aire3F\", 0);\n      flow.set(\"aire4F\", 0);\n      flow.set(\"aireChimeneaF\", 100); \n    }\n    if (parseInt(global.get(\"salamandraPausa\")) === 2){\n      flow.set(\"estadoTurboF\", global.get(\"estadoTurbo\"));//salamandraPausa == 0 esta en marcha\n      flow.set(\"aire1F\", global.get(\"aire1\"));\n      flow.set(\"aire2F\", global.get(\"aire2\"));\n      flow.set(\"aire3F\", global.get(\"aire3\"));\n      flow.set(\"aire4F\", global.get(\"aire4\"));\n      flow.set(\"aireChimeneaF\", global.get(\"aireChimenea\"));  \n    } \n\n    if (parseInt(global.get(\"estadoSalamandra\")) === 0){\n      flow.set(\"estadoTurboF\", 0);//salamandraPausa == 0 esta en marcha\n      flow.set(\"aire1F\", 0);\n      flow.set(\"aire2F\", 0);\n      flow.set(\"aire3F\", 0);\n      flow.set(\"aire4F\", 0);\n      flow.set(\"aireChimeneaF\", 0);       \n    }\n  \n  //  msg = {topic: \"salamandra/backUp\", payload: \"estado\" };\n  //  node.send([msg, null, null, null]);\n    // dato = global.get(\"salamandraAuto\") + \"#\";\n  dato = global.get(\"salamandraBbaCirc\") + \"#\";\n  dato += global.get(\"salamandraBbaRad\") + \"#\";\n  dato += global.get(\"salamandraBbaTermo\") + \"#\";\n  dato += flow.get(\"estadoTurboF\") + \"#\";//salamandraPausa == 0 esta en marcha\n  dato += flow.get(\"aire1F\") + \"#\";\n  dato += flow.get(\"aire2F\") + \"#\";\n  dato += flow.get(\"aire3F\") + \"#\";\n  dato += flow.get(\"aire4F\") + \"#\";\n  dato += flow.get(\"aireChimeneaF\");    \n  \n  // dato += global.get(\"estadoTurbo\") + \"#\";\n\n\n  if (dato.includes(\"undefined\")){\n    msg = {topic: \"salamandra/backUp/recovery\", payload: 1}; \n    node.send([msg, null]); \n    return;\n  }\n  msg = {topic: \"salamandra/backUp\", payload: \"estado\" };\n  node.send([msg, null, null, null]);\n  msg = {estado: \"node\", topic: \"salamandra/Recibo\", payload: \"estado\" + dato}; \n  if (topicInicial == \"salamandra/NodeRed\")msg = {estado: \"node\", topic: \"salamandra/Recibo\", payload: \"estado\" + dato};\n  node.send([msg, null, null, null]);\n}\n\n\n\n\n// var mysql = \"INSERT INTO \\\\`salamandra\\\\`(\\\\`tiempo\\\\`, \\\\`tempLiving\\\\`, \\\\`tempPasillo\\\\`, \\\\`tempBano\\\\`, \\\\`tempHab1\\\\`, \\\\`tempHab2\\\\`, \\\\`tempComedor\\\\`, \\\\`tempCocina\\\\`, \\\\`tempLavadero\\\\`, \\\\`tempExterior\\\\`, \\\\`tempTermo\\\\`, \\\\`tempBajTermo\\\\`, \\\\`tempSubTermo\\\\`, \\\\`tempDepTermo\\\\`, \\\\`tempSerpCamara\\\\`, \\\\`temp1Serp\\\\`, \\\\`tempChimenea\\\\`, \\\\`tempRetRad\\\\`, \\\\`tempDepRad\\\\`, \\\\`aireEnc\\\\`, \\\\`airePrim\\\\`, \\\\`aireSec\\\\`, \\\\`aireTerc\\\\`, \\\\`turbo\\\\`, \\\\`bombaRad\\\\`, \\\\`bombaRec\\\\`, \\\\`bombaTermo\\\\`) VALUES (now(),\";\n// mysql += 55 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\"; mysql += 0 + \",\";\n// mysql += 0 + \",\"; mysql += 0 + \")\";\n// msg.topic = mysql;\n// return msg;\n",
        "outputs": 4,
        "noerr": 0,
        "x": 1250,
        "y": 335,
        "wires": [
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "86b88f32.1c0e",
        "type": "debug",
        "z": "65561250.4225fc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1506.5,
        "y": 1001,
        "wires": []
    },
    {
        "id": "7108fd4e.0d52e4",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "terminalBlynk",
        "qos": "",
        "retain": "",
        "broker": "3fe9d635.ec409a",
        "x": 499,
        "y": 262,
        "wires": []
    },
    {
        "id": "62513301.80a4ec",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.payload == \"1\")return msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 243.5,
        "y": 261,
        "wires": [
            [
                "152c1010.b18a4"
            ]
        ]
    },
    {
        "id": "58bd8633.de8618",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": "20",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 359,
        "y": 632,
        "wires": [
            [
                "975ffbce.bc05a8"
            ]
        ]
    },
    {
        "id": "3d0eaf73.033a8",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "var pin = parseInt(msg.pin);\nvar intPayload = parseInt(msg.payload);\nvar topic = msg.topic;\nvar dato;\n\nswitch (pin){\n  case 18:\n    global.set(\"itemPotencia\", msg.payload);\n    // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n      context.item = parseInt(msg.payload);\n      switch(parseInt(msg.payload)){\n          case 1:\n              msg = {pin: 19, min: 0, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n          break;\n          case 2:\n              msg = {pin: 19, min: 0, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n          break;\n          case 3:\n              msg = {pin: 19, min: 0, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n          break;\n          case 4:\n              msg = {pin: 19, min: 0, max: 255, label: \"Led Living\", payload: global.get(\"ledLiving\")};\n          break;\n          case 5:\n              msg = {pin: 19, min: 1, max: 255, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n          break;          \n          case 6:\n              msg = {pin: 19, min: 1, max: 100, label: \"Ducha de bano\", payload: global.get(\"pwmDucha\")};\n          break;     \n          case 7:\n              msg = {pin: 19, min: 1, max: 100, label: \"Luz Bano\", payload: global.get(\"pwmLuzBano\")};\n          break;\n          case 8:\n              msg = {pin: 19, min: 15, max: 240, label: \"timer extractor baño\", payload: global.get(\"timerExtractorBano\")};\n          break;          \n          case 9:\n              msg = {pin: 19, min: 10, max: 200, label: \"tiempo MIN teclas\", payload: global.get(\"minTeclas\")};\n          break;       \n          case 10:\n              msg = {pin: 19, min: 400, max: 2000, label: \"tiempo MAX teclas\", payload: global.get(\"maxTeclas\")};\n          break;   \n          case 11:\n              msg = {pin: 19, min: 1, max: 100, label: \"delay buzzer\", payload: global.get(\"delayBuzzer\")};\n          break;                              \n      }\n      node.send([null, msg]);\n      return;\n    // }\n  break;\n\n  case 19:\n    // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n      var valor = parseInt(msg.payload);\n      switch(context.item){\n          case 1:\n              // if (global.get(\"estLiving\") === 0)return;\n              global.set(\"potLiving\", valor);\n              global.set(\"potIsla\", valor);\n              global.set(\"potCielorrazo\", valor);\n              global.set(\"ledLiving\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 2:\n              // if (global.get(\"estIsla\") === 0)return;\n              global.set(\"potIsla\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 3:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"potCielorrazo\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 4:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"ledLiving\", valor);\n\t\t\t  global.set(\"IslaR\", valor);\n\t\t\t  global.set(\"IslaG\", valor);\n\t\t\t  global.set(\"IslaB\", valor);\n\t\t\t  msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"living\");\n          break;          \n          case 5:\n              // if (global.get(\"Dia\") === 1)return;\n              global.set(\"pwmPatioLuz\", valor);\n              enviarMQTT(\"patioLuz\");\n              return;\n          case 6:\n              // if (global.get(\"estDucha\") === 0)return;  \n              global.set(\"pwmDucha\", valor);\n              enviarMQTT(\"bano\");\n              return;\n          case 7:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLuzBano\", valor);\n              enviarMQTT(\"bano\");\n              return;     \n      case 8:\n              global.set(\"timerExtractorBano\", valor);\n              enviarMQTT(\"bano\");\n              return;\n          case 9:\n              global.set(\"minTeclas\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;     \n      case 10:\n              global.set(\"maxTeclas\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;              \n        case 11:  \n              global.set(\"delayBuzzer\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;              \n            }  \n          break;\n}\n\nfunction enviarMQTT(caso){\nvar dato;\n  if (caso == \"bano\"){\n  dato = global.get(\"estLuzBano\") + \"#\" + global.get(\"pwmLuzBano\") + \"#\" + global.get(\"modoDucha\") + \"#\" + global.get(\"estDucha\") + \"#\" + global.get(\"pwmDucha\");\n  dato += \"#\" + global.get(\"estLuzEspejo\") + \"#\" + global.get(\"estExtractorBano\") + \"#\" + global.get(\"timerExtractorBano\") + \"#\" + global.get(\"Dia\");\n    msg = {topic: \"ESP/Bano/Recibo\", payload: dato};\n  }\n\n  if (caso == \"patioLuz\"){msg = {topic: \"USBout\", payload: \"Noche\" + global.get(\"pwmPatioLuz\")};}\n  \n\n  if (caso == \"living\"){\n    dato = global.get(\"estIsla\") + \",\";\n    dato += global.get(\"potIsla\") + \"#\";\n    dato += global.get(\"estCielorrazo\") + \",\";\n    dato += global.get(\"potCielorrazo\") + \"#\";  \n    dato += global.get(\"estIslaRGB\") + \",\";\n    dato += global.get(\"ledLiving\") + \",\";\n    dato += global.get(\"ledLiving\") + \",\";      \n    dato += global.get(\"ledLiving\") + \"#\";\n\n    dato += global.get(\"pwmMaxLed\") + \"#\";\n    dato += global.get(\"pwmMinLed\") + \"#\";\n\n    dato += global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"doblePuls\");\n    dato += \"#\" + global.get(\"Dia\");\n\n    msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n    node.send([msg, null]);\n  }\n  if (caso == \"configGenericas\"){\n    dato = global.get(\"minTeclas\") + \"#\";\n  dato += global.get(\"maxTeclas\") + \"#\";\n  dato += global.get(\"delayBuzzer\");\n  msg = {topic: \"configTeclas\", payload: dato};\n  }\n\nnode.send([msg, null]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 106,
        "y": 246,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "5b4fbb29.c17a04",
        "type": "blynk-ws-in-write",
        "z": "9c63fd61.9908c",
        "name": "Luces cascada",
        "pin": "21",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 242,
        "y": 621,
        "wires": [
            [
                "78364cb0.17f444"
            ]
        ]
    },
    {
        "id": "9972572c.2f7518",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "context.item = context.item || 0;\n\nif (parseInt(msg.pin) == 21){\n    context.item = parseInt(msg.payload);\n    return;\n}\n\nif (msg.topic == \"crepMQTT\"){\n    if (parseInt(global.get(\"Dia\")) === 1){\n        msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#0#0#0#0#0#0#0#0#0#0\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\")};\n        node.send([msg, null]);\n        return;\n    }\n    if (parseInt(global.get(\"Dia\")) === 0){\n        enviarMQTT(\"patioLuz\");\n        return;\n    }\n}\n\nif (msg.topic == \"PatioLuz/Inicio\"){\n  enviarMQTT(\"patioLuz\");\n  return;\n}\n\nswitch(parseInt(msg.pin)){\n    case 22:\n        global.set(\"bombaCascada\", parseInt(msg.payload));\n        if (parseInt(msg.payload) === 0 && parseInt(global.get(\"Dia\")) === 0){\n          msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#\" + global.get(\"pwmPatioLuz\") + \"#0#0#1#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\")};      \n        }\n        mensaje = \"bomba\" + global.get(\"bombaCascada\");\n        msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n        node.send([msg, null]);\n        return;\n    break;\n    case 23:\n        global.set(\"modoLed1Cascada\", parseInt(msg.payload));\n        enviarMQTT(\"patioLuz\");\n        return;\n    break;\n    case 24:\n        global.set(\"modoLed2Cascada\", parseInt(msg.payload));\n        enviarMQTT(\"patioLuz\");\n        return;\n    break;\n    case 25:\n        global.set(\"modoLed3Cascada\", parseInt(msg.payload));\n        enviarMQTT(\"patioLuz\");\n        return;\n    break;      \n}\nmsg.payload = context.item; node.send(msg);\nswitch (parseInt(context.item)){\n    case 1:\n        global.set(\"IslaR\", msg.arrayOfValues[0]);\n        global.set(\"IslaG\", msg.arrayOfValues[1]);\n        global.set(\"IslaB\", msg.arrayOfValues[2]);\n        msg = {pin: 32, payload: \"12\"}; node.send([null, msg]);\n        global.set(\"estIslaRGB\", 1);\n        enviarMQTT(\"living\");\n    break;\n    case 2:\n        global.set(\"topeCascadaR\", msg.arrayOfValues[0]); global.set(\"mitadCascadaR\", msg.arrayOfValues[0]); global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n        global.set(\"topeCascadaG\", msg.arrayOfValues[1]); global.set(\"mitadCascadaG\", msg.arrayOfValues[1]); global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n        global.set(\"topeCascadaB\", msg.arrayOfValues[2]); global.set(\"mitadCascadaB\", msg.arrayOfValues[2]); global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n        enviarMQTT(\"patioLuz\");\n    break;\n    case 3:\n        global.set(\"topeCascadaR\", msg.arrayOfValues[0]);\n        global.set(\"topeCascadaG\", msg.arrayOfValues[1]);\n        global.set(\"topeCascadaB\", msg.arrayOfValues[2]);\n        enviarMQTT(\"patioLuz\");\n    break;\n    case 4:\n        global.set(\"mitadCascadaR\", msg.arrayOfValues[0]);\n        global.set(\"mitadCascadaG\", msg.arrayOfValues[1]);\n        global.set(\"mitadCascadaB\", msg.arrayOfValues[2]);\n        enviarMQTT(\"patioLuz\");\n    break;\n    case 5:\n        global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n        global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n        global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n        enviarMQTT(\"patioLuz\"); \n    break;          \n}\n\n\n\nfunction enviarMQTT(caso){\n\n  if (caso == \"living\"){\n    dato = global.get(\"estIsla\") + \",\";\n    dato += global.get(\"potIsla\") + \"#\";\n    dato += global.get(\"estCielorrazo\") + \",\";\n    dato += global.get(\"potCielorrazo\") + \"#\";  \n    dato += global.get(\"estIslaRGB\") + \",\";\n    dato += global.get(\"IslaR\") + \",\";\n    dato += global.get(\"IslaG\") + \",\";      \n    dato += global.get(\"IslaB\") + \"#\";\n\n    dato += global.get(\"pwmMaxLed\") + \"#\";\n    dato += global.get(\"pwmMinLed\") + \"#\";\n\n    dato += global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"doblePuls\");\n    dato += \"#\" + global.get(\"Dia\");\n\n    msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n    node.send([msg, null]);\n  }\n    if (caso == \"patioLuz\"){\n      if (parseInt(global.get(\"Dia\")) === 1){\n        msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#0#0#0#0#0#0#0#0#0#0\"};\n        node.send([msg, null]);\n        return;\n      }\n    var mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\" + global.get(\"pwmPatioLuz\") + \"#0#\" ;\n    // mensaje = mensaje + global.get(\"bombaCascada\")  + \"#\" + global.get(\"modoLed2Cascada\")  + \"#\" + global.get(\"modoLed3Cascada\")+ \"#\";\n    mensaje = mensaje + global.get(\"modoLed2Cascada\")  + \"#\" + global.get(\"modoLed3Cascada\")+ \"#\";\n    mensaje = mensaje + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n    mensaje = mensaje + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n    mensaje = mensaje + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\");\n    msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n    node.send([msg, null]);\n    }\n}\n\n// 1#1023#32#138#21#0#1#1#1#undefined#69#69#0#146#92",
        "outputs": 1,
        "noerr": 0,
        "x": 72.5,
        "y": 820.7500114440918,
        "wires": [
            [
                "14c6b05e.0f1f6",
                "c3ada573.e26c58"
            ]
        ]
    },
    {
        "id": "eb4c2dae.92768",
        "type": "blynk-ws-in-write",
        "z": "9c63fd61.9908c",
        "name": "valor color",
        "pin": "8",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 258,
        "y": 436,
        "wires": [
            [
                "78364cb0.17f444"
            ]
        ]
    },
    {
        "id": "c3ada573.e26c58",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 209.5,
        "y": 816.7500114440918,
        "wires": []
    },
    {
        "id": "c5f5d35b.26da3",
        "type": "blynk-ws-in-write",
        "z": "9c63fd61.9908c",
        "name": "bomba casc",
        "pin": "22",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 251,
        "y": 473,
        "wires": [
            [
                "78364cb0.17f444",
                "ec2e5128.b39c"
            ]
        ]
    },
    {
        "id": "33736249.88124e",
        "type": "blynk-ws-in-write",
        "z": "9c63fd61.9908c",
        "name": "pil cascada",
        "pin": "23",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 260,
        "y": 511,
        "wires": [
            [
                "78364cb0.17f444"
            ]
        ]
    },
    {
        "id": "2f219bb4.1f8234",
        "type": "blynk-ws-in-write",
        "z": "9c63fd61.9908c",
        "name": "med cascada",
        "pin": "24",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 252,
        "y": 546,
        "wires": [
            [
                "78364cb0.17f444"
            ]
        ]
    },
    {
        "id": "fa56e1cc.0dd54",
        "type": "blynk-ws-in-write",
        "z": "9c63fd61.9908c",
        "name": "arr cascada",
        "pin": "25",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 253,
        "y": 582,
        "wires": [
            [
                "78364cb0.17f444"
            ]
        ]
    },
    {
        "id": "14c6b05e.0f1f6",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 209.5,
        "y": 867.7500114440918,
        "wires": []
    },
    {
        "id": "d1f492f0.4848f",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "PatioLuz/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 917.5,
        "y": 288,
        "wires": [
            [
                "208e4c51.d36044"
            ]
        ]
    },
    {
        "id": "208e4c51.d36044",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1095.5,
        "y": 287,
        "wires": []
    },
    {
        "id": "c8e36659.af0518",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "delay20#120",
        "payloadType": "str",
        "x": 395,
        "y": 873,
        "wires": [
            [
                "d99ec6b4.c43c78"
            ]
        ]
    },
    {
        "id": "d99ec6b4.c43c78",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "PatioLuz/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 595.5,
        "y": 848,
        "wires": []
    },
    {
        "id": "c0394701.511a48",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "delay20#100#20",
        "payloadType": "str",
        "x": 386.5,
        "y": 833,
        "wires": [
            [
                "d99ec6b4.c43c78"
            ]
        ]
    },
    {
        "id": "23ec95cb.bc980a",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#0#0#0#0#0#0#0#0#0#0#0#0#0",
        "payloadType": "str",
        "x": 219.5,
        "y": 905,
        "wires": [
            [
                "d99ec6b4.c43c78"
            ]
        ]
    },
    {
        "id": "9ab4c9a7.a428f8",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "if (msg.topic == \"delayMin\")global.set(\"dalayMinCascada\", msg.payload);\nif (msg.topic == \"delayMax\")global.set(\"delayMaxCascada\", msg.payload);\nif (msg.topic == \"minAuto\")global.set(\"minAutoCascada\", msg.payload);\nif (msg.topic == \"maxAuto\")global.set(\"maxAutoCascada\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 985.5,
        "y": 1107,
        "wires": [
            [
                "84562d6.bdd5bd"
            ]
        ]
    },
    {
        "id": "1cf38697.fead69",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "delayMin",
        "payload": "2",
        "payloadType": "str",
        "x": 801.5,
        "y": 1109,
        "wires": [
            [
                "9ab4c9a7.a428f8"
            ]
        ]
    },
    {
        "id": "153d02ba.2c68ad",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "delayMax",
        "payload": "20",
        "payloadType": "str",
        "x": 818,
        "y": 1150,
        "wires": [
            [
                "9ab4c9a7.a428f8"
            ]
        ]
    },
    {
        "id": "eee4fc2.5ce68",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "minAuto",
        "payload": "1",
        "payloadType": "str",
        "x": 810,
        "y": 1188,
        "wires": [
            [
                "9ab4c9a7.a428f8"
            ]
        ]
    },
    {
        "id": "b1dbd554.5f4fa8",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "maxAuto",
        "payload": "100",
        "payloadType": "str",
        "x": 821,
        "y": 1225,
        "wires": [
            [
                "9ab4c9a7.a428f8"
            ]
        ]
    },
    {
        "id": "84562d6.bdd5bd",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "PatioLuz/Inicio",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1136.5,
        "y": 1109,
        "wires": []
    },
    {
        "id": "745b2766.10db38",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "context.auto = context.auto || 0;\ncontext.mm = context.mm || 0;\ncontext.hh = context.hh || 1;\n\n// if (parseInt(global.get(\"hh\")) === 22 && parseInt(global.get(\"estLucesRGBPileta\")) === 1){// && parseInt(global.get(\"mm\")) < 4){\n//         global.set(\"estLucesRGBPileta\", 0);\n//         msg = {topic: \"ESP/Pileta/Inicio\", payload: 2}; \n//         node.send(msg);\n//         return;\n//     }\n    \n// node.status({text: global.get(\"estPiletaCascada\") + \"-\" + global.get(\"estPalioLuz\")});\nif (parseInt(global.get(\"estPalioLuz\")) === 1 || parseInt(global.get(\"estPiletaCascada\")) === 1){\n    if (parseInt(global.get(\"hh\")) === 1){// && parseInt(global.get(\"mm\")) < 4){\n        global.set(\"estPalioLuz\", 0);\n        global.set(\"estPiletaCascada\", 0);\n        msg = {topic: \"PatioLuz/Inicio\", payload: 2}; \n        node.send(msg);\n        return;\n    }\n}\n\nif (parseInt(global.get(\"hh\")) > 8 && parseInt(global.get(\"hh\")) < 23){\n    var ponele = global.get(\"hh\") + \" - \" + context.hh + \" - \" + global.get(\"bombaCascada\") + \" - \" + global.get(\"estadoPatioLuz\");\n    node.status({text: ponele});\n  if (parseInt(global.get(\"hh\")) != parseInt(context.hh) && parseInt(global.get(\"bombaCascada\")) === 0){// && parseInt(global.get(\"estadoPatioLuz\")) === 1){\n    context.auto = 1;\n    context.hh = global.get(\"hh\");\n    global.set(\"bombaCascada\", 1);\n    msg = {topic: \"notifyBlynk\", payload: global.get(\"hsCpu\") + \" - Prendo Bomba Cascada\"}; node.send(msg);\n    msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" - Prendo Bomba Cascada\\n\"}; node.send(msg);\n    mensaje = \"bomba\" + global.get(\"bombaCascada\"); msg = {topic: \"PatioLuz/Recibo\", payload: mensaje}; node.send(msg);\n    return;\n  }\n//   if (parseInt(global.get(\"mm\")) != parseInt(context.mm) && parseInt(context.auto) === 1 && parseInt(global.get(\"estadoPatioLuz\")) === 1){\n  if (parseInt(context.auto) === 1){//} && parseInt(global.get(\"estadoPatioLuz\")) === 1){      \n    // context.mm = global.get(\"mm\");\n    context.auto = 0;\n    global.set(\"bombaCascada\", 0);\n    msg = {topic: \"notifyBlynk\", payload: global.get(\"hsCpu\") + \" - Apago Bomba Cascada\"}; node.send(msg);\n    msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \" - Apago Bomba Cascada\\n\"}; node.send(msg);\n    mensaje = \"bomba\" + global.get(\"bombaCascada\"); msg = {topic: \"PatioLuz/Recibo\", payload: mensaje}; node.send(msg);\n    return;\n  }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 793,
        "y": 697,
        "wires": [
            [
                "e73062c6.a9f42",
                "a5b0533c.8d283"
            ]
        ]
    },
    {
        "id": "42823c2b.101b84",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "arr auto bomba",
        "repeat": "182",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "timer",
        "payload": "",
        "payloadType": "date",
        "x": 609,
        "y": 687,
        "wires": [
            [
                "e73062c6.a9f42",
                "745b2766.10db38"
            ]
        ]
    },
    {
        "id": "a5b0533c.8d283",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 952,
        "y": 715,
        "wires": []
    },
    {
        "id": "e73062c6.a9f42",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 975.5,
        "y": 679,
        "wires": []
    },
    {
        "id": "e3246980.56dd68",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "PatioLuz/Debug1",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 604.5,
        "y": 723,
        "wires": [
            [
                "27f4f2af.c3372e"
            ]
        ]
    },
    {
        "id": "27f4f2af.c3372e",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg = {topic: \"terminalBlynk\", payload: msg.payload + \"\\n\"}; \nnode.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 792.5,
        "y": 752,
        "wires": [
            []
        ]
    },
    {
        "id": "370185b9.c0222a",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "PatioLuz/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 242,
        "y": 692,
        "wires": [
            [
                "78364cb0.17f444",
                "a5a621dd.53654"
            ]
        ]
    },
    {
        "id": "52d3324d.e3bc4c",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "crepMQTT",
        "qos": "2",
        "broker": "c339edbf.39572",
        "x": 147.5,
        "y": 657,
        "wires": [
            [
                "b0ee4419.bb94f8"
            ]
        ]
    },
    {
        "id": "6c5c63e5.36f72c",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "if (msg.topic == \"crepMQTT\"){\n    if (parseInt(global.get(\"Dia\")) === 1){\n        msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#0#0#0#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\")};\n        node.send([msg, null]);\n        return;\n    }\n    if (parseInt(global.get(\"Dia\")) === 0){\n        enviarMQTT(\"patioLuz\");\n        return;\n    }\n}\n\nif (msg.topic == \"PatioLuz/Inicio\"){\n  enviarMQTT(\"patioLuz\");\n  return;\n}\n\nfunction enviarMQTT(caso){\n    if (caso == \"patioLuz\"){\n      if (parseInt(global.get(\"Dia\")) === 1){\n        msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#0#0#0#0#0#0#0#0#0#0\"};\n        node.send([msg, null]);\n        return;\n      }\n    var mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\" + global.get(\"pwmPatioLuz\") + \"#0#\" ;\n    // mensaje = mensaje + global.get(\"bombaCascada\")  + \"#\" + global.get(\"modoLed2Cascada\")  + \"#\" + global.get(\"modoLed3Cascada\")+ \"#\";\n    mensaje = mensaje + global.get(\"modoLed2Cascada\")  + \"#\" + global.get(\"modoLed3Cascada\")+ \"#\";\n    mensaje = mensaje + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n    mensaje = mensaje + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n    mensaje = mensaje + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\");\n    msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n    node.send([msg, null]);\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 1195.5,
        "y": 342,
        "wires": [
            [
                "f74e3bde.5892e8"
            ]
        ]
    },
    {
        "id": "f74e3bde.5892e8",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1317.5,
        "y": 342,
        "wires": []
    },
    {
        "id": "be7a37bb.f4d3e8",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "global.set (\"Dia\", msg.payload);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1164,
        "y": 401,
        "wires": [
            [
                "498f7533.28b64c",
                "64099c76.63e684"
            ]
        ]
    },
    {
        "id": "6ecc082b.6c1508",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "1",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "crepMQTT",
        "payload": "1",
        "payloadType": "str",
        "x": 1027,
        "y": 404,
        "wires": [
            [
                "be7a37bb.f4d3e8"
            ]
        ]
    },
    {
        "id": "498f7533.28b64c",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1343,
        "y": 465,
        "wires": []
    },
    {
        "id": "7a71f8ba.eaba28",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "0",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "crepMQTT",
        "payload": "0",
        "payloadType": "str",
        "x": 1029.5,
        "y": 440,
        "wires": [
            [
                "be7a37bb.f4d3e8"
            ]
        ]
    },
    {
        "id": "b0ee4419.bb94f8",
        "type": "delay",
        "z": "9c63fd61.9908c",
        "name": "1s",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 271.5,
        "y": 656,
        "wires": [
            [
                "78364cb0.17f444",
                "3c374cb5.85aa64"
            ]
        ]
    },
    {
        "id": "ec2e5128.b39c",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 475,
        "y": 490,
        "wires": []
    },
    {
        "id": "a5a621dd.53654",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 520.5,
        "y": 784,
        "wires": []
    },
    {
        "id": "390ba879.e60678",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.topic.includes(\"desconectado\") || msg.topic.includes(\"Desconectado\")){\n    global.set(\"estadoPatioLuz\", 0);\n    global.set(\"estado-PatioLuz\", global.get(\"fechaCompleta\") + \" - Desc\\n\");\n    node.send(msg);}\nif (msg.topic.includes(\"Inicio\")){\n    global.set(\"estadoPatioLuz\", 1);\n    global.set(\"estado-PatioLuz\", global.get(\"fechaCompleta\") + \" - Con\\n\");\n    node.send(msg);}    \n    \n    node.status({text: global.get(\"estado-PatioLuz\")});      ",
        "outputs": 1,
        "noerr": 0,
        "x": 1503,
        "y": 749,
        "wires": [
            [
                "6e57dcc9.a5e0a4"
            ]
        ]
    },
    {
        "id": "f69ca16c.3a34",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "PatioLuz/Desconectado",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1276,
        "y": 754.22216796875,
        "wires": [
            [
                "390ba879.e60678",
                "c9ee0382.8cf6"
            ]
        ]
    },
    {
        "id": "6f19e341.ae015c",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "PatioLuz/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1294.494873046875,
        "y": 789.0908203125,
        "wires": [
            [
                "390ba879.e60678",
                "c9ee0382.8cf6"
            ]
        ]
    },
    {
        "id": "1c3dc106.3cb18f",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1705.5,
        "y": 623,
        "wires": [
            [
                "6e57dcc9.a5e0a4"
            ]
        ]
    },
    {
        "id": "64099c76.63e684",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "crepMQTT",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1363,
        "y": 400,
        "wires": []
    },
    {
        "id": "69e2ccfb.535754",
        "type": "function",
        "z": "73083520.75304c",
        "name": "llenado de tanque",
        "func": "  context.nivelAnterior = context.nivelAnterior || 0;\n  context.estadoAnterior = context.estadoAnterior || 0;\n  // context.avisoTanque = context.avisoTanque || 0;\n  context.llenadoAnulado = context.llenadoAnulado || 0;\n  context.tiempoLlenado = context.tiempoLlenado || 0;\n  context.tiempoRestante = context.tiempoRestante || 0; // 0 == por nivel\n  context.nivelInicioLlenado = context.nivelInicioLlenado || 0;\n  context.tiempoInicioLlenado = context.tiempoInicioLlenado || 0;\n  if (global.get(\"llenarTanque\") === undefined)global.set(\"llenarTanque\", 0);\n\n  var date = new Date();\n  // var dato = JSON.parse(msg.payload);\n  var topic = msg.topic;\n  var pin = parseInt(msg.pin);\n  var nivMaximo = 400;\n  var nivMinimo = 250;\n  var timerLuces = 12000;\n  var tasaLlenado = 0;\n\n  if (global.get(\"fallasLavadero\") === undefined)global.set(\"fallasLavadero\", 0);\n  if (global.get(\"luzLavadero\") === undefined)global.set(\"luzLavadero\", 0);\n  if (global.get(\"luzAlacenaLavadero\") === undefined)global.set(\"luzAlacenaLavadero\", 0);\n  if (global.get(\"bombaPozo\") === undefined)global.set(\"bombaPozo\", 0);\n  if (global.get(\"valvulaTanque\") === undefined)global.set(\"valvulaTanque\", 0);\n  if (global.get(\"bombaPileta\") === undefined)global.set(\"bombaPileta\", 0);\n  if (global.get(\"estadoEspTanque\") === undefined)global.set(\"estadoEspTanque\", 1);\n  if (global.get(\"tasaLlenadoTanque\") === undefined)global.set(\"tasaLlenadoTanque\", 0);\n\n  if (global.get(\"minimoTanque\") === undefined)global.set(\"minimoTanque\", 250);\n  if (global.get(\"maximoTanque\") === undefined)global.set(\"maximoTanque\", 400);\n  if (global.get(\"alturaTanque\") === undefined)global.set(\"alturaTanque\", 680);\n\n  // node.status({text: global.get(\"estadoAlarma\") + \" -- \"  + global.get(\"luzLavadero\")});\n\n  if (topic == \"blynk/marchaBomba\")pin = 2;\n  if (topic == \"blynk/llenarTanque\")pin = 34;\n\n  if (topic == \"aviso/Alarma\"){\n    if (global.get(\"estadoAlarma\") === 1)apagadoLuces();\n  }\n\n  // if (topic == \"google/Alarma\" || topic == \"aviso/Alarma\"){\n  //   if (global.get(\"luzAlacenaLavadero\") === 1 || global.get(\"luzLavadero\") === 1){\n  //     node.status({text: global.get(\"estadoAlarma\") + \" -ppp- \"  + global.get(\"luzLavadero\")});\n  //     if (global.get(\"estadoAlarma\") === 1 && global.get(\"Dia\") === 0){setTimeout(apagadoLuces, timerLuces);}\n  //     if (global.get(\"estadoAlarma\") === 1 && global.get(\"Dia\") === 1)apagadoLuces();\n  //   }\n  // } \n\n  if (topic == \"google/Lavadero\" || topic == \"crepMQTT\"){\n    enviarBlynk();\n    enviarDatos();\n  }   \n\n  // if (topic == \"ESP/Lavadero/Temperatura\"){\n  //   global.set(\"tempLavadero\", parseFloat(msg.payload).toFixed(2)); \n  //   return;\n  // }\n\n  if (topic == \"ESP/Lavadero/Envio\"){\n    if (msg.payload === \"\")return;\n    if (msg.payload.substring(0, 13) == \"bloqueoTeclasSI\"){msg = {pin: 74, payload: 1}; node.send([null, msg]); return;}\n    if (msg.payload.substring(0, 13) == \"bloqueoTeclasNO\"){msg = {pin: 74, payload: 0}; node.send([null, msg]); return;}\n    // if (msg.substring(0, 6) == \"Buzzer\") msg = msg.substring(6);\n    var dato = msg.payload.split(\"#\");\n    global.set(\"bombaPozo\", parseInt(dato[0])); \n    global.set(\"bombaPileta\", parseInt(dato[1])); \n    global.set(\"luzLavadero\", parseInt(dato[2])); \n    global.set(\"luzAlacenaLavadero\", parseInt(dato[3])); \n  //   if (global.get(\"luzLavadero\") === 0)global.set(\"luzAlacenaLavadero\", 0); \n    enviarBlynk();\n    return;\n  }\n\n  if (topic == \"ESP/TanqueAgua/Desconectado\"){\n    var restante = parseInt(nivMaximo) - parseInt(global.get(\"nivTanque\"));\n    var tiempoRestante = (parseInt(restante) * 209) / 104;\n    context.tiempoRestante = parseInt(tiempoRestante * 1000);\n    global.set(\"estadoEspTanque\", 0);// 0 = Desconectado\n    return;\n  }  \n\n  if (topic == \"ESP/TanqueAgua/Inicio\"){\n    global.set(\"estadoEspTanque\", 1);\n    var datos = \"config\" + global.get(\"minimoTanque\") + \"#\" + global.get(\"maximoTanque\") + \"#\" + global.get(\"alturaTanque\");\n    msg = {topic: \"ESP/TanqueAgua/Recibo\", payload: datos}; node.send([msg, null]);\n    // enviarDatos();    \n    return;\n  }   \n\n  // if (global.get(\"estadoEspTanque\") === 0 && global.get(\"llenarTanque\") === 1 && date.getTime() > parseInt(context.tiempoRestante)){\n  //   global.set(\"llenarTanque\", 0); global.set(\"bombaPozo\", 0);  global.set(\"valvulaTanque\", 0); \n  //   msg = {topic: \"notifyBlynk\", payload:\"tanque lleno por tiempo\"}; node.send(msg);\n  //   enviarBlynk(); \n  //   enviarDatos();  \n  // }\n\n  // if (dato.topic == \"bombaRF\"){\n  //   if (global.get(\"bombaPozo\") === 0){global.set(\"bombaPozo\", 1);}else{global.set(\"bombaPozo\", 0);}\n  //   enviarBlynk(); \n  //   enviarDatos(); //return;\n  // }\n\n  if (parseInt(global.get(\"llenarTanque\")) === 1 && parseInt(date.getTime()) > parseInt(context.tiempoLlenado)){\n    context.tiempoLlenado = date.getTime() + 60000;\n    msg = {topic: \"ESP/TanqueAgua/Recibo\", payload: \" \"}; node.send([msg, null]); \n    return;\n  }\n\n  // sube el nivel a razon de 104mm cada 209\"     42mm en 91\"\nif (topic == \"ESP/TanqueAgua/Envio\"){\n    global.set(\"nivTanque\", parseInt(msg.payload)); \n\n    if (parseInt(global.get(\"nivTanque\")) < parseInt(global.get(\"minimoTanque\")) && global.get(\"llenarTanque\") === 0 && context.llenadoAnulado === 0){\n      context.nivelInicioLlenado = parseInt(global.get(\"nivTanque\"));\n      context.tiempoInicioLlenado = date.getTime();  \n      node.status({text: \"nivelInicio: \" + context.nivelInicioLlenado + \"  tiempoInicio: \" + context.tiempoInicioLlenado});\n      context.tiempoLlenado = date.getTime() + 60000;\n      context.estadoAnterior = 1;\n      global.set(\"llenarTanque\", 1);\n      global.set(\"bombaPozo\",  1);\n      global.set(\"valvulaTanque\", 1);\n    //   msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" Inicio AUTO llenado tanque, \" + context.nivelInicioLlenado + \"mm\\n\"}; node.send([msg, null]);\n      msg = {topic: \"ESP/Lavadero/Recibo\", payload: \"llenando1\"}; node.send([msg, null]);\n      msg = {topic: \"informarNivel\", payload: 1}; node.send([msg, null]);\n      enviarBlynk(); \n      msg.topic = \"ESP/Lavadero/Inicio\";\n      enviarDatos();\n      return;    \n    }\n    \n    if (parseInt(global.get(\"nivTanque\")) >= parseInt(global.get(\"maximoTanque\")) && parseInt(global.get(\"llenarTanque\")) === 1){// && parseInt(global.get(\"estadoEspTanque\")) === 1){ //&& context.avisoTanque === 0 && global.get(\"estadoEspTanque\") === 1){\n        var var1 = global.get(\"nivTanque\");\n        tasaLlenado = (date.getTime() - parseInt(context.tiempoInicioLlenado)) / 60000;\n        tasaLlenado = parseFloat((var1 - context.nivelInicioLlenado) / tasaLlenado).toFixed(2);\n        global.set(\"tasaLlenadoTanque\", tasaLlenado);        \n        global.set(\"llenarTanque\", 0); global.set(\"bombaPozo\", 0);  global.set(\"valvulaTanque\", 0); \n        var ponele3 = parseInt(global.get(\"nivTanque\")) - context.nivelInicioLlenado;\n        node.status({text: \"FIN Auto nivelInicio: \" + ponele3 + \"  TiempoLlenado: \" + parseFloat(global.get(\"tasaLlenadoTanque\")).toFixed(2)});\n        // msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" Paro AUTO Llenado tanque, \" + var1 + \"mm\\n\"}; node.send([msg, null]);\n        // msg = {topic: \"notifyBlynk\", payload:\"tanque lleno por nivel\"}; node.send(msg);\n        msg = {topic: \"informarNivel\", payload: 1}; node.send([msg, null]);\n        topicNuevo = \"ESP/Lavadero/Inicio\";\n        enviarBlynk(); \n        msg.topic = \"ESP/Lavadero/Inicio\";\n        enviarDatos();\n        return;\n    }  \n\n    if (global.get(\"nivTanque\") != context.nivelAnterior){\n      context.nivelAnterior = global.get(\"nivTanque\");\n        if (parseInt(global.get(\"llenarTanque\")) === 1){// parseInt(global.get(\"nivTanque\")) < parseInt(nivMaximo)){\n          var var1 = global.get(\"nivTanque\");\n          tasaLlenado = (date.getTime() - parseInt(context.tiempoInicioLlenado)) / 60000;\n          tasaLlenado = parseFloat((var1 - context.nivelInicioLlenado) / tasaLlenado).toFixed(2);\n          context.nivelInicioLlenado = parseInt(global.get(\"nivTanque\"));\n          context.tiempoInicioLlenado = date.getTime();\n          global.set(\"tasaLlenadoTanque\", tasaLlenado);      \n          msg = {topic: \"informarNivel\", payload: 1}; node.send([msg, null]);\n          msg = {topic: \"Blynk/actualizar/estado\", payload: 1}; node.send([msg, null]);\n      }\n    }  \n\n} \n\n  if (topic == \"ESP/Lavadero/Inicio\") {\n    enviarDatos(); \n    return;\n  }\n\n  switch (pin){\n    case 2:\n    global.set(\"bombaPozo\", parseInt(msg.payload));\n      enviarDatos(); //return;\n      break;\n\n    case 34:\n      context.estadoAnterior = msg.payload;\n      global.set(\"llenarTanque\", parseInt(msg.payload));\n      global.set(\"bombaPozo\",  parseInt(msg.payload));\n      global.set(\"valvulaTanque\",parseInt( msg.payload));\n      context.tiempoLlenado = date.getTime() + 60000;\n      if (parseInt(msg.payload) === 0) {\n        var var1 = global.get(\"nivTanque\");\n        tasaLlenado = (date.getTime() - context.tiempoInicioLlenado) / 60000;        \n        parseFloat((var1 - context.nivelInicioLlenado) / tasaLlenado).toFixed(2);\n        var ponele = var1 - context.nivelInicioLlenado;\n        global.set(\"tasaLlenadoTanque\", tasaLlenado);\n        // msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" Paro MANUAL Llenado tanque, \" + var1 + \"mm\\n\"}; node.send([msg, null]);\n        msg = {topic: \"informarNivel\", payload: 1}; node.send([msg, null]);\n        node.status({text: \"FIN Man nivelInicio: \" + ponele + \"  TiempoLlenado: \" + parseFloat(global.get(\"tasaLlenadoTanque\")).toFixed(2)});\n        context.llenadoAnulado = 1;\n      }\n      if (parseInt(msg.payload) === 1) {\n        context.nivelInicioLlenado = parseInt(global.get(\"nivTanque\"));\n        context.tiempoInicioLlenado = date.getTime();\n        // msg = {topic: \"terminalBlynk\", payload: global.get(\"fechaCompleta\") + \" Inicio MANUAL llenado tanque, \" + context.nivelInicioLlenado + \"mm\\n\"}; node.send([msg, null]);\n        msg = {topic: \"informarNivel\", payload: 1}; node.send([msg, null]);\n        node.status({text: \"nivelInicio: \" + context.nivelInicioLlenado + \"  tiempoInicio: \" + context.tiempoInicioLlenado});\n        context.llenadoAnulado = 0;\n        }\n      enviarBlynk();\n      enviarDatos(); //return;\n      break;  \n\n    case 35:\n      // if (parseInt(msg.payload) === 1) global.set(\"luzLavadero\", 0);\n      // if (parseInt(msg.payload) === 0) global.set(\"luzLavadero\", 1);\n      global.set(\"luzLavadero\", parseInt(msg.payload));\n      node.status({text: global.get(\"estadoAlarma\") + \" -fff- \"  + global.get(\"luzLavadero\")});\n      enviarDatos(); //return;\n      break;\n\n    case 36:\n      global.set(\"luzAlacenaLavadero\", parseInt(msg.payload));\n      node.status({text: global.get(\"estadoAlarma\") + \" -ggg- \"  + global.get(\"luzAlacenaLavadero\")});\n      enviarDatos(); //return;\n      break;\n\n    case 37:\n      global.set(\"bombaPileta\", parseInt(msg.payload));\n      enviarDatos(); //return;\n      break;   \n\n    case 38:\n      global.set(\"valvulaTanque\", parseInt(msg.payload));\n      enviarDatos(); //return;\n      break;                  \n  }\n\n  function enviarBlynk(){\n    msg = {pin: 2, payload: global.get(\"bombaPozo\")}; node.send([null, msg]);\n    msg = {pin: 34, payload: global.get(\"llenarTanque\")}; node.send([null, msg]);\n    msg = {pin: 35, payload: global.get(\"luzLavadero\")}; node.send([null, msg]);\n    msg = {pin: 36, payload: global.get(\"luzAlacenaLavadero\")}; node.send([null, msg]);\n    msg = {pin: 37, payload: global.get(\"bombaPileta\")}; node.send([null, msg]);\n    msg = {pin: 38, payload: global.get(\"valvulaTanque\")}; node.send([null, msg]);\n  }\n\n  function enviarDatos(){//return;\n    var topicNuevo = msg.topic;\n    msg = global.get(\"bombaPozo\") + \"#\";\n    msg = global.get(\"bombaPozo\") + \"#\";\n    msg += global.get(\"valvulaTanque\") + \"#\";\n    msg += global.get(\"bombaPileta\") + \"#\";\n    msg += global.get(\"luzLavadero\") + \"#\";\n    msg += global.get(\"luzAlacenaLavadero\") + \"#\";\n    msg += global.get(\"pwmMaxLed\") + \"#\";\n    msg += global.get(\"pwmMinLed\") + \"#\";\n    msg += global.get(\"Dia\");\n    if (topicNuevo == \"crepMQTT\" || topicNuevo == \"ESP/Lavadero/Inicio\" || topicNuevo == \"aviso/Alarma\")msg += \"#\";\n    msg = {topic: \"ESP/Lavadero/Recibo\", payload: msg}; node.send([msg, null]);\n\n\n    // if (global.get(\"valvulaTanque\") === 1) {context.avisoTanque = 0;}\n    // msg = {pin: 2, payload: global.get(\"bombaPozo\")}; node.send([null,msg]);\n    // msg = {pin: 34, payload: global.get(\"llenarTanque\")}; node.send([null,msg]);\n    // msg = {topic: \"USBout\", payload: \"{\\\"topic\\\":\\\"most\\\",\\\"payload\\\":\" + msg.payload + \"}\"}; node.send(msg);\n    // msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele1\", payload: global.get(\"bombaPozo\")}; node.send(msg);\n    // msg = {topic: \"ESP/Lavadero/Bombas/Estado/Rele0\", payload: global.get(\"valvulaTanque\")}; node.send(msg);    \n    // node.status({text: \"Bomba: \" + global.get(\"bombaPozo\") + \"  Valvula: \" + global.get(\"valvulaTanque\") + \" - \" + global.get(\"nivTanque\") + \" - \" + global.get(\"llenarTanque\") + \" - \" + context.estadoAnterior});\n  }\n\n  function apagadoLuces(){\n      node.status({text: \"apagado auto\"});\n      global.set(\"luzLavadero\", 0);\n      global.set(\"luzAlacenaLavadero\", 0);\n      enviarBlynk();\n      enviarDatos();\n  }\n\n",
        "outputs": 2,
        "noerr": 0,
        "x": 173,
        "y": 271,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "2e55bdae.ae3ac2",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1086.5,
        "y": 581,
        "wires": [
            [
                "96cdc54e.97b928"
            ]
        ]
    },
    {
        "id": "96cdc54e.97b928",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "node.status({text: \"estado Dia: \" + global.get(\"pwmLucesPasadaAuto\")})",
        "outputs": 1,
        "noerr": 0,
        "x": 1285.5,
        "y": 574,
        "wires": [
            [
                "f3d32f7f.eb283"
            ]
        ]
    },
    {
        "id": "c9ee0382.8cf6",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "var dato;\nif (msg.topic == \"PatioLuz/Desconectado\"){\n    dato = global.get(\"fechaCompleta\") + \" Desc\\n\";\n    node.status({text: dato});\n    // msg = {topic: \"notifyBlynk\", payload: dato}; node.send([null, msg]);\n    // msg.payload = dato;\n}\nif (msg.topic == \"PatioLuz/Inicio\"){\n    msg = {topic: \"terminalBlynk\", payload: msg.payload + \"\\n\"}; node.send([null, msg]);\n    dato = global.get(\"fechaCompleta\") + \" Con:\" + msg.payload + \"\\n\";\n    node.status({text: dato});\n    // msg.payload = dato;\n}\nmsg.payload= dato; node.send([msg, null]);\n\n\n",
        "outputs": 2,
        "noerr": 0,
        "x": 1509,
        "y": 804,
        "wires": [
            [
                "18d807e4.4d0a18"
            ],
            [
                "de20f11c.46b02"
            ]
        ]
    },
    {
        "id": "18d807e4.4d0a18",
        "type": "file",
        "z": "f682d492.22a758",
        "name": "estado PatioLuz",
        "filename": "/home/pi/BackUp-Node-Red/Estado_PatioLuz.txt",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "x": 1812.3333740234375,
        "y": 752,
        "wires": [
            []
        ]
    },
    {
        "id": "6387f805.531258",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1172.7500228881836,
        "y": 1112.7500143051147,
        "wires": [
            [
                "a01823.526747e"
            ]
        ]
    },
    {
        "id": "a01823.526747e",
        "type": "file in",
        "z": "f682d492.22a758",
        "name": "estado PatioLuz",
        "filename": "/home/gaston/BackUp-Node-Red/Estado_PatioLuz.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 1338.7500228881836,
        "y": 1118.7500143051147,
        "wires": [
            [
                "d3aa7161.47973"
            ]
        ]
    },
    {
        "id": "d3aa7161.47973",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1507.7500228881836,
        "y": 1119.7500143051147,
        "wires": []
    },
    {
        "id": "d3ef825e.f5d6f",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "salamandra/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 2123,
        "y": 686,
        "wires": [
            [
                "93115bde.8a42a8"
            ]
        ]
    },
    {
        "id": "43759209.11bb3c",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "salamandra/Desconectado",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 2094,
        "y": 648,
        "wires": [
            [
                "93115bde.8a42a8"
            ]
        ]
    },
    {
        "id": "93115bde.8a42a8",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "var dato;\nif (msg.topic == \"salamandra/Desconectado\"){\n    dato = global.get(\"fechaCompleta\") + \" Desconexion salamandra\\n\";\n    node.status({text: dato});\n    // msg = {topic: \"notifyBlynk\", payload: dato}; node.send([null, msg]);\n    // msg.payload = dato;\n}\nif (msg.topic == \"salamandra/Inicio\"){\n    dato = global.get(\"fechaCompleta\") + \" Conexion salamandra, fallo:\" + msg.payload + \"\\n\";\n    node.status({text: dato});\n    // msg.payload = dato;\n}\nmsg.payload= dato; node.send([msg, null]);\n\n\n",
        "outputs": 2,
        "noerr": 0,
        "x": 2334,
        "y": 659.77783203125,
        "wires": [
            [
                "11f55b7c.0a2175"
            ],
            [
                "267ff02.0515a1"
            ]
        ]
    },
    {
        "id": "11f55b7c.0a2175",
        "type": "file",
        "z": "f682d492.22a758",
        "name": "estado PatioLuz",
        "filename": "/home/gaston/BackUp-Node-Red/Estado_salamandra.txt",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "x": 2540.3333740234375,
        "y": 620.77783203125,
        "wires": [
            []
        ]
    },
    {
        "id": "267ff02.0515a1",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 2517.6666259765625,
        "y": 651.77783203125,
        "wires": []
    },
    {
        "id": "9404e26d.a5408",
        "type": "file in",
        "z": "f682d492.22a758",
        "name": "estado PatioLuz",
        "filename": "/home/gaston/BackUp-Node-Red/Estado_salamandra.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 2281,
        "y": 729,
        "wires": [
            [
                "3c6ea445.1a957c"
            ]
        ]
    },
    {
        "id": "8a41cb3d.a6d9b8",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2080,
        "y": 723,
        "wires": [
            [
                "9404e26d.a5408"
            ]
        ]
    },
    {
        "id": "3c6ea445.1a957c",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 2484,
        "y": 710,
        "wires": []
    },
    {
        "id": "b3705a32.04c348",
        "type": "blynk-ws-in-write",
        "z": "9c63fd61.9908c",
        "name": "Gps",
        "pin": "135",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 930,
        "y": 182,
        "wires": [
            [
                "11840e90.f478a1"
            ]
        ]
    },
    {
        "id": "11840e90.f478a1",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "var dato = global.get(\"fechaCompleta\") + \" GPS: \" + msg.payload + \"\\n\";\nmsg.payload = dato; node.send([null, msg]);\nmsg = {topic: \"notifyBlynk\", payload: dato}; node.send([msg, null]);\nmsg = {topic: \"terminalBlynk\", payload: dato}; node.send([msg, null]);\n\n\n\n",
        "outputs": 2,
        "noerr": 0,
        "x": 1069,
        "y": 161,
        "wires": [
            [
                "489f7e30.7d58d"
            ],
            [
                "644b1673.96cd88"
            ]
        ]
    },
    {
        "id": "644b1673.96cd88",
        "type": "file",
        "z": "9c63fd61.9908c",
        "name": "GPS",
        "filename": "/home/gaston/BackUp-Node-Red/GPS.txt",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "x": 1218,
        "y": 169,
        "wires": [
            []
        ]
    },
    {
        "id": "5e7715a7.89003c",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1425.6666259765625,
        "y": 200.22216796875,
        "wires": []
    },
    {
        "id": "40437cf5.be80d4",
        "type": "file in",
        "z": "9c63fd61.9908c",
        "name": "GPS",
        "filename": "/home/gaston/BackUp-Node-Red/GPS.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 1208.6666259765625,
        "y": 209.22216796875,
        "wires": [
            [
                "5e7715a7.89003c"
            ]
        ]
    },
    {
        "id": "3b34464a.c50bda",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1076.6666259765625,
        "y": 210.22216796875,
        "wires": [
            [
                "40437cf5.be80d4"
            ]
        ]
    },
    {
        "id": "489f7e30.7d58d",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1217,
        "y": 126,
        "wires": []
    },
    {
        "id": "4705d808.668488",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "PatioLuz/Inicio",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 889.5,
        "y": 357,
        "wires": []
    },
    {
        "id": "b4c2ed54.24a36",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 674.5,
        "y": 353,
        "wires": [
            [
                "4705d808.668488"
            ]
        ]
    },
    {
        "id": "405a6150.ae6f1",
        "type": "file",
        "z": "f682d492.22a758",
        "name": "borrar est_salamandra",
        "filename": "/home/gaston/BackUp-Node-Red/Estado_salamandra.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "delete",
        "encoding": "none",
        "x": 2337.5,
        "y": 763,
        "wires": [
            []
        ]
    },
    {
        "id": "d125ea5e.718b38",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2129,
        "y": 762,
        "wires": [
            [
                "405a6150.ae6f1"
            ]
        ]
    },
    {
        "id": "6ed86367.5f505c",
        "type": "file",
        "z": "f682d492.22a758",
        "name": "borrar est_PatioLuz",
        "filename": "/home/gaston/BackUp-Node-Red/Estado_PatioLuz.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "delete",
        "encoding": "none",
        "x": 1381.7500228881836,
        "y": 1168.500015258789,
        "wires": [
            []
        ]
    },
    {
        "id": "38550c3b.9f26e4",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1183.2500228881836,
        "y": 1163.500015258789,
        "wires": [
            [
                "6ed86367.5f505c"
            ]
        ]
    },
    {
        "id": "3281a36f.6cfb0c",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "PatioLuz/Potencia",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1442.0000228881836,
        "y": 1060.5000133514404,
        "wires": [
            [
                "5431664c.7ca048"
            ]
        ]
    },
    {
        "id": "5ed00464.0f4f2c",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1955.5000228881836,
        "y": 1021.5000133514404,
        "wires": []
    },
    {
        "id": "5431664c.7ca048",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "msg.payload = global.get(\"fechaCompleta\") + \" - (\" + msg.payload + \")\\n\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1626.5000228881836,
        "y": 1056.5000133514404,
        "wires": [
            [
                "5ed00464.0f4f2c",
                "11399c0f.108e84"
            ]
        ]
    },
    {
        "id": "11399c0f.108e84",
        "type": "file",
        "z": "f682d492.22a758",
        "name": "estado PatioLuz",
        "filename": "/home/gaston/BackUp-Node-Red/Sen_PatioLuz.txt",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "x": 1807.0000228881836,
        "y": 1065.5000133514404,
        "wires": [
            []
        ]
    },
    {
        "id": "e5a4d977.08f708",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1579,
        "y": 1177,
        "wires": [
            [
                "aa1cfb81.fe0488"
            ]
        ]
    },
    {
        "id": "aa1cfb81.fe0488",
        "type": "file in",
        "z": "f682d492.22a758",
        "name": "estado PatioLuz",
        "filename": "/home/gaston/BackUp-Node-Red/Sen_PatioLuz.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 1745,
        "y": 1183,
        "wires": [
            [
                "d5440736.22c058"
            ]
        ]
    },
    {
        "id": "d5440736.22c058",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1914,
        "y": 1184,
        "wires": []
    },
    {
        "id": "5dd60018.f8a1",
        "type": "file",
        "z": "f682d492.22a758",
        "name": "borrar est_PatioLuz",
        "filename": "/home/gaston/BackUp-Node-Red/Sen_PatioLuz.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "delete",
        "encoding": "none",
        "x": 1879,
        "y": 1243,
        "wires": [
            []
        ]
    },
    {
        "id": "5c0f35e7.025a5c",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1680.5,
        "y": 1238,
        "wires": [
            [
                "5dd60018.f8a1"
            ]
        ]
    },
    {
        "id": "dc48ec92.28e3a",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/Escaleras/Potencia",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1793,
        "y": 1344,
        "wires": [
            [
                "c6620a38.fe3448"
            ]
        ]
    },
    {
        "id": "c6620a38.fe3448",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1996,
        "y": 1335,
        "wires": []
    },
    {
        "id": "86c1a364.8b682",
        "type": "inject",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#0#0#1",
        "payloadType": "str",
        "x": 225.5,
        "y": 45,
        "wires": [
            [
                "ed0921c.44ba6e"
            ]
        ]
    },
    {
        "id": "ed0921c.44ba6e",
        "type": "mqtt out",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "topic": "ESP/Escaleras/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 507.49999999999994,
        "y": 123.33333333333331,
        "wires": []
    },
    {
        "id": "298cab44.122fb4",
        "type": "debug",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 429.16666666666663,
        "y": 268.3333333333333,
        "wires": []
    },
    {
        "id": "274c9a94.18b416",
        "type": "mqtt in",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "topic": "ESP/Escaleras/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 191.16666412353516,
        "y": 265,
        "wires": [
            [
                "298cab44.122fb4"
            ]
        ]
    },
    {
        "id": "e6418d86.ff8f6",
        "type": "debug",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 427,
        "y": 322,
        "wires": []
    },
    {
        "id": "f6f0e8d6.5b7ef8",
        "type": "mqtt in",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "topic": "ESP/Escaleras/Desconectado",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 218.99999745686853,
        "y": 318.6666666666667,
        "wires": [
            [
                "e6418d86.ff8f6"
            ]
        ]
    },
    {
        "id": "c3624c0f.b4783",
        "type": "inject",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado100#0#0#0#1",
        "payloadType": "str",
        "x": 226,
        "y": 81,
        "wires": [
            [
                "ed0921c.44ba6e"
            ]
        ]
    },
    {
        "id": "9e770765.7df058",
        "type": "inject",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#100#0#0#1",
        "payloadType": "str",
        "x": 226,
        "y": 118,
        "wires": [
            [
                "ed0921c.44ba6e"
            ]
        ]
    },
    {
        "id": "eadaf80c.873018",
        "type": "mqtt in",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "topic": "ESP/Escaleras/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 210,
        "y": 388,
        "wires": [
            [
                "f7163885.2b91a8"
            ]
        ]
    },
    {
        "id": "f7163885.2b91a8",
        "type": "debug",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 432,
        "y": 393,
        "wires": []
    },
    {
        "id": "8dbc1fc8.c051b",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/Escaleras/Desconectado",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1255.0000228881836,
        "y": 873.7500133514404,
        "wires": [
            [
                "f248f0d7.1528a",
                "daef5479.c6aa18"
            ]
        ]
    },
    {
        "id": "14771b32.59bf25",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/Escaleras/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1278.4948959350586,
        "y": 907.3686656951904,
        "wires": [
            [
                "f248f0d7.1528a",
                "daef5479.c6aa18"
            ]
        ]
    },
    {
        "id": "f248f0d7.1528a",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.topic.includes(\"desconectado\") || msg.topic.includes(\"Desconectado\")){\n    global.set(\"estado-Escaleras\", global.get(\"fechaCompleta\") + \" - Desc\\n\");\n    node.send(msg);}\nif (msg.topic.includes(\"Inicio\")){\n    global.set(\"estado-Escaleras\", global.get(\"fechaCompleta\") + \" - Con\\n\");\n    node.send(msg);}    \n    \n    node.status({text: global.get(\"estado-Escaleras\")});      ",
        "outputs": 1,
        "noerr": 0,
        "x": 1505.75,
        "y": 867.27783203125,
        "wires": [
            [
                "6e57dcc9.a5e0a4"
            ]
        ]
    },
    {
        "id": "daef5479.c6aa18",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "var dato;\nif (msg.topic == \"ESP/Escaleras/Desconectado\"){\n    dato = global.get(\"fechaCompleta\") + \" Desc\\n\";\n    node.status({text: dato});\n    msg = {topic: \"notifyBlynk\", payload: dato}; node.send([null, msg]);\n    // msg.payload = dato;\n}\nif (msg.topic == \"ESP/Escaleras/Inicio\"){\n    dato = global.get(\"fechaCompleta\") + \" Con:\" + msg.payload + \"\\n\";\n    node.status({text: dato});\n    // msg.payload = dato;\n}\nmsg.payload= dato; node.send([msg, null]);\n\n\n",
        "outputs": 2,
        "noerr": 0,
        "x": 1511.75,
        "y": 922.27783203125,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "9f24f44c.804238",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Escaleras/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 232.5,
        "y": 737.5000114440918,
        "wires": [
            [
                "78364cb0.17f444",
                "76ef6fe0.34343"
            ]
        ]
    },
    {
        "id": "9ac2864c.0400c8",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 871.25,
        "y": 833.75,
        "wires": [
            [
                "f69c90d0.d0de9"
            ]
        ]
    },
    {
        "id": "f69c90d0.d0de9",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "node.status({text: global.get(\"estadoPatioLuz\") + \"-\" + global.get(\"bombaCascada\")})",
        "outputs": 1,
        "noerr": 0,
        "x": 1052.5,
        "y": 816.25,
        "wires": [
            []
        ]
    },
    {
        "id": "7f59ce8c.73eb3",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "var dato;\nif (msg.topic == \"ESP/TanqueAgua2/Desconectado\"){\n    dato = global.get(\"fechaCompleta\") + \" tanque agua2 Desc\\n\";\n    node.status({text: dato});\n    msg = {topic: \"notifyBlynk\", payload: dato}; node.send([null, msg]);\n    msg = {topic: \"terminalBlynk\", payload: dato}; node.send([null, msg]);\n    // msg.payload = dato;\n}\nif (msg.topic == \"ESP/TanqueAgua2/Inicio\"){\n    dato = global.get(\"fechaCompleta\") + \" TANQUE AGUA 2 CON\\n\";\n    node.status({text: dato});\n    msg = {topic: \"notifyBlynk\", payload: dato}; node.send([null, msg]);\n    msg = {topic: \"terminalBlynk\", payload: dato}; node.send([null, msg]);\n    // msg.payload = dato;\n}\n\n\n\n",
        "outputs": 2,
        "noerr": 0,
        "x": 1885.0000267028809,
        "y": 862.5000133514404,
        "wires": [
            [],
            [
                "de20f11c.46b02"
            ]
        ]
    },
    {
        "id": "4b010795.4708e8",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/TanqueAgua2/Desconectado",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1862.5000305175781,
        "y": 925.000014025718,
        "wires": [
            [
                "7f59ce8c.73eb3"
            ]
        ]
    },
    {
        "id": "e31cdb2b.f6d618",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/TanqueAgua2/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1835.0000305175781,
        "y": 976.2500143051147,
        "wires": [
            [
                "7f59ce8c.73eb3"
            ]
        ]
    },
    {
        "id": "61e3757c.254a4c",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "informarPotencia NO",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "informarPotencia0",
        "payloadType": "str",
        "x": 1256.5,
        "y": 682,
        "wires": [
            [
                "2e5de58d.140b0a"
            ]
        ]
    },
    {
        "id": "cee40f34.bf39f",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "informarPotencia SI",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "informarPotencia1",
        "payloadType": "str",
        "x": 1242,
        "y": 730,
        "wires": [
            [
                "2e5de58d.140b0a"
            ]
        ]
    },
    {
        "id": "2e5de58d.140b0a",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Escaleras/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1466,
        "y": 717,
        "wires": []
    },
    {
        "id": "3e9fc88.18c9d38",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Escaleras/Potencia",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1350.5,
        "y": 794,
        "wires": [
            [
                "cb36afed.561df"
            ]
        ]
    },
    {
        "id": "cb36afed.561df",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1578.5,
        "y": 780,
        "wires": []
    },
    {
        "id": "e285a915.ed7f58",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "reset escaleras",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "reset",
        "payloadType": "str",
        "x": 1242,
        "y": 645,
        "wires": [
            [
                "2e5de58d.140b0a"
            ]
        ]
    },
    {
        "id": "ee77c130.c4242",
        "type": "inject",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#0#0#1",
        "payloadType": "str",
        "x": 638,
        "y": 201,
        "wires": [
            [
                "1630aa8e.d3f535"
            ]
        ]
    },
    {
        "id": "1630aa8e.d3f535",
        "type": "mqtt out",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "topic": "ESP/Escaleras/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 924,
        "y": 242.33333333333331,
        "wires": []
    },
    {
        "id": "7631fb1d.77a704",
        "type": "inject",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#0#25#1",
        "payloadType": "str",
        "x": 636.5,
        "y": 248,
        "wires": [
            [
                "1630aa8e.d3f535"
            ]
        ]
    },
    {
        "id": "aaed8396.2ed6b",
        "type": "inject",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#0#50#1",
        "payloadType": "str",
        "x": 642.5,
        "y": 285,
        "wires": [
            [
                "1630aa8e.d3f535"
            ]
        ]
    },
    {
        "id": "d1cf5b47.0b9a98",
        "type": "inject",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#0#75#1",
        "payloadType": "str",
        "x": 652,
        "y": 330,
        "wires": [
            [
                "1630aa8e.d3f535"
            ]
        ]
    },
    {
        "id": "e1a6b377.10614",
        "type": "inject",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado50#0#0#0#1",
        "payloadType": "str",
        "x": 651,
        "y": 383,
        "wires": [
            [
                "1630aa8e.d3f535"
            ]
        ]
    },
    {
        "id": "65eb2c8.4d79fd4",
        "type": "inject",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#100#0#1",
        "payloadType": "str",
        "x": 227,
        "y": 155,
        "wires": [
            [
                "ed0921c.44ba6e"
            ]
        ]
    },
    {
        "id": "7e291c1f.b76b94",
        "type": "inject",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#0#100#1",
        "payloadType": "str",
        "x": 229,
        "y": 191,
        "wires": [
            [
                "ed0921c.44ba6e"
            ]
        ]
    },
    {
        "id": "8c88904f.94361",
        "type": "mqtt in",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "topic": "ESP/Escaleras/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 513,
        "y": 50,
        "wires": [
            [
                "306e7716.d97e98"
            ]
        ]
    },
    {
        "id": "306e7716.d97e98",
        "type": "debug",
        "z": "a27bf9ec.e6e2f8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 704.5,
        "y": 39,
        "wires": []
    },
    {
        "id": "46476559.6e260c",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "if (global.get(\"estTopeCascada\") === undefined)global.set(\"estTopeCascada\", 0);\nif (global.get(\"estMitadCascada\") === undefined)global.set(\"estMitadCascada\", 0);\nif (global.get(\"estPiletaCascada\") === undefined)global.set(\"estPiletaCascada\", 0);\nif (global.get(\"estPalioLuz\") === undefined)global.set(\"estPalioLuz\", 0);\nif (global.get(\"estLuzCascada\") === undefined)global.set(\"estLuzCascada\", 0);\n\nif (global.get(\"estEscaleras\") === undefined)global.set(\"estEscaleras\", 0);\nif (global.get(\"pwmEscaleras\") === undefined)global.set(\"pwmEscaleras\", 0);\nif (global.get(\"estReflectorPergola\") === undefined)global.set(\"estReflectorPergola\", 0);\nif (global.get(\"pwmReflectorPergola\") === undefined)global.set(\"pwmReflectorPergola\", 0);\nif (global.get(\"estLucesPergola\") === undefined)global.set(\"estLucesPergola\", 0);\nif (global.get(\"pwmLucesPergola\") === undefined)global.set(\"pwmLucesPergola\", 0);\nif (global.get(\"estLucesPasadaAuto\") === undefined)global.set(\"estLucesPasadaAuto\", 0);\nif (global.get(\"pwmLucesPasadaAuto\") === undefined)global.set(\"pwmLucesPasadaAuto\", 0);\n\n// var topicOriginal = msg.topic\n\n\nvar pin = parseInt(msg.pin);\nvar intPayload = parseInt(msg.payload);\nvar topic = msg.topic;\nvar dato;\n\nif (msg.topic == \"crepMQTT\"){\n  if (parseInt(global.get(\"Dia\")) === 1){\n      global.set(\"estLuzCascada\", 0);\n      global.set(\"estTopeCascada\", 0); \n      global.set(\"estMitadCascada\", 0);\n      global.set(\"estPiletaCascada\", 0); \n      enviarMQTT(\"patioLuz\");\n      global.set(\"estEscaleras\", 0);\n      global.set(\"estReflectorPergola\", 0);\n      global.set(\"estLucesPergola\", 0);\n      global.set(\"estLucesPasadaAuto\", 0);\n      enviarMQTT(\"escaleras\");\n  }\n  if (parseInt(global.get(\"Dia\")) === 0){\n      global.set(\"estLuzCascada\", 1);\n      global.set(\"estTopeCascada\", 1); \n      global.set(\"estMitadCascada\", 1);\n      global.set(\"estPiletaCascada\", 1); \n      enviarMQTT(\"patioLuz\"); \n      global.set(\"estEscaleras\", 1); \n      // global.set(\"estReflectorPergola\", 1);\n      // global.set(\"pwmReflectorPergola\", 5);\n      global.set(\"estLucesPergola\", 1);\n      // global.set(\"pwmLucesPergola\", 10);      \n      global.set(\"estLucesPasadaAuto\", 1);\n      // global.set(\"pwmLucesPasadaAuto\", 100);\n      enviarMQTT(\"escaleras\");\n  }  \n  return;\n}\n\nif (msg.topic == \"PatioLuz/Inicio\"){\n    enviarMQTT(\"patioLuz\"); \n    return;    \n}\n\nif (msg.topic == \"ESP/Escaleras/Inicio\"){\n    enviarMQTT(\"escaleras\"); \n    return;    \n}\n\n// node.status({text: context.item});\n\nswitch (pin){\n  case 8:\n    switch (parseInt(context.item)){\n        case 4:\n            global.set(\"IslaR\", msg.arrayOfValues[0]);\n            global.set(\"IslaG\", msg.arrayOfValues[1]);\n            global.set(\"IslaB\", msg.arrayOfValues[2]);\n            // msg = {pin: 32, payload: \"12\"}; node.send([null, msg]);\n            global.set(\"estIslaRGB\", 1);\n            enviarMQTT(\"living\");\n            return;\n        break;\n        case 6:\n            global.set(\"topeCascadaR\", msg.arrayOfValues[0]); global.set(\"mitadCascadaR\", msg.arrayOfValues[0]); global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"topeCascadaG\", msg.arrayOfValues[1]); global.set(\"mitadCascadaG\", msg.arrayOfValues[1]); global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"topeCascadaB\", msg.arrayOfValues[2]); global.set(\"mitadCascadaB\", msg.arrayOfValues[2]); global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\");\n            return;\n        break;\n        case 7:\n            global.set(\"topeCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"topeCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"topeCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\");\n            return;\n        break;\n        case 8:\n            global.set(\"mitadCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"mitadCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"mitadCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\");\n            return;\n        break;\n        case 9:\n            global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\"); \n            return;\n        break;          \n    }  \n\n  case 18:\n    global.set(\"itemPotencia\", msg.payload);\n    // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n      context.item = parseInt(msg.payload);\n      node.status({text: context.item + \" - \" + msg.payload});\n      switch(parseInt(msg.payload)){\n          case 1:\n              msg = {pin: 19, min: 0, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n          break;\n          case 2:\n              msg = {pin: 19, min: 0, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n          break;\n          case 3:\n              msg = {pin: 19, min: 0, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n          break;\n          case 4:\n              msg = {pin: 19, min: 0, max: 255, label: \"Led Living\", payload: global.get(\"ledLiving\")};\n          break;\n          case 5:\n              msg = {pin: 21, label: \"Luz Casc\", payload: global.get(\"estLuzCascada\")}; node.send([null, msg]);\n              msg = {pin: 21, label: \"Patio Luz\", payload: global.get(\"estPalioLuz\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 70, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n          break; \n          case 6:\n              msg = {pin: 19, min: 0, max: 255, label: \"Cascada Completa\", payload: global.get(\"ledTopeCascada\")};\n          break;              \n          case 7:\n              msg = {pin: 21, label: \"Top Casc\", payload: global.get(\"estTopeCascada\")}; node.send([null, msg]);\n              msg = {pin: 24, label: \"Top Casc\", payload: global.get(\"modoLed3Cascada\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 0, max: 255, label: \"Tope Cascada\", payload: global.get(\"ledTopeCascada\")}; node.send([null, msg]);\n              return;\n          break; \n          case 8:\n              msg = {pin: 21, label: \"Mit Casc\", payload: global.get(\"estMitadCascada\")}; node.send([null, msg]);\n              msg = {pin: 24, label: \"Mit Casc\", payload: global.get(\"modoLed1Cascada\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 0, max: 255, label: \"Mitad Cascada\", payload: global.get(\"ledMitadCascada\")}; node.send([null, msg]);\n              return;\n          break; \n          case 9:\n              msg = {pin: 21, label: \"Pil Casc\", payload: global.get(\"estPiletaCascada\")}; node.send([null, msg]);\n              msg = {pin: 24, label: \"Pil Casc\", payload: global.get(\"modoLed2Cascada\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 0, max: 255, label: \"Pileta Cascada\", payload: global.get(\"ledPiletaCascada\")}; node.send([null, msg]);\n              return;\n          break;      \n          case 10:\n              msg = {pin: 19, min: 1, max: 100, label: \"Ducha de bano\", payload: global.get(\"pwmDucha\")};\n          break;     \n          case 11:\n              msg = {pin: 19, min: 1, max: 100, label: \"Luz Bano\", payload: global.get(\"pwmLuzBano\")};\n          break;\n          case 12:\n              msg = {pin: 21, label: \"Escaleras\", payload: global.get(\"estEscaleras\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Pot Escaleras\", payload: global.get(\"pwmEscaleras\")};\n          break;     \n          case 13:\n              msg = {pin: 21, label: \"Refl Perg\", payload: global.get(\"estReflectorPergola\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Ref Pergola\", payload: global.get(\"pwmReflectorPergola\")};\n          break;                \n          case 14:\n              msg = {pin: 21, label: \"Luces Perg\", payload: global.get(\"estLucesPergola\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Luces Pergola\", payload: global.get(\"pwmLucesPergola\")};\n          break;  \n          case 15:\n              msg = {pin: 21, label: \"Luces Pasada Auto\", payload: global.get(\"estLucesPasadaAuto\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Luces Pas Auto\", payload: global.get(\"pwmLucesPasadaAuto\")};\n          break;            \n          case 16:\n              msg = {pin: 19, min: 15, max: 240, label: \"timer extractor baño\", payload: global.get(\"timerExtractorBano\")};\n          break;          \n          case 17:\n              msg = {pin: 19, min: 10, max: 100, label: \"tiempo MIN teclas\", payload: global.get(\"minTeclas\")};\n          break;       \n          case 18:\n              msg = {pin: 19, min: 400, max: 2000, label: \"tiempo MAX teclas\", payload: global.get(\"maxTeclas\")};\n          break;   \n          case 19:\n              msg = {pin: 19, min: 1, max: 100, label: \"delay buzzer\", payload: global.get(\"delayBuzzer\")};\n          break;                              \n      }\n      node.send([null, msg]);\n      return;\n    // }\n  break;\n\n  case 19:\n    // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n      var valor = parseInt(msg.payload);\n      switch(context.item){\n          case 1:\n              // if (global.get(\"estLiving\") === 0)return;\n              global.set(\"potLiving\", valor);\n              global.set(\"potIsla\", valor);\n              global.set(\"potCielorrazo\", valor);\n              global.set(\"ledLiving\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 2:\n              // if (global.get(\"estIsla\") === 0)return;\n              global.set(\"potIsla\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 3:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"potCielorrazo\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 4:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"ledLiving\", valor);\n              global.set(\"IslaR\", valor);\n              global.set(\"IslaG\", valor);\n              global.set(\"IslaB\", valor);\n              msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"living\");\n          break;          \n          case 5:\n              // if (global.get(\"Dia\") === 1)return;\n              global.set(\"pwmPatioLuz\", valor);\n              enviarMQTT(\"patioLuz\");\n              return;\n          case 6:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"topeCascadaR\", valor);\n              global.set(\"topeCascadaG\", valor);\n              global.set(\"topeCascadaB\", valor);\n              global.set(\"mitadCascadaR\", valor);\n              global.set(\"mitadCascadaG\", valor);\n              global.set(\"mitadCascadaB\", valor);\n              global.set(\"piletaCascadaR\", valor);\n              global.set(\"piletaCascadaG\", valor);\n              global.set(\"piletaCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break;               \n          case 7:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"topeCascadaR\", valor);\n              global.set(\"topeCascadaG\", valor);\n              global.set(\"topeCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break; \n          case 8:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"mitadCascadaR\", valor);\n              global.set(\"mitadCascadaG\", valor);\n              global.set(\"mitadCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break; \n          case 9:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"piletaCascadaR\", valor);\n              global.set(\"piletaCascadaG\", valor);\n              global.set(\"piletaCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break;                                   \n          case 10:\n              // if (global.get(\"estDucha\") === 0)return;  \n              global.set(\"pwmDucha\", valor);\n              enviarMQTT(\"bano\");\n              return;\n          case 11:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLuzBano\", valor);\n              enviarMQTT(\"bano\");\n              return;  \n          case 12:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmEscaleras\", valor);\n              enviarMQTT(\"escaleras\");\n              return;  \n          case 13:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmReflectorPergola\", valor);\n              enviarMQTT(\"escaleras\");\n              return;\n          case 14:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLucesPergola\", valor);\n              enviarMQTT(\"escaleras\");\n              return; \n          case 15:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLucesPasadaAuto\", valor);\n              enviarMQTT(\"escaleras\");\n              return;                             \n          case 16:\n              global.set(\"timerExtractorBano\", valor);\n              enviarMQTT(\"bano\");\n              return;\n          case 17:\n              global.set(\"minTeclas\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;     \n          case 18:\n              global.set(\"maxTeclas\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;              \n          case 19:  \n              global.set(\"delayBuzzer\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;              \n            }  \n          break;\n  case 21:\n  // node.status({text: context.item + \" - \" + msg.payload});\n    switch(context.item){\n      case 5:\n        global.set(\"estPalioLuz\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 6:\n        global.set(\"estLuzCascada\", msg.payload);\n        global.set(\"estTopeCascada\", msg.payload);\n        global.set(\"estMitadCascada\", msg.payload);\n        global.set(\"estPiletaCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;      \n      case 7:\n        global.set(\"estTopeCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 8:\n        global.set(\"estMitadCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 9:\n        global.set(\"estPiletaCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 12:\n        global.set(\"estEscaleras\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;\n      case 13:\n        global.set(\"estReflectorPergola\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;     \n      case 14:\n        global.set(\"estLucesPergola\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;  \n      case 15:\n        global.set(\"estLucesPasadaAuto\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;                     \n      break;      \n    }\n  break;\n  case 22:\n      global.set(\"bombaCascada\", parseInt(msg.payload));\n      // if (parseInt(msg.payload) === 0 && parseInt(global.get(\"Dia\")) === 0){\n      //   msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#\" + global.get(\"pwmPatioLuz\") + \"#0#0#1#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\")};      \n      // }\n      mensaje = \"bomba\" + global.get(\"bombaCascada\");\n      msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n      node.send([msg, null]);\n      return;\n  case 24:\n      switch(context.item){\n        case 7:\n          global.set(\"modoLed3Cascada\", msg.payload);\n          enviarMQTT(\"patioLuz\"); \n          return;\n        break;\n        case 8:\n          global.set(\"modoLed1Cascada\", msg.payload);\n          enviarMQTT(\"patioLuz\"); \n          return;\n        break;\n        case 9:\n          global.set(\"modoLed2Cascada\", msg.payload);\n          enviarMQTT(\"patioLuz\"); \n          return;\n      break;\n    //   global.set(\"modoLed1Cascada\", parseInt(msg.payload));\n    //   enviarMQTT(\"patioLuz\");\n      return;\n    }\n  // case 24:\n  //     global.set(\"modoLed2Cascada\", parseInt(msg.payload));\n  //     enviarMQTT(\"patioLuz\");\n  //     return;\n  // case 25:\n  //     global.set(\"modoLed3Cascada\", parseInt(msg.payload));\n  //     enviarMQTT(\"patioLuz\");\n  //     return;\n}\n\nfunction enviarMQTT(caso){\nvar dato;\n  if (caso == \"bano\"){\n  dato = global.get(\"estLuzBano\") + \"#\" + global.get(\"pwmLuzBano\") + \"#\" + global.get(\"modoDucha\") + \"#\" + global.get(\"estDucha\") + \"#\" + global.get(\"pwmDucha\");\n  dato += \"#\" + global.get(\"estLuzEspejo\") + \"#\" + global.get(\"estExtractorBano\") + \"#\" + global.get(\"timerExtractorBano\") + \"#\" + global.get(\"Dia\");\n    msg = {topic: \"ESP/Bano/Recibo\", payload: dato};\n  }\n\n  if (caso == \"escaleras\"){\n      if (parseInt(global.get(\"estReflectorPergola\")) === 1){\n         dato = \"estado\" + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estReflectorPergola\")) === 0){\n         dato = \"estado0\";//#0#0#0#0#0#1\";\n      }\n      dato = dato + \"#\";\n      if (parseInt(global.get(\"estEscaleras\")) === 1){\n         // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n         dato = dato + global.get(\"pwmEscaleras\");\n         // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estEscaleras\")) === 0){\n         dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n      }    \n      dato = dato + \"#\";\n      if (parseInt(global.get(\"estLucesPergola\")) === 1){\n         // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n         dato = dato + global.get(\"pwmLucesPergola\");\n         // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estLucesPergola\")) === 0){\n         dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n      }   \n      dato = dato + \"#\";\n      if (parseInt(global.get(\"estLucesPasadaAuto\")) === 1){\n         // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n         dato = dato + global.get(\"pwmLucesPasadaAuto\");\n         // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estLucesPasadaAuto\")) === 0){\n         dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n      } \n      dato = dato + \"#1\";                \n//estado10#0#0#0#0#0#1\n\n       msg = {topic: \"ESP/Escaleras/Recibo\", payload: dato};\n  }  \n\nif (caso == \"patioLuz\"){\n    var mensaje;\n    if (parseInt(global.get(\"estMitadCascada\")) === 0){\n      mensaje = \"estado0#0#0#0#\";\n    }\n      else{\n        mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\";\n      }\n\n    if (parseInt(global.get(\"estPalioLuz\")) === 0){\n      mensaje = mensaje + \"0#0#\";\n    }\n      else{\n        mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n      }      \n\n    // mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n\n    if (parseInt(global.get(\"estPiletaCascada\")) === 0){\n      mensaje = mensaje + \"0#0#0#0#\";\n    }\n      else{\n         mensaje = mensaje + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n      }\n\n    if (parseInt(global.get(\"estTopeCascada\")) === 0){\n      mensaje = mensaje + \"0#0#0#0#\";\n    }\n      else{\n         mensaje = mensaje + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n      }\n\n    mensaje = mensaje + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\");\n\n    // if (parseInt(global.get(\"Dia\")) === 1){\n    //     msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#0#0#0#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\") + \"#\" + global.get(\"maxAuto\")};\n    //   } \n    //   else{   \n    //     msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n    //   }\n    msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n\n    //1#1023#32#118#118#118#0#1#1#undefined#45#45#45#0#181\n  }\n  \n\n  if (caso == \"living\"){\n    dato = global.get(\"estIsla\") + \",\";\n    dato += global.get(\"potIsla\") + \"#\";\n    dato += global.get(\"estCielorrazo\") + \",\";\n    dato += global.get(\"potCielorrazo\") + \"#\";  \n    dato += global.get(\"estIslaRGB\") + \",\";\n    dato += global.get(\"IslaR\") + \",\";\n    dato += global.get(\"IslaG\") + \",\";      \n    dato += global.get(\"IslaB\") + \"#\";\n\n    dato += global.get(\"pwmMaxLed\") + \"#\";\n    dato += global.get(\"pwmMinLed\") + \"#\";\n\n    dato += global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"doblePuls\");\n    dato += \"#\" + global.get(\"Dia\");\n\n    msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n    node.send([msg, null]);\n  }\n  if (caso == \"configGenericas\"){\n    dato = global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"delayBuzzer\");\n    msg = {topic: \"configTeclas\", payload: dato};\n  }\n\nnode.send([msg, null]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 85,
        "y": 443,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "8446c248.f9eb2",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": "60",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 316,
        "y": 928,
        "wires": [
            [
                "52bb7a36.4a4e94"
            ]
        ]
    },
    {
        "id": "66ea8700.1becb8",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": "61",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 316,
        "y": 969,
        "wires": [
            [
                "52bb7a36.4a4e94"
            ]
        ]
    },
    {
        "id": "52bb7a36.4a4e94",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "",
        "func": "var pin = msg.pin;\nvar payload = msg.payload;\n\nif (global.get(\"estLucesBarraCocina\") === undefined)global.set(\"estLucesBarraCocina\", 0);\nif (global.get(\"estLuzCocina\") === undefined)global.set(\"estLuzCocina\", 0);\n\nif (msg.topic == \"ESP/Cocina/Inicio\"){\n    enviarMQTT(); \n    return;    \n}\n\nif (msg.topic == \"ESP/Cocina/Envio\"){\n    var dato = payload.split(\"#\");\n    global.set(\"estLucesBarraCocina\", parseInt(dato[0]));\n    global.set(\"estLuzCocina\", parseInt(dato[1]));\n    enviarBlynk(); \n    return;    \n}\n\nswitch (parseInt(pin)){\n    case 61:\n        global.set(\"estLuzCocina\", parseInt(payload));\n        break;    \n    case 60:\n        global.set(\"estLucesBarraCocina\", parseInt(payload));\n        break;\n}\nenviarMQTT();\nreturn;\n\nfunction enviarMQTT(){\n    msg = {pin: 60, payload: global.get(\"estLucesBarraCocina\")}; node.send([null, msg]);\n    msg = {pin: 61, payload: global.get(\"estLuzCocina\")}; node.send([null, msg]);    \n    dato = \"estado\" + global.get(\"estLucesBarraCocina\") + \"#\" + global.get(\"estLuzCocina\");\n    dato = dato + \"#\" + global.get(\"minTeclas\") + \"#\" + global.get(\"maxTeclas\");\n    // dato = dato + \"#200\" + \"#\" + global.get(\"maxTeclas\");\n    msg = {topic: \"ESP/Cocina/Recibo\", payload: dato};\n    node.send([msg, null]);\n  } \n  \nfunction enviarBlynk(){\n    msg = {pin: 60, payload: global.get(\"estLucesBarraCocina\")}; node.send([null, msg]);\n    msg = {pin: 61, payload: global.get(\"estLuzCocina\")}; node.send([null, msg]);\n  }   \n  ",
        "outputs": 2,
        "noerr": 0,
        "x": 505.5,
        "y": 944,
        "wires": [
            [
                "7b6d19d4.be33f8",
                "498bb257.eca9bc",
                "b5adb9a8.a255b8"
            ],
            [
                "16383dac.fbfbc2",
                "129c7fcb.724a4"
            ]
        ]
    },
    {
        "id": "b5adb9a8.a255b8",
        "type": "mqtt out",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 676.5,
        "y": 954,
        "wires": []
    },
    {
        "id": "7b6d19d4.be33f8",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 643.5,
        "y": 902,
        "wires": []
    },
    {
        "id": "cbeb8783.ed1098",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "if (global.get(\"estTopeCascada\") === undefined)global.set(\"estTopeCascada\", 0);\nif (global.get(\"estMitadCascada\") === undefined)global.set(\"estMitadCascada\", 0);\nif (global.get(\"estPiletaCascada\") === undefined)global.set(\"estPiletaCascada\", 0);\nif (global.get(\"estPalioLuz\") === undefined)global.set(\"estPalioLuz\", 0);\nif (global.get(\"estLuzCascada\") === undefined)global.set(\"estLuzCascada\", 0);\n\nif (global.get(\"estEscaleras\") === undefined)global.set(\"estEscaleras\", 0);\nif (global.get(\"pwmEscaleras\") === undefined)global.set(\"pwmEscaleras\", 0);\nif (global.get(\"estReflectorPergola\") === undefined)global.set(\"estReflectorPergola\", 0);\nif (global.get(\"pwmReflectorPergola\") === undefined)global.set(\"pwmReflectorPergola\", 0);\nif (global.get(\"estLucesPergola\") === undefined)global.set(\"estLucesPergola\", 0);\nif (global.get(\"pwmLucesPergola\") === undefined)global.set(\"pwmLucesPergola\", 0);\nif (global.get(\"estLucesPasadaAuto\") === undefined)global.set(\"estLucesPasadaAuto\", 0);\nif (global.get(\"pwmLucesPasadaAuto\") === undefined)global.set(\"pwmLucesPasadaAuto\", 0);\n\nif (global.get(\"estLucesBarraCocina\") === undefined)global.set(\"estLucesBarraCocina\", 0);\nif (global.get(\"estLuzCocina\") === undefined)global.set(\"estLuzCocina\", 0);\n\n// var topicOriginal = msg.topic\n\n\nvar pin = parseInt(msg.pin);\nvar intPayload = parseInt(msg.payload);\nvar topic = msg.topic;\nvar dato;\n\nif (msg.topic == \"crepMQTT\"){\n  if (parseInt(global.get(\"Dia\")) === 1){\n      global.set(\"estLuzCascada\", 0);\n      global.set(\"estTopeCascada\", 0); \n      global.set(\"estMitadCascada\", 0);\n      global.set(\"estPiletaCascada\", 0); \n      enviarMQTT(\"patioLuz\");\n      global.set(\"estEscaleras\", 0);\n      global.set(\"estReflectorPergola\", 0);\n      global.set(\"estLucesPergola\", 0);\n      global.set(\"estLucesPasadaAuto\", 0);\n      enviarMQTT(\"escaleras\");\n  }\n  if (parseInt(global.get(\"Dia\")) === 0){\n      global.set(\"estLuzCascada\", 1);\n      global.set(\"estTopeCascada\", 1); \n      global.set(\"estMitadCascada\", 1);\n      global.set(\"estPiletaCascada\", 1); \n      enviarMQTT(\"patioLuz\"); \n      global.set(\"estEscaleras\", 1); \n      // global.set(\"estReflectorPergola\", 1);\n      // global.set(\"pwmReflectorPergola\", 5);\n      global.set(\"estLucesPergola\", 1);\n      // global.set(\"pwmLucesPergola\", 10);      \n      global.set(\"estLucesPasadaAuto\", 1);\n      // global.set(\"pwmLucesPasadaAuto\", 100);\n      enviarMQTT(\"escaleras\");\n  }  \n  return;\n}\n\nif (msg.topic == \"PatioLuz/Inicio\"){\n    enviarMQTT(\"patioLuz\"); \n    return;    \n }\n\n\nif (msg.topic == \"PatioLuz/Inicio\"){\n    enviarMQTT(\"patioLuz\"); \n    return;    \n}\n\nif (msg.topic == \"ESP/Cocina/Inicio\"){\n    enviarMQTT(\"cocina\"); \n    return;    \n}\n\n// node.status({text: context.item});\n\nswitch (pin){\n  case 8:\n    switch (parseInt(context.item)){\n        case 4:\n            global.set(\"IslaR\", msg.arrayOfValues[0]);\n            global.set(\"IslaG\", msg.arrayOfValues[1]);\n            global.set(\"IslaB\", msg.arrayOfValues[2]);\n            // msg = {pin: 32, payload: \"12\"}; node.send([null, msg]);\n            global.set(\"estIslaRGB\", 1);\n            enviarMQTT(\"living\");\n            return;\n        break;\n        case 6:\n            global.set(\"topeCascadaR\", msg.arrayOfValues[0]); global.set(\"mitadCascadaR\", msg.arrayOfValues[0]); global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"topeCascadaG\", msg.arrayOfValues[1]); global.set(\"mitadCascadaG\", msg.arrayOfValues[1]); global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"topeCascadaB\", msg.arrayOfValues[2]); global.set(\"mitadCascadaB\", msg.arrayOfValues[2]); global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\");\n            return;\n        break;\n        case 7:\n            global.set(\"topeCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"topeCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"topeCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\");\n            return;\n        break;\n        case 8:\n            global.set(\"mitadCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"mitadCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"mitadCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\");\n            return;\n        break;\n        case 9:\n            global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\"); \n            return;\n        break;          \n    }  \n\n  case 18:\n    global.set(\"itemPotencia\", msg.payload);\n    // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n      context.item = parseInt(msg.payload);\n      node.status({text: context.item + \" - \" + msg.payload});\n      switch(parseInt(msg.payload)){\n          case 1:\n              msg = {pin: 19, min: 0, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n          break;\n          case 2:\n              msg = {pin: 19, min: 0, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n          break;\n          case 3:\n              msg = {pin: 19, min: 0, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n          break;\n          case 4:\n              msg = {pin: 19, min: 0, max: 255, label: \"Led Living\", payload: global.get(\"ledLiving\")};\n          break;\n          case 5:\n              msg = {pin: 21, label: \"Luz Cocina\", payload: global.get(\"estLuzCocina\")}; node.send([null, msg]);\n          break;\n          case 6:\n              msg = {pin: 21, label: \"Luces Barra Cocina\", payload: global.get(\"estLucesBarraCocina\")}; node.send([null, msg]);\n          break;      \n          case 7:\n              // msg = {pin: 21, label: \"Luz Casc\", payload: global.get(\"estLuzCascada\")}; node.send([null, msg]);\n              msg = {pin: 21, label: \"Patio Luz\", payload: global.get(\"estPalioLuz\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 70, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n          break; \n          case 8:\n              msg = {pin: 19, min: 0, max: 255, label: \"Cascada Completa\", payload: global.get(\"ledTopeCascada\")};\n          break;              \n          case 9:\n              msg = {pin: 21, label: \"Top Casc\", payload: global.get(\"estTopeCascada\")}; node.send([null, msg]);\n              msg = {pin: 24, label: \"Top Casc\", payload: global.get(\"modoLed3Cascada\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 0, max: 255, label: \"Tope Cascada\", payload: global.get(\"ledTopeCascada\")}; node.send([null, msg]);\n              return;\n          break; \n          case 10:\n              msg = {pin: 21, label: \"Mit Casc\", payload: global.get(\"estMitadCascada\")}; node.send([null, msg]);\n              msg = {pin: 24, label: \"Mit Casc\", payload: global.get(\"modoLed1Cascada\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 0, max: 255, label: \"Mitad Cascada\", payload: global.get(\"ledMitadCascada\")}; node.send([null, msg]);\n              return;\n          break; \n          case 11:\n              msg = {pin: 21, label: \"Pil Casc\", payload: global.get(\"estPiletaCascada\")}; node.send([null, msg]);\n              msg = {pin: 24, label: \"Pil Casc\", payload: global.get(\"modoLed2Cascada\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 0, max: 255, label: \"Pileta Cascada\", payload: global.get(\"ledPiletaCascada\")}; node.send([null, msg]);\n              return;\n          break;      \n          case 12:\n              msg = {pin: 19, min: 1, max: 100, label: \"Ducha de bano\", payload: global.get(\"pwmDucha\")};\n          break;     \n          case 13:\n              msg = {pin: 19, min: 1, max: 100, label: \"Luz Bano\", payload: global.get(\"pwmLuzBano\")};\n          break;\n          case 14:\n              msg = {pin: 21, label: \"Escaleras\", payload: global.get(\"estEscaleras\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Pot Escaleras\", payload: global.get(\"pwmEscaleras\")};\n          break;     \n          case 15:\n              msg = {pin: 21, label: \"Refl Perg\", payload: global.get(\"estReflectorPergola\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Ref Pergola\", payload: global.get(\"pwmReflectorPergola\")};\n          break;                \n          case 16:\n              msg = {pin: 21, label: \"Luces Perg\", payload: global.get(\"estLucesPergola\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Luces Pergola\", payload: global.get(\"pwmLucesPergola\")};\n          break;  \n          case 17:\n              msg = {pin: 21, label: \"Luces Pasada Auto\", payload: global.get(\"estLucesPasadaAuto\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Luces Pas Auto\", payload: global.get(\"pwmLucesPasadaAuto\")};\n          break;            \n          case 18:\n              msg = {pin: 19, min: 15, max: 240, label: \"timer extractor baño\", payload: global.get(\"timerExtractorBano\")};\n          break;          \n          case 19:\n              msg = {pin: 19, min: 10, max: 100, label: \"tiempo MIN teclas\", payload: global.get(\"minTeclas\")};\n          break;       \n          case 20:\n              msg = {pin: 19, min: 400, max: 2000, label: \"tiempo MAX teclas\", payload: global.get(\"maxTeclas\")};\n          break;   \n          case 21:\n              msg = {pin: 19, min: 1, max: 100, label: \"delay buzzer\", payload: global.get(\"delayBuzzer\")};\n          break;                              \n      }\n      node.send([null, msg]);\n      return;\n    // }\n  break;\n\n  case 19:\n    // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n      var valor = parseInt(msg.payload);\n      switch(context.item){\n          case 1:\n              // if (global.get(\"estLiving\") === 0)return;\n              global.set(\"potLiving\", valor);\n              global.set(\"potIsla\", valor);\n              global.set(\"potCielorrazo\", valor);\n              global.set(\"ledLiving\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 2:\n              // if (global.get(\"estIsla\") === 0)return;\n              global.set(\"potIsla\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 3:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"potCielorrazo\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 4:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"ledLiving\", valor);\n              global.set(\"IslaR\", valor);\n              global.set(\"IslaG\", valor);\n              global.set(\"IslaB\", valor);\n              msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"living\");\n          break;          \n          case 5:\n              // if (global.get(\"Dia\") === 1)return;\n              global.set(\"pwmPatioLuz\", valor);\n              enviarMQTT(\"patioLuz\");\n              return;\n          case 6:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"topeCascadaR\", valor);\n              global.set(\"topeCascadaG\", valor);\n              global.set(\"topeCascadaB\", valor);\n              global.set(\"mitadCascadaR\", valor);\n              global.set(\"mitadCascadaG\", valor);\n              global.set(\"mitadCascadaB\", valor);\n              global.set(\"piletaCascadaR\", valor);\n              global.set(\"piletaCascadaG\", valor);\n              global.set(\"piletaCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break;               \n          case 7:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"topeCascadaR\", valor);\n              global.set(\"topeCascadaG\", valor);\n              global.set(\"topeCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break; \n          case 8:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"mitadCascadaR\", valor);\n              global.set(\"mitadCascadaG\", valor);\n              global.set(\"mitadCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break; \n          case 9:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"piletaCascadaR\", valor);\n              global.set(\"piletaCascadaG\", valor);\n              global.set(\"piletaCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break;                                   \n          case 10:\n              // if (global.get(\"estDucha\") === 0)return;  \n              global.set(\"pwmDucha\", valor);\n              enviarMQTT(\"bano\");\n              return;\n          case 11:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLuzBano\", valor);\n              enviarMQTT(\"bano\");\n              return;  \n          case 12:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmEscaleras\", valor);\n              enviarMQTT(\"escaleras\");\n              return;  \n          case 13:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmReflectorPergola\", valor);\n              enviarMQTT(\"escaleras\");\n              return;\n          case 14:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLucesPergola\", valor);\n              enviarMQTT(\"escaleras\");\n              return; \n          case 15:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLucesPasadaAuto\", valor);\n              enviarMQTT(\"escaleras\");\n              return;                             \n          case 16:\n              global.set(\"timerExtractorBano\", valor);\n              enviarMQTT(\"bano\");\n              return;\n          case 17:\n              global.set(\"minTeclas\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;     \n          case 18:\n              global.set(\"maxTeclas\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;              \n          case 19:  \n              global.set(\"delayBuzzer\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;              \n            }  \n          break;\n  case 21:\n  // node.status({text: context.item + \" - \" + msg.payload});\n    switch(context.item){\n      case 5:\n        global.set(\"estLuzCocina\", msg.payload);\n        enviarMQTT(\"cocina\"); \n        return;\n      break;\n      case 6:\n        global.set(\"estLucesBarraCocina\", msg.payload);\n        enviarMQTT(\"cocina\"); \n        return;\n      break;            \n      case 7:\n        global.set(\"estPalioLuz\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 8:\n        global.set(\"estLuzCascada\", msg.payload);\n        global.set(\"estTopeCascada\", msg.payload);\n        global.set(\"estMitadCascada\", msg.payload);\n        global.set(\"estPiletaCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;      \n      case 9:\n        global.set(\"estTopeCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 10:\n        global.set(\"estMitadCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 11:\n        global.set(\"estPiletaCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 14:\n        global.set(\"estEscaleras\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;\n      case 15:\n        global.set(\"estReflectorPergola\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;     \n      case 16:\n        global.set(\"estLucesPergola\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;  \n      case 17:\n        global.set(\"estLucesPasadaAuto\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;                     \n      break;      \n    }\n  break;\n  case 22:\n      global.set(\"bombaCascada\", parseInt(msg.payload));\n      // if (parseInt(msg.payload) === 0 && parseInt(global.get(\"Dia\")) === 0){\n      //   msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#\" + global.get(\"pwmPatioLuz\") + \"#0#0#1#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\")};      \n      // }\n      mensaje = \"bomba\" + global.get(\"bombaCascada\");\n      msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n      node.send([msg, null]);\n      return;\n  case 24:\n      switch(context.item){\n        case 7:\n          global.set(\"modoLed3Cascada\", msg.payload);\n          enviarMQTT(\"patioLuz\"); \n          return;\n        break;\n        case 8:\n          global.set(\"modoLed1Cascada\", msg.payload);\n          enviarMQTT(\"patioLuz\"); \n          return;\n        break;\n        case 9:\n          global.set(\"modoLed2Cascada\", msg.payload);\n          enviarMQTT(\"patioLuz\"); \n          return;\n      break;\n    //   global.set(\"modoLed1Cascada\", parseInt(msg.payload));\n    //   enviarMQTT(\"patioLuz\");\n      return;\n    }\n  // case 24:\n  //     global.set(\"modoLed2Cascada\", parseInt(msg.payload));\n  //     enviarMQTT(\"patioLuz\");\n  //     return;\n  // case 25:\n  //     global.set(\"modoLed3Cascada\", parseInt(msg.payload));\n  //     enviarMQTT(\"patioLuz\");\n  //     return;\n}\n\nfunction enviarMQTT(caso){\nvar dato;\n  if (caso == \"bano\"){\n  dato = global.get(\"estLuzBano\") + \"#\" + global.get(\"pwmLuzBano\") + \"#\" + global.get(\"modoDucha\") + \"#\" + global.get(\"estDucha\") + \"#\" + global.get(\"pwmDucha\");\n  dato += \"#\" + global.get(\"estLuzEspejo\") + \"#\" + global.get(\"estExtractorBano\") + \"#\" + global.get(\"timerExtractorBano\") + \"#\" + global.get(\"Dia\");\n    msg = {topic: \"ESP/Bano/Recibo\", payload: dato};\n  }\n\n  if (caso == \"cocina\"){\n  dato = dato = \"estado\" + global.get(\"estLuzCocina\") + \"#\" + global.get(\"estLucesBarraCocina\");\n    msg = {topic: \"ESP/Cocina/Recibo\", payload: dato};\n  }  \n\n  if (caso == \"escaleras\"){\n      if (parseInt(global.get(\"estReflectorPergola\")) === 1){\n         dato = \"estado\" + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estReflectorPergola\")) === 0){\n         dato = \"estado0\";//#0#0#0#0#0#1\";\n      }\n      dato = dato + \"#\";\n      if (parseInt(global.get(\"estEscaleras\")) === 1){\n         // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n         dato = dato + global.get(\"pwmEscaleras\");\n         // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estEscaleras\")) === 0){\n         dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n      }    \n      dato = dato + \"#\";\n      if (parseInt(global.get(\"estLucesPergola\")) === 1){\n         // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n         dato = dato + global.get(\"pwmLucesPergola\");\n         // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estLucesPergola\")) === 0){\n         dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n      }   \n      dato = dato + \"#\";\n      if (parseInt(global.get(\"estLucesPasadaAuto\")) === 1){\n         // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n         dato = dato + global.get(\"pwmLucesPasadaAuto\");\n         // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estLucesPasadaAuto\")) === 0){\n         dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n      } \n      dato = dato + \"#1\";                \n//estado10#0#0#0#0#0#1\n\n       msg = {topic: \"ESP/Escaleras/Recibo\", payload: dato};\n  }  \n\nif (caso == \"patioLuz\"){\n    var mensaje;\n    if (parseInt(global.get(\"estMitadCascada\")) === 0){\n      mensaje = \"estado0#0#0#0#\";\n    }\n      else{\n        mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\";\n      }\n\n    if (parseInt(global.get(\"estPalioLuz\")) === 0){\n      mensaje = mensaje + \"0#0#\";\n    }\n      else{\n        mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n      }      \n\n    // mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n\n    if (parseInt(global.get(\"estPiletaCascada\")) === 0){\n      mensaje = mensaje + \"0#0#0#0#\";\n    }\n      else{\n         mensaje = mensaje + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n      }\n\n    if (parseInt(global.get(\"estTopeCascada\")) === 0){\n      mensaje = mensaje + \"0#0#0#0#\";\n    }\n      else{\n         mensaje = mensaje + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n      }\n\n    mensaje = mensaje + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\");\n\n    // if (parseInt(global.get(\"Dia\")) === 1){\n    //     msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#0#0#0#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\") + \"#\" + global.get(\"maxAuto\")};\n    //   } \n    //   else{   \n    //     msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n    //   }\n    msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n\n    //1#1023#32#118#118#118#0#1#1#undefined#45#45#45#0#181\n  }\n  \n\n  if (caso == \"living\"){\n    dato = global.get(\"estIsla\") + \",\";\n    dato += global.get(\"potIsla\") + \"#\";\n    dato += global.get(\"estCielorrazo\") + \",\";\n    dato += global.get(\"potCielorrazo\") + \"#\";  \n    dato += global.get(\"estIslaRGB\") + \",\";\n    dato += global.get(\"IslaR\") + \",\";\n    dato += global.get(\"IslaG\") + \",\";      \n    dato += global.get(\"IslaB\") + \"#\";\n\n    dato += global.get(\"pwmMaxLed\") + \"#\";\n    dato += global.get(\"pwmMinLed\") + \"#\";\n\n    dato += global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"doblePuls\");\n    dato += \"#\" + global.get(\"Dia\");\n\n    msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n    node.send([msg, null]);\n  }\n  if (caso == \"configGenericas\"){\n    dato = global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"delayBuzzer\");\n    msg = {topic: \"configTeclas\", payload: dato};\n  }\n\nnode.send([msg, null]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 93,
        "y": 507,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "6d22ee85.6becc",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/Cocina/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 321,
        "y": 881,
        "wires": [
            [
                "52bb7a36.4a4e94",
                "9b83bd65.c2587"
            ]
        ]
    },
    {
        "id": "f3c4dc81.0c1d2",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/Cocina/Debug",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 610,
        "y": 780,
        "wires": [
            [
                "9acb3f41.28eea"
            ]
        ]
    },
    {
        "id": "9acb3f41.28eea",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 823.5,
        "y": 781,
        "wires": []
    },
    {
        "id": "5fa49237.5c3e8c",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/Cocina/Envio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 316,
        "y": 841,
        "wires": [
            [
                "52bb7a36.4a4e94"
            ]
        ]
    },
    {
        "id": "16383dac.fbfbc2",
        "type": "blynk-ws-out-write",
        "z": "a89e305a.c50bb",
        "name": "",
        "pin": 0,
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 678,
        "y": 1000,
        "wires": []
    },
    {
        "id": "13e30dc0.ff2902",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/Cocina/Debug1",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 619,
        "y": 822,
        "wires": [
            [
                "3da7f98d.f3dec6"
            ]
        ]
    },
    {
        "id": "3da7f98d.f3dec6",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 832.5,
        "y": 823,
        "wires": []
    },
    {
        "id": "b6ddc131.7b66e",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/Cocina/Debug2",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 619,
        "y": 858,
        "wires": [
            [
                "5746f1d.16aff1"
            ]
        ]
    },
    {
        "id": "5746f1d.16aff1",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 832.5,
        "y": 859,
        "wires": []
    },
    {
        "id": "916fd992.3c1288",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "",
        "func": "msg.payload = global.get(\"estLuzCocina\"); node.send([msg, null]);\nmsg.payload = global.get(\"estLucesBarraCocina\"); node.send([null, msg]);\nmsg.payload = global.get(\"estCielorrazo\"); node.send([null, null, msg]);\nmsg.payload = global.get(\"estIslaRGB\"); node.send([null, null, null, msg]);",
        "outputs": 4,
        "noerr": 0,
        "x": 396,
        "y": 1116,
        "wires": [
            [
                "46e6f6b9.487288"
            ],
            [
                "5238a73e.cf3a88"
            ],
            [],
            []
        ]
    },
    {
        "id": "8bce8e9e.d6782",
        "type": "link in",
        "z": "a89e305a.c50bb",
        "name": "",
        "links": [
            "498bb257.eca9bc"
        ],
        "x": 311,
        "y": 1116,
        "wires": [
            [
                "916fd992.3c1288"
            ]
        ]
    },
    {
        "id": "46e6f6b9.487288",
        "type": "ui_switch",
        "z": "a89e305a.c50bb",
        "name": "",
        "label": "Luz Cocina",
        "group": "8cf8292c.1cbf98",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "luzCocina",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 556,
        "y": 1066,
        "wires": [
            [
                "2fe36770.63a868"
            ]
        ]
    },
    {
        "id": "5238a73e.cf3a88",
        "type": "ui_switch",
        "z": "a89e305a.c50bb",
        "name": "",
        "label": "Luz Barra",
        "group": "8cf8292c.1cbf98",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "luzBarra",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 546,
        "y": 1106,
        "wires": [
            [
                "2fe36770.63a868"
            ]
        ]
    },
    {
        "id": "2fe36770.63a868",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "",
        "func": "if (msg.topic == \"luzCocina\")msg = {pin: 61, payload: msg.payload};\n\nif (msg.topic == \"luzBarra\")msg = {pin: 60, payload: msg.payload};\n// if (msg.topic == \"Cielorrazo\")msg = {pin: 17, payload: msg.payload};\n// if (msg.topic == \"islaRGB\")msg = {pin: 29, payload: msg.payload};\n\nnode.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 716,
        "y": 1116,
        "wires": [
            [
                "86027b4c.130a38"
            ]
        ]
    },
    {
        "id": "86027b4c.130a38",
        "type": "link out",
        "z": "a89e305a.c50bb",
        "name": "salidaLiving",
        "links": [
            "c0a5a838.106888"
        ],
        "x": 816,
        "y": 1116,
        "wires": []
    },
    {
        "id": "498bb257.eca9bc",
        "type": "link out",
        "z": "a89e305a.c50bb",
        "name": "iluminacionCocina",
        "links": [
            "8bce8e9e.d6782"
        ],
        "x": 784.5,
        "y": 949,
        "wires": []
    },
    {
        "id": "c0a5a838.106888",
        "type": "link in",
        "z": "a89e305a.c50bb",
        "name": "salidaCocina",
        "links": [
            "86027b4c.130a38"
        ],
        "x": 392.5,
        "y": 1012,
        "wires": [
            [
                "52bb7a36.4a4e94"
            ]
        ]
    },
    {
        "id": "95875391.4f5e1",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 942.5,
        "y": 692,
        "wires": []
    },
    {
        "id": "129c7fcb.724a4",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 824.4443969726562,
        "y": 1034.4444580078125,
        "wires": []
    },
    {
        "id": "4a38cd91.3f1d44",
        "type": "blynk-ws-in-write",
        "z": "f682d492.22a758",
        "name": "",
        "pin": "100",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 2014,
        "y": 476,
        "wires": [
            [
                "da78fbf0.e73618"
            ]
        ]
    },
    {
        "id": "e7d5737f.8d663",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "PatioLuz/BackUp",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 291.25003814697266,
        "y": 1447.083270072937,
        "wires": [
            [
                "7795e2b5.74a72c",
                "d9cd9a4c.5e3798"
            ]
        ]
    },
    {
        "id": "7795e2b5.74a72c",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg.payload = msg.payload.substring(6);\nif (msg.payload.includes(\"undefined\"))return;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 485.4166488647461,
        "y": 1442.0833950042725,
        "wires": [
            [
                "c5c1e2c5.7d10a",
                "f99c2456.e432c8"
            ]
        ]
    },
    {
        "id": "c5c1e2c5.7d10a",
        "type": "file",
        "z": "9c63fd61.9908c",
        "name": "back patioLuz",
        "filename": "/home/pi/BackUpNodeRed/patioLuz.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 662.0833129882812,
        "y": 1443.7500128746033,
        "wires": [
            []
        ]
    },
    {
        "id": "e33a66c6.af5268",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "val. in. termo",
        "func": "var dato = msg.payload.split(\"#\");\nglobal.set(\"pwmReflectorPergola\", dato[0]);\nglobal.set(\"pwmEscaleras\", dato[1]);\nglobal.set(\"pwmLucesPergola\", dato[2]);\nglobal.set(\"pwmLucesPasadaAuto\", dato[3]);\n\nmsg = {topic: \"ESP/Escaleras/Inicio\", payload: 1};\nnode.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 708.3333587646484,
        "y": 1290.000051498413,
        "wires": [
            [
                "32f8b9b0.d4e906",
                "3388a605.bb64ea"
            ]
        ]
    },
    {
        "id": "3388a605.bb64ea",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "pedido",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 897.9166984558105,
        "y": 1381.6667671203613,
        "wires": []
    },
    {
        "id": "50e46901.5c9eb8",
        "type": "file in",
        "z": "9c63fd61.9908c",
        "name": "recover Escaleras",
        "filename": "/home/pi/BackUpNodeRed/Escaleras.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 501.6666488647461,
        "y": 1293.333426475525,
        "wires": [
            [
                "e33a66c6.af5268",
                "a94d9786.f36f88"
            ]
        ]
    },
    {
        "id": "531c9549.de388c",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "4",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 286.6666564941406,
        "y": 1293.333351135254,
        "wires": [
            [
                "50e46901.5c9eb8"
            ]
        ]
    },
    {
        "id": "a94d9786.f36f88",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 711.6666793823242,
        "y": 1330.000012397766,
        "wires": []
    },
    {
        "id": "f99c2456.e432c8",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 658.75,
        "y": 1403.7500128746033,
        "wires": []
    },
    {
        "id": "d9cd9a4c.5e3798",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 482.0833206176758,
        "y": 1402.500030040741,
        "wires": []
    },
    {
        "id": "da78fbf0.e73618",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (global.get(\"estado-TanqueAgua\") === undefined)global.set(\"estado-TanqueAgua\", null);\nif (global.get(\"estado-Lavadero\") === undefined)global.set(\"estado-Lavadero\", null);\nif (global.get(\"estado-IluminacionLiving\") === undefined)global.set(\"estado-IluminacionLiving\", null);\nif (global.get(\"estado-TermoSolar\") === undefined)global.set(\"estado-TermoSolar\", null);\nif (global.get(\"estado-Bano\") === undefined)global.set(\"estado-Bano\", null);\nif (global.get(\"estado-PatioLuz\") === undefined)global.set(\"estado-PatioLuz\", null);\nif (global.get(\"estado-Escaleras\") === undefined)global.set(\"estado-Escaleras\", null);\nif (global.get(\"estado-Porche\") === undefined)global.set(\"estado-Porche\", null);\n\n\nif (msg.payload == \"0\")return;\n// node.send(msg.payload);\nmsg.payload = \"\";\nfor (i = 0; i < 13; i++) {msg = {topic: \"terminalBlynk\", payload: \"\\n\"};}\nnode.send(msg);\n\nmsg =  \"Tanque  : \" + global.get(\"estado-TanqueAgua\");// + \"\\n\";// + \"\\n\";\nmsg += \"Lav.    : \" + global.get(\"estado-Lavadero\");// + \"\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"Liv.    : \" + global.get(\"estado-IluminacionLiving\");// + \"\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"Termo   : \" + global.get(\"estado-TermoSolar\");// + \"\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"Bano    : \" + global.get(\"estado-Bano\");// + \"\\n\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"PatioLuz: \" + global.get(\"estado-PatioLuz\");// + \"\\n\\n\";// + \"\\n\"; + \"\\n\";\nmsg += \"Escalera: \" + global.get(\"estado-Escaleras\");// + \"\\n\\n\";// + \"\\n\"; + \"\\n\";Caldera\nmsg += \"Porche  : \" + global.get(\"estado-Porche\");\nmsg += \"\\n\";\n\nmsg = {topic: \"terminalBlynk\", payload: msg};\nnode.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "x": 2226.66650390625,
        "y": 471.6666564941406,
        "wires": [
            [
                "d684a422.1c7d88",
                "86f4eda8.a214c"
            ]
        ]
    },
    {
        "id": "d684a422.1c7d88",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "terminalBlynk",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 2391.66650390625,
        "y": 464.9999694824219,
        "wires": []
    },
    {
        "id": "86f4eda8.a214c",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 2373.333251953125,
        "y": 526.6666259765625,
        "wires": []
    },
    {
        "id": "32f8b9b0.d4e906",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 885,
        "y": 1242.5,
        "wires": []
    },
    {
        "id": "ea55771e.5d9598",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Escaleras/BackUp",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 303.75000762939453,
        "y": 1238.7500171661377,
        "wires": [
            [
                "ac3f1127.66155",
                "f48ff165.d6d89"
            ]
        ]
    },
    {
        "id": "ac3f1127.66155",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg.payload = msg.payload.substring(6);\nif (msg.payload.includes(\"undefined\"))return;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 477.91661834716797,
        "y": 1233.7501420974731,
        "wires": [
            [
                "95bb259a.821848",
                "ff638d3c.af6f6"
            ]
        ]
    },
    {
        "id": "f48ff165.d6d89",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 474.58329010009766,
        "y": 1194.1667771339417,
        "wires": []
    },
    {
        "id": "95bb259a.821848",
        "type": "file",
        "z": "9c63fd61.9908c",
        "name": "back datos termo",
        "filename": "/home/pi/BackUpNodeRed/Escaleras.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 664.5832824707031,
        "y": 1235.416759967804,
        "wires": [
            []
        ]
    },
    {
        "id": "ff638d3c.af6f6",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 651.2499694824219,
        "y": 1195.416759967804,
        "wires": []
    },
    {
        "id": "1be908c5.2168e7",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 281.25,
        "y": 1492.5,
        "wires": [
            [
                "361bbb57.97be24"
            ]
        ]
    },
    {
        "id": "361bbb57.97be24",
        "type": "file in",
        "z": "9c63fd61.9908c",
        "name": "recover patioLuz",
        "filename": "/home/pi/BackUpNodeRed/patioLuz.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 496.24999237060547,
        "y": 1492.500075340271,
        "wires": [
            [
                "eb354f8d.a4a08",
                "ca12682e.afd248"
            ]
        ]
    },
    {
        "id": "eb354f8d.a4a08",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "val. in. termo",
        "func": "var dato = msg.payload.split(\"#\");\nglobal.set(\"modoLed1Cascada\", dato[0]);\nglobal.set(\"mitadCascadaG\", dato[1]);\nglobal.set(\"mitadCascadaR\", dato[2]);\nglobal.set(\"mitadCascadaB\", dato[3]);\nglobal.set(\"pwmPatioLuz\", dato[4]);\n// global.set(\"pedToldo\", dato[5]);\nglobal.set(\"modoLed2Cascada\", dato[6]);\nglobal.set(\"piletaCascadaG\", dato[7]);\nglobal.set(\"piletaCascadaR\", dato[8]);\nglobal.set(\"piletaCascadaB\", dato[9]);\nglobal.set(\"modoLed3Cascada\", dato[10]);\nglobal.set(\"topeCascadaR\", dato[11]);\nglobal.set(\"topeCascadaG\", dato[12]);\nglobal.set(\"topeCascadaB\", dato[13]);\nglobal.set(\"dalayMinCascada\", dato[14]);\nglobal.set(\"delayMaxCascada\", dato[15]);\nglobal.set(\"minAutoCascada\", dato[16]);\nglobal.set(\"maxAutoCascada\", dato[17]);\n\nmsg = {topic: \"PatioLuz/Inicio\", payload: 1};\nnode.send(msg);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 702.9167022705078,
        "y": 1489.1667003631592,
        "wires": [
            [
                "2619220f.5610ee",
                "3388a605.bb64ea"
            ]
        ]
    },
    {
        "id": "ca12682e.afd248",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 706.2500228881836,
        "y": 1529.1666612625122,
        "wires": []
    },
    {
        "id": "2619220f.5610ee",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 879.5833435058594,
        "y": 1441.666648864746,
        "wires": []
    },
    {
        "id": "b7693f6a.0fe94",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/Cocina/Inicio",
        "payload": "",
        "payloadType": "date",
        "x": 301.875,
        "y": 786.25,
        "wires": [
            [
                "52bb7a36.4a4e94"
            ]
        ]
    },
    {
        "id": "1a548276.22479e",
        "type": "file",
        "z": "9c63fd61.9908c",
        "name": "back datos termo",
        "filename": "/home/pi/BackUpNodeRed/Prueba.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 1251.5,
        "y": 1274.5,
        "wires": [
            []
        ]
    },
    {
        "id": "21f2a647.6dceca",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1043.375,
        "y": 1260.75,
        "wires": [
            [
                "1a548276.22479e"
            ]
        ]
    },
    {
        "id": "866f2959.6c57d8",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "4",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1067.25,
        "y": 1211.0001220703125,
        "wires": [
            [
                "b7e9b075.0c63"
            ]
        ]
    },
    {
        "id": "b7e9b075.0c63",
        "type": "file in",
        "z": "9c63fd61.9908c",
        "name": "recover Escaleras",
        "filename": "/home/pi/BackUpNodeRed/Prueba.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 1282.2499923706055,
        "y": 1211.0001974105835,
        "wires": [
            [
                "69ef82b1.68175c"
            ]
        ]
    },
    {
        "id": "69ef82b1.68175c",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1492.2500228881836,
        "y": 1247.6667833328247,
        "wires": []
    },
    {
        "id": "f3d32f7f.eb283",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1458.333251953125,
        "y": 568.3333129882812,
        "wires": []
    },
    {
        "id": "e279d86.eecb628",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "if (global.get(\"estTopeCascada\") === undefined)global.set(\"estTopeCascada\", 0);\nif (global.get(\"estMitadCascada\") === undefined)global.set(\"estMitadCascada\", 0);\nif (global.get(\"estPiletaCascada\") === undefined)global.set(\"estPiletaCascada\", 0);\nif (global.get(\"estPalioLuz\") === undefined)global.set(\"estPalioLuz\", 0);\nif (global.get(\"estLuzCascada\") === undefined)global.set(\"estLuzCascada\", 0);\n\nif (global.get(\"estEscaleras\") === undefined)global.set(\"estEscaleras\", 0);\nif (global.get(\"pwmEscaleras\") === undefined)global.set(\"pwmEscaleras\", 0);\nif (global.get(\"estReflectorPergola\") === undefined)global.set(\"estReflectorPergola\", 0);\nif (global.get(\"pwmReflectorPergola\") === undefined)global.set(\"pwmReflectorPergola\", 0);\nif (global.get(\"estLucesPergola\") === undefined)global.set(\"estLucesPergola\", 0);\nif (global.get(\"pwmLucesPergola\") === undefined)global.set(\"pwmLucesPergola\", 0);\nif (global.get(\"estLucesPasadaAuto\") === undefined)global.set(\"estLucesPasadaAuto\", 0);\nif (global.get(\"pwmLucesPasadaAuto\") === undefined)global.set(\"pwmLucesPasadaAuto\", 0);\n\n// var topicOriginal = msg.topic\n\n\nvar pin = parseInt(msg.pin);\nvar intPayload = parseInt(msg.payload);\nvar topic = msg.topic;\nvar dato;\n\nif (msg.topic == \"crepMQTT\"){\n  if (parseInt(global.get(\"Dia\")) === 1){\n      global.set(\"estLuzCascada\", 0);\n      global.set(\"estTopeCascada\", 0); \n      global.set(\"estMitadCascada\", 0);\n      global.set(\"estPiletaCascada\", 0); \n      enviarMQTT(\"patioLuz\");\n      global.set(\"estEscaleras\", 0);\n      global.set(\"estReflectorPergola\", 0);\n      global.set(\"estLucesPergola\", 0);\n      global.set(\"estLucesPasadaAuto\", 0);\n      enviarMQTT(\"escaleras\");\n  }\n  if (parseInt(global.get(\"Dia\")) === 0){\n      global.set(\"estLuzCascada\", 1);\n      global.set(\"estTopeCascada\", 1); \n      global.set(\"estMitadCascada\", 1);\n      global.set(\"estPiletaCascada\", 1); \n      enviarMQTT(\"patioLuz\"); \n      global.set(\"estEscaleras\", 1); \n      // global.set(\"estReflectorPergola\", 1);\n      // global.set(\"pwmReflectorPergola\", 5);\n      global.set(\"estLucesPergola\", 1);\n      // global.set(\"pwmLucesPergola\", 10);      \n      global.set(\"estLucesPasadaAuto\", 1);\n      // global.set(\"pwmLucesPasadaAuto\", 100);\n      enviarMQTT(\"escaleras\");\n  }  \n  return;\n}\n\nif (msg.topic == \"PatioLuz/Inicio\"){\n    enviarMQTT(\"patioLuz\"); \n    return;    \n}\n\nif (msg.topic == \"ESP/Escaleras/Inicio\"){\n    enviarMQTT(\"escaleras\"); \n    return;    \n}\n\n// node.status({text: context.item});\n\nswitch (pin){\n  case 8:\n    switch (parseInt(context.item)){\n        case 4:\n            global.set(\"IslaR\", msg.arrayOfValues[0]);\n            global.set(\"IslaG\", msg.arrayOfValues[1]);\n            global.set(\"IslaB\", msg.arrayOfValues[2]);\n            // msg = {pin: 32, payload: \"12\"}; node.send([null, msg]);\n            global.set(\"estIslaRGB\", 1);\n            enviarMQTT(\"living\");\n            return;\n        break;\n        case 6:\n            global.set(\"topeCascadaR\", msg.arrayOfValues[0]); global.set(\"mitadCascadaR\", msg.arrayOfValues[0]); global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"topeCascadaG\", msg.arrayOfValues[1]); global.set(\"mitadCascadaG\", msg.arrayOfValues[1]); global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"topeCascadaB\", msg.arrayOfValues[2]); global.set(\"mitadCascadaB\", msg.arrayOfValues[2]); global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\");\n            return;\n        break;\n        case 7:\n            global.set(\"topeCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"topeCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"topeCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\");\n            return;\n        break;\n        case 8:\n            global.set(\"mitadCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"mitadCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"mitadCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\");\n            return;\n        break;\n        case 9:\n            global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n            global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n            global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n            enviarMQTT(\"patioLuz\"); \n            return;\n        break;          \n    }  \n\n  case 18:\n    global.set(\"itemPotencia\", msg.payload);\n    // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n      context.item = parseInt(msg.payload);\n      node.status({text: context.item + \" - \" + msg.payload});\n      switch(parseInt(msg.payload)){\n          case 1:\n              msg = {pin: 19, min: 0, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n          break;\n          case 2:\n              msg = {pin: 19, min: 0, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n          break;\n          case 3:\n              msg = {pin: 19, min: 0, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n          break;\n          case 4:\n              msg = {pin: 19, min: 0, max: 255, label: \"Led Living\", payload: global.get(\"ledLiving\")};\n          break;\n          case 5:\n              msg = {pin: 21, label: \"Luz Casc\", payload: global.get(\"estLuzCascada\")}; node.send([null, msg]);\n              msg = {pin: 21, label: \"Patio Luz\", payload: global.get(\"estPalioLuz\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 70, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n          break; \n          case 6:\n              msg = {pin: 19, min: 0, max: 255, label: \"Cascada Completa\", payload: global.get(\"ledTopeCascada\")};\n          break;              \n          case 7:\n              msg = {pin: 21, label: \"Top Casc\", payload: global.get(\"estTopeCascada\")}; node.send([null, msg]);\n              msg = {pin: 24, label: \"Top Casc\", payload: global.get(\"modoLed3Cascada\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 0, max: 255, label: \"Tope Cascada\", payload: global.get(\"ledTopeCascada\")}; node.send([null, msg]);\n              return;\n          break; \n          case 8:\n              msg = {pin: 21, label: \"Mit Casc\", payload: global.get(\"estMitadCascada\")}; node.send([null, msg]);\n              msg = {pin: 24, label: \"Mit Casc\", payload: global.get(\"modoLed1Cascada\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 0, max: 255, label: \"Mitad Cascada\", payload: global.get(\"ledMitadCascada\")}; node.send([null, msg]);\n              return;\n          break; \n          case 9:\n              msg = {pin: 21, label: \"Pil Casc\", payload: global.get(\"estPiletaCascada\")}; node.send([null, msg]);\n              msg = {pin: 24, label: \"Pil Casc\", payload: global.get(\"modoLed2Cascada\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 0, max: 255, label: \"Pileta Cascada\", payload: global.get(\"ledPiletaCascada\")}; node.send([null, msg]);\n              return;\n          break;      \n          case 10:\n              msg = {pin: 19, min: 1, max: 100, label: \"Ducha de bano\", payload: global.get(\"pwmDucha\")};\n          break;     \n          case 11:\n              msg = {pin: 19, min: 1, max: 100, label: \"Luz Bano\", payload: global.get(\"pwmLuzBano\")};\n          break;\n          case 12:\n              msg = {pin: 21, label: \"Escaleras\", payload: global.get(\"estEscaleras\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Pot Escaleras\", payload: global.get(\"pwmEscaleras\")};\n          break;     \n          case 13:\n              msg = {pin: 21, label: \"Refl Perg\", payload: global.get(\"estReflectorPergola\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Ref Pergola\", payload: global.get(\"pwmReflectorPergola\")};\n          break;                \n          case 14:\n              msg = {pin: 21, label: \"Luces Perg\", payload: global.get(\"estLucesPergola\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Luces Pergola\", payload: global.get(\"pwmLucesPergola\")};\n          break;  \n          case 15:\n              msg = {pin: 21, label: \"Luces Pasada Auto\", payload: global.get(\"estLucesPasadaAuto\")}; node.send([null, msg]);\n              msg = {pin: 19, min: 1, max: 100, label: \"Luces Pas Auto\", payload: global.get(\"pwmLucesPasadaAuto\")};\n          break;            \n          case 16:\n              msg = {pin: 19, min: 15, max: 240, label: \"timer extractor baño\", payload: global.get(\"timerExtractorBano\")};\n          break;          \n          case 17:\n              msg = {pin: 19, min: 10, max: 100, label: \"tiempo MIN teclas\", payload: global.get(\"minTeclas\")};\n          break;       \n          case 18:\n              msg = {pin: 19, min: 400, max: 2000, label: \"tiempo MAX teclas\", payload: global.get(\"maxTeclas\")};\n          break;   \n          case 19:\n              msg = {pin: 19, min: 1, max: 100, label: \"delay buzzer\", payload: global.get(\"delayBuzzer\")};\n          break;                              \n      }\n      node.send([null, msg]);\n      return;\n    // }\n  break;\n\n  case 19:\n    // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n      var valor = parseInt(msg.payload);\n      switch(context.item){\n          case 1:\n              // if (global.get(\"estLiving\") === 0)return;\n              global.set(\"potLiving\", valor);\n              global.set(\"potIsla\", valor);\n              global.set(\"potCielorrazo\", valor);\n              global.set(\"ledLiving\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 2:\n              // if (global.get(\"estIsla\") === 0)return;\n              global.set(\"potIsla\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 3:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"potCielorrazo\", valor);\n              enviarMQTT(\"living\");\n          break;\n          case 4:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"ledLiving\", valor);\n              global.set(\"IslaR\", valor);\n              global.set(\"IslaG\", valor);\n              global.set(\"IslaB\", valor);\n              msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"living\");\n          break;          \n          case 5:\n              // if (global.get(\"Dia\") === 1)return;\n              global.set(\"pwmPatioLuz\", valor);\n              enviarMQTT(\"patioLuz\");\n              return;\n          case 6:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"topeCascadaR\", valor);\n              global.set(\"topeCascadaG\", valor);\n              global.set(\"topeCascadaB\", valor);\n              global.set(\"mitadCascadaR\", valor);\n              global.set(\"mitadCascadaG\", valor);\n              global.set(\"mitadCascadaB\", valor);\n              global.set(\"piletaCascadaR\", valor);\n              global.set(\"piletaCascadaG\", valor);\n              global.set(\"piletaCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break;               \n          case 7:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"topeCascadaR\", valor);\n              global.set(\"topeCascadaG\", valor);\n              global.set(\"topeCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break; \n          case 8:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"mitadCascadaR\", valor);\n              global.set(\"mitadCascadaG\", valor);\n              global.set(\"mitadCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break; \n          case 9:\n              // if (global.get(\"estCielorrazo\") === 0)return;\n              global.set(\"piletaCascadaR\", valor);\n              global.set(\"piletaCascadaG\", valor);\n              global.set(\"piletaCascadaB\", valor);\n              // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n              enviarMQTT(\"patioLuz\");\n          break;                                   \n          case 10:\n              // if (global.get(\"estDucha\") === 0)return;  \n              global.set(\"pwmDucha\", valor);\n              enviarMQTT(\"bano\");\n              return;\n          case 11:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLuzBano\", valor);\n              enviarMQTT(\"bano\");\n              return;  \n          case 12:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmEscaleras\", valor);\n              enviarMQTT(\"escaleras\");\n              return;  \n          case 13:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmReflectorPergola\", valor);\n              enviarMQTT(\"escaleras\");\n              return;\n          case 14:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLucesPergola\", valor);\n              enviarMQTT(\"escaleras\");\n              return; \n          case 15:\n              // if (global.get(\"estLuzBano\") === 0)return;  \n              global.set(\"pwmLucesPasadaAuto\", valor);\n              enviarMQTT(\"escaleras\");\n              return;                             \n          case 16:\n              global.set(\"timerExtractorBano\", valor);\n              enviarMQTT(\"bano\");\n              return;\n          case 17:\n              global.set(\"minTeclas\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;     \n          case 18:\n              global.set(\"maxTeclas\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;              \n          case 19:  \n              global.set(\"delayBuzzer\", valor);\n              enviarMQTT(\"configGenericas\");\n              return;              \n            }  \n          break;\n  case 21:\n  // node.status({text: context.item + \" - \" + msg.payload});\n    switch(context.item){\n      case 5:\n        global.set(\"estPalioLuz\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 6:\n        global.set(\"estLuzCascada\", msg.payload);\n        global.set(\"estTopeCascada\", msg.payload);\n        global.set(\"estMitadCascada\", msg.payload);\n        global.set(\"estPiletaCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;      \n      case 7:\n        global.set(\"estTopeCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 8:\n        global.set(\"estMitadCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 9:\n        global.set(\"estPiletaCascada\", msg.payload);\n        enviarMQTT(\"patioLuz\"); \n        return;\n      break;\n      case 12:\n        global.set(\"estEscaleras\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;\n      case 13:\n        global.set(\"estReflectorPergola\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;     \n      case 14:\n        global.set(\"estLucesPergola\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;  \n      case 15:\n        global.set(\"estLucesPasadaAuto\", msg.payload);\n        enviarMQTT(\"escaleras\"); \n        return;                     \n      break;      \n    }\n  break;\n  case 22:\n      global.set(\"bombaCascada\", parseInt(msg.payload));\n      // if (parseInt(msg.payload) === 0 && parseInt(global.get(\"Dia\")) === 0){\n      //   msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#\" + global.get(\"pwmPatioLuz\") + \"#0#0#1#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\")};      \n      // }\n      mensaje = \"bomba\" + global.get(\"bombaCascada\");\n      msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n      node.send([msg, null]);\n      return;\n  case 24:\n      switch(context.item){\n        case 7:\n          global.set(\"modoLed3Cascada\", msg.payload);\n          enviarMQTT(\"patioLuz\"); \n          return;\n        break;\n        case 8:\n          global.set(\"modoLed1Cascada\", msg.payload);\n          enviarMQTT(\"patioLuz\"); \n          return;\n        break;\n        case 9:\n          global.set(\"modoLed2Cascada\", msg.payload);\n          enviarMQTT(\"patioLuz\"); \n          return;\n      break;\n    //   global.set(\"modoLed1Cascada\", parseInt(msg.payload));\n    //   enviarMQTT(\"patioLuz\");\n      return;\n    }\n  // case 24:\n  //     global.set(\"modoLed2Cascada\", parseInt(msg.payload));\n  //     enviarMQTT(\"patioLuz\");\n  //     return;\n  // case 25:\n  //     global.set(\"modoLed3Cascada\", parseInt(msg.payload));\n  //     enviarMQTT(\"patioLuz\");\n  //     return;\n}\n\nfunction enviarMQTT(caso){\nvar dato;\n  if (caso == \"bano\"){\n  dato = global.get(\"estLuzBano\") + \"#\" + global.get(\"pwmLuzBano\") + \"#\" + global.get(\"modoDucha\") + \"#\" + global.get(\"estDucha\") + \"#\" + global.get(\"pwmDucha\");\n  dato += \"#\" + global.get(\"estLuzEspejo\") + \"#\" + global.get(\"estExtractorBano\") + \"#\" + global.get(\"timerExtractorBano\") + \"#\" + global.get(\"Dia\");\n    msg = {topic: \"ESP/Bano/Recibo\", payload: dato};\n  }\n\n  if (caso == \"escaleras\"){\n      if (parseInt(global.get(\"estReflectorPergola\")) === 1){\n         dato = \"estado\" + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estReflectorPergola\")) === 0){\n         dato = \"estado0\";//#0#0#0#0#0#1\";\n      }\n      dato = dato + \"#\";\n      if (parseInt(global.get(\"estEscaleras\")) === 1){\n         // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n         dato = dato + global.get(\"pwmEscaleras\");\n         // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estEscaleras\")) === 0){\n         dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n      }    \n      dato = dato + \"#\";\n      if (parseInt(global.get(\"estLucesPergola\")) === 1){\n         // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n         dato = dato + global.get(\"pwmLucesPergola\");\n         // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estLucesPergola\")) === 0){\n         dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n      }   \n      dato = dato + \"#\";\n      if (parseInt(global.get(\"estLucesPasadaAuto\")) === 1){\n         // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n         dato = dato + global.get(\"pwmLucesPasadaAuto\");\n         // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n      }\n      if (parseInt(global.get(\"estLucesPasadaAuto\")) === 0){\n         dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n      } \n      dato = dato + \"#1\";                \n//estado10#0#0#0#0#0#1\n    if (dato.includes(\"desconectado\")) return;\n    msg = {topic: \"ESP/Escaleras/Recibo\", payload: dato};\n  }  \n\nif (caso == \"patioLuz\"){\n    var mensaje;\n    if (parseInt(global.get(\"estMitadCascada\")) === 0){\n      mensaje = \"estado0#0#0#0#\";\n    }\n      else{\n        mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\";\n      }\n\n    if (parseInt(global.get(\"estPalioLuz\")) === 0){\n      mensaje = mensaje + \"0#0#\";\n    }\n      else{\n        mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n      }      \n\n    // mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n\n    if (parseInt(global.get(\"estPiletaCascada\")) === 0){\n      mensaje = mensaje + \"0#0#0#0#\";\n    }\n      else{\n         mensaje = mensaje + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n      }\n\n    if (parseInt(global.get(\"estTopeCascada\")) === 0){\n      mensaje = mensaje + \"0#0#0#0#\";\n    }\n      else{\n         mensaje = mensaje + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n      }\n\n    mensaje = mensaje + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\");\n\n    // if (parseInt(global.get(\"Dia\")) === 1){\n    //     msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#0#0#0#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\") + \"#\" + global.get(\"maxAuto\")};\n    //   } \n    //   else{   \n    //     msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n    //   }\n    if (mensaje.includes(\"desconectado\")) return;\n    msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n\n    //1#1023#32#118#118#118#0#1#1#undefined#45#45#45#0#181\n  }\n  \n\n  if (caso == \"living\"){\n    dato = global.get(\"estIsla\") + \",\";\n    dato += global.get(\"potIsla\") + \"#\";\n    dato += global.get(\"estCielorrazo\") + \",\";\n    dato += global.get(\"potCielorrazo\") + \"#\";  \n    dato += global.get(\"estIslaRGB\") + \",\";\n    dato += global.get(\"IslaR\") + \",\";\n    dato += global.get(\"IslaG\") + \",\";      \n    dato += global.get(\"IslaB\") + \"#\";\n\n    dato += global.get(\"pwmMaxLed\") + \"#\";\n    dato += global.get(\"pwmMinLed\") + \"#\";\n\n    dato += global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"doblePuls\");\n    dato += \"#\" + global.get(\"Dia\");\n\n    msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n    node.send([msg, null]);\n  }\n  if (caso == \"configGenericas\"){\n    dato = global.get(\"minTeclas\") + \"#\";\n    dato += global.get(\"maxTeclas\") + \"#\";\n    dato += global.get(\"delayBuzzer\");\n    msg = {topic: \"configTeclas\", payload: dato};\n  }\n\nnode.send([msg, null]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 471.6666564941406,
        "y": 615,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "c3d575b9.d175a8",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/TermoSolar/Inicio",
        "payload": "",
        "payloadType": "date",
        "x": 259.16666666666663,
        "y": 783.3333333333333,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "76702958.bb4348",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Pileta/Redonda/BackUp",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 269,
        "y": 1642,
        "wires": [
            [
                "589fab74.a56524",
                "93dd297a.d19b38"
            ]
        ]
    },
    {
        "id": "589fab74.a56524",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg.payload = msg.payload.substring(6);\nif (msg.payload.includes(\"undefined\"))return;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 476.16661071777344,
        "y": 1642.0001249313354,
        "wires": [
            [
                "35b9dffe.c0b7",
                "b0cf742d.a6d3a8"
            ]
        ]
    },
    {
        "id": "93dd297a.d19b38",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 472.8332824707031,
        "y": 1602.416759967804,
        "wires": []
    },
    {
        "id": "35b9dffe.c0b7",
        "type": "file",
        "z": "9c63fd61.9908c",
        "name": "back PiletaRedonda",
        "filename": "/home/pi/BackUpNodeRed/PiletaRedonda.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 672.8332748413086,
        "y": 1643.6667428016663,
        "wires": [
            []
        ]
    },
    {
        "id": "b0cf742d.a6d3a8",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 649.4999618530273,
        "y": 1603.6667428016663,
        "wires": []
    },
    {
        "id": "8802c065.15fe7",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "6",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 244,
        "y": 1698,
        "wires": [
            [
                "feff71eb.cbfe2"
            ]
        ]
    },
    {
        "id": "feff71eb.cbfe2",
        "type": "file in",
        "z": "9c63fd61.9908c",
        "name": "recover patioLuz",
        "filename": "/home/pi/BackUpNodeRed/PiletaRedonda.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 458.99999237060547,
        "y": 1698.000075340271,
        "wires": [
            [
                "e34f692b.827858",
                "5912e31.3cdef1c"
            ]
        ]
    },
    {
        "id": "e34f692b.827858",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "val. in. termo",
        "func": "var dato = msg.payload.split(\"#\");\nglobal.set(\"estLucesPiletaRedodna\", dato[0]);\nglobal.set(\"modoLucesPiletaRedonda\", dato[1]);\nglobal.set(\"PiletaRedondaR\", dato[2]);\nglobal.set(\"PiletaRedondaG\", dato[3]);\nglobal.set(\"PiletaRedondaB\", dato[4]);\n\nmsg = {topic: \"ESP/Pileta/Redonda/Inicio\", payload: 1};\nnode.send(msg);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 665.6667022705078,
        "y": 1694.6667003631592,
        "wires": [
            [
                "6ef11710.ef55a8",
                "8a2636ea.f26d08"
            ]
        ]
    },
    {
        "id": "5912e31.3cdef1c",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 669.0000228881836,
        "y": 1734.6666612625122,
        "wires": []
    },
    {
        "id": "6ef11710.ef55a8",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 867.3333740234375,
        "y": 1656.1666259765625,
        "wires": []
    },
    {
        "id": "8a2636ea.f26d08",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "pedido",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 849,
        "y": 1694,
        "wires": []
    },
    {
        "id": "1a032a46.94b4e6",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Pileta/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 222,
        "y": 782,
        "wires": [
            [
                "78364cb0.17f444"
            ]
        ]
    },
    {
        "id": "9aca3948.2b27d8",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.topic.includes(\"desconectado\") || msg.topic.includes(\"Desconectado\")){\n    global.set(\"estadoPorche\", 0);\n    global.set(\"estado-Porche\", global.get(\"fechaCompleta\") + \" - Desc\\n\");\n    node.send(msg);}\nif (msg.topic.includes(\"Inicio\")){\n    global.set(\"estadoPorche\", 1);\n    global.set(\"estado-Porche\", global.get(\"fechaCompleta\") + \" - Con\\n\");\n    node.send(msg);}    \n    \n    node.status({text: global.get(\"estado-Porche\")});      ",
        "outputs": 1,
        "noerr": 0,
        "x": 1520,
        "y": 967,
        "wires": [
            [
                "6e57dcc9.a5e0a4"
            ]
        ]
    },
    {
        "id": "4f45ce91.ff8aa",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/Porche/Desconectado",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1220.25,
        "y": 972.47216796875,
        "wires": [
            [
                "9aca3948.2b27d8"
            ]
        ]
    },
    {
        "id": "348048e4.b64f38",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/Porche/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1262.744873046875,
        "y": 1012.0908203125,
        "wires": [
            [
                "9aca3948.2b27d8"
            ]
        ]
    },
    {
        "id": "3ae867e1.9fd498",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 185.5,
        "y": 1119,
        "wires": [
            [
                "7fd305be.ee069c"
            ]
        ]
    },
    {
        "id": "7fd305be.ee069c",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "var dato = global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\nmsg.payload = dato;\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 354.5,
        "y": 1121,
        "wires": [
            [
                "187be084.4a721f"
            ]
        ]
    },
    {
        "id": "187be084.4a721f",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 499.5,
        "y": 1122,
        "wires": []
    },
    {
        "id": "1775ff31.9ae781",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "reset cocina",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "reset",
        "payloadType": "str",
        "x": 1237.5,
        "y": 875,
        "wires": [
            [
                "8c6570cd.f6d52"
            ]
        ]
    },
    {
        "id": "8c6570cd.f6d52",
        "type": "mqtt out",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/Cocina/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1443.5,
        "y": 866,
        "wires": []
    },
    {
        "id": "14f7a80c.53c5b8",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Porche/BackUp",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 214,
        "y": 1858,
        "wires": [
            [
                "f5c50453.b20558",
                "825838c7.537038"
            ]
        ]
    },
    {
        "id": "f5c50453.b20558",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg.payload = msg.payload.substring(6);\nif (msg.payload.includes(\"undefined\"))return;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 451.16661071777344,
        "y": 1858.0001249313354,
        "wires": [
            [
                "af1b9fb1.5e15f",
                "e85b818a.48056"
            ]
        ]
    },
    {
        "id": "825838c7.537038",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 447.8332824707031,
        "y": 1818.416759967804,
        "wires": []
    },
    {
        "id": "af1b9fb1.5e15f",
        "type": "file",
        "z": "9c63fd61.9908c",
        "name": "back PiletaRedonda",
        "filename": "/home/pi/BackUpNodeRed/Porche.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 647.8332748413086,
        "y": 1859.6667428016663,
        "wires": [
            []
        ]
    },
    {
        "id": "e85b818a.48056",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 624.4999618530273,
        "y": 1819.6667428016663,
        "wires": []
    },
    {
        "id": "c1da2fbd.727f6",
        "type": "file in",
        "z": "9c63fd61.9908c",
        "name": "recover patioLuz",
        "filename": "/home/pi/BackUpNodeRed/Porche.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 390,
        "y": 1943,
        "wires": [
            [
                "96060df9.89a21",
                "3daf2c02.b84964"
            ]
        ]
    },
    {
        "id": "ab53c33b.79a1a",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "6",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 175.00000762939453,
        "y": 1942.999924659729,
        "wires": [
            [
                "c1da2fbd.727f6"
            ]
        ]
    },
    {
        "id": "96060df9.89a21",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "val. in. termo",
        "func": "var dato = msg.payload.split(\"#\");\nglobal.set(\"estLuzPorche\", dato[0]);\nglobal.set(\"pwmLuzPorche\", dato[1]);\nglobal.set(\"estLucesDicroicasPorche\", dato[2]);\nglobal.set(\"pwmLucesDicroicasPorche\", dato[3]);\n\nmsg = {topic: \"ESP/Porche/Inicio\", payload: 1};\nnode.send(msg);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 596.6667098999023,
        "y": 1939.6666250228882,
        "wires": [
            [
                "3392b131.43f76e",
                "d6637db0.e76ba"
            ]
        ]
    },
    {
        "id": "3daf2c02.b84964",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 600.0000305175781,
        "y": 1979.6665859222412,
        "wires": []
    },
    {
        "id": "3392b131.43f76e",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 798.333381652832,
        "y": 1901.1665506362915,
        "wires": []
    },
    {
        "id": "d6637db0.e76ba",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "pedido",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 780.0000076293945,
        "y": 1938.999924659729,
        "wires": []
    },
    {
        "id": "3c374cb5.85aa64",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 456.5,
        "y": 665,
        "wires": []
    },
    {
        "id": "844b8b90.689ce8",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 384.5,
        "y": 1190,
        "wires": [
            [
                "514d18e8.ebe378"
            ]
        ]
    },
    {
        "id": "514d18e8.ebe378",
        "type": "function",
        "z": "a89e305a.c50bb",
        "name": "",
        "func": "msg.payload = global.get(\"minTeclas\") + \"#\" + global.get(\"maxTeclas\") + \"#\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 535.5,
        "y": 1182,
        "wires": [
            [
                "855b4aa1.360b58"
            ]
        ]
    },
    {
        "id": "855b4aa1.360b58",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 725.5,
        "y": 1184,
        "wires": []
    },
    {
        "id": "e023e3a5.c7798",
        "type": "blynk-ws-in-write",
        "z": "a89e305a.c50bb",
        "name": "item a correguir",
        "pin": "19",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 217,
        "y": 1163,
        "wires": [
            [
                "514d18e8.ebe378"
            ]
        ]
    },
    {
        "id": "db4552e4.06486",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "terminalBlynk",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 809,
        "y": 389,
        "wires": []
    },
    {
        "id": "249cc871.8bc848",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg.payload = msg.payload;// + \"/n\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 566.5,
        "y": 309,
        "wires": [
            []
        ]
    },
    {
        "id": "932c6575.0ec8e8",
        "type": "blynk-ws-out-write",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pin": "105",
        "pinmode": 0,
        "client": "2c18e412.5f5cbc",
        "x": 617.5,
        "y": 205,
        "wires": []
    },
    {
        "id": "dbdf2ccf.6fa97",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado1#0#0#0#0#0#0#0",
        "payloadType": "str",
        "x": 1344.5,
        "y": 30,
        "wires": [
            [
                "c744389d.e36448"
            ]
        ]
    },
    {
        "id": "c744389d.e36448",
        "type": "mqtt out",
        "z": "65561250.4225fc",
        "name": "",
        "topic": "salamandra/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1603.5,
        "y": 82,
        "wires": []
    },
    {
        "id": "e1445415.46b0f8",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#0#0#0#0#0#0",
        "payloadType": "str",
        "x": 1346,
        "y": 69,
        "wires": [
            [
                "c744389d.e36448"
            ]
        ]
    },
    {
        "id": "2b7114d5.f7e4fc",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#1#0#0#0#0#0",
        "payloadType": "str",
        "x": 1343,
        "y": 103,
        "wires": [
            [
                "c744389d.e36448"
            ]
        ]
    },
    {
        "id": "b552a2ff.19bbb",
        "type": "inject",
        "z": "65561250.4225fc",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "estado0#0#0#0#0#0#0#0",
        "payloadType": "str",
        "x": 1341,
        "y": 141,
        "wires": [
            [
                "c744389d.e36448"
            ]
        ]
    },
    {
        "id": "a84e6bdc.49bac8",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "crepMQTT",
        "qos": "2",
        "broker": "6b36e4a.1d30b1c",
        "x": 228,
        "y": 20,
        "wires": [
            [
                "cab2d6e1.105e98"
            ]
        ]
    },
    {
        "id": "cab2d6e1.105e98",
        "type": "delay",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pauseType": "delay",
        "timeout": "20",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 380,
        "y": 20,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "fa0cea4a.ecfb18",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg.payload = global.get(\"autoResistencia\") + \"#\" + global.get(\"tempTermoFin\") + \"#\" + global.get(\"tempMinimaResistenciaAuto\") + \"#\" + global.get(\"tempMaxResistenciaAuto\")  + \"#\" + global.get(\"pedResistencia\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 769.5,
        "y": 41,
        "wires": [
            [
                "f70400e6.356a3"
            ]
        ]
    },
    {
        "id": "8d279b21.01ad38",
        "type": "delay",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pauseType": "delay",
        "timeout": "200",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 627.5,
        "y": 35,
        "wires": [
            [
                "fa0cea4a.ecfb18"
            ]
        ]
    },
    {
        "id": "ca44f940.3997f8",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 834.5,
        "y": 81,
        "wires": [
            [
                "50c43d45.045d54"
            ]
        ]
    },
    {
        "id": "50c43d45.045d54",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg = {topic: \"ESP/TermoSolar/Recibo\", payload: 1}; node.send(msg);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1128.5,
        "y": 27,
        "wires": [
            [
                "59c990e2.85e21"
            ]
        ]
    },
    {
        "id": "59c990e2.85e21",
        "type": "mqtt out",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 1251.5,
        "y": 29,
        "wires": []
    },
    {
        "id": "f70400e6.356a3",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 936.5,
        "y": 16,
        "wires": []
    },
    {
        "id": "8246de34.6a911",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 788.5,
        "y": 480,
        "wires": [
            [
                "1c5c9391.f49c1c"
            ]
        ]
    },
    {
        "id": "1c5c9391.f49c1c",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "global.set(\"tiempoEncResis\", 0);\n\t      global.set(\"potenciaResistencia\", 0);",
        "outputs": 1,
        "noerr": 0,
        "x": 934.5,
        "y": 478,
        "wires": [
            []
        ]
    },
    {
        "id": "9b14bdc1.d9555",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/TermoSolar/controlResistencia",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 304,
        "y": 80,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "a5bd85f3.485068",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120.5,
        "y": 288,
        "wires": [
            [
                "6dfb52f7.940eec"
            ]
        ]
    },
    {
        "id": "6dfb52f7.940eec",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg.payload = global.get(\"habilitacionResistenciaTermo\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 255.5,
        "y": 242,
        "wires": [
            [
                "8a02ab9e.d9eb08"
            ]
        ]
    },
    {
        "id": "8a02ab9e.d9eb08",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 392.5,
        "y": 250,
        "wires": []
    },
    {
        "id": "c74f9237.4f812",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 77.5,
        "y": 349,
        "wires": [
            [
                "29794562.5266fa"
            ]
        ]
    },
    {
        "id": "5e8b6b82.b0bef4",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 77.5,
        "y": 458,
        "wires": []
    },
    {
        "id": "29794562.5266fa",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "msg.payload = global.get(\"potenciaResistencia\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 104.5,
        "y": 391,
        "wires": [
            [
                "5e8b6b82.b0bef4"
            ]
        ]
    },
    {
        "id": "c11e0b47.578438",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "reset Nano",
        "repeat": "86400",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "reset",
        "payloadType": "str",
        "x": 1131,
        "y": 703,
        "wires": [
            [
                "d568dd07.8f5e2"
            ]
        ]
    },
    {
        "id": "198b1db1.9acd92",
        "type": "inject",
        "z": "950c1426.ff4008",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 483.5,
        "y": 59,
        "wires": [
            [
                "2c590ed2.426b22"
            ]
        ]
    },
    {
        "id": "2c590ed2.426b22",
        "type": "mqtt out",
        "z": "950c1426.ff4008",
        "name": "",
        "topic": "ESP/Bano/Inicio",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 717.5,
        "y": 40,
        "wires": []
    },
    {
        "id": "953ddbf7.78ddc8",
        "type": "mqtt in",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/Cocina/Envio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1070,
        "y": 981,
        "wires": [
            []
        ]
    },
    {
        "id": "38731fde.e006a",
        "type": "inject",
        "z": "a89e305a.c50bb",
        "name": "",
        "repeat": "43200",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "reset",
        "payloadType": "str",
        "x": 120.5,
        "y": 719,
        "wires": [
            [
                "d42c8d52.8b487"
            ]
        ]
    },
    {
        "id": "d42c8d52.8b487",
        "type": "mqtt out",
        "z": "a89e305a.c50bb",
        "name": "",
        "topic": "ESP/Cocina/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 318.5,
        "y": 718,
        "wires": []
    },
    {
        "id": "9b83bd65.c2587",
        "type": "debug",
        "z": "a89e305a.c50bb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 518.5,
        "y": 741,
        "wires": []
    },
    {
        "id": "781ecbeb.90fd04",
        "type": "function",
        "z": "50119c6e.6ff584",
        "name": "tempLiving",
        "func": "if (msg.payload.substring(0, 6) == \"temp 5\")return;\nvar dato = msg.payload.substring(8);\ndato = dato.split(\"#\");\n// msg.payload = dato[9];\n// return msg\n//respTemp0#0#0#0#9#10#9#9#10#12.00#41.00\n  \n// var temp = parseFloat(msg.payload);// + (-1.5);\n// if (parseFloat(msg.payload) !== 0){\n    global.set(\"tempLiving\", parseFloat(dato[9]).toFixed(1)); \n    global.set(\"humLiving\", parseFloat(dato[10]).toFixed(1));\n    msg= {topic: \"tempLiving\", payload: global.get(\"tempLiving\")}; node.send(msg);\n    msg= {topic: \"humLiving\", payload: global.get(\"humLiving\")}; node.send(msg);\n    node.status({text: \"temp: \" + global.get(\"tempLiving\") + \" hum:\" + global.get(\"humLiving\") + \" -- \" + global.get(\"hsCpu\")});\n// }",
        "outputs": 1,
        "noerr": 0,
        "x": 439,
        "y": 485,
        "wires": [
            [
                "1f5e6cad.b1cab3"
            ]
        ]
    },
    {
        "id": "4f5432e6.98d83c",
        "type": "mqtt in",
        "z": "50119c6e.6ff584",
        "name": "salamandra/Envio",
        "topic": "salamandra/Envio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 197,
        "y": 483,
        "wires": [
            [
                "781ecbeb.90fd04",
                "38526b0d.0344a4"
            ]
        ]
    },
    {
        "id": "395f36a7.91527a",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1487.5,
        "y": 371,
        "wires": []
    },
    {
        "id": "4b971887.75de38",
        "type": "debug",
        "z": "50119c6e.6ff584",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 721.5,
        "y": 449,
        "wires": []
    },
    {
        "id": "91a1bf54.5314c",
        "type": "function",
        "z": "950c1426.ff4008",
        "name": "",
        "func": "var pin = parseInt(msg.pin);\nvar intPayload = parseInt(msg.payload);\nvar topic = msg.topic;\nvar topicInicial = msg.topic;\nvar dato;\nvar timerLuces = 12000;  \ncontext.parcheDejarApagarLuz = context.parcheDejarApagarLuz || 0;\nvar date = new Date();\n\nif (global.get(\"estLuzBano\") === undefined)global.set(\"estLuzBano\", 0);\nif (global.get(\"pwmLuzBano\") === undefined)global.set(\"pwmLuzBano\", 512);\nif (global.get(\"modoDucha\") === undefined)global.set(\"modoDucha\", 0);\nif (global.get(\"estDucha\") === undefined)global.set(\"estDucha\", 0);\nif (global.get(\"pwmDucha\") === undefined)global.set(\"pwmDucha\", 512);\nif (global.get(\"estLuzEspejo\") === undefined)global.set(\"estLuzEspejo\", 0);\nif (global.get(\"estExtractorBano\") === undefined)global.set(\"estExtractorBano\", 0);\nif (global.get(\"timerExtractorBano\") === undefined)global.set(\"timerExtractorBano\", 5);\n\n\nif (topic == \"aviso/Alarma\" && global.get(\"estadoAlarma\") === 1){\n  global.set(\"estLuzBano\", 0);\n  global.set(\"estDucha\", 0);\n  global.set(\"estLuzEspejo\", 0);\n  global.set(\"estExtractorBano\", 0);  \n  enviarBlynk();\n  enviarMQTT();\n}\n\nif (topic == \"aviso/Alarma\"){\n  if (global.get(\"estLuzBano\") === 1 && global.get(\"estadoAlarma\") === 1)apagadoLuces();\n  context.parcheDejarApagarLuz = date.getTime();\n  return;\n}\n\n// if (topic == \"ESP/Bano/Desconectado\") {\n//     enviarMQTT();\n//     return;\n// }\n\nif (topic == \"ESP/Pasillo/Iluminacion/Envio\") {\n  global.set(\"estLuzPasillo\", parseInt(msg.payload.substring(4)));\n  msg = {pin: 44, payload: global.get(\"estLuzPasillo\")}; node.send([null, msg]);  \n  }\n\nif (topic == \"google/Baño\"){\n  enviarBlynk();\n  enviarMQTT();\n}\n\nif (topic == \"crepMQTT\"){enviarMQTT(); return;}\n\nif (topic == \"ESP/Bano/Inicio\"){  \n    var fallasBano = global.get(\"fallasBano\") + 1;\n    global.set(\"fallasBano\", fallasBano);\n    global.set(\"fallasBano\", msg.payload);// msg = {topic: \"fallas_MQTT\", payload: 1}; node.send([msg, null]);\n    msg = {topic: \"terminalBlynk\", payload: global.get(\"hsCpu\") + \"  ResetNano Baño\" + \"\\n\"}; node.send([msg, null]);\n    topicInicial = \"ESP/Bano/Inicio\";\n    enviarMQTT();\n    return;\n}\n\nif (topic == \"ESP/Bano/Envio\"){\n  if (msg.payload == \"timerExtractorSI\"){\n    msg = {pin: 43, color: \"#ED9D00\", payload: global.get(\"estExtractorBano\")}; node.send([null, msg]);\n    return;\n  }\n  if (msg.payload == \"timerExtractorNO\"){\n    global.set(\"estExtractorBano\", 0);\n    msg = {pin: 43, color: \"#23C48E\", payload: global.get(\"estExtractorBano\")}; node.send([null, msg]);\n    return;\n  } \n  dato = msg.payload.split(\"#\");\n  global.set(\"estLuzBano\", parseInt(dato[0]));\n  global.set(\"estLuzEspejo\", parseInt(dato[1]));\n  global.set(\"modoDucha\", parseInt(dato[2]));\n  global.set(\"estDucha\", parseInt(dato[3]));\n  global.set(\"estExtractorBano\", parseInt(dato[4]));  \n  enviarBlynk();\n  return;\n}\n// if (global.get(\"luzBano\") === 0 && context.parcheDejarApagarLuz === 1)context.parcheDejarApagarLuz = 0;\n\nswitch (pin){\n  case 39:  \n    global.set(\"modoDucha\", intPayload);\n    if (msg.tema == \"node\")enviarBlynk();\n    enviarMQTT();\n  break;\n  case 40:\n    if (intPayload === 0){global.set(\"modoDucha\", 1); global.set(\"estDucha\", 0);}\n    if (intPayload === 1){global.set(\"modoDucha\", 0); global.set(\"estDucha\", 1);}\n    if (parseInt(global.get(\"Dia\")) === 0 && parseInt(global.get(\"estDucha\")) === 0)global.set(\"estLuzBano\", 1);\n    if (msg.tema = \"node\")enviarBlynk();\n    enviarBlynk();\n    enviarMQTT();\n  break;\n  case 41:\n    global.set(\"estLuzBano\", intPayload);\n    if (global.get(\"estLuzBano\") === 0)global.set(\"estLuzEspejo\", 0);\n    context.parcheDejarApagarLuz = date.getTime();\n    if (msg.tema = \"node\")enviarBlynk();\n    enviarMQTT();  \n  break;\n  case 42:\n    global.set(\"estLuzEspejo\", intPayload);\n    // context.parcheDejarApagarLuz = date.getTime();\n    if (msg.tema = \"node\")enviarBlynk();\n    enviarMQTT();  \n  break;\n  case 43:\n    global.set(\"estExtractorBano\", intPayload);\n    // context.parcheDejarApagarLuz = date.getTime();\n    if (msg.tema = \"node\")enviarBlynk();\n    enviarMQTT();  \n  break;\n  case 44:\n    global.set(\"estLuzPasillo\", intPayload);\n    // context.parcheDejarApagarLuz = date.getTime();\n    if (msg.tema = \"node\")enviarBlynk();\n    msg = {topic: \"ESP/Pasillo/Iluminacion/Recibo\", payload: global.get(\"estLuzPasillo\")}; node.send([msg, null]);\n  break;    \n}\n\nfunction apagadoLuces(){\n  global.set(\"estLuzBano\", 0);\n  global.set(\"estDucha\", 0);\n  global.set(\"estLuzEspejo\", 0);\n  global.set(\"estExtractorBano\", 0); \n  enviarBlynk();\n  enviarDatos();\n}\n\nnode.status({text: context.parcheDejarApagarLuz});\n\nfunction enviarBlynk(){\n  msg = {pin: 39, payload: global.get(\"modoDucha\")}; node.send([null, msg]);\n  msg = {pin: 40, payload: global.get(\"estDucha\")}; node.send([null, msg]);\n  msg = {pin: 41, payload: global.get(\"estLuzBano\")}; node.send([null, msg]);\n  msg = {pin: 42, payload: global.get(\"estLuzEspejo\")}; node.send([null, msg]);\n  msg = {pin: 43, payload: global.get(\"estExtractorBano\")}; node.send([null, msg]);\n  msg = {pin: 44, payload: global.get(\"estLuzPasillo\")}; node.send([null, msg]);\n  msg = {topic: \"bano/nodeRed\", payload: 1}; node.send([msg, null]);\n}\n\nfunction enviarMQTT(){\n  var dato = global.get(\"estLuzBano\") + \"#\" + global.get(\"pwmLuzBano\") + \"#\" + global.get(\"modoDucha\") + \"#\" + global.get(\"estDucha\") + \"#\" + global.get(\"pwmDucha\");\n  dato += \"#\" + global.get(\"estLuzEspejo\") + \"#\" + global.get(\"estExtractorBano\") + \"#\" + global.get(\"timerExtractorBano\") + \"#\" + global.get(\"Dia\");\n\n  if (topicInicial == \"ESP/Bano/Inicio\" || topicInicial == \"aviso/Alarma\" || topicInicial == \"crepMQTT\") dato +=\"#\";\n\n    msg = {topic: \"ESP/Bano/Recibo\", payload: dato}; node.send([msg, null]);\n    msg = {topic: \"bano/nodeRed\", payload: 1}; node.send([msg, null]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 149,
        "y": 227,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "3ab3f828.cf2788",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 678.5,
        "y": 520,
        "wires": []
    },
    {
        "id": "76ef6fe0.34343",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 458,
        "y": 729,
        "wires": []
    },
    {
        "id": "6f2eb890.0ddcc8",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "andando bien 09/08/2020",
        "func": "    // global.set(\"incrementoBaño\", 10);\n    var pin = parseInt(msg.pin);\n    var intPayload = parseInt(msg.payload);\n    var topic = msg.topic;\n    var dato;\n    \n\n    if (msg.topic == \"crepMQTT\"){//} || msg.topic == \"PatioLuz/Inicio\" || msg.topic == \"ESP/Escaleras/Inicio\"){\n      if (parseInt(global.get(\"Dia\")) === 1){\n          global.set(\"estPalioLuz\", 0);\n          global.set(\"estLuzCascada\", 0);\n          global.set(\"estTopeCascada\", 0); \n          global.set(\"estMitadCascada\", 0);\n          global.set(\"estPiletaCascada\", 0); \n          enviarMQTT(\"patioLuz\");\n          global.set(\"estEscaleras\", 0);\n          global.set(\"estReflectorPergola\", 0);\n          global.set(\"estLucesPergola\", 0);\n          global.set(\"estLucesPasadaAuto\", 0);\n          enviarMQTT(\"escaleras\");\n          global.set(\"estLuzPorche\", 0);\n          enviarMQTT(\"porche\");\n      }\n      if (parseInt(global.get(\"Dia\")) === 0){\n          global.set(\"estLuzCascada\", 1);\n          global.set(\"estTopeCascada\", 1); \n          global.set(\"estMitadCascada\", 1);\n          global.set(\"estPiletaCascada\", 1); \n          enviarMQTT(\"patioLuz\"); \n          global.set(\"estEscaleras\", 1); \n          global.set(\"estReflectorPergola\", 0);\n          // global.set(\"pwmReflectorPergola\", 5);\n          global.set(\"estLucesPergola\", 1);\n          // global.set(\"pwmLucesPergola\", 10);      \n          global.set(\"estLucesPasadaAuto\", 1);\n          // global.set(\"pwmLucesPasadaAuto\", 100);\n          enviarMQTT(\"escaleras\");\n          global.set(\"estLuzPorche\", 1);\n          enviarMQTT(\"porche\");          \n      }  \n      return;\n    }\n\n    if (msg.topic == \"PatioLuz/Inicio\"){\n        enviarMQTT(\"patioLuz\"); \n        return;    \n    }\n\n    if (msg.topic == \"ESP/Porche/Inicio\"){\n        enviarMQTT(\"porche\"); \n        return;    \n    }    \n\n    if (msg.topic == \"ESP/Pileta/Redonda/Inicio\"){\n        enviarMQTT(\"PiletaRedonda\"); \n        return;    \n    }\n\n    if (msg.topic == \"ESP/Escaleras/Inicio\"){\n        enviarMQTT(\"escaleras\"); \n        return;    \n    }\n\n    // node.status({text: context.item});\n\n    switch (pin){\n      case 8:\n        switch (parseInt(context.item)){\n            case 4:\n                global.set(\"IslaR\", msg.arrayOfValues[0]);\n                global.set(\"IslaG\", msg.arrayOfValues[1]);\n                global.set(\"IslaB\", msg.arrayOfValues[2]);\n                // msg = {pin: 32, payload: \"12\"}; node.send([null, msg]);\n                global.set(\"estIslaRGB\", 1);\n                enviarMQTT(\"living\");\n                return;\n            break;\n            case 6:\n                global.set(\"topeCascadaR\", msg.arrayOfValues[0]); global.set(\"mitadCascadaR\", msg.arrayOfValues[0]); global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"topeCascadaG\", msg.arrayOfValues[1]); global.set(\"mitadCascadaG\", msg.arrayOfValues[1]); global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"topeCascadaB\", msg.arrayOfValues[2]); global.set(\"mitadCascadaB\", msg.arrayOfValues[2]); global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\");\n                return;\n            break;\n            case 7:\n                global.set(\"topeCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"topeCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"topeCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\");\n                return;\n            break;\n            case 8:\n                global.set(\"mitadCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"mitadCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"mitadCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\");\n                return;\n            break;\n            case 9:\n                global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\"); \n                return;\n            case 16:\n                global.set(\"PiletaRedondaR\", msg.arrayOfValues[0]);\n                global.set(\"PiletaRedondaG\", msg.arrayOfValues[1]);\n                global.set(\"PiletaRedondaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"PiletaRedonda\"); \n                return;            \n            break;          \n        }  \n\n      case 18:\n        global.set(\"itemPotencia\", msg.payload);\n        // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n          context.item = parseInt(msg.payload);\n          node.status({text: context.item + \" - \" + msg.payload});\n          switch(parseInt(msg.payload)){\n              case 1:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n              break;\n              case 2:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n              break;\n              case 3:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n              break;\n              case 4:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Led Living\", payload: global.get(\"ledLiving\")};\n              break;\n              case 5:\n                  msg = {pin: 21, label: \"Luz Casc\", payload: global.get(\"estLuzCascada\")}; node.send([null, msg]);\n                  msg = {pin: 21, label: \"Patio Luz\", payload: global.get(\"estPalioLuz\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 70, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n              break; \n              case 6:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Cascada Completa\", payload: global.get(\"ledTopeCascada\")};\n              break;              \n              case 7:\n                  msg = {pin: 21, label: \"Top Casc\", payload: global.get(\"estTopeCascada\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Top Casc\", payload: global.get(\"modoLed3Cascada\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 0, max: 255, label: \"Tope Cascada\", payload: global.get(\"ledTopeCascada\")}; node.send([null, msg]);\n                  return;\n              break; \n              case 8:\n                  msg = {pin: 21, label: \"Mit Casc\", payload: global.get(\"estMitadCascada\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Mit Casc\", payload: global.get(\"modoLed1Cascada\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 0, max: 255, label: \"Mitad Cascada\", payload: global.get(\"ledMitadCascada\")}; node.send([null, msg]);\n                  return;\n              break; \n              case 9:\n                  msg = {pin: 21, label: \"Pil Casc\", payload: global.get(\"estPiletaCascada\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Pil Casc\", payload: global.get(\"modoLed2Cascada\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 0, max: 255, label: \"Pileta Cascada\", payload: global.get(\"ledPiletaCascada\")}; node.send([null, msg]);\n                  return;\n              break;      \n              case 10:\n                  msg = {pin: 19, min: 1, max: 100, label: \"Ducha de bano\", payload: global.get(\"pwmDucha\")};\n              break;     \n              case 11:\n                  msg = {pin: 19, min: 1, max: 100, label: \"Luz Bano\", payload: global.get(\"pwmLuzBano\")};\n              break;\n              case 12:\n                  msg = {pin: 21, label: \"Escaleras\", payload: global.get(\"estEscaleras\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Pot Escaleras\", payload: global.get(\"pwmEscaleras\")};\n              break;     \n              case 13:\n                  msg = {pin: 21, label: \"Refl Perg\", payload: global.get(\"estReflectorPergola\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Ref Pergola\", payload: global.get(\"pwmReflectorPergola\")};\n              break;                \n              case 14:\n                  msg = {pin: 21, label: \"Luces Perg\", payload: global.get(\"estLucesPergola\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Luces Pergola\", payload: global.get(\"pwmLucesPergola\")};\n              break;  \n              case 15:\n                  msg = {pin: 21, label: \"Luces Pasada Auto\", payload: global.get(\"estLucesPasadaAuto\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Luces Pas Auto\", payload: global.get(\"pwmLucesPasadaAuto\")};\n              break;       \n              case 16:\n                  msg = {pin: 21, label: \"Luces Pileta Redonda\", payload: global.get(\"estLucesPiletaRedonda\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Luz Pil Red\", payload: global.get(\"modoLucesPiletaRedonda\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 255, label: \"Luces Pil Red\", payload: global.get(\"pwmLucesPiletaRedonda\")};\n              break; \n              case 17:\n                  msg = {pin: 19, min: 0, max: 100, label: \"Potencia Porche\", payload: global.get(\"pwmPorche\")};\n                  msg = {pin: 21, label: \"Luz Porche\", payload: global.get(\"estLuzPorche\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Potencia Luz Porche\", payload: global.get(\"pwmPorche\")};\n              break;                             \n              case 18:\n                  msg = {pin: 19, min: 0, max: 100, label: \"Potencia Dicroicas Porche\", payload: global.get(\"pwmDicroicasPorche\")};\n                  msg = {pin: 21, label: \"Luz Dicroicas Porche\", payload: global.get(\"estLucesDicroicasPorche\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Potencia Dicroicas Porche\", payload: global.get(\"pwmDicroicasPorche\")};                  \n              break;  \n              \n              case 19:\n                  msg = {pin: 19, min: 0, max: 98, label: \"Temp Max Termo (Seg)\", payload: global.get(\"tempMaximaTermo\")};                  \n              break;\n              case 20:\n                    var va2 = parseInt(global.get(\"tempMinimaResistenciaAuto\")) + 10;\n                    node.status({text: va2});\n                  msg = {pin: 19, min: 40, max: global.get(\"tempMaximaTermo\"), label: \"Temp Max Termo (Auto)\", payload: global.get(\"tempMaxResistenciaAuto\")};                  \n              break;\n              case 21:\n                  msg = {pin: 19, min: 0, max: global.get(\"tempMaximaTermo\"), label: \"Temp Min Termo (Man)\", payload: global.get(\"tempMaxResistenciaManual\")};                  \n              break;\n              case 22:\n                  msg = {pin: 19, min: 40, max: global.get(\"tempMaximaTermo\"), label: \"Temp Min Termo (Auto)\", payload: global.get(\"tempMinimaResistenciaAuto\")};                 \n              break;\n\n              case 23:\n                  msg = {pin: 21, label: \"Encendido Caldera\", payload: global.get(\"marchaCaldera\")};                 \n              break;\n              case 24:\n                  if (parseInt(global.get(\"modoCaldera\")) === 1){\n                    msg = {pin: 21, label: \"Caldera Auto\", payload: global.get(\"modoCaldera\")};//1= automatico 0==  manual  \n                  }\n                  if (parseInt(global.get(\"modoCaldera\")) === 0){\n                    msg = {pin: 21, label: \"Caldera Man\", payload: global.get(\"modoCaldera\")};//1= automatico 0==  manual  \n                  }                                   \n              break;              \n              case 25:\n                  msg = {pin: 19, min: 10, max: 30, label: \"Temp Min Casa\", payload: global.get(\"tempMinimaCasa\")}; //node.send([null, msg]);\n                  // msg = {pin: 21, label: \"Temp Min Casa\", payload: global.get(\"tempMinimaCasa\")};                 \n              break;\n              case 26:\n                  msg = {pin: 19, min: 10, max: 30, label: \"Temp Max Casa\", payload: global.get(\"tempMaximaCasa\")}; //node.send([null, msg]);\n                  // msg = {pin: 21, label: \"Temp Max Casa\", payload: global.get(\"tempMaximaCasa\")};                 \n              break;                            \n              case 27:\n                  msg = {pin: 21, label: \"Hab Rad Living\", payload: global.get(\"habilitacionRadLiving\")};                 \n              break;\n              case 28:\n                  msg = {pin: 21, label: \"Hab Rad Comedor\", payload: global.get(\"habilitacionRadComedor\")};                 \n              break;\n              case 29:\n                  msg = {pin: 21, label: \"Hab Rad Cocina\", payload: global.get(\"habilitacionRadCocina\")};                 \n              break;\n              case 30:\n                  msg = {pin: 21, label: \"Hab Rad Pasillo\", payload: global.get(\"habilitacionRadPasillo\")};                 \n              break;\n              case 31:\n                  msg = {pin: 21, label: \"Hab Rad Hab1\", payload: global.get(\"habilitacionRadHabitacion1\")};                 \n              break;\n              case 32:\n                  msg = {pin: 21, label: \"Hab Rad Hab2\", payload: global.get(\"habilitacionRadHabitacion2\")};                 \n              break;\n              case 33:\n                  msg = {pin: 21, label: \"Hab Rad Lavadero\", payload: global.get(\"habilitacionRadLavadero\")};                 \n              break;\n\n\n              case 34:\n                  msg = {pin: 21, label: \"Marcha Resistencia\", payload: global.get(\"habilitacionResistenciaTermo\")};                \n              break;                            \n\n              case 35: \n                  msg = {pin: 21, label: \"Est Dia\", payload: global.get(\"Dia\")}; node.send([null, msg]);\n              break;              \n              case 36: \n                  msg = {pin: 19, min: 15, max: 240, label: \"timer extractor baño\", payload: global.get(\"timerExtractorBano\")};\n              break;\n              case 37:\n                  msg = {pin: 19, min: 10, max: 100, label: \"tiempo MIN teclas\", payload: global.get(\"minTeclas\")};\n              break;       \n              case 38:\n                  msg = {pin: 19, min: 400, max: 2000, label: \"tiempo MAX teclas\", payload: global.get(\"maxTeclas\")};\n              break;   \n              case 39:\n                  msg = {pin: 19, min: 1, max: 100, label: \"delay buzzer\", payload: global.get(\"delayBuzzer\")};\n              break;                              \n          }\n          node.send([null, msg]);\n          return;\n        // }\n      break;\n\n      case 19:\n        // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n          var valor = parseInt(msg.payload);\n          switch(context.item){\n              case 1:\n                  // if (global.get(\"estLiving\") === 0)return;\n                  global.set(\"potLiving\", valor);\n                  global.set(\"potIsla\", valor);\n                  global.set(\"potCielorrazo\", valor);\n                  global.set(\"ledLiving\", valor);\n                  enviarMQTT(\"living\");\n              break;\n              case 2:\n                  // if (global.get(\"estIsla\") === 0)return;\n                  global.set(\"potIsla\", valor);\n                  enviarMQTT(\"living\");\n              break;\n              case 3:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"potCielorrazo\", valor);\n                  enviarMQTT(\"living\");\n              break;\n              case 4:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"ledLiving\", valor);\n                  global.set(\"IslaR\", valor);\n                  global.set(\"IslaG\", valor);\n                  global.set(\"IslaB\", valor);\n                  msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"living\");\n              break;          \n              case 5:\n                  // if (global.get(\"Dia\") === 1)return;\n                  global.set(\"pwmPatioLuz\", valor);\n                  enviarMQTT(\"patioLuz\");\n                  return;\n              case 6:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"topeCascadaR\", valor);\n                  global.set(\"topeCascadaG\", valor);\n                  global.set(\"topeCascadaB\", valor);\n                  global.set(\"mitadCascadaR\", valor);\n                  global.set(\"mitadCascadaG\", valor);\n                  global.set(\"mitadCascadaB\", valor);\n                  global.set(\"piletaCascadaR\", valor);\n                  global.set(\"piletaCascadaG\", valor);\n                  global.set(\"piletaCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break;               \n              case 7:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"topeCascadaR\", valor);\n                  global.set(\"topeCascadaG\", valor);\n                  global.set(\"topeCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break; \n              case 8:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"mitadCascadaR\", valor);\n                  global.set(\"mitadCascadaG\", valor);\n                  global.set(\"mitadCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break; \n              case 9:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"piletaCascadaR\", valor);\n                  global.set(\"piletaCascadaG\", valor);\n                  global.set(\"piletaCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break;                                   \n              case 10:\n                  // if (global.get(\"estDucha\") === 0)return;  \n                  global.set(\"pwmDucha\", valor);\n                  enviarMQTT(\"bano\");\n                  return;\n              case 11:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmLuzBano\", valor);\n                  enviarMQTT(\"bano\");\n                  return;  \n              case 12:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmEscaleras\", valor);\n                  enviarMQTT(\"escaleras\");\n                  return;  \n              case 13:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmReflectorPergola\", valor);\n                  enviarMQTT(\"escaleras\");\n                  return;\n              case 14:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmLucesPergola\", valor);\n                  enviarMQTT(\"escaleras\");\n                  return; \n              case 15:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmLucesPasadaAuto\", valor);\n                  enviarMQTT(\"escaleras\");\n                  return;          \n              case 16:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"PiletaRedondaR\", valor);\n                  global.set(\"PiletaRedondaG\", valor);\n                  global.set(\"PiletaRedondaB\", valor);\n                  enviarMQTT(\"PiletaRedonda\");\n                  return;                                 \n              case 17:\n                  global.set(\"pwmPorche\", valor);\n                  enviarMQTT(\"porche\");\n                  return;\n              case 18:\n                  global.set(\"pwmDicroicasPorche\", valor);\n                  enviarMQTT(\"porche\");\n                  return;\n\n              case 19:\n                  global.set(\"tempMaximaTermo\", valor);\n                  enviarMQTT(\"termoSolar\");\n                  return;\n              case 20:\n                  global.set(\"tempMaxResistenciaAuto\", valor);\n                  enviarMQTT(\"termoSolar\");\n                  return;\n              case 21:\n                  global.set(\"tempMaxResistenciaManual\", valor);\n                  enviarMQTT(\"termoSolar\");\n                  return;\n              case 22:\n                  global.set(\"tempMinimaResistenciaAuto\", valor);\n                  enviarMQTT(\"termoSolar\");\n                  return;                                                      \n\n              case 25:\n                  global.set(\"tempMinimaCasa\", valor);\n                  enviarMQTT(\"lavaderoCaldera\");\n                  return;\n              case 26:\n                  global.set(\"tempMaximaCasa\", valor);\n                  enviarMQTT(\"lavaderoCaldera\");\n                  return;                  \n\n              case 36:\n                  global.set(\"timerExtractorBano\", valor);\n                  enviarMQTT(\"baño\");\n                  return;                                    \n              case 37:\n                  global.set(\"minTeclas\", valor);\n                  enviarMQTT(\"configGenericas\");\n                  return;     \n              case 38:\n                  global.set(\"maxTeclas\", valor);\n                  enviarMQTT(\"configGenericas\");\n                  return;              \n              case 39:  \n                  global.set(\"delayBuzzer\", valor);\n                  enviarMQTT(\"configGenericas\");\n                  return;              \n                }  \n              break;\n      case 21:\n      // node.status({text: context.item + \" - \" + msg.payload});\n        switch(context.item){\n          case 5:\n            global.set(\"estPalioLuz\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            return;\n          break;\n          case 6:\n            global.set(\"estLuzCascada\", msg.payload);\n            global.set(\"estTopeCascada\", msg.payload);\n            global.set(\"estMitadCascada\", msg.payload);\n            global.set(\"estPiletaCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            return;\n          break;      \n          case 7:\n            global.set(\"estTopeCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            return;\n          break;\n          case 8:\n            global.set(\"estMitadCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            return;\n          break;\n          case 9:\n            global.set(\"estPiletaCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            return;\n          break;\n          case 12:\n            global.set(\"estEscaleras\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            return;\n          case 13:\n            global.set(\"estReflectorPergola\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            return;     \n          case 14:\n            global.set(\"estLucesPergola\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            return;  \n          case 15:\n            global.set(\"estLucesPasadaAuto\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            return;   \n          case 16:\n            global.set(\"estLucesPiletaRedonda\", msg.payload);\n            enviarMQTT(\"PiletaRedonda\"); \n            return;       \n          case 17:\n            global.set(\"estLuzPorche\", msg.payload);\n            enviarMQTT(\"porche\"); \n            return; \n          case 18:\n            global.set(\"estLucesDicroicasPorche\", msg.payload);\n            enviarMQTT(\"porche\"); \n            return; \n\n          case 23:\n            global.set(\"marchaCaldera\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 24:\n            global.set(\"modoCaldera\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return;             \n          case 27:\n            global.set(\"habilitacionRadLiving\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 28:\n            global.set(\"habilitacionRadComedor\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 29:\n            global.set(\"habilitacionRadCocina\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 30:\n            global.set(\"habilitacionRadPasillo\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 31:\n            global.set(\"habilitacionRadHabitacion1\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 32:\n            global.set(\"habilitacionRadHabitacion2\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 33:\n            global.set(\"habilitacionRadLavadero\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return;                                                                                  \n\n          case 34:\n            global.set(\"habilitacionResistenciaTermo\", msg.payload);\n            msg = {topic: \"ESP/TermoSolar/controlResistencia\", payload: 1}; node.send([msg, null, null]);\n            return;                         \n\n          case 35:\n            global.set(\"Dia\", msg.payload);\n            msg = {topic: \"crepMQTT\", payload: global.get(\"Dia\")};\n            node.send([msg, null]);\n            return;                                                 \n          break;      \n        }\n      break;\n      case 22:\n          global.set(\"bombaCascada\", parseInt(msg.payload));\n          // if (parseInt(msg.payload) === 0 && parseInt(global.get(\"Dia\")) === 0){\n          //   msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#\" + global.get(\"pwmPatioLuz\") + \"#0#0#1#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\")};      \n          // }\n          mensaje = \"bomba\" + global.get(\"bombaCascada\");\n          msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n          node.send([msg, null]);\n          return;\n      case 24:\n          switch(context.item){\n            case 7:\n              global.set(\"modoLed3Cascada\", msg.payload);\n              enviarMQTT(\"patioLuz\"); \n              return;\n            break;\n            case 8:\n              global.set(\"modoLed1Cascada\", msg.payload);\n              enviarMQTT(\"patioLuz\"); \n              return;\n            break;\n            case 9:\n              global.set(\"modoLed2Cascada\", msg.payload);\n              enviarMQTT(\"patioLuz\"); \n              return;\n            case 16:\n              global.set(\"modoLucesPiletaRedonda\", msg.payload);\n              enviarMQTT(\"PiletaRedonda\"); \n              return;          \n          break;\n        //   global.set(\"modoLed1Cascada\", parseInt(msg.payload));\n        //   enviarMQTT(\"patioLuz\");\n          return;\n        }\n      // case 24:\n      //     global.set(\"modoLed2Cascada\", parseInt(msg.payload));\n      //     enviarMQTT(\"patioLuz\");\n      //     return;\n      // case 25:\n      //     global.set(\"modoLed3Cascada\", parseInt(msg.payload));\n      //     enviarMQTT(\"patioLuz\");\n      //     return;\n    }\n\n    function enviarMQTT(caso){\n    var dato;\n      if (caso == \"bano\"){\n          dato = \"estado\" + global.get(\"estLuzBano\") + \"#\" + global.get(\"pwmLuzBano\");\n          dato += \"#\" + global.get(\"estLuzEspejo\") + \"#\" + global.get(\"pwmLuzBano\");\n          dato += \"#1\" ;//+ global.get(\"estExtractorBano\");\n          dato += \"#\" + global.get(\"incrementoBaño\");\n          dato += \"#\" + global.get(\"minTeclas\");\n          dato += \"#\" + global.get(\"maxTeclas\");\n          dato += \"#\" + global.get(\"delayBuzzer\");          \n        msg = {topic: \"ESP/Bano/Recibo\", payload: dato};\n      }\n\n    if (caso == \"PiletaRedonda\"){\n         \n        dato = \"estado\" + global.get(\"estLucesPiletaRedonda\") + \"#\" + global.get(\"modoLucesPiletaRedonda\") + \"#\";\n        dato = dato + global.get(\"PiletaRedondaR\") + \"#\";\n        dato = dato + global.get(\"PiletaRedondaG\") + \"#\";\n        dato = dato + global.get(\"PiletaRedondaB\");\n        msg = {topic: \"ESP/Pileta/Redonda/BackUp\", payload: dato}; node.send([msg, null]);\n\n        if (parseInt(global.get(\"estLucesPiletaRedonda\")) === 1){\n           dato = \"estado\" + global.get(\"modoLucesPiletaRedonda\") + \"#\";\n           dato = dato + global.get(\"PiletaRedondaR\") + \"#\";\n           dato = dato + global.get(\"PiletaRedondaG\") + \"#\";\n           dato = dato + global.get(\"PiletaRedondaB\") + \"#\";}\n        else{  \n            dato = \"estado0#0#0#0#\"; \n           }\n        dato = dato + \"1#10#1#255\";\n        // dato = dato + global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\n        msg = {topic: \"ESP/Pileta/Redonda/Recibo\", payload: dato}; //node.send([msg, null]);\n        // return;\n    }\n\n    if (caso == \"porche\"){\n      //estado0#100#1\n      //ESP/Porche/Recibo\n      dato = \"estado\" + global.get(\"estLuzPorche\") + \"#\" + global.get(\"pwmPorche\") + \"#\";\n      dato = dato + global.get(\"estLucesDicroicasPorche\") + \"#\";\n      dato = dato + global.get(\"pwmDicroicasPorche\") + \"#\";\n      msg = {topic: \"ESP/Porche/BackUp\", payload: dato}; node.send([msg, null]);\n\n      if (parseInt(global.get(\"estLuzPorche\")) === 1){\n         dato = \"estado\" + global.get(\"pwmPorche\") + \"#\";\n         dato = dato + global.get(\"pwmDicroicasPorche\") + \"#1\";}\n      if (parseInt(global.get(\"estLuzPorche\")) === 0){dato = \"estado0#0#1\"}         \n      msg = {topic: \"ESP/Porche/Recibo\", payload: dato};\n    }\n\n    if (caso == \"escaleras\"){\n\n        dato = \"estado\" + global.get(\"pwmReflectorPergola\") + \"#\";\n        dato = dato + global.get(\"pwmEscaleras\") + \"#\";\n        dato = dato + global.get(\"pwmLucesPergola\") + \"#\";\n        dato = dato + global.get(\"pwmLucesPasadaAuto\");\n        msg = {topic: \"ESP/Escaleras/BackUp\", payload: dato}; node.send([msg, null]);\n\n        if (parseInt(global.get(\"estReflectorPergola\")) === 1){\n        dato = \"estado\" + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estReflectorPergola\")) === 0){\n        dato = \"estado0\";//#0#0#0#0#0#1\";\n        }\n        dato = dato + \"#\";\n        if (parseInt(global.get(\"estEscaleras\")) === 1){\n        // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n        dato = dato + global.get(\"pwmEscaleras\");\n        // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estEscaleras\")) === 0){\n        dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n        }    \n        dato = dato + \"#\";\n        if (parseInt(global.get(\"estLucesPergola\")) === 1){\n        // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n        dato = dato + global.get(\"pwmLucesPergola\");\n        // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estLucesPergola\")) === 0){\n        dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n        }   \n        dato = dato + \"#\";\n        if (parseInt(global.get(\"estLucesPasadaAuto\")) === 1){\n        // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n        dato = dato + global.get(\"pwmLucesPasadaAuto\");\n        // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estLucesPasadaAuto\")) === 0){\n        dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n        } \n        dato = dato + \"#1\";                \n        //estado10#0#0#0#0#0#1\n        if (dato.includes(\"desconectado\")) return;\n        msg = {topic: \"ESP/Escaleras/Recibo\", payload: dato};\n    }  \n\n    if (caso == \"patioLuz\"){\n        var mensaje;\n\n        mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\";\n        mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n        mensaje = mensaje + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n        mensaje = mensaje + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n        mensaje = mensaje + global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\n        msg = {topic: \"PatioLuz/BackUp\", payload: mensaje}; node.send([msg, null]);\n\n        if (parseInt(global.get(\"estMitadCascada\")) === 0){\n          mensaje = \"estado0#0#0#0#\";\n        }\n          else{\n            mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\";\n          }\n\n        if (parseInt(global.get(\"estPalioLuz\")) === 0){\n          mensaje = mensaje + \"0#0#\";\n        }\n          else{\n            mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n          }      \n\n        // mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n\n        if (parseInt(global.get(\"estPiletaCascada\")) === 0){\n          mensaje = mensaje + \"0#0#0#0#\";\n        }\n          else{\n             mensaje = mensaje + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n          }\n\n        if (parseInt(global.get(\"estTopeCascada\")) === 0){\n          mensaje = mensaje + \"0#0#0#0#\";\n        }\n          else{\n             mensaje = mensaje + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n          }\n\n        mensaje = mensaje + global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\n\n        // if (parseInt(global.get(\"Dia\")) === 1){\n        //     msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#0#0#0#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\") + \"#\" + global.get(\"maxAuto\")};\n        //   } \n        //   else{   \n        //     msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n        //   }\n        if (mensaje.includes(\"desconectado\")) return;\n        msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n\n        //1#1023#32#118#118#118#0#1#1#undefined#45#45#45#0#181\n      }\n      \n\n      if (caso == \"living\"){\n        dato = global.get(\"estIsla\") + \",\";\n        dato += global.get(\"potIsla\") + \"#\";\n        dato += global.get(\"estCielorrazo\") + \",\";\n        dato += global.get(\"potCielorrazo\") + \"#\";  \n        dato += global.get(\"estIslaRGB\") + \",\";\n        dato += global.get(\"IslaR\") + \",\";\n        dato += global.get(\"IslaG\") + \",\";      \n        dato += global.get(\"IslaB\") + \"#\";\n\n        dato += global.get(\"pwmMaxLed\") + \"#\";\n        dato += global.get(\"pwmMinLed\") + \"#\";\n\n        dato += global.get(\"minTeclas\") + \"#\";\n        dato += global.get(\"maxTeclas\") + \"#\";\n        dato += global.get(\"doblePuls\");\n        dato += \"#\" + global.get(\"Dia\");\n\n        msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n        node.send([msg, null]);\n      }\n      if (caso == \"configGenericas\"){\n        dato = global.get(\"minTeclas\") + \"#\";\n        dato += global.get(\"maxTeclas\") + \"#\";\n        dato += global.get(\"delayBuzzer\");\n        msg = {topic: \"configTeclas\", payload: dato};\n      }\n    node.send([msg, null]);\n\n    if (caso == \"termoSolar\"){\n        payload = global.get(\"autoBomba\");\n        payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; \n        payload += global.get(\"tempMaximaTermo\") + \"#\";\n        payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n        msg.payload = payload;  \n        msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([msg, null, null]);\n    }\n\n    if (caso == \"termoSolar\"){\n        payload = global.get(\"autoBomba\");\n        payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; \n        payload += global.get(\"tempMaximaTermo\") + \"#\";\n        payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n        msg.payload = payload;  \n        msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([msg, null, null]);\n    }\n\n    if (caso == \"lavaderoCaldera\"){\n        payload = global.get(\"autoBomba\");\n        payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; \n        payload += global.get(\"tempMaximaTermo\") + \"#\";\n        payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n        msg.payload = payload;  \n        msg = {topic: \"ESP/lavadero/caldera\", payload: payload}; node.send([msg, null, null]);\n    }   \n\n        \n\n    // function enviarMQTT(){   \n    //     payload = global.get(\"autoBomba\");\n    //     // payload =\"0\";    \n    //     //payload += \"#\"; payload += global.get(\"autoResistencia\") + \"#\"; payload += global.get(\"autoToldo\") + \"#\"; \n    //     payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; //payload += global.get(\"pedToldo\") + \"#\"; \n    //     payload += global.get(\"tempMaximaTermo\");// + \"#\"; payload += global.get(\"tempMaxResistencia\") + \"#\"; \n    //     //payload += global.get(\"tempMaxResistenciaManual\") + \"#\"; payload += global.get(\"tempMinimaResistencia\") + \"#\";\n    //     payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n    //     // payload += \"#\" + global.get(\"offsetDia\")  + \"#\"; payload += global.get(\"offsetNoche\");\n    //     msg.payload = payload;  \n    //     msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([null, msg, null]);\n    // }    \n}\n",
        "outputs": 2,
        "noerr": 0,
        "x": 470,
        "y": 366,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "5cb70fc5.ddfb1",
        "type": "file in",
        "z": "9c63fd61.9908c",
        "name": "recover datos termo",
        "filename": "/home/pi/BackUpNodeRed/resguardo.txt",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 1345,
        "y": 891,
        "wires": [
            [
                "ec4b3f44.8373f",
                "149affd5.20549"
            ]
        ]
    },
    {
        "id": "12cbc826.e74648",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1151,
        "y": 891,
        "wires": [
            [
                "5cb70fc5.ddfb1"
            ]
        ]
    },
    {
        "id": "ec4b3f44.8373f",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "val. in. termo",
        "func": "// Teclas:\nglobal.set(\"incrementoBaño\", 1);\nglobal.set(\"minTeclas\", 15);\nglobal.set(\"maxTeclas\", 765);\nglobal.set(\"delayBuzzer\", 60); \n\n//Termo Solar y crepuscular\nglobal.set(\"valorDia\", 650); \nglobal.set(\"valorNoche\", 500);\nglobal.set(\"segundosMarchaBomba\", 60000);\n\nglobal.set(\"timerExtractorBano\", 2);// en Minutos\n\nvar dato = msg.payload.split(\"#\");\n\nglobal.set(\"estLuzBano\", dato[0]);\nglobal.set(\"pwmLuzBano\", dato[1]);\nglobal.set(\"estLuzEspejo\", dato[2]);\nglobal.set(\"pwmLuzEspejo\", dato[3]);\n\nglobal.set(\"estLucesRGBPileta\", dato[4]);\nglobal.set(\"modoLucesRGBPileta\", dato[5]);\nglobal.set(\"PiletaR\", dato[6]);\nglobal.set(\"PiletaG\", dato[7]);\nglobal.set(\"PiletaB\", dato[8]);\nglobal.set(\"estLuzPileta\", dato[9]);\nglobal.set(\"estBombaPileta\", dato[10]);//11\n\nglobal.set(\"estLuzPorche\", dato[11]);\nglobal.set(\"pwmPorche\", dato[12]);\nglobal.set(\"estLucesDicroicasPorche\", dato[13]);\nglobal.set(\"pwmDicroicasPorche\", dato[14]);\n\nglobal.set(\"pwmReflectorPergola\", dato[15]);\nglobal.set(\"pwmEscaleras\", dato[16]);\nglobal.set(\"pwmLucesPergola\", dato[17]);\nglobal.set(\"pwmLucesPasadaAuto\", dato[18]);\n\nglobal.set(\"bombaCascada\", dato[19]);\nglobal.set(\"modoLed1Cascada\", dato[20]);\nglobal.set(\"mitadCascadaG\", dato[21]);\nglobal.set(\"mitadCascadaR\", dato[22]);\nglobal.set(\"mitadCascadaB\", dato[23]);\nglobal.set(\"pwmPatioLuz\", dato[24]);\n//#0\nglobal.set(\"modoLed2Cascada\", dato[26]);\nglobal.set(\"piletaCascadaG\", dato[27]);\nglobal.set(\"piletaCascadaR\", dato[28]);\nglobal.set(\"piletaCascadaB\", dato[29]);\n\nglobal.set(\"modoLed3Cascada\", dato[30]);\nglobal.set(\"topeCascadaR\", dato[31]);\nglobal.set(\"topeCascadaG\", dato[32]);\nglobal.set(\"topeCascadaB\", dato[33]);\n\nglobal.set(\"dalayMinCascada\", dato[34]);\nglobal.set(\"delayMaxCascada\", dato[35]);\nglobal.set(\"minAutoCascada\", dato[36]);\nglobal.set(\"maxAutoCascada\", dato[37]);\n\nglobal.set(\"estIsla\", dato[38]);\nglobal.set(\"potIsla\", dato[39]);\nglobal.set(\"estCielorrazo\", dato[40]);\nglobal.set(\"potCielorrazo\", dato[41]);\n\nglobal.set(\"estIslaRGB\", dato[42]);\nglobal.set(\"IslaR\", dato[43]);\nglobal.set(\"IslaG\", dato[44]);\nglobal.set(\"IslaB\", dato[45]);\n\nglobal.set(\"autoBomba\", dato[46]);\nglobal.set(\"pedBomba\", dato[47]);\nglobal.set(\"pedResistencia\", dato[48]);\nglobal.set(\"tempMaximaTermo\", dato[49]);\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1535,
        "y": 891,
        "wires": [
            []
        ]
    },
    {
        "id": "149affd5.20549",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1585,
        "y": 921,
        "wires": []
    },
    {
        "id": "52206e37.320fc",
        "type": "file",
        "z": "9c63fd61.9908c",
        "name": "back datos termo",
        "filename": "/home/pi/BackUpNodeRed/resguardo.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 733,
        "y": 607,
        "wires": [
            []
        ]
    },
    {
        "id": "136a4379.5c005d",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 690.5,
        "y": 640,
        "wires": []
    },
    {
        "id": "9e22f516.6bdb28",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0#82#0#100#1#1#62#62#62#1#1#1#20#0#26#21#8#12#65#0#1#255#255#255#70#0#1#149#149#149#1#0#11#1#255#255#255#1#0#27#0#0#0#13#0#87#0#0#0#0",
        "payloadType": "str",
        "x": 530,
        "y": 591,
        "wires": [
            [
                "52206e37.320fc"
            ]
        ]
    },
    {
        "id": "b0075a07.421e88",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "andando bien 12/08/2020",
        "func": "    // global.set(\"incrementoBaño\", 10);\n    var pin = parseInt(msg.pin);\n    var intPayload = parseInt(msg.payload);\n    var topic = msg.topic;\n    var dato;\n    var envioresguardo = 0;  var envioresguardoCrep = 1;    \n\n    if (msg.topic == \"crepMQTT\"){//} || msg.topic == \"PatioLuz/Inicio\" || msg.topic == \"ESP/Escaleras/Inicio\"){\n        envioresguardoCrep = 0;\n        if (parseInt(global.get(\"Dia\")) === 1){\n            global.set(\"estPalioLuz\", 0);\n            global.set(\"estLuzCascada\", 0);\n            global.set(\"estTopeCascada\", 0); \n            global.set(\"estMitadCascada\", 0);\n            global.set(\"estPiletaCascada\", 0); \n            enviarMQTT(\"patioLuz\");\n            global.set(\"estEscaleras\", 0);\n            global.set(\"estReflectorPergola\", 0);\n            global.set(\"estLucesPergola\", 0);\n            global.set(\"estLucesPasadaAuto\", 0);\n            enviarMQTT(\"escaleras\");\n            global.set(\"estLuzPorche\", 0);\n            enviarMQTT(\"porche\");\n            envioresguardoCrep = 1;\n            enviarMQTT(\"resguardo\");\n        }\n        if (parseInt(global.get(\"Dia\")) === 0){\n            global.set(\"estLuzCascada\", 1);\n            global.set(\"estTopeCascada\", 1); \n            global.set(\"estMitadCascada\", 1);\n            global.set(\"estPiletaCascada\", 1); \n            enviarMQTT(\"patioLuz\"); \n            global.set(\"estEscaleras\", 1); \n            global.set(\"estReflectorPergola\", 0);\n            // global.set(\"pwmReflectorPergola\", 5);\n            global.set(\"estLucesPergola\", 1);\n            // global.set(\"pwmLucesPergola\", 10);      \n            global.set(\"estLucesPasadaAuto\", 1);\n            // global.set(\"pwmLucesPasadaAuto\", 100);\n            enviarMQTT(\"escaleras\");\n            global.set(\"estLuzPorche\", 1);\n            enviarMQTT(\"porche\"); \n            envioresguardoCrep = 1;\n            enviarMQTT(\"resguardo\");         \n      }  \n      return;\n    }\n\n    if (msg.topic == \"PatioLuz/Inicio\"){\n        enviarMQTT(\"patioLuz\"); \n        return;    \n    }\n\n    if (msg.topic == \"ESP/Porche/Inicio\"){\n        enviarMQTT(\"porche\"); \n        return;    \n    }    \n\n    if (msg.topic == \"ESP/Pileta/Redonda/Inicio\"){\n        enviarMQTT(\"PiletaRedonda\"); \n        return;    \n    }\n\n    if (msg.topic == \"ESP/Escaleras/Inicio\"){\n        enviarMQTT(\"escaleras\"); \n        return;    \n    }\n\n    // node.status({text: context.item});\n\n    switch (pin){\n      case 8:\n        switch (parseInt(context.item)){\n            case 4:\n                global.set(\"IslaR\", msg.arrayOfValues[0]);\n                global.set(\"IslaG\", msg.arrayOfValues[1]);\n                global.set(\"IslaB\", msg.arrayOfValues[2]);\n                // msg = {pin: 32, payload: \"12\"}; node.send([null, msg]);\n                global.set(\"estIslaRGB\", 1);\n                enviarMQTT(\"living\");\n                return;\n            break;\n            case 6:\n                global.set(\"topeCascadaR\", msg.arrayOfValues[0]); global.set(\"mitadCascadaR\", msg.arrayOfValues[0]); global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"topeCascadaG\", msg.arrayOfValues[1]); global.set(\"mitadCascadaG\", msg.arrayOfValues[1]); global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"topeCascadaB\", msg.arrayOfValues[2]); global.set(\"mitadCascadaB\", msg.arrayOfValues[2]); global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\");\n                return;\n            break;\n            case 7:\n                global.set(\"topeCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"topeCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"topeCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\");\n                return;\n            break;\n            case 8:\n                global.set(\"mitadCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"mitadCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"mitadCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\");\n                return;\n            break;\n            case 9:\n                global.set(\"piletaCascadaR\", msg.arrayOfValues[0]);\n                global.set(\"piletaCascadaG\", msg.arrayOfValues[1]);\n                global.set(\"piletaCascadaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"patioLuz\"); \n                return;\n            case 16:\n                global.set(\"PiletaRedondaR\", msg.arrayOfValues[0]);\n                global.set(\"PiletaRedondaG\", msg.arrayOfValues[1]);\n                global.set(\"PiletaRedondaB\", msg.arrayOfValues[2]);\n                enviarMQTT(\"PiletaRedonda\"); \n                return;            \n            break;          \n        }  \n\n      case 18:\n        global.set(\"itemPotencia\", msg.payload);\n        // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n          context.item = parseInt(msg.payload);\n          node.status({text: context.item + \" - \" + msg.payload});\n          switch(parseInt(msg.payload)){\n              case 1:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Living\", payload: global.get(\"potLiving\")};\n              break;\n              case 2:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Isla\", payload: global.get(\"potIsla\")};\n              break;\n              case 3:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Cielorrazo\", payload: global.get(\"potCielorrazo\")};\n              break;\n              case 4:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Led Living\", payload: global.get(\"ledLiving\")};\n              break;\n              case 5:\n                  msg = {pin: 21, label: \"Luz Casc\", payload: global.get(\"estLuzCascada\")}; node.send([null, msg]);\n                  msg = {pin: 21, label: \"Patio Luz\", payload: global.get(\"estPalioLuz\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 70, label: \"Patio Luz\", payload: global.get(\"pwmPatioLuz\")};\n              break; \n              case 6:\n                  msg = {pin: 19, min: 0, max: 255, label: \"Cascada Completa\", payload: global.get(\"ledTopeCascada\")};\n              break;              \n              case 7:\n                  msg = {pin: 21, label: \"Top Casc\", payload: global.get(\"estTopeCascada\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Top Casc\", payload: global.get(\"modoLed3Cascada\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 0, max: 255, label: \"Tope Cascada\", payload: global.get(\"ledTopeCascada\")}; node.send([null, msg]);\n                  return;\n              break; \n              case 8:\n                  msg = {pin: 21, label: \"Mit Casc\", payload: global.get(\"estMitadCascada\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Mit Casc\", payload: global.get(\"modoLed1Cascada\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 0, max: 255, label: \"Mitad Cascada\", payload: global.get(\"ledMitadCascada\")}; node.send([null, msg]);\n                  return;\n              break; \n              case 9:\n                  msg = {pin: 21, label: \"Pil Casc\", payload: global.get(\"estPiletaCascada\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Pil Casc\", payload: global.get(\"modoLed2Cascada\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 0, max: 255, label: \"Pileta Cascada\", payload: global.get(\"ledPiletaCascada\")}; node.send([null, msg]);\n                  return;\n              break;      \n              case 10:\n                  msg = {pin: 19, min: 1, max: 100, label: \"Ducha de bano\", payload: global.get(\"pwmDucha\")};\n              break;     \n              case 11:\n                  msg = {pin: 19, min: 1, max: 100, label: \"Luz Bano\", payload: global.get(\"pwmLuzBano\")};\n              break;\n              case 12:\n                  msg = {pin: 21, label: \"Escaleras\", payload: global.get(\"estEscaleras\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Pot Escaleras\", payload: global.get(\"pwmEscaleras\")};\n              break;     \n              case 13:\n                  msg = {pin: 21, label: \"Refl Perg\", payload: global.get(\"estReflectorPergola\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Ref Pergola\", payload: global.get(\"pwmReflectorPergola\")};\n              break;                \n              case 14:\n                  msg = {pin: 21, label: \"Luces Perg\", payload: global.get(\"estLucesPergola\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Luces Pergola\", payload: global.get(\"pwmLucesPergola\")};\n              break;  \n              case 15:\n                  msg = {pin: 21, label: \"Luces Pasada Auto\", payload: global.get(\"estLucesPasadaAuto\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Luces Pas Auto\", payload: global.get(\"pwmLucesPasadaAuto\")};\n              break;       \n              case 16:\n                  msg = {pin: 21, label: \"Luces Pileta Redonda\", payload: global.get(\"estLucesPiletaRedonda\")}; node.send([null, msg]);\n                  msg = {pin: 24, label: \"Luz Pil Red\", payload: global.get(\"modoLucesPiletaRedonda\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 255, label: \"Luces Pil Red\", payload: global.get(\"pwmLucesPiletaRedonda\")};\n              break; \n              case 17:\n                  msg = {pin: 19, min: 0, max: 100, label: \"Potencia Porche\", payload: global.get(\"pwmPorche\")};\n                  msg = {pin: 21, label: \"Luz Porche\", payload: global.get(\"estLuzPorche\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Potencia Luz Porche\", payload: global.get(\"pwmPorche\")};\n              break;                             \n              case 18:\n                  msg = {pin: 19, min: 0, max: 100, label: \"Potencia Dicroicas Porche\", payload: global.get(\"pwmDicroicasPorche\")};\n                  msg = {pin: 21, label: \"Luz Dicroicas Porche\", payload: global.get(\"estLucesDicroicasPorche\")}; node.send([null, msg]);\n                  msg = {pin: 19, min: 1, max: 100, label: \"Potencia Dicroicas Porche\", payload: global.get(\"pwmDicroicasPorche\")};                  \n              break;  \n              \n              case 19:\n                  msg = {pin: 19, min: 0, max: 98, label: \"Temp Max Termo (Seg)\", payload: global.get(\"tempMaximaTermo\")};                  \n              break;\n              case 20:\n                    var va2 = parseInt(global.get(\"tempMinimaResistenciaAuto\")) + 10;\n                    node.status({text: va2});\n                  msg = {pin: 19, min: 40, max: global.get(\"tempMaximaTermo\"), label: \"Temp Max Termo (Auto)\", payload: global.get(\"tempMaxResistenciaAuto\")};                  \n              break;\n              case 21:\n                  msg = {pin: 19, min: 0, max: global.get(\"tempMaximaTermo\"), label: \"Temp Min Termo (Man)\", payload: global.get(\"tempMaxResistenciaManual\")};                  \n              break;\n              case 22:\n                  msg = {pin: 19, min: 40, max: global.get(\"tempMaximaTermo\"), label: \"Temp Min Termo (Auto)\", payload: global.get(\"tempMinimaResistenciaAuto\")};                 \n              break;\n\n              case 23:\n                  msg = {pin: 21, label: \"Encendido Caldera\", payload: global.get(\"marchaCaldera\")};                 \n              break;\n              case 24:\n                  if (parseInt(global.get(\"modoCaldera\")) === 1){\n                    msg = {pin: 21, label: \"Caldera Auto\", payload: global.get(\"modoCaldera\")};//1= automatico 0==  manual  \n                  }\n                  if (parseInt(global.get(\"modoCaldera\")) === 0){\n                    msg = {pin: 21, label: \"Caldera Man\", payload: global.get(\"modoCaldera\")};//1= automatico 0==  manual  \n                  }                                   \n              break;              \n              case 25:\n                  msg = {pin: 19, min: 10, max: 30, label: \"Temp Min Casa\", payload: global.get(\"tempMinimaCasa\")}; //node.send([null, msg]);\n                  // msg = {pin: 21, label: \"Temp Min Casa\", payload: global.get(\"tempMinimaCasa\")};                 \n              break;\n              case 26:\n                  msg = {pin: 19, min: 10, max: 30, label: \"Temp Max Casa\", payload: global.get(\"tempMaximaCasa\")}; //node.send([null, msg]);\n                  // msg = {pin: 21, label: \"Temp Max Casa\", payload: global.get(\"tempMaximaCasa\")};                 \n              break;                            \n              case 27:\n                  msg = {pin: 21, label: \"Hab Rad Living\", payload: global.get(\"habilitacionRadLiving\")};                 \n              break;\n              case 28:\n                  msg = {pin: 21, label: \"Hab Rad Comedor\", payload: global.get(\"habilitacionRadComedor\")};                 \n              break;\n              case 29:\n                  msg = {pin: 21, label: \"Hab Rad Cocina\", payload: global.get(\"habilitacionRadCocina\")};                 \n              break;\n              case 30:\n                  msg = {pin: 21, label: \"Hab Rad Pasillo\", payload: global.get(\"habilitacionRadPasillo\")};                 \n              break;\n              case 31:\n                  msg = {pin: 21, label: \"Hab Rad Hab1\", payload: global.get(\"habilitacionRadHabitacion1\")};                 \n              break;\n              case 32:\n                  msg = {pin: 21, label: \"Hab Rad Hab2\", payload: global.get(\"habilitacionRadHabitacion2\")};                 \n              break;\n              case 33:\n                  msg = {pin: 21, label: \"Hab Rad Lavadero\", payload: global.get(\"habilitacionRadLavadero\")};                 \n              break;\n\n\n              case 34:\n                  msg = {pin: 21, label: \"Marcha Resistencia\", payload: global.get(\"habilitacionResistenciaTermo\")};                \n              break;                            \n\n              case 35: \n                  msg = {pin: 21, label: \"Est Dia\", payload: global.get(\"Dia\")}; node.send([null, msg]);\n              break;              \n              case 36: \n                  msg = {pin: 19, min: 15, max: 240, label: \"timer extractor baño\", payload: global.get(\"timerExtractorBano\")};\n              break;\n              case 37:\n                  msg = {pin: 19, min: 10, max: 100, label: \"tiempo MIN teclas\", payload: global.get(\"minTeclas\")};\n              break;       \n              case 38:\n                  msg = {pin: 19, min: 400, max: 2000, label: \"tiempo MAX teclas\", payload: global.get(\"maxTeclas\")};\n              break;   \n              case 39:\n                  msg = {pin: 19, min: 1, max: 100, label: \"delay buzzer\", payload: global.get(\"delayBuzzer\")};\n              break;                              \n          }\n          node.send([null, msg]);\n          return;\n        // }\n      break;\n\n      case 19:\n        // if (parseInt(global.get(\"itemPotencia\")) > 0 && parseInt(global.get(\"itemPotencia\")) <= 5){\n          var valor = parseInt(msg.payload);\n          switch(context.item){\n              case 1:\n                  // if (global.get(\"estLiving\") === 0)return;\n                  global.set(\"potLiving\", valor);\n                  global.set(\"potIsla\", valor);\n                  global.set(\"potCielorrazo\", valor);\n                  global.set(\"ledLiving\", valor);\n                  enviarMQTT(\"living\");\n              break;\n              case 2:\n                  // if (global.get(\"estIsla\") === 0)return;\n                  global.set(\"potIsla\", valor);\n                  enviarMQTT(\"living\");\n              break;\n              case 3:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"potCielorrazo\", valor);\n                  enviarMQTT(\"living\");\n              break;\n              case 4:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"ledLiving\", valor);\n                  global.set(\"IslaR\", valor);\n                  global.set(\"IslaG\", valor);\n                  global.set(\"IslaB\", valor);\n                  msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"living\");\n              break;          \n              case 5:\n                  // if (global.get(\"Dia\") === 1)return;\n                  global.set(\"pwmPatioLuz\", valor);\n                  enviarMQTT(\"patioLuz\");\n                  return;\n              case 6:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"topeCascadaR\", valor);\n                  global.set(\"topeCascadaG\", valor);\n                  global.set(\"topeCascadaB\", valor);\n                  global.set(\"mitadCascadaR\", valor);\n                  global.set(\"mitadCascadaG\", valor);\n                  global.set(\"mitadCascadaB\", valor);\n                  global.set(\"piletaCascadaR\", valor);\n                  global.set(\"piletaCascadaG\", valor);\n                  global.set(\"piletaCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break;               \n              case 7:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"topeCascadaR\", valor);\n                  global.set(\"topeCascadaG\", valor);\n                  global.set(\"topeCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break; \n              case 8:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"mitadCascadaR\", valor);\n                  global.set(\"mitadCascadaG\", valor);\n                  global.set(\"mitadCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break; \n              case 9:\n                  // if (global.get(\"estCielorrazo\") === 0)return;\n                  global.set(\"piletaCascadaR\", valor);\n                  global.set(\"piletaCascadaG\", valor);\n                  global.set(\"piletaCascadaB\", valor);\n                  // msg = {pin: 8, payload: [valor, valor, valor]}; node.send([null, msg]);\n                  enviarMQTT(\"patioLuz\");\n              break;                                   \n              case 10:\n                  // if (global.get(\"estDucha\") === 0)return;  \n                  global.set(\"pwmDucha\", valor);\n                  enviarMQTT(\"bano\");\n                  return;\n              case 11:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmLuzBano\", valor);\n                  enviarMQTT(\"bano\");\n                  return;  \n              case 12:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmEscaleras\", valor);\n                  enviarMQTT(\"escaleras\");\n                  return;  \n              case 13:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmReflectorPergola\", valor);\n                  enviarMQTT(\"escaleras\");\n                  return;\n              case 14:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmLucesPergola\", valor);\n                  enviarMQTT(\"escaleras\");\n                  return; \n              case 15:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"pwmLucesPasadaAuto\", valor);\n                  enviarMQTT(\"escaleras\");\n                  return;          \n              case 16:\n                  // if (global.get(\"estLuzBano\") === 0)return;  \n                  global.set(\"PiletaRedondaR\", valor);\n                  global.set(\"PiletaRedondaG\", valor);\n                  global.set(\"PiletaRedondaB\", valor);\n                  enviarMQTT(\"PiletaRedonda\");\n                  return;                                 \n              case 17:\n                  global.set(\"pwmPorche\", valor);\n                  enviarMQTT(\"porche\");\n                  return;\n              case 18:\n                  global.set(\"pwmDicroicasPorche\", valor);\n                  enviarMQTT(\"porche\");\n                  return;\n\n              case 19:\n                  global.set(\"tempMaximaTermo\", valor);\n                  enviarMQTT(\"termoSolar\");\n                  return;\n              case 20:\n                  global.set(\"tempMaxResistenciaAuto\", valor);\n                  enviarMQTT(\"termoSolar\");\n                  return;\n              case 21:\n                  global.set(\"tempMaxResistenciaManual\", valor);\n                  enviarMQTT(\"termoSolar\");\n                  return;\n              case 22:\n                  global.set(\"tempMinimaResistenciaAuto\", valor);\n                  enviarMQTT(\"termoSolar\");\n                  return;                                                      \n\n              case 25:\n                  global.set(\"tempMinimaCasa\", valor);\n                  enviarMQTT(\"lavaderoCaldera\");\n                  return;\n              case 26:\n                  global.set(\"tempMaximaCasa\", valor);\n                  enviarMQTT(\"lavaderoCaldera\");\n                  return;                  \n\n              case 36:\n                  global.set(\"timerExtractorBano\", valor);\n                  enviarMQTT(\"baño\");\n                  return;                                    \n              case 37:\n                  global.set(\"minTeclas\", valor);\n                  enviarMQTT(\"configGenericas\");\n                  return;     \n              case 38:\n                  global.set(\"maxTeclas\", valor);\n                  enviarMQTT(\"configGenericas\");\n                  return;              \n              case 39:  \n                  global.set(\"delayBuzzer\", valor);\n                  enviarMQTT(\"configGenericas\");\n                  return;              \n                }  \n              break;\n      case 21:\n      // node.status({text: context.item + \" - \" + msg.payload});\n        switch(context.item){\n          case 5:\n            global.set(\"estPalioLuz\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            return;\n          break;\n          case 6:\n            global.set(\"estLuzCascada\", msg.payload);\n            global.set(\"estTopeCascada\", msg.payload);\n            global.set(\"estMitadCascada\", msg.payload);\n            global.set(\"estPiletaCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            return;\n          break;      \n          case 7:\n            global.set(\"estTopeCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            return;\n          break;\n          case 8:\n            global.set(\"estMitadCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            return;\n          break;\n          case 9:\n            global.set(\"estPiletaCascada\", msg.payload);\n            enviarMQTT(\"patioLuz\"); \n            return;\n          break;\n          case 12:\n            global.set(\"estEscaleras\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            return;\n          case 13:\n            global.set(\"estReflectorPergola\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            return;     \n          case 14:\n            global.set(\"estLucesPergola\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            return;  \n          case 15:\n            global.set(\"estLucesPasadaAuto\", msg.payload);\n            enviarMQTT(\"escaleras\"); \n            return;   \n          case 16:\n            global.set(\"estLucesPiletaRedonda\", msg.payload);\n            enviarMQTT(\"PiletaRedonda\"); \n            return;       \n          case 17:\n            global.set(\"estLuzPorche\", msg.payload);\n            enviarMQTT(\"porche\"); \n            return; \n          case 18:\n            global.set(\"estLucesDicroicasPorche\", msg.payload);\n            enviarMQTT(\"porche\"); \n            return; \n\n          case 23:\n            global.set(\"marchaCaldera\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 24:\n            global.set(\"modoCaldera\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return;             \n          case 27:\n            global.set(\"habilitacionRadLiving\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 28:\n            global.set(\"habilitacionRadComedor\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 29:\n            global.set(\"habilitacionRadCocina\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 30:\n            global.set(\"habilitacionRadPasillo\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 31:\n            global.set(\"habilitacionRadHabitacion1\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 32:\n            global.set(\"habilitacionRadHabitacion2\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return; \n          case 33:\n            global.set(\"habilitacionRadLavadero\", msg.payload);\n            enviarMQTT(\"lavaderoCaldera\"); \n            return;                                                                                  \n\n          case 34:\n            global.set(\"habilitacionResistenciaTermo\", msg.payload);\n            msg = {topic: \"ESP/TermoSolar/controlResistencia\", payload: 1}; node.send([msg, null, null]);\n            return;                         \n\n          case 35:\n            global.set(\"Dia\", msg.payload);\n            msg = {topic: \"crepMQTT\", payload: global.get(\"Dia\")};\n            node.send([msg, null]);\n            return;                                                 \n          break;      \n        }\n      break;\n      case 22:\n          global.set(\"bombaCascada\", parseInt(msg.payload));\n          // if (parseInt(msg.payload) === 0 && parseInt(global.get(\"Dia\")) === 0){\n          //   msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#\" + global.get(\"pwmPatioLuz\") + \"#0#0#1#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\")+ \"#\" + global.get(\"maxAuto\")};      \n          // }\n          mensaje = \"bomba\" + global.get(\"bombaCascada\");\n          msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n          node.send([msg, null]);\n          return;\n      case 24:\n          switch(context.item){\n            case 7:\n              global.set(\"modoLed3Cascada\", msg.payload);\n              enviarMQTT(\"patioLuz\"); \n              return;\n            break;\n            case 8:\n              global.set(\"modoLed1Cascada\", msg.payload);\n              enviarMQTT(\"patioLuz\"); \n              return;\n            break;\n            case 9:\n              global.set(\"modoLed2Cascada\", msg.payload);\n              enviarMQTT(\"patioLuz\"); \n              return;\n            case 16:\n              global.set(\"modoLucesPiletaRedonda\", msg.payload);\n              enviarMQTT(\"PiletaRedonda\"); \n              return;          \n          break;\n        //   global.set(\"modoLed1Cascada\", parseInt(msg.payload));\n        //   enviarMQTT(\"patioLuz\");\n          return;\n        }\n      // case 24:\n      //     global.set(\"modoLed2Cascada\", parseInt(msg.payload));\n      //     enviarMQTT(\"patioLuz\");\n      //     return;\n      // case 25:\n      //     global.set(\"modoLed3Cascada\", parseInt(msg.payload));\n      //     enviarMQTT(\"patioLuz\");\n      //     return;\n    }\n\n    function enviarMQTT(caso){\n\n    var dato;\n      if (caso == \"bano\"){\n        envioresguardo = 1;\n        dato = \"estado\" + global.get(\"estLuzBano\") + \"#\" + global.get(\"pwmLuzBano\");\n        dato += \"#\" + global.get(\"estLuzEspejo\") + \"#\" + global.get(\"pwmLuzBano\");\n        dato += \"#1\" ;//+ global.get(\"estExtractorBano\");\n        dato += \"#\" + global.get(\"incrementoBaño\");\n        dato += \"#\" + global.get(\"minTeclas\");\n        dato += \"#\" + global.get(\"maxTeclas\");\n        dato += \"#\" + global.get(\"delayBuzzer\");          \n        msg = {topic: \"ESP/Bano/Recibo\", payload: dato};\n      }\n\n    if (caso == \"PiletaRedonda\"){\n        envioresguardo = 1;\n         \n        dato = \"estado\" + global.get(\"estLucesPiletaRedonda\") + \"#\" + global.get(\"modoLucesPiletaRedonda\") + \"#\";\n        dato = dato + global.get(\"PiletaRedondaR\") + \"#\";\n        dato = dato + global.get(\"PiletaRedondaG\") + \"#\";\n        dato = dato + global.get(\"PiletaRedondaB\");\n        msg = {topic: \"ESP/Pileta/Redonda/BackUp\", payload: dato}; node.send([msg, null]);\n\n        if (parseInt(global.get(\"estLucesPiletaRedonda\")) === 1){\n           dato = \"estado\" + global.get(\"modoLucesPiletaRedonda\") + \"#\";\n           dato = dato + global.get(\"PiletaRedondaR\") + \"#\";\n           dato = dato + global.get(\"PiletaRedondaG\") + \"#\";\n           dato = dato + global.get(\"PiletaRedondaB\") + \"#\";}\n        else{  \n            dato = \"estado0#0#0#0#\"; \n           }\n        dato = dato + \"1#10#1#255\";\n        // dato = dato + global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\n        msg = {topic: \"ESP/Pileta/Redonda/Recibo\", payload: dato}; //node.send([msg, null]);\n        // return;\n    }\n\n    if (caso == \"porche\"){\n        envioresguardo = 1;\n      //estado0#100#1\n      //ESP/Porche/Recibo\n      dato = \"estado\" + global.get(\"estLuzPorche\") + \"#\" + global.get(\"pwmPorche\") + \"#\";\n      dato = dato + global.get(\"estLucesDicroicasPorche\") + \"#\";\n      dato = dato + global.get(\"pwmDicroicasPorche\") + \"#\";\n      msg = {topic: \"ESP/Porche/BackUp\", payload: dato}; node.send([msg, null]);\n\n      if (parseInt(global.get(\"estLuzPorche\")) === 1){\n         dato = \"estado\" + global.get(\"pwmPorche\") + \"#\";\n         dato = dato + global.get(\"pwmDicroicasPorche\") + \"#1\";}\n      if (parseInt(global.get(\"estLuzPorche\")) === 0){dato = \"estado0#0#1\"}         \n      msg = {topic: \"ESP/Porche/Recibo\", payload: dato};\n    }\n\n    if (caso == \"escaleras\"){\n        envioresguardo = 1;\n\n        dato = \"estado\" + global.get(\"pwmReflectorPergola\") + \"#\";\n        dato = dato + global.get(\"pwmEscaleras\") + \"#\";\n        dato = dato + global.get(\"pwmLucesPergola\") + \"#\";\n        dato = dato + global.get(\"pwmLucesPasadaAuto\");\n        msg = {topic: \"ESP/Escaleras/BackUp\", payload: dato}; node.send([msg, null]);\n\n        if (parseInt(global.get(\"estReflectorPergola\")) === 1){\n        dato = \"estado\" + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estReflectorPergola\")) === 0){\n        dato = \"estado0\";//#0#0#0#0#0#1\";\n        }\n        dato = dato + \"#\";\n        if (parseInt(global.get(\"estEscaleras\")) === 1){\n        // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n        dato = dato + global.get(\"pwmEscaleras\");\n        // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estEscaleras\")) === 0){\n        dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n        }    \n        dato = dato + \"#\";\n        if (parseInt(global.get(\"estLucesPergola\")) === 1){\n        // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n        dato = dato + global.get(\"pwmLucesPergola\");\n        // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estLucesPergola\")) === 0){\n        dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n        }   \n        dato = dato + \"#\";\n        if (parseInt(global.get(\"estLucesPasadaAuto\")) === 1){\n        // if (topicOriginal == \"crepMQTT\"){dato = dato + \"7\";} else{dato = dato + global.get(\"pwmReflectorPergola\");}\n        dato = dato + global.get(\"pwmLucesPasadaAuto\");\n        // dato = dato + global.get(\"pwmReflectorPergola\");// + \"#0#0#0#0#0#1\";\n        }\n        if (parseInt(global.get(\"estLucesPasadaAuto\")) === 0){\n        dato = dato + \"0\";//;//#0#0#0#0#0#1\";\n        } \n        dato = dato + \"#1\";                \n        //estado10#0#0#0#0#0#1\n        if (dato.includes(\"desconectado\")) return;\n        msg = {topic: \"ESP/Escaleras/Recibo\", payload: dato};\n    }  \n\n    if (caso == \"patioLuz\"){\n        envioresguardo = 1;\n        var mensaje;\n\n        mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\";\n        mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n        mensaje = mensaje + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n        mensaje = mensaje + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n        mensaje = mensaje + global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\n        msg = {topic: \"PatioLuz/BackUp\", payload: mensaje}; node.send([msg, null]);\n\n        if (parseInt(global.get(\"estMitadCascada\")) === 0){\n          mensaje = \"estado0#0#0#0#\";\n        }\n          else{\n            mensaje = \"estado\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\")+ \"#\";\n          }\n\n        if (parseInt(global.get(\"estPalioLuz\")) === 0){\n          mensaje = mensaje + \"0#0#\";\n        }\n          else{\n            mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n          }      \n\n        // mensaje = mensaje + global.get(\"pwmPatioLuz\") + \"#0#\";\n\n        if (parseInt(global.get(\"estPiletaCascada\")) === 0){\n          mensaje = mensaje + \"0#0#0#0#\";\n        }\n          else{\n             mensaje = mensaje + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\")+ \"#\";\n          }\n\n        if (parseInt(global.get(\"estTopeCascada\")) === 0){\n          mensaje = mensaje + \"0#0#0#0#\";\n        }\n          else{\n             mensaje = mensaje + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\")+ \"#\";\n          }\n\n        mensaje = mensaje + global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\n\n        // if (parseInt(global.get(\"Dia\")) === 1){\n        //     msg = {topic: \"PatioLuz/Recibo\", payload: \"estado0#0#0#0#0#0#0#0#0#0#0#0#0#0#\" + global.get(\"dalayMin\")  + \"#\" + global.get(\"delayMax\")  + \"#\" + global.get(\"minAuto\") + \"#\" + global.get(\"maxAuto\")};\n        //   } \n        //   else{   \n        //     msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n        //   }\n        if (mensaje.includes(\"desconectado\")) return;\n        msg = {topic: \"PatioLuz/Recibo\", payload: mensaje};\n\n        //1#1023#32#118#118#118#0#1#1#undefined#45#45#45#0#181\n      }\n      \n\n      if (caso == \"living\"){\n        envioresguardo = 1;\n        dato = global.get(\"estIsla\") + \",\";\n        dato += global.get(\"potIsla\") + \"#\";\n        dato += global.get(\"estCielorrazo\") + \",\";\n        dato += global.get(\"potCielorrazo\") + \"#\";  \n        dato += global.get(\"estIslaRGB\") + \",\";\n        dato += global.get(\"IslaR\") + \",\";\n        dato += global.get(\"IslaG\") + \",\";      \n        dato += global.get(\"IslaB\") + \"#\";\n\n        dato += global.get(\"pwmMaxLed\") + \"#\";\n        dato += global.get(\"pwmMinLed\") + \"#\";\n\n        dato += global.get(\"minTeclas\") + \"#\";\n        dato += global.get(\"maxTeclas\") + \"#\";\n        dato += global.get(\"doblePuls\");\n        dato += \"#\" + global.get(\"Dia\");\n\n        msg = {topic: \"ESP/living/Iluminacion/Recibo\", payload: dato};\n        node.send([msg, null]);\n      }\n      if (caso == \"configGenericas\"){\n        dato = global.get(\"minTeclas\") + \"#\";\n        dato += global.get(\"maxTeclas\") + \"#\";\n        dato += global.get(\"delayBuzzer\");\n        msg = {topic: \"configTeclas\", payload: dato};\n      }\n    node.send([msg, null]);\n\n    if (caso == \"termoSolar\"){\n        envioresguardo = 1;\n        payload = global.get(\"autoBomba\");\n        payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; \n        payload += global.get(\"tempMaximaTermo\") + \"#\";\n        payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n        msg.payload = payload;  \n        msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([msg, null, null]);\n    }\n\n    // if (caso == \"termoSolar\"){\n    //     payload = global.get(\"autoBomba\");\n    //     payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; \n    //     payload += global.get(\"tempMaximaTermo\") + \"#\";\n    //     payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n    //     msg.payload = payload;  \n    //     msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([msg, null, null]);\n    // }\n\n    // if (caso == \"lavaderoCaldera\"){\n    //     payload = global.get(\"autoBomba\");\n    //     payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; \n    //     payload += global.get(\"tempMaximaTermo\") + \"#\";\n    //     payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n    //     msg.payload = payload;  \n    //     msg = {topic: \"ESP/lavadero/caldera\", payload: payload}; node.send([msg, null, null]);\n    // }   \n\n    if (parseInt(envioresguardo) == 1 && parseInt(envioresguardoCrep) == 1){\n        dato = global.get(\"estLuzBano\");\n        dato += \"#\" + global.get(\"pwmLuzBano\");\n        dato += \"#\" + global.get(\"estLuzEspejo\"); \n        dato += \"#\" + global.get(\"pwmLuzEspejp\")\n\n        dato += \"#\" + global.get(\"estLucesPiletaRedonda\");\n        dato += \"#\" + global.get(\"modoLucesPiletaRedonda\");\n        dato += \"#\" + global.get(\"PiletaRedondaR\");\n        dato += \"#\" + global.get(\"PiletaRedondaG\");\n        dato += \"#\" + global.get(\"PiletaRedondaB\");\n\n        dato += \"#\" + global.get(\"estLuzPorche\");\n        dato += \"#\" + global.get(\"pwmPorche\");\n        dato += \"#\" + global.get(\"estLucesDicroicasPorche\");\n        dato += \"#\" + global.get(\"pwmDicroicasPorche\");    \n\n        dato += \"#\" + global.get(\"pwmReflectorPergola\");\n        dato += \"#\" + global.get(\"pwmEscaleras\");\n        dato += \"#\" + global.get(\"pwmLucesPergola\");\n        dato += \"#\" + global.get(\"pwmLucesPasadaAuto\");\n\n        dato += \"#\" + global.get(\"modoLed1Cascada\") + \"#\" + global.get(\"mitadCascadaG\")  + \"#\" + global.get(\"mitadCascadaR\")  + \"#\" + global.get(\"mitadCascadaB\");\n        dato += \"#\" + global.get(\"pwmPatioLuz\") + \"#0\"\n        dato += \"#\" + global.get(\"modoLed2Cascada\") + \"#\" + global.get(\"piletaCascadaG\")  + \"#\" + global.get(\"piletaCascadaR\")  + \"#\" + global.get(\"piletaCascadaB\");\n        dato += \"#\" + global.get(\"modoLed3Cascada\") +  \"#\" + global.get(\"topeCascadaR\")  + \"#\" + global.get(\"topeCascadaG\")  + \"#\" + global.get(\"topeCascadaB\");\n        dato += \"#\" + global.get(\"dalayMinCascada\")  + \"#\" + global.get(\"delayMaxCascada\")  + \"#\" + global.get(\"minAutoCascada\")+ \"#\" + global.get(\"maxAutoCascada\");\n\n        dato += \"#\" + global.get(\"estIsla\") + \"#\" + global.get(\"potIsla\") + \"#\" + global.get(\"estCielorrazo\") + \"#\" + global.get(\"potCielorrazo\");\n        dato += \"#\" + global.get(\"estIslaRGB\") + \"#\" + global.get(\"IslaR\") + \"#\" + global.get(\"IslaG\") + \"#\" + global.get(\"IslaB\");\n\n        dato += \"#\" + global.get(\"autoBomba\") + \"#\" + global.get(\"pedBomba\") + \"#\" + global.get(\"pedResistencia\") + \"#\" + global.get(\"tempMaximaTermo\");\n        //dato += \"#\" + global.get(\"valorDia\")  + \"#\" + global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n\n        msg = {payload: dato}; node.send([null, null, msg]);\n    }\n       \n\n    // function enviarMQTT(){   \n    //     payload = global.get(\"autoBomba\");\n    //     // payload =\"0\";    \n    //     //payload += \"#\"; payload += global.get(\"autoResistencia\") + \"#\"; payload += global.get(\"autoToldo\") + \"#\"; \n    //     payload += \"#\" + global.get(\"pedBomba\") + \"#\"; payload += global.get(\"pedResistencia\") + \"#\"; //payload += global.get(\"pedToldo\") + \"#\"; \n    //     payload += global.get(\"tempMaximaTermo\");// + \"#\"; payload += global.get(\"tempMaxResistencia\") + \"#\"; \n    //     //payload += global.get(\"tempMaxResistenciaManual\") + \"#\"; payload += global.get(\"tempMinimaResistencia\") + \"#\";\n    //     payload += global.get(\"valorDia\")  + \"#\"; payload += global.get(\"valorNoche\") + \"#\" + global.get(\"segundosMarchaBomba\");\n    //     // payload += \"#\" + global.get(\"offsetDia\")  + \"#\"; payload += global.get(\"offsetNoche\");\n    //     msg.payload = payload;  \n    //     msg = {topic: \"ESP/TermoSolar/Config\", payload: payload}; node.send([null, msg, null]);\n    // }    \n}\n",
        "outputs": 3,
        "noerr": 0,
        "x": 474,
        "y": 407,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "564049d7.c5a4a8",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1230.5,
        "y": 972,
        "wires": [
            [
                "e77bbc59.9cd25"
            ]
        ]
    },
    {
        "id": "e77bbc59.9cd25",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg.pauload = global.get(\"timerExtractorBano\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1373.5,
        "y": 988,
        "wires": [
            [
                "7d727de1.4da874"
            ]
        ]
    },
    {
        "id": "7d727de1.4da874",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1515.5,
        "y": 980,
        "wires": []
    },
    {
        "id": "a8603597.643b18",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "if (msg.payload == 1)return msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2256,
        "y": 422,
        "wires": [
            [
                "dba439b.cd98cc8"
            ]
        ]
    },
    {
        "id": "dba439b.cd98cc8",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "// msg.payload = \"Reinicios: \\n\" + msg.payload;\n\nmsg.payload = \"\";\nfor (i = 0; i < 29; i++) {msg.payload += \"\\n\";}\nmsg = {topic: \"terminalBlynk\", payload: msg.payload};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2376,
        "y": 422,
        "wires": [
            [
                "ac745a52.b461c8"
            ]
        ]
    },
    {
        "id": "88fe305a.bf2b4",
        "type": "blynk-ws-in-write",
        "z": "f682d492.22a758",
        "name": "",
        "pin": "125",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 2086,
        "y": 422,
        "wires": [
            [
                "a8603597.643b18"
            ]
        ]
    },
    {
        "id": "ac745a52.b461c8",
        "type": "mqtt out",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 2516,
        "y": 422,
        "wires": []
    },
    {
        "id": "570d9702.f921a8",
        "type": "mqtt in",
        "z": "f682d492.22a758",
        "name": "",
        "topic": "ESP/Pileta/Potencia",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 2152,
        "y": 237,
        "wires": [
            [
                "a6eb17e6.b31178"
            ]
        ]
    },
    {
        "id": "2ca544c.cdc94bc",
        "type": "debug",
        "z": "f682d492.22a758",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 2465.5,
        "y": 230,
        "wires": []
    },
    {
        "id": "a6eb17e6.b31178",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "msg.payload = global.get(\"fechaCompleta\") + \" (\" + msg.payload + \")\"+ \"\\n\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2318.5,
        "y": 237,
        "wires": [
            [
                "2ca544c.cdc94bc"
            ]
        ]
    },
    {
        "id": "9715321f.4e6e3",
        "type": "blynk-ws-out-write",
        "z": "f682d492.22a758",
        "name": "",
        "pin": "150",
        "pinmode": 0,
        "client": "2c18e412.5f5cbc",
        "x": 2495.5,
        "y": 266,
        "wires": []
    },
    {
        "id": "d1cffb2e.5b5f08",
        "type": "blynk-ws-in-write",
        "z": "9c63fd61.9908c",
        "name": "",
        "pin": "22",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 483.5,
        "y": 961,
        "wires": [
            [
                "d6a2d982.a6eb18"
            ]
        ]
    },
    {
        "id": "d6a2d982.a6eb18",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "global.set(\"estBombaPileta\", msg.payload);\nmsg = {topic: \"ESP/Pileta/Inicio\", payload: 2}; \nnode.send(msg);\nreturn;",
        "outputs": 1,
        "noerr": 0,
        "x": 655.5,
        "y": 962,
        "wires": [
            [
                "1edf98ca.e24af7"
            ]
        ]
    },
    {
        "id": "1edf98ca.e24af7",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 783,
        "y": 954,
        "wires": []
    },
    {
        "id": "2a081816.8b1d88",
        "type": "blynk-ws-in-write",
        "z": "73083520.75304c",
        "name": "riegoFrente",
        "pin": "200",
        "pin_all": false,
        "client": "2c18e412.5f5cbc",
        "x": 351,
        "y": 69,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "c01e5ae4.cbad98",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 585.5,
        "y": 541,
        "wires": []
    },
    {
        "id": "9d5b5730.9afb58",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/Lavadero/Envio",
        "payload": "1#0#0#0#",
        "payloadType": "str",
        "x": 167.5,
        "y": 328,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "2a5e2f5d.d70c5",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/Lavadero/Envio",
        "payload": "$0#0#0#0#",
        "payloadType": "str",
        "x": 168,
        "y": 374,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "aaefc418.e19248",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 830.5,
        "y": 173,
        "wires": []
    },
    {
        "id": "a048a9c9.e236a8",
        "type": "mqtt in",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "topic": "ESP/TermoSolar/Config",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 642.5,
        "y": 178,
        "wires": [
            [
                "aaefc418.e19248"
            ]
        ]
    },
    {
        "id": "cbd358e1.9edbe8",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "google/Lavadero/prueba",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 1588.5,
        "y": 343,
        "wires": [
            [
                "5c6f2be7.e8a204",
                "6c2c4c1e.230734"
            ]
        ]
    },
    {
        "id": "5c6f2be7.e8a204",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "var valor = global.get(\"tipoRiego\");\nvar date = new Date();\nmsg.payload = valor;\nnode.send(msg);\nnode.status({text: valor});\nif (parseInt(valor) === 0){\n            global.set(\"riegoFrente\", 0);\n            global.set(\"riegoPatio\", 0);\n        }\n        if (parseInt(valor) === 1){\n            global.set(\"riegoFrente\", 1);\n            global.set(\"riegoPatio\", 0);\n            valor  = parseInt(date.getTime()) + (parseInt(global.get(\"tiempoRiegoFrente\")) * 1000 * 60);\n            global.set(\"dateRiegoFrente\", valor);\n        }\n        if (parseInt(valor) === 2){\n            global.set(\"riegoPatio\", 1);\n            global.set(\"riegoFrente\", 0);\n            valor  = parseInt(date.getTime()) + (parseInt(global.get(\"tiempoRiegoPatio\")) * 1000 * 60);\n            global.set(\"dateRiegoPatio\", valor);            \n        }        \n        \nmsg.payload = date.getTime() + \" -- \" +   valor;     \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1741.5,
        "y": 419,
        "wires": [
            [
                "4878bb6.9184b44"
            ]
        ]
    },
    {
        "id": "8223c975.2281e8",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1551.5,
        "y": 470,
        "wires": [
            [
                "5c6f2be7.e8a204"
            ]
        ]
    },
    {
        "id": "4878bb6.9184b44",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1901.5,
        "y": 405,
        "wires": []
    },
    {
        "id": "6c2c4c1e.230734",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1870.5,
        "y": 316,
        "wires": []
    },
    {
        "id": "cb216e41.86c7e",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1696.5,
        "y": 216,
        "wires": [
            [
                "7ac72f25.7c5f"
            ]
        ]
    },
    {
        "id": "7ac72f25.7c5f",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg.payload = global.get(\"tipoRiego\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1834.5,
        "y": 213,
        "wires": [
            [
                "4e1489b0.6922d8"
            ]
        ]
    },
    {
        "id": "4e1489b0.6922d8",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1987.5,
        "y": 211,
        "wires": []
    },
    {
        "id": "1a7e45c4.46ad9a",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 105,
        "y": 22,
        "wires": [
            [
                "79e2935c.25c1cc"
            ]
        ]
    },
    {
        "id": "79e2935c.25c1cc",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 337,
        "y": 25,
        "wires": []
    },
    {
        "id": "6f3bdda.26ff124",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 995.5,
        "y": 449,
        "wires": []
    },
    {
        "id": "a783c06c.dd8ac",
        "type": "delay",
        "z": "73083520.75304c",
        "name": "",
        "pauseType": "delayv",
        "timeout": "300",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 822.5,
        "y": 453,
        "wires": [
            [
                "72543df4.d241e4",
                "6f3bdda.26ff124"
            ]
        ]
    },
    {
        "id": "3052c61f.fa9cca",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/Lavadero/riego",
        "qos": "2",
        "datatype": "auto",
        "broker": "c339edbf.39572",
        "x": 334,
        "y": 764,
        "wires": [
            [
                "9f837dbe.a7563",
                "adf46704.fda6a8"
            ]
        ]
    },
    {
        "id": "61ee3c51.f77fd4",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1412.5,
        "y": 27,
        "wires": [
            [
                "95ebf7ac.1254d8"
            ]
        ]
    },
    {
        "id": "95ebf7ac.1254d8",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "var date = new Date();\nmsg.payload = date.getTime() + \" - \" + global.get(\"tiempoRiegoFrente\")+ \" - \" + \nreturn msg;",
        "outputs": 1,
        "noerr": 5,
        "x": 1457.5,
        "y": 76,
        "wires": [
            [
                "7886af19.8db6d"
            ]
        ]
    },
    {
        "id": "7886af19.8db6d",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1614.5,
        "y": 48,
        "wires": []
    },
    {
        "id": "b5883d54.09f77",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 883.5,
        "y": 280,
        "wires": []
    },
    {
        "id": "adf46704.fda6a8",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 593.5,
        "y": 813,
        "wires": []
    },
    {
        "id": "72543df4.d241e4",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1028,
        "y": 494,
        "wires": []
    },
    {
        "id": "718ecd4d.a8baf4",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 613.5,
        "y": 360,
        "wires": [
            [
                "d38ce610.7c6128"
            ]
        ]
    },
    {
        "id": "d38ce610.7c6128",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "msg = {pin: 200, payload: \"1\"};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 577.5,
        "y": 91,
        "wires": [
            [
                "9f837dbe.a7563"
            ]
        ]
    },
    {
        "id": "26d4a422.c99a4c",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1078,
        "y": 247,
        "wires": []
    },
    {
        "id": "8168c2be.1f1e8",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1036,
        "y": 143,
        "wires": []
    },
    {
        "id": "63b55de1.439804",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/Lavadero/AguaCaliente",
        "payload": "BombaAguaCalienteSI",
        "payloadType": "str",
        "x": 627.5,
        "y": 144,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "c5428d42.a2211",
        "type": "delay",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 826.5,
        "y": 227,
        "wires": [
            [
                "6c4e466c.f10088",
                "b8d4156f.274c28"
            ]
        ]
    },
    {
        "id": "6c4e466c.f10088",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1041,
        "y": 233,
        "wires": []
    },
    {
        "id": "f8f43f80.c0535",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "reset tanque agua",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "reset",
        "payloadType": "str",
        "x": 322,
        "y": 955,
        "wires": [
            [
                "6a0353.c7477cac"
            ]
        ]
    },
    {
        "id": "6a0353.c7477cac",
        "type": "mqtt out",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 560,
        "y": 959,
        "wires": []
    },
    {
        "id": "b6ad4130.a39a3",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua3/Envio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 275.5,
        "y": 1056,
        "wires": [
            [
                "e194abfe.f975d8"
            ]
        ]
    },
    {
        "id": "e194abfe.f975d8",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 469.5,
        "y": 1062,
        "wires": []
    },
    {
        "id": "d44ec8ab.d055d8",
        "type": "blynk-ws-out-write",
        "z": "73083520.75304c",
        "name": "",
        "pin": "150",
        "pinmode": 0,
        "client": "2c18e412.5f5cbc",
        "x": 978,
        "y": 845,
        "wires": []
    },
    {
        "id": "796b7510.34a9ec",
        "type": "inject",
        "z": "73083520.75304c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "132000",
        "payloadType": "num",
        "x": 831.5,
        "y": 48,
        "wires": [
            [
                "1f2ebbe1.6038f4"
            ]
        ]
    },
    {
        "id": "1f2ebbe1.6038f4",
        "type": "function",
        "z": "73083520.75304c",
        "name": "",
        "func": "var mensaje = msg.payload;\nmensaje = mensaje / 1000;\nvar minutosLL = parseInt(parseInt(mensaje)/60);\nvar segundosLL = parseInt(((parseInt(mensaje)/60) - minutosLL)*60);\nif (parseInt(minutosLL) < 10) minutosLL = \"0\" + minutosLL;\nif (parseInt(segundosLL) < 10) segundosLL = \"0\" + segundosLL;\nminutosLL = minutosLL + \":\" + segundosLL; \nmsg.payload = minutosLL;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 998.5,
        "y": 43,
        "wires": [
            [
                "d5246166.ee14f"
            ]
        ]
    },
    {
        "id": "d5246166.ee14f",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1146.5,
        "y": 38,
        "wires": []
    },
    {
        "id": "86079719.eb54b8",
        "type": "debug",
        "z": "73083520.75304c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 598,
        "y": 474,
        "wires": []
    },
    {
        "id": "25ef68d1.b6c758",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua3/Inicio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 272,
        "y": 1110,
        "wires": [
            [
                "e194abfe.f975d8"
            ]
        ]
    },
    {
        "id": "a6dde091.b8765",
        "type": "mqtt in",
        "z": "73083520.75304c",
        "name": "",
        "topic": "ESP/TanqueAgua/Inicio",
        "qos": "2",
        "broker": "e779f8d6.7bc2c8",
        "x": 316.5,
        "y": 444,
        "wires": [
            []
        ]
    },
    {
        "id": "d4cc34f1.810498",
        "type": "debug",
        "z": "950c1426.ff4008",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 674.5,
        "y": 392,
        "wires": []
    },
    {
        "id": "5a407b4c.4f8134",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/TermoSolar/Inicio",
        "payload": "",
        "payloadType": "date",
        "x": 116.5,
        "y": 63,
        "wires": [
            [
                "ab21644b.e84768"
            ]
        ]
    },
    {
        "id": "8acb9678.dbc198",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "3600",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 217.5,
        "y": 496,
        "wires": [
            [
                "9f8a7ccd.0130c",
                "a39fd6c5.9df478"
            ]
        ]
    },
    {
        "id": "9f8a7ccd.0130c",
        "type": "function",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "func": "if (parseInt(global.get(\"hh\")) > 7){\n    msg = {pin: 101, payload: 1};\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 379.5,
        "y": 497,
        "wires": [
            [
                "ab21644b.e84768",
                "8b3363c1.b3357"
            ]
        ]
    },
    {
        "id": "a39fd6c5.9df478",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 602.5,
        "y": 466,
        "wires": []
    },
    {
        "id": "8b3363c1.b3357",
        "type": "debug",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 599,
        "y": 393,
        "wires": []
    },
    {
        "id": "7068b5cc.700a3c",
        "type": "inject",
        "z": "5c310d6f.5422c4",
        "name": "",
        "repeat": "600",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 151.78569412231445,
        "y": 248.09523042043048,
        "wires": [
            [
                "b4079615.914ee8"
            ]
        ]
    },
    {
        "id": "d814c53.73cb138",
        "type": "http request",
        "z": "5c310d6f.5422c4",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "https://www.jugandoonline.com.ar/SorteosQuiniela3.aspx",
        "tls": "",
        "proxy": "",
        "authType": "",
        "x": 478.6904525756836,
        "y": 241.42855771382648,
        "wires": [
            [
                "f7933031.4d3e8",
                "6b1147f8.968f18"
            ]
        ]
    },
    {
        "id": "11ee55c.c3b30aa",
        "type": "debug",
        "z": "5c310d6f.5422c4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 820.3571014404297,
        "y": 201.4285677274068,
        "wires": []
    },
    {
        "id": "f7933031.4d3e8",
        "type": "function",
        "z": "5c310d6f.5422c4",
        "name": "",
        "func": "context.mes = context.mes || 18;\nvar payload = msg.payload;\nvar mes = global.get(\"fechaMes\");\nif (msg.topic != \"enviaMail\"){\n    var primeraCiudad = payload.substring(payload.indexOf(\"Ciudad La Primera\") + 119, payload.indexOf(\"Ciudad La Primera\") + 123);\n    var primeraProv = msg.payload.substring(msg.payload.indexOf(\"Prov Bs As La Primera\") + 123, msg.payload.indexOf(\"Prov Bs As La Primera\") + 127);\n    var SantaFeLaPrimera = msg.payload.substring(msg.payload.indexOf(\"Santa Fe La Primera\") + 121, msg.payload.indexOf(\"Santa Fe La Primera\") + 125);\n    \n    var CiudadMatutino = msg.payload.substring(msg.payload.indexOf(\"Ciudad Matutino\") + 119, msg.payload.indexOf(\"Ciudad Matutino\") + 123);\n    var ProvMatutino = msg.payload.substring(msg.payload.indexOf(\"Prov Bs As Matutino\") + 123, msg.payload.indexOf(\"Prov Bs As Matutino\") + 127);\n    var SantaFeMatutino = msg.payload.substring(msg.payload.indexOf(\"Santa Fe Matutino\") + 121, msg.payload.indexOf(\"Santa Fe Matutino\") + 125);\n    \n    var CiudadVespertino = msg.payload.substring(msg.payload.indexOf(\"Ciudad Vespertino\") + 119, msg.payload.indexOf(\"Ciudad Vespertino\") + 123);\n    var ProvVespertino = msg.payload.substring(msg.payload.indexOf(\"Prov Bs As Vespertino\") + 123, msg.payload.indexOf(\"Prov Bs As Vespertino\") + 127);\n    var SantaFeVespertino = msg.payload.substring(msg.payload.indexOf(\"Santa Fe Vespertino\") + 121, msg.payload.indexOf(\"Santa Fe Vespertino\") + 125);\n    \n    var CiudadNocturno = msg.payload.substring(msg.payload.indexOf(\"Ciudad Nocturno\") + 119, msg.payload.indexOf(\"Ciudad Nocturno\") + 123);\n    var ProvNocturno = msg.payload.substring(msg.payload.indexOf(\"Prov Bs As Nocturno\") + 123, msg.payload.indexOf(\"Prov Bs As Nocturno\") + 127);\n    var SantaFeNocturno = msg.payload.substring(msg.payload.indexOf(\"Santa Fe Nocturno\") + 121, msg.payload.indexOf(\"Santa Fe Nocturno\") + 125);\n    \n    \n    // Santa Fe La Primera\n    // msg.payload =  \"Primera:    \" + primeraCiudad + \" - \" + primeraProv + \" - \" + SantaFeLaPrimera + \"\\n\";\n    // msg.payload += \"Matutino:   \" + CiudadMatutino + \" - \" + ProvMatutino + \" - \" + SantaFeMatutino + \"\\n\";\n    // msg.payload += \"Vespertino: \" + CiudadVespertino + \" - \" + ProvVespertino + \" - \" + SantaFeVespertino + \"\\n\";\n    // msg.payload += \"Nocturna:   \" + CiudadNocturno + \" - \" + ProvNocturno + \" - \" + SantaFeNocturno;\n    \n    msg.payload = primeraCiudad + \" - \" + primeraProv + \" - \" + SantaFeLaPrimera + \" - \";\n    msg.payload += CiudadMatutino + \" - \" + ProvMatutino + \" - \" + SantaFeMatutino + \" - \";\n    msg.payload += CiudadVespertino + \" - \" + ProvVespertino + \" - \" + SantaFeVespertino + \" - \";\n    msg.payload += CiudadNocturno + \" - \" + ProvNocturno + \" - \" + SantaFeNocturno;\n    \n    \n    msg.payload = global.get(\"fechaQuinela\") + \" - \" + msg.payload + \"\\n\";\n    msg.filename = \"/home/pi/BackUpNodeRed/Quinela/\" + global.get(\"fechaAno\") + \"/\" + mes;\n    node.send([msg, null]);\n}\n\nnode.status({text: global.get(\"fechaMes\") + \" -- \" + context.mes});\n\nif (parseInt(global.get(\"fechaMes\")) !== parseInt(context.mes) || msg.topic == \"enviaMail\"){\n    context.mes = global.get(\"fechaMes\");\n    var mensaje = \"Resultados Quinela del mes: \" + global.get(\"fechaMes\") + '/' + global.get(\"fechaAno\");\n    msg.payload = mensaje;\n    msg.topic = mensaje;\n    msg.filename = \"/home/pi/BackUpNodeRed/Quinela/\" + global.get(\"fechaAno\") + \"/\" + mes;\n    msg.attachments = [{\n        filename: mes + '.txt',// + '.csv',\n        path: '/home/pi/BackUpNodeRed/Quinela/' + global.get(\"fechaAno\") + \"/\" + mes,//.txt',\n        content: mensaje\n    }]    \n    node.send([null, msg]);\n    return;\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 663.6904525756836,
        "y": 248.09522438049316,
        "wires": [
            [
                "11ee55c.c3b30aa",
                "a720ec58.bdd7b"
            ],
            [
                "cbcecb15.a99278",
                "f23fa64a.0625a8"
            ]
        ]
    },
    {
        "id": "6b1147f8.968f18",
        "type": "debug",
        "z": "5c310d6f.5422c4",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 648.2142639160156,
        "y": 297.6190299987793,
        "wires": []
    },
    {
        "id": "b4079615.914ee8",
        "type": "function",
        "z": "5c310d6f.5422c4",
        "name": "",
        "func": "context.envio = context.envio || 0;\nif (parseInt(global.get(\"hh\")) === 21 && parseInt(global.get(\"mm\")) > 15 && parseInt(context.envio) === 0){\n    context.envio = 1\n    return msg;\n}\n\nif (parseInt(global.get(\"hh\")) === 23 && parseInt(context.envio) === 1)context.envio = 0;",
        "outputs": 1,
        "noerr": 0,
        "x": 312.97620391845703,
        "y": 245.47618039449054,
        "wires": [
            [
                "d814c53.73cb138"
            ]
        ]
    },
    {
        "id": "2b166436.8ef15c",
        "type": "file in",
        "z": "5c310d6f.5422c4",
        "name": "",
        "filename": "/home/pi/BackUpNodeRed/Quinela",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 347.26185607910156,
        "y": 350.47619819641113,
        "wires": [
            [
                "8a0092da.e5338"
            ]
        ]
    },
    {
        "id": "a720ec58.bdd7b",
        "type": "file",
        "z": "5c310d6f.5422c4",
        "name": "",
        "filename": "",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 813.6905174255371,
        "y": 161.428565343221,
        "wires": [
            []
        ]
    },
    {
        "id": "35b19e16.300f22",
        "type": "inject",
        "z": "5c310d6f.5422c4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 117.738037109375,
        "y": 350.238112449646,
        "wires": [
            [
                "2b166436.8ef15c"
            ]
        ]
    },
    {
        "id": "8a0092da.e5338",
        "type": "debug",
        "z": "5c310d6f.5422c4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 593.6903839111328,
        "y": 353.0952339172363,
        "wires": []
    },
    {
        "id": "f3dfc54b.b06b18",
        "type": "inject",
        "z": "5c310d6f.5422c4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 171.4285659790039,
        "y": 97.14285469055176,
        "wires": [
            [
                "b0903dad.28939"
            ]
        ]
    },
    {
        "id": "20faf778.ef7ef8",
        "type": "file",
        "z": "5c310d6f.5422c4",
        "name": "",
        "filename": "",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "delete",
        "encoding": "none",
        "x": 509.80152130126953,
        "y": 93.57143115997314,
        "wires": [
            []
        ]
    },
    {
        "id": "f23fa64a.0625a8",
        "type": "e-mail",
        "z": "5c310d6f.5422c4",
        "server": "smtp.mail.yahoo.com",
        "port": "465",
        "secure": true,
        "tls": false,
        "name": "gdietrich22@yahoo.com.ar",
        "dname": "gd28722563",
        "x": 970.0793609619141,
        "y": 250.31744130452472,
        "wires": []
    },
    {
        "id": "66950e4b.ca117",
        "type": "delay",
        "z": "5c310d6f.5422c4",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 812.3016242980957,
        "y": 251.42858060201007,
        "wires": [
            [
                "f23fa64a.0625a8"
            ]
        ]
    },
    {
        "id": "cbcecb15.a99278",
        "type": "debug",
        "z": "5c310d6f.5422c4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 909.5237693786621,
        "y": 360.31745465596515,
        "wires": []
    },
    {
        "id": "b0903dad.28939",
        "type": "function",
        "z": "5c310d6f.5422c4",
        "name": "",
        "func": "msg.filename = \"/home/pi/BackUpNodeRed/Quinela/\" + global.get(\"fechaAno\") + \"/1\";\nvar mess = 0;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 342.02381896972656,
        "y": 96.34920477867126,
        "wires": [
            [
                "20faf778.ef7ef8"
            ]
        ]
    },
    {
        "id": "bbafd8ad.901bd8",
        "type": "inject",
        "z": "5c310d6f.5422c4",
        "name": "enviar Mail",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "enviaMail",
        "payload": "",
        "payloadType": "date",
        "x": 462.8571434020996,
        "y": 173.65078290303546,
        "wires": [
            [
                "f7933031.4d3e8"
            ]
        ]
    },
    {
        "id": "22d5cf6.d23353",
        "type": "http request",
        "z": "5c310d6f.5422c4",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "https://www.jugandoonline.com.ar/SorteosQuiniela3.aspx",
        "tls": "",
        "proxy": "",
        "authType": "",
        "x": 443.33334732055664,
        "y": 491.4285888671875,
        "wires": [
            [
                "aa658b45.78ef88"
            ]
        ]
    },
    {
        "id": "aa658b45.78ef88",
        "type": "function",
        "z": "5c310d6f.5422c4",
        "name": "",
        "func": "context.mes = context.mes || 18;\nvar payload = msg.payload;\nvar mes = global.get(\"fechaMes\");\nif (msg.topic != \"enviaMail\"){\n    var primeraCiudad = payload.substring(payload.indexOf(\"Ciudad La Primera\") + 119, payload.indexOf(\"Ciudad La Primera\") + 123);\n    var primeraProv = msg.payload.substring(msg.payload.indexOf(\"Prov Bs As La Primera\") + 123, msg.payload.indexOf(\"Prov Bs As La Primera\") + 127);\n    var SantaFeLaPrimera = msg.payload.substring(msg.payload.indexOf(\"Santa Fe La Primera\") + 121, msg.payload.indexOf(\"Santa Fe La Primera\") + 125);\n    \n    var CiudadMatutino = msg.payload.substring(msg.payload.indexOf(\"Ciudad Matutino\") + 119, msg.payload.indexOf(\"Ciudad Matutino\") + 123);\n    var ProvMatutino = msg.payload.substring(msg.payload.indexOf(\"Prov Bs As Matutino\") + 123, msg.payload.indexOf(\"Prov Bs As Matutino\") + 127);\n    var SantaFeMatutino = msg.payload.substring(msg.payload.indexOf(\"Santa Fe Matutino\") + 121, msg.payload.indexOf(\"Santa Fe Matutino\") + 125);\n    \n    var CiudadVespertino = msg.payload.substring(msg.payload.indexOf(\"Ciudad Vespertino\") + 119, msg.payload.indexOf(\"Ciudad Vespertino\") + 123);\n    var ProvVespertino = msg.payload.substring(msg.payload.indexOf(\"Prov Bs As Vespertino\") + 123, msg.payload.indexOf(\"Prov Bs As Vespertino\") + 127);\n    var SantaFeVespertino = msg.payload.substring(msg.payload.indexOf(\"Santa Fe Vespertino\") + 121, msg.payload.indexOf(\"Santa Fe Vespertino\") + 125);\n    \n    var CiudadNocturno = msg.payload.substring(msg.payload.indexOf(\"Ciudad Nocturno\") + 119, msg.payload.indexOf(\"Ciudad Nocturno\") + 123);\n    var ProvNocturno = msg.payload.substring(msg.payload.indexOf(\"Prov Bs As Nocturno\") + 123, msg.payload.indexOf(\"Prov Bs As Nocturno\") + 127);\n    var SantaFeNocturno = msg.payload.substring(msg.payload.indexOf(\"Santa Fe Nocturno\") + 121, msg.payload.indexOf(\"Santa Fe Nocturno\") + 125);\n    \n    \n    // Santa Fe La Primera\n    // msg.payload =  \"Primera:    \" + primeraCiudad + \" - \" + primeraProv + \" - \" + SantaFeLaPrimera + \"\\n\";\n    // msg.payload += \"Matutino:   \" + CiudadMatutino + \" - \" + ProvMatutino + \" - \" + SantaFeMatutino + \"\\n\";\n    // msg.payload += \"Vespertino: \" + CiudadVespertino + \" - \" + ProvVespertino + \" - \" + SantaFeVespertino + \"\\n\";\n    // msg.payload += \"Nocturna:   \" + CiudadNocturno + \" - \" + ProvNocturno + \" - \" + SantaFeNocturno;\n    \n    msg.payload = primeraCiudad + \" - \" + primeraProv + \" - \" + SantaFeLaPrimera + \" - \";\n    msg.payload += CiudadMatutino + \" - \" + ProvMatutino + \" - \" + SantaFeMatutino + \" - \";\n    msg.payload += CiudadVespertino + \" - \" + ProvVespertino + \" - \" + SantaFeVespertino + \" - \";\n    msg.payload += CiudadNocturno + \" - \" + ProvNocturno + \" - \" + SantaFeNocturno;\n    \n    \n    msg.payload = global.get(\"fechaQuinela\") + \" - \" + msg.payload + \"\\n\";\n    msg.filename = \"/home/pi/BackUpNodeRed/Quinela/\" + global.get(\"fechaAno\") + \"/\" + mes;\n    node.send([msg, null]);\n}\n\nnode.status({text: global.get(\"fechaMes\") + \" -- \" + context.mes});\n\nif (parseInt(global.get(\"fechaMes\")) !== parseInt(context.mes) || msg.topic == \"enviaMail\"){\n    context.mes = global.get(\"fechaMes\");\n    var mensaje = \"Resultados Quinela del mes: \" + global.get(\"fechaMes\") + '/' + global.get(\"fechaAno\");\n    msg.payload = mensaje;\n    msg.topic = mensaje;\n    msg.filename = \"/home/pi/BackUpNodeRed/Quinela/\" + global.get(\"fechaAno\") + \"/\" + mes;\n    msg.attachments = [{\n        filename: mes + '.txt',// + '.csv',\n        path: '/home/pi/BackUpNodeRed/Quinela/' + global.get(\"fechaAno\") + \"/\" + mes,//.txt',\n        content: mensaje\n    }]    \n    node.send([null, msg]);\n    return;\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 628.3333473205566,
        "y": 498.0952555338542,
        "wires": [
            [
                "11367fdd.1ae01"
            ],
            []
        ]
    },
    {
        "id": "92c04caa.f9072",
        "type": "function",
        "z": "5c310d6f.5422c4",
        "name": "",
        "func": "context.envio = context.envio || 0;\nif (parseInt(global.get(\"hh\")) === 21 && parseInt(global.get(\"mm\")) > 15 && parseInt(context.envio) === 0){\n    context.envio = 1\n    return msg;\n}\n\nif (parseInt(global.get(\"hh\")) === 23 && parseInt(context.envio) === 1)context.envio = 0;",
        "outputs": 1,
        "noerr": 0,
        "x": 277.6190986633301,
        "y": 495.47621154785156,
        "wires": [
            [
                "22d5cf6.d23353"
            ]
        ]
    },
    {
        "id": "11367fdd.1ae01",
        "type": "debug",
        "z": "5c310d6f.5422c4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 804.9999961853027,
        "y": 451.4285988807678,
        "wires": []
    },
    {
        "id": "76ef025f.b1e1bc",
        "type": "inject",
        "z": "5c310d6f.5422c4",
        "name": "enviar Mail",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "enviaMail",
        "payload": "",
        "payloadType": "date",
        "x": 427.50003814697266,
        "y": 423.6508140563965,
        "wires": [
            [
                "aa658b45.78ef88"
            ]
        ]
    },
    {
        "id": "8f575945.63ec48",
        "type": "inject",
        "z": "5c310d6f.5422c4",
        "name": "",
        "repeat": "600",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 116.4285888671875,
        "y": 498.0952615737915,
        "wires": [
            [
                "92c04caa.f9072"
            ]
        ]
    },
    {
        "id": "66906315.eecc9c",
        "type": "inject",
        "z": "5c310d6f.5422c4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170.7142857142857,
        "y": 432.85714285714283,
        "wires": [
            [
                "22d5cf6.d23353"
            ]
        ]
    },
    {
        "id": "640021ed.69792",
        "type": "mqtt in",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "PatioLuz/Recibo",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 504.5,
        "y": 34,
        "wires": [
            [
                "6c6744bd.03494c"
            ]
        ]
    },
    {
        "id": "6c6744bd.03494c",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 709.5,
        "y": 27,
        "wires": []
    },
    {
        "id": "4cb8a55a.a3715c",
        "type": "inject",
        "z": "1b403a13.0ec8c6",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 781.5,
        "y": 698,
        "wires": [
            [
                "803cd776.b0d768"
            ]
        ]
    },
    {
        "id": "b8bcf3d1.0b22",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 268.5,
        "y": 2076,
        "wires": [
            [
                "ffce9989.7876b8"
            ]
        ]
    },
    {
        "id": "83ce556d.124da8",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 248.5,
        "y": 2163,
        "wires": [
            [
                "9fff7fa4.777be"
            ]
        ]
    },
    {
        "id": "ffce9989.7876b8",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg.payload  = \"estado100#100#1\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 461.5,
        "y": 2074,
        "wires": [
            [
                "3622ee95.32ca72",
                "f9c71901.2f7b98"
            ]
        ]
    },
    {
        "id": "3622ee95.32ca72",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Porche/Recibo",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 656.5,
        "y": 2130,
        "wires": []
    },
    {
        "id": "9fff7fa4.777be",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg.payload  = \"estado0#0#1\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 449,
        "y": 2171,
        "wires": [
            [
                "3622ee95.32ca72",
                "f9c71901.2f7b98"
            ]
        ]
    },
    {
        "id": "f9c71901.2f7b98",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 664.5,
        "y": 2275,
        "wires": []
    },
    {
        "id": "1cf5793d.33c6f7",
        "type": "inject",
        "z": "f682d492.22a758",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "x": 1441.5,
        "y": 1020,
        "wires": [
            [
                "8a620d61.c043c"
            ]
        ]
    },
    {
        "id": "8a620d61.c043c",
        "type": "function",
        "z": "f682d492.22a758",
        "name": "",
        "func": "\n\n    global.set(\"estado-Porche\", global.get(\"fechaCompleta\") + \" - Con\\n\");\n    global.set(\"estadoPorche\", 1);\n    node.send(msg);  \n    \n    node.status({text: global.get(\"estado-Porche\")});      ",
        "outputs": 1,
        "noerr": 0,
        "x": 1597,
        "y": 1019,
        "wires": [
            []
        ]
    },
    {
        "id": "3a1dec29.7fa414",
        "type": "mqtt out",
        "z": "9c63fd61.9908c",
        "name": "",
        "topic": "ESP/Lavadero/riego",
        "qos": "",
        "retain": "",
        "broker": "e779f8d6.7bc2c8",
        "x": 617.5,
        "y": 1022,
        "wires": []
    },
    {
        "id": "94da225a.fb7c1",
        "type": "inject",
        "z": "9c63fd61.9908c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 228.5,
        "y": 1077,
        "wires": [
            [
                "e5a9548.64637a8"
            ]
        ]
    },
    {
        "id": "e5a9548.64637a8",
        "type": "function",
        "z": "9c63fd61.9908c",
        "name": "",
        "func": "msg.payload = global.set(\"tipoRiego\", 0)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 371.5,
        "y": 1078,
        "wires": [
            [
                "2a784b62.c6ea24",
                "3a1dec29.7fa414"
            ]
        ]
    },
    {
        "id": "2a784b62.c6ea24",
        "type": "debug",
        "z": "9c63fd61.9908c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 518.5,
        "y": 1076,
        "wires": []
    },
    {
        "id": "38526b0d.0344a4",
        "type": "debug",
        "z": "50119c6e.6ff584",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 486,
        "y": 578,
        "wires": []
    },
    {
        "id": "177ff9bb.9c1ec6",
        "type": "blynk-ws-out-write",
        "z": "a43ba0fe.679e4",
        "name": "",
        "pin": "150",
        "pinmode": "1",
        "client": "2c18e412.5f5cbc",
        "x": 700.5,
        "y": 203,
        "wires": []
    },
    {
        "id": "fd21249c.cd27c8",
        "type": "blynk-ws-in-write",
        "z": "a43ba0fe.679e4",
        "name": "",
        "pin": "132",
        "pin_all": 0,
        "client": "2c18e412.5f5cbc",
        "x": 544.5,
        "y": 51,
        "wires": [
            []
        ]
    },
    {
        "id": "f9232a27.01e0f8",
        "type": "mqtt in",
        "z": "a43ba0fe.679e4",
        "name": "",
        "topic": "ESP/Gas/Envio",
        "qos": "2",
        "datatype": "auto",
        "broker": "e779f8d6.7bc2c8",
        "x": 177.5,
        "y": 75,
        "wires": [
            [
                "7cb36ef1.e6117",
                "4e5f8b98.50bb94"
            ]
        ]
    },
    {
        "id": "7cb36ef1.e6117",
        "type": "debug",
        "z": "a43ba0fe.679e4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 430.5,
        "y": 129,
        "wires": []
    },
    {
        "id": "4e5f8b98.50bb94",
        "type": "function",
        "z": "a43ba0fe.679e4",
        "name": "",
        "func": "var date = new Date();\nvar payload = msg.payload;\ncontext.tiempoAnteriorQuemador = context.tiempoAnteriorQuemador || 0;\ncontext.tiempoAnteriorCaldera = context.tiempoAnteriorCaldera || 0;\ncontext.tiempoAnteriorTermo = context.tiempoAnteriorTermo || 0;\ncontext.estAnteriorQuemador = context.estAnteriorQuemador || null;\ncontext.estAnteriorCaldera = context.estAnteriorCaldera || null;\ncontext.diaAnterior = context.diaAnterior || null;\ncontext.avisoMail = context.avisoMail || 0;\nvar dia = date.getDate(); \nvar datos = 0;\n\n\nif (global.get(\"estQuemador\") === undefined || global.get(\"estQuemador\") == isNaN)global.set(\"estQuemador\", 0);\nif (global.get(\"estCaldera\") === undefined || global.get(\"estCaldera\") == isNaN)global.set(\"estCaldera\", 0);\nif (global.get(\"mtsCaldera\") === undefined || global.get(\"mtsCaldera\") == isNaN)global.set(\"mtsCaldera\", 0);\nif (global.get(\"mtsTermo\") === undefined || global.get(\"mtsTermo\") == isNaN)global.set(\"mtsTermo\", 0);\nif (global.get(\"mtsTotales\") === undefined || global.get(\"mtsTotales\") == isNaN)global.set(\"mtsTotales\", 0);\n\n\nif (global.get(\"mtsDiariosCaldera\") === undefined || global.get(\"mtsDiariosCaldera\") == isNaN)global.set(\"mtsDiariosCaldera\", 0);\nif (global.get(\"mtsDiariosTermo\") === undefined || global.get(\"mtsDiariosTermo\") == isNaN)global.set(\"mtsDiariosTermo\", 0);\nif (global.get(\"tiempoDiarioCaldera\") === undefined || global.get(\"tiempoDiarioCaldera\") == isNaN)global.set(\"tiempoDiarioCaldera\", 0);\nif (global.get(\"tiempoMarchaCaldera\") === undefined || global.get(\"tiempoMarchaCaldera\") == isNaN)global.set(\"tiempoMarchaCaldera\", 0);\n\nif (global.get(\"mtsControlCaldera\") === undefined || global.get(\"mtsControlCaldera\") == isNaN)global.set(\"mtsControlCaldera\", 0);\nif (global.get(\"tiempoControlCaldera\") === undefined || global.get(\"tiempoControlCaldera\") == isNaN)global.set(\"tiempoControlCaldera\", 0);\n\n\nvar enviarDatos = 0;\nvar tiempo = 0;\n\nif (msg.topic == \"timer\"){\n\tif (parseInt(context.diaAnterior) != parseInt(dia)){\n\t\tcontext.diaAnterior = dia;\n\t\tcontext.avisoMail = 0;\n\t}\t\n\tif (parseInt(date.getHours()) == 23 && parseInt(date.getMinutes()) == 59 && parseInt(context.avisoMail) === 0){\n\t\tcontext.avisoMail = 1;\n\n\t\ttiempo = parseInt(date.getTime()) - parseInt(global.get(\"tiempoEncCaldera\"));\n\t\t// msg.payload = tiempo; node.send(msg);\n\t\ttiempo = tiempo / 3600000;\n\t\ttiempo = parseFloat(tiempo).toFixed(2);\n\t\ttiempo = parseFloat(global.get(\"tiempoDiarioCaldera\")) + parseFloat(tiempo); global.set(\"tiempoDiarioCaldera\", tiempo);\t\t\n\t\tglobal.set(\"tiempoEncCaldera\", date.getTime());\n\n\t\ttiempo = \"Consumo de gas del: \" + global.get(\"fechaQuinela\") + \":\\n\";\n\t\ttiempo += \"Caldera: \" + global.get(\"mtsDiariosCaldera\") + \" mts3.\\n\";\n\t\ttiempo += \"Termo: \" + global.get(\"mtsDiariosTermo\") + \" mts3.\\n\";\n\t\ttiempo += \"Totales Diarios: \" + parseFloat(global.get(\"mtsDiariosTermo\")) + parseFloat(global.get(\"mtsDiariosCaldera\")) + \" mts3.\\n\";\n\t\ttiempo += \"Tiempo de caldera prendida: \" + global.get(\"tiempoDiarioCaldera\") + \" minutos\\n\";\n\n\t\tmsg.topic = \"Conumos de gas de casa\";\n    \tmsg.payload = tiempo;\t\n    \tnode.send([null, null, msg]);\n\n\t\tmsg = {topic: \"metrosGas\", payload: global.get(\"mtsTotales\")}; node.send([null, msg]);\n\t\tmsg = {topic: \"mtsDiariosCaldera\", payload: global.get(\"mtsDiariosCaldera\")}; node.send([null, msg]);\n\t\tmsg = {topic: \"mtsDiariosTermo\", payload: global.get(\"tiempoDiarioCaldera\")}; node.send([null, msg]);\n\n\t\ttiempo = parseFloat(global.get(\"mtsDiariosTermo\")) + parseFloat(global.get(\"mtsDiariosCaldera\"));\n\t\t\n\t\tmsg = {topic: \"mtsDiariosTotales\", payload: tiempo}; node.send([null, msg]);\n\t\tmsg = {topic: \"tiempoDiarioCaldera\", payload: global.get(\"tiempoDiarioCaldera\")}; node.send([null, msg]);\n\n\t\tglobal.set(\"mtsDiariosCaldera\", 0); global.set(\"mtsDiariosTermo\", 0);\n\t\tglobal.set(\"mtsDiariosTotales\", 0); global.set(\"tiempoDiarioCaldera\", 0);\n\n    return ([null, msg]);\n\n\t}\n\tmsg = {pin: 129, payload: global.get(\"estQuemador\")}; node.send(msg);\n\tmsg = {pin: 130, payload: global.get(\"estCaldera\")}; node.send(msg);\n\tmsg = {pin: 131, payload: global.get(\"estTermo\")}; node.send(msg);\n\treturn;\n}\n\n\n// if (msg.topic == \"ESP/Lavadero/Recibo\" && msg.payload == \"pedidoTemp\"){\n//     // var dato = parseFloat(global.get(\"mtsTotales\")) + parseFloat(global.get(\"mtsCaldera\")) + parseFloat(global.get(\"mtsTermo\"));\n//     // msg.payload = \"Dato:  \" + dato;node.send(msg);\n\n//     // msg.payload = global.get(\"mtsTotales\") + \"   caldera\" + global.get(\"mtsCaldera\") + \"   termo\" + global.get(\"mtsTermo\"); node.send(msg);\n//     // global.set(\"mtsTotales\", dato);\n//     // msg.payload = \"termo\" + global.get(\"mtsTermo\"); node.send(msg);\n//     msg = {topic: \"metrosGas\", payload: global.get(\"mtsTotales\")}; \n//     return ([null, msg]);\n// }\n\nif (parseInt(payload.substring(0,1)) !== parseInt(context.estAnteriorQuemador) && parseInt(date.getTime()) > parseInt(context.tiempoAnteriorQuemador) + 2000){\n\tenviarDatos = 1;\n\tcontext.tiempoAnteriorQuemador = date.getTime();\n\tcontext.estAnteriorQuemador = payload.substring(0,1);\n\tglobal.set(\"estQuemador\",payload.substring(0,1));\n\tif (parseInt(global.get(\"estQuemador\")) === 1){global.set(\"tiempoEncQuemador\", date.getTime());}\n\tif (parseInt(global.get(\"estQuemador\")) === 0){\n\t\ttiempo = parseInt(date.getTime()) - parseInt(global.get(\"tiempoEncQuemador\"));\n\n\t\tdatos = parseFloat(global.get(\"tiempoControlCaldera\")) + tiempo; global.set(\"tiempoControlCaldera\", datos);\n\n\t\ttiempo = tiempo / 1000; //  aca esta el tiempo en minutos\n\n\t\tvar tiempo2 = parseFloat(tiempo) + parseFloat(global.get(\"tiempoMarchaCaldera\")); global.set(\"tiempoMarchaCaldera\", tiempo2);\n\n\t\ttiempo = parseFloat(tiempo) * parseFloat(22.369); tiempo = parseFloat(tiempo) / parseFloat(50190.968); // 1mts3 en 2190 segundos (36.5min)\n\t\t// msg.payload = \"mts3: \" + tiempo +\"\\n\"; node.send([null, msg]);\n\n\t\tdatos = parseFloat(global.get(\"mtsControlCaldera\")) + tiempo; global.set(\"mtsControlCaldera\", datos);\n\n\t\tvar tiempo3 = parseFloat(global.get(\"mtsTotales\")) + parseFloat(tiempo); global.set(\"mtsTotales\", tiempo3);\n\t\t\n\t\ttiempo = parseFloat(global.get(\"mtsDiariosCaldera\")) + parseFloat(tiempo); tiempo = parseFloat(tiempo).toFixed(3); global.set(\"mtsDiariosCaldera\", tiempo);\n\t\t// global.set(\"mtsCaldera\", tiempo);\n\t\t// tiempo = parseFloat(global.get(\"mtsTotales\")) + parseFloat(tiempo);\n\t\t// global.set(\"mtsTotales\", tiempo);\n\t\t// msg.payload = \"mts3 totales: \" + global.get(\"mtsTotales\") +\"\\n\"; node.send([null, msg]);\n\t\t\n\t\t// msg.payload = \n\t}\n}\npayload = payload.substring(2);\n\nif (parseInt(payload.substring(0,1)) !== parseInt(context.estAnteriorCaldera) && parseInt(date.getTime()) > parseInt(context.tiempoAnteriorCaldera) + 2000){\n\tenviarDatos = 1;\n\tcontext.tiempoAnteriorCaldera = date.getTime();\n\tcontext.estAnteriorCaldera = payload.substring(0,1);\n\tglobal.set(\"estCaldera\",payload.substring(0,1));\n\tif (parseInt(global.get(\"estCaldera\")) === 1)global.set(\"tiempoEncCaldera\", date.getTime());\n\tif (parseInt(global.get(\"estCaldera\")) === 0){\n\t\ttiempo = parseInt(date.getTime()) - parseInt(global.get(\"tiempoEncCaldera\"));\n\t\t// msg.payload = tiempo; node.send(msg);\n\t\ttiempo = tiempo / 3600000;\n\t\ttiempo = parseFloat(tiempo).toFixed(2);\n\t\ttiempo = parseFloat(global.get(\"tiempoDiarioCaldera\")) + parseFloat(tiempo); global.set(\"tiempoDiarioCaldera\", tiempo);\n\t}\t\n}\npayload = payload.substring(2);\n\nif (parseInt(payload.substring(0,1)) !== parseInt(context.tiempoAnteriorTermo)){\n\tenviarDatos = 1;\n\tcontext.tiempoAnteriorTermo = payload.substring(0,1);\n\tif (parseInt(payload.substring(0,1)) === 1)global.set(\"estTermo\", 0);\n\tif (parseInt(payload.substring(0,1)) === 0)global.set(\"estTermo\", 1);\n\tif (parseInt(global.get(\"estTermo\")) === 1){global.set(\"tiempoEncTermo\", date.getTime());}\n\tif (parseInt(global.get(\"estTermo\")) === 0){\n\t\t\n\t\ttiempo = parseInt(date.getTime()) - parseInt(global.get(\"tiempoEncTermo\"));\n\n\t\t// datos = parseFloat(global.get(\"tiempoControlCaldera\")) + tiempo; global.set(\"tiempoControlCaldera\", datos);\n\n\t\ttiempo = tiempo / 1000;//  aca esta el tiempo en minutos\n\t\tmsg.payload = \"tiempo en segundos: \" + tiempo +\"\\n\"; node.send([null, msg]);\n\t\ttiempo = tiempo / 6920;// 1mts3 en 6920 segundos (115.33min)\n\n\t\t// datos = parseFloat(global.get(\"mtsControlCaldera\")) + tiempo; global.set(\"mtsControlCaldera\", datos);\n\n\t\tmsg.payload = \"mts3: \" + tiempo +\"\\n\"; node.send([null, msg]);\n\t\ttiempo = parseFloat(global.get(\"mtsDiariosTermo\")) + tiempo; tiempo = parseFloat(tiempo).toFixed(3); global.set(\"mtsDiariosTermo\", tiempo);\n\t\t// global.set(\"mtsTermo\", tiempo);\n\t\ttiempo = parseFloat(global.get(\"mtsTotales\")) + parseFloat(tiempo);\n\n\t\tglobal.set(\"mtsTotales\", tiempo);\n\n\t\t// global.set(\"mtsControlCaldera\")\n\n\t\tmsg.payload = \"mts3 totales: \" + global.get(\"mtsTotales\") +\"\\n\"; node.send([null, msg]);\n\t}\t\t\n}\n\n\nif (parseInt(enviarDatos) === 1){\n\tmsg = {pin: 129, payload: global.get(\"estQuemador\")}; node.send(msg);\n\tmsg = {pin: 130, payload: global.get(\"estCaldera\")}; node.send(msg);\n\tmsg = {pin: 131, payload: global.get(\"estTermo\")}; node.send(msg);\n\n\t// msg.payload = global.get(\"fechaCompleta\") + \" - Q: \" + global.get(\"estQuemador\");\n\t// msg.payload = msg.payload +  \" - BC: \" + global.get(\"estCaldera\");\n\t// msg.payload = msg.payload +  \" - T: \" + global.get(\"estTermo\") + \"\\n\";\n\nmsg.payload = \"\\nmts totales:\" + global.get(\"mtsTotales\").toFixed(3) + \"\\n\";\nmsg.payload += \"mts diar caldera: \" + global.get(\"mtsDiariosCaldera\") + \"\\n\";\nmsg.payload += \"mts diar termo: \" + global.get(\"mtsDiariosTermo\") + \"\\n\";\nmsg.payload += \"tiempoDiarioCaldera: \" + global.get(\"tiempoDiarioCaldera\").toFixed(2) + \"\\n\";\nmsg.payload += \"tiempoMarchaCaldera: \" + global.get(\"tiempoMarchaCaldera\") + \"\\n\";\nmsg.payload += \"tiempoControlCaldera: \" + global.get(\"tiempoControlCaldera\").toFixed(2) + \"\\n\";\nmsg.payload += \"mtsControlCaldera: \" + global.get(\"mtsControlCaldera\") + \"\\n\";\n\n\tmsg = {pin: 150, payload: msg.payload}; \n\t// node.send(msg);\n\t// msg.payload = \"mts totales: \" + parseFloat(global.get(\"mtsTotales\")).toFixed(3) + \"\\n\"\n\treturn msg;\n}\n\n\n\n\n// msg.payload = global.get(\"fechaCompleta\") + \" - \" + msg.payload + \"\\n\";\n// return msg;",
        "outputs": 3,
        "noerr": 0,
        "x": 428.5,
        "y": 178,
        "wires": [
            [
                "b7d65fc1.5ee4f",
                "177ff9bb.9c1ec6"
            ],
            [
                "f0e6b30c.ec7dc",
                "2771a2f3.2517ae"
            ],
            [
                "cc8cf82a.118428",
                "1da74f12.719651"
            ]
        ]
    },
    {
        "id": "1902a258.c3b9fe",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0#1#0",
        "payloadType": "str",
        "x": 187.5,
        "y": 110,
        "wires": [
            [
                "4e5f8b98.50bb94",
                "9aac0d0c.c647c",
                "f2e9aef2.5cb47"
            ]
        ]
    },
    {
        "id": "b7d65fc1.5ee4f",
        "type": "debug",
        "z": "a43ba0fe.679e4",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 685,
        "y": 127,
        "wires": []
    },
    {
        "id": "e981968e.c0f718",
        "type": "function",
        "z": "a43ba0fe.679e4",
        "name": "",
        "func": "var payload = msg.payload;\n// node.send(msg);\nglobal.set(\"estCaldera\",payload.substring(0,1));\npayload = payload.substring(2);// msg.payload = payload; node.send(msg);\nglobal.set(\"estBomba\",payload.substring(0,1));\npayload = payload.substring(2);// msg.payload = payload; node.send(msg);\n// global.set(\"estTermo\",payload.substring(0,1));\n\nif (parseInt(payload.substring(0,1)) === 1)global.set(\"estTermo\", 0);\nif (parseInt(payload.substring(0,1)) === 0)global.set(\"estTermo\", 1);\n\nmsg = {pin: 129, payload: global.get(\"estCaldera\")}; node.send(msg);\nmsg = {pin: 130, payload: global.get(\"estBomba\")}; node.send(msg);\nmsg = {pin: 131, payload: global.get(\"estTermo\")}; node.send(msg);\n\nmsg.payload = global.get(\"fechaCompleta\") + \" - Q: \" + global.get(\"estCaldera\");\nmsg.payload = msg.payload +  \" - BC: \" + global.get(\"estBomba\");\nmsg.payload = msg.payload +  \" - T: \" + global.get(\"estTermo\") + \"\\n\";\n\nmsg = {pin: 150, payload: msg.payload}; \n\n\n\nreturn msg;\n\n\n\n\n// msg.payload = global.get(\"fechaCompleta\") + \" - \" + msg.payload + \"\\n\";\n// return msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 459,
        "y": 244,
        "wires": [
            []
        ]
    },
    {
        "id": "2771a2f3.2517ae",
        "type": "thingspeak42",
        "z": "a43ba0fe.679e4",
        "name": "",
        "delay": "5",
        "topic1": "metrosGas",
        "topic2": "mtsDiariosCaldera",
        "topic3": "mtsDiariosTermo",
        "topic4": "mtsDiariosTotales",
        "topic5": "tiempoDiarioCaldera",
        "topic6": "",
        "topic7": "",
        "topic8": "",
        "endpoint": "https://thingspeak.com",
        "x": 684.5,
        "y": 281,
        "wires": []
    },
    {
        "id": "bcef1ce4.81b0b",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0#1#0",
        "payloadType": "str",
        "x": 183,
        "y": 221,
        "wires": [
            [
                "4e5f8b98.50bb94"
            ]
        ]
    },
    {
        "id": "ca6726a4.294378",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ESP/Lavadero/Recibo",
        "payload": "pedidoTemp",
        "payloadType": "str",
        "x": 222.5,
        "y": 307,
        "wires": [
            [
                "4e5f8b98.50bb94"
            ]
        ]
    },
    {
        "id": "f0e6b30c.ec7dc",
        "type": "debug",
        "z": "a43ba0fe.679e4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 700,
        "y": 333,
        "wires": []
    },
    {
        "id": "ade1cd2f.12aa2",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "2098.218",
        "payloadType": "num",
        "x": 153.5,
        "y": 24,
        "wires": [
            [
                "737bfc5d.85dda4"
            ]
        ]
    },
    {
        "id": "737bfc5d.85dda4",
        "type": "function",
        "z": "a43ba0fe.679e4",
        "name": "",
        "func": "global.set(\"mtsTotales\", msg.payload);\nglobal.set(\"mtsCaldera\", 0);\nglobal.set(\"mtsTermo\", 0);\nglobal.set(\"mtsDiariosCaldera\", 0);\nglobal.set(\"mtsDiariosTermo\", 0);\nglobal.set(\"tiempoDiarioCaldera\", 0);\nglobal.set(\"tiempoMarchaCaldera\", 0);\nglobal.set(\"tiempoControlCaldera\", 0);\nglobal.set(\"mtsControlCaldera\", 0);",
        "outputs": 1,
        "noerr": 0,
        "x": 323,
        "y": 22,
        "wires": [
            []
        ]
    },
    {
        "id": "e625c071.9916e",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "2030.900",
        "payloadType": "num",
        "x": 166,
        "y": 337,
        "wires": [
            [
                "eb1b52fc.9f2d3"
            ]
        ]
    },
    {
        "id": "eb1b52fc.9f2d3",
        "type": "function",
        "z": "a43ba0fe.679e4",
        "name": "",
        "func": "msg.payload = \"\\nmts totales:\" + global.get(\"mtsTotales\").toFixed(3) + \"\\n\";\nmsg.payload += \"mts diar caldera: \" + global.get(\"mtsDiariosCaldera\") + \"\\n\";\nmsg.payload += \"mts diar termo: \" + global.get(\"mtsDiariosTermo\") + \"\\n\";\nmsg.payload += \"tiempoDiarioCaldera: \" + global.get(\"tiempoDiarioCaldera\").toFixed(2) + \"\\n\";\nmsg.payload += \"tiempoMarchaCaldera: \" + global.get(\"tiempoMarchaCaldera\") + \"\\n\";\nmsg.payload += \"tiempoControlCaldera: \" + global.get(\"tiempoControlCaldera\").toFixed(2) + \"\\n\";\nmsg.payload += \"mtsControlCaldera: \" + global.get(\"mtsControlCaldera\") + \"\\n\";\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 296.5,
        "y": 340,
        "wires": [
            [
                "b746541d.5a31c8"
            ]
        ]
    },
    {
        "id": "3378ce7d.593bd2",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "15",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "timer",
        "payload": "",
        "payloadType": "str",
        "x": 180,
        "y": 185,
        "wires": [
            [
                "4e5f8b98.50bb94"
            ]
        ]
    },
    {
        "id": "cc8cf82a.118428",
        "type": "e-mail",
        "z": "a43ba0fe.679e4",
        "server": "smtp.mail.yahoo.com",
        "port": "465",
        "secure": true,
        "tls": false,
        "name": "gdietrich22@yahoo.com.ar",
        "dname": "rgrjrvcuhxdloine",
        "x": 753,
        "y": 418,
        "wires": []
    },
    {
        "id": "59ec634c.d6693c",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 428.5,
        "y": 456,
        "wires": [
            [
                "cc8cf82a.118428"
            ]
        ]
    },
    {
        "id": "1da74f12.719651",
        "type": "debug",
        "z": "a43ba0fe.679e4",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 715,
        "y": 476,
        "wires": []
    },
    {
        "id": "61c04c4b.b4c414",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 114.5,
        "y": 388,
        "wires": [
            [
                "5d957444.86fcec"
            ]
        ]
    },
    {
        "id": "5d957444.86fcec",
        "type": "function",
        "z": "a43ba0fe.679e4",
        "name": "",
        "func": "msg.payload  = parseFloat(global.get(\"tiempoDiarioCaldera\"));\nnode.send(msg);\nmsg.payload  = parseFloat(global.get(\"tiempoDiarioCaldera\")) + 1000;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 266.5,
        "y": 385,
        "wires": [
            [
                "207f24cc.817a8c"
            ]
        ]
    },
    {
        "id": "41090efb.77488",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0#0#0",
        "payloadType": "str",
        "x": 193,
        "y": 147,
        "wires": [
            [
                "4e5f8b98.50bb94"
            ]
        ]
    },
    {
        "id": "9aac0d0c.c647c",
        "type": "function",
        "z": "a43ba0fe.679e4",
        "name": "",
        "func": "msg.payload = \"0#0#0\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 370.5,
        "y": 76,
        "wires": [
            [
                "c0e93e36.d7b72"
            ]
        ]
    },
    {
        "id": "c0e93e36.d7b72",
        "type": "delay",
        "z": "a43ba0fe.679e4",
        "name": "",
        "pauseType": "delay",
        "timeout": "117",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 532.5,
        "y": 80,
        "wires": [
            [
                "4b271a23.78e0f4"
            ]
        ]
    },
    {
        "id": "4b271a23.78e0f4",
        "type": "debug",
        "z": "a43ba0fe.679e4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 733,
        "y": 85,
        "wires": []
    },
    {
        "id": "f2e9aef2.5cb47",
        "type": "debug",
        "z": "a43ba0fe.679e4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 670,
        "y": 169,
        "wires": []
    },
    {
        "id": "b746541d.5a31c8",
        "type": "debug",
        "z": "a43ba0fe.679e4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 452,
        "y": 330,
        "wires": []
    },
    {
        "id": "207f24cc.817a8c",
        "type": "debug",
        "z": "a43ba0fe.679e4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 443,
        "y": 380,
        "wires": []
    },
    {
        "id": "588c4fa0.125d6",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0#1#0",
        "payloadType": "str",
        "x": 191,
        "y": 280,
        "wires": [
            [
                "4e5f8b98.50bb94"
            ]
        ]
    },
    {
        "id": "751a981c.5e83a8",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0#1#1",
        "payloadType": "str",
        "x": 194,
        "y": 254,
        "wires": [
            [
                "4e5f8b98.50bb94"
            ]
        ]
    },
    {
        "id": "a86f7d0c.4b093",
        "type": "function",
        "z": "a43ba0fe.679e4",
        "name": "",
        "func": "global.set(\"mtsTotales\", msg.payload);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 258,
        "y": 447,
        "wires": [
            []
        ]
    },
    {
        "id": "6e94f768.5464c8",
        "type": "inject",
        "z": "a43ba0fe.679e4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "2075.849",
        "payloadType": "num",
        "x": 88.5,
        "y": 449,
        "wires": [
            [
                "a86f7d0c.4b093"
            ]
        ]
    }
]